!function e(t,i,n){function r(s,a){if(!i[s]){if(!t[s]){var h="function"==typeof require&&require;if(!a&&h)return h(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=i[s]={exports:{}};t[s][0].call(c.exports,function(e){var i=t[s][1][e];return r(i?i:e)},c,c.exports,e,t,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,t,i){"use strict";var n=e("three"),r=e("./pointerlocker"),o=Math.PI/2;t.exports=function(e,t){function i(e,t){return function(){t.apply(e,arguments)}}function s(e,t,i){return Math.min(Math.max(e,t),i)}t||(t={}),e.rotation.set(0,0,0);var a=new n.Object3D;a.add(e);var h=new n.Object3D;h.add(a),this.domElement=t.domElement||document,this.domElement.setAttribute&&this.domElement.setAttribute("tabindex",-1),this.movementSpeed=t.movementSpeed||9,this.rollSpeed=t.rollSpeed||.5,this.movementSpeedMultiplier=1,this.jumpEnabled=void 0!==t.jumpEnabled?t.jumpEnabled:!0,this.canJump=!0,this.jumpVelocityBoost=t.jumpVelocityBoost||100,this.jumpVelocity=0,this.jumpGroundThreshold=t.jumpGroundThreshold||10,this.mass=t.mass||10,this.dragToLook=t.dragToLook||!1,this.autoForward=t.autoForward||!1,this.keysAsRotation=t.keysAsRotation||!1,this.allowYMovement=t.allowYMovement||!1,this.restrictedXRange=t.restrictedXRange||null,this.restrictedZRange=t.restrictedZRange||null,this.enabled=!1,this.locker=new r,this.getObject=function(){return h},this.pitchObject=function(){return a},this.setEnabled=function(e){this.enabled=e},this.requestPointerlock=function(){this.locker.requestPointerlock()},this.exitPointerlock=function(){this.locker.exitPointerlock()},this.reset=function(){[h,a,e].forEach(function(e){e.position.set(0,0,0),e.rotation.set(0,0,0)})},this.prevTime=window.performance?window.performance.now():new Date,this.mouseStatus=0,this.moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this.moveVector=new n.Vector3(0,0,0),this.rotationVector=new n.Vector3(0,0,0),this.keydown=function(e){if(!e.altKey){switch(e.keyCode){case 16:this.movementSpeedMultiplier=.1;break;case 87:this.moveState.forward=1;break;case 83:this.moveState.back=1;break;case 65:this.moveState.left=1;break;case 68:this.moveState.right=1;break;case 82:this.moveState.up=1;break;case 70:this.moveState.down=1;break;case 38:this.keysAsRotation?this.moveState.pitchUp=1:this.moveState.forward=1;break;case 40:this.keysAsRotation?this.moveState.pitchDown=1:this.moveState.back=1;break;case 37:this.keysAsRotation?this.moveState.yawLeft=1:this.moveState.left=1;break;case 39:this.keysAsRotation?this.moveState.yawRight=1:this.moveState.right=1;break;case 81:this.moveState.rollLeft=1;break;case 69:this.moveState.rollRight=1;break;case 32:this.jumpEnabled&&this.canJump&&(this.jumpVelocity+=this.jumpVelocityBoost,this.canJump=!1)}this.updateMovementVector(),this.updateRotationVector()}},this.keyup=function(e){switch(e.keyCode){case 16:this.movementSpeedMultiplier=1;break;case 87:this.moveState.forward=0;break;case 83:this.moveState.back=0;break;case 65:this.moveState.left=0;break;case 68:this.moveState.right=0;break;case 82:this.moveState.up=0;break;case 70:this.moveState.down=0;break;case 38:this.moveState.forward=0,this.moveState.pitchUp=0;break;case 40:this.moveState.back=0,this.moveState.pitchDown=0;break;case 37:this.moveState.left=0,this.moveState.yawLeft=0;break;case 39:this.moveState.right=0,this.moveState.yawRight=0;break;case 81:this.moveState.rollLeft=0;break;case 69:this.moveState.rollRight=0;break;case 90:this.reset()}this.updateMovementVector(),this.updateRotationVector()},this.mousedown=function(e){if(this.enabled&&(!this.locker.canEverHavePointerLock()||this.locker.currentlyHasPointerlock))if(this.domElement!==document&&this.domElement.focus(),e.preventDefault(),e.stopPropagation(),this.dragToLook)this.mouseStatus++;else{switch(e.button){case 0:this.moveState.forward=1;break;case 2:this.moveState.back=1}this.updateMovementVector()}},this.mousemove=function(e){if(this.enabled&&(!this.locker.canEverHavePointerLock()||this.locker.currentlyHasPointerlock)&&(!this.dragToLook||this.mouseStatus>0)){var t=e.movementX||e.mozMovementX||e.webkitMovementX,i=e.movementY||e.mozMovementY||e.webkitMovementY;(void 0===t||void 0===i)&&(void 0!==this.lastClientX?(t=e.clientX-this.lastClientX,i=e.clientY-this.lastClientY):(t=0,i=0),this.lastClientX=e.clientX,this.lastClientY=e.clientY),h.rotation.y-=.002*t,a.rotation.x-=.002*i,a.rotation.x=Math.max(-o,Math.min(o,a.rotation.x))}},this.mouseup=function(e){if(this.enabled&&(!this.locker.canEverHavePointerLock()||this.locker.currentlyHasPointerlock)){if(e.preventDefault(),e.stopPropagation(),this.dragToLook)this.mouseStatus--,this.moveState.yawLeft=this.moveState.pitchDown=0;else{switch(e.button){case 0:this.moveState.forward=0;break;case 2:this.moveState.back=0}this.updateMovementVector()}this.updateRotationVector()}},this.update=function(){var e=window.performance?window.performance.now():new Date,t=(e-this.prevTime)/1e3;if(this.enabled){var i=t*this.movementSpeed*this.movementSpeedMultiplier,n=t*this.rollSpeed;if(h.translateX(this.moveVector.x*i),this.restrictedXRange&&(h.position.x=s(h.position.x,this.restrictedXRange.min,this.restrictedXRange.max)),h.translateZ(this.moveVector.z*i),this.restrictedZRange&&(h.position.z=s(h.position.z,this.restrictedZRange.min,this.restrictedZRange.max)),this.allowYMovement)h.translateY(this.moveVector.y*i);else if(this.jumpEnabled){this.jumpVelocity-=9.8*this.mass*t;var r=this.jumpVelocity*t;h.translateY(r),h.position.y<this.jumpGroundThreshold&&(this.jumpVelocity=0,h.position.y=this.jumpGroundThreshold,this.canJump=!0)}this.keysAsRotation&&(h.rotateX(this.rotationVector.x*n),h.rotateY(this.rotationVector.y*n),h.rotateZ(this.rotationVector.z*n))}this.mostRecentDelta=t,this.prevTime=e},this.updateMovementVector=function(){var e=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right,this.moveVector.y=-this.moveState.down+this.moveState.up,this.moveVector.z=-e+this.moveState.back},this.updateRotationVector=function(){this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp,this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft,this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft},this.getContainerDimensions=function(){return this.domElement!==document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}},this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1),this.domElement.addEventListener("mousemove",i(this,this.mousemove),!1),this.domElement.addEventListener("mousedown",i(this,this.mousedown),!1),this.domElement.addEventListener("mouseup",i(this,this.mouseup),!1),window.addEventListener("keydown",i(this,this.keydown),!1),window.addEventListener("keyup",i(this,this.keyup),!1),this.updateMovementVector(),this.updateRotationVector()}},{"./pointerlocker":2,three:110}],2:[function(e,t,i){"use strict";t.exports=function(){function e(){document.pointerLockElement===o||document.mozPointerLockElement===o||document.webkitPointerLockElement===o?n.currentlyHasPointerlock=!0:n.currentlyHasPointerlock=!1,n.pointerLockChangeCallback&&n.pointerLockChangeCallback(n.currentlyHasPointerlock)}function t(e){console.log("POINTER LOCK ERROR:"),console.log(e)}function i(){r&&(document.addEventListener("pointerlockchange",function(){e()},!1),document.addEventListener("mozpointerlockchange",function(){e()},!1),document.addEventListener("webkitpointerlockchange",function(){e()},!1),document.addEventListener("pointerlockerror",function(e){t(e)},!1),document.addEventListener("mozpointerlockerror",function(e){t(e)},!1),document.addEventListener("webkitpointerlockerror",function(e){t(e)},!1))}var n=this,r="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,o=document.body;this.canRequestPointerlock=!1,this.currentlyHasPointerlock=!1,i(),this.requestPointerlock=function(){n.canRequestPointerlock=!0,o.requestPointerLock=o.requestPointerLock||o.mozRequestPointerLock||o.webkitRequestPointerLock,o.requestPointerLock&&o.requestPointerLock()},this.exitPointerlock=function(){document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,document.exitPointerLock&&document.exitPointerLock(),n.canRequestPointerlock=!1},this.canEverHavePointerLock=function(){return r}}},{}],3:[function(e,t,i){"use strict";!function(e,i){"undefined"!=typeof t&&t.exports?t.exports=i():"function"==typeof define&&define.amd?define([],i):e.buzz=i()}(void 0,function(){var e=window.AudioContext||window.webkitAudioContext,t={defaults:{autoplay:!1,duration:5e3,formats:[],loop:!1,placeholder:"--",preload:"metadata",volume:80,webAudioApi:!1,document:window.document},types:{mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",aac:"audio/aac",m4a:"audio/x-m4a"},sounds:[],el:document.createElement("audio"),getAudioContext:function(){if(void 0===this.audioCtx)try{this.audioCtx=e?new e:null}catch(t){this.audioCtx=null}return this.audioCtx},sound:function(e,i){function n(e){for(var t=[],i=e.length-1,n=0;i>=n;n++)t.push({start:e.start(n),end:e.end(n)});return t}function r(e){return e.split(".").pop()}i=i||{};var o=i.document||t.defaults.document,s=0,a=[],h={},l=t.isSupported();if(this.load=function(){return l?(this.sound.load(),this):this},this.play=function(){return l?(this.sound.play(),this):this},this.togglePlay=function(){return l?(this.sound.paused?this.sound.play():this.sound.pause(),this):this},this.pause=function(){return l?(this.sound.pause(),this):this},this.isPaused=function(){return l?this.sound.paused:null},this.stop=function(){return l?(this.setTime(0),this.sound.pause(),this):this},this.isEnded=function(){return l?this.sound.ended:null},this.loop=function(){return l?(this.sound.loop="loop",this.bind("ended.buzzloop",function(){this.currentTime=0,this.play()}),this):this},this.unloop=function(){return l?(this.sound.removeAttribute("loop"),this.unbind("ended.buzzloop"),this):this},this.mute=function(){return l?(this.sound.muted=!0,this):this},this.unmute=function(){return l?(this.sound.muted=!1,this):this},this.toggleMute=function(){return l?(this.sound.muted=!this.sound.muted,this):this},this.isMuted=function(){return l?this.sound.muted:null},this.setVolume=function(e){return l?(0>e&&(e=0),e>100&&(e=100),this.volume=e,this.sound.volume=e/100,this):this},this.getVolume=function(){return l?this.volume:this},this.increaseVolume=function(e){return this.setVolume(this.volume+(e||1))},this.decreaseVolume=function(e){return this.setVolume(this.volume-(e||1))},this.setTime=function(e){if(!l)return this;var t=!0;return this.whenReady(function(){t===!0&&(t=!1,this.sound.currentTime=e)}),this},this.getTime=function(){if(!l)return null;var e=Math.round(100*this.sound.currentTime)/100;return isNaN(e)?t.defaults.placeholder:e},this.setPercent=function(e){return l?this.setTime(t.fromPercent(e,this.sound.duration)):this},this.getPercent=function(){if(!l)return null;var e=Math.round(t.toPercent(this.sound.currentTime,this.sound.duration));return isNaN(e)?t.defaults.placeholder:e},this.setSpeed=function(e){return l?(this.sound.playbackRate=e,this):this},this.getSpeed=function(){return l?this.sound.playbackRate:null},this.getDuration=function(){if(!l)return null;var e=Math.round(100*this.sound.duration)/100;return isNaN(e)?t.defaults.placeholder:e},this.getPlayed=function(){return l?n(this.sound.played):null},this.getBuffered=function(){return l?n(this.sound.buffered):null},this.getSeekable=function(){return l?n(this.sound.seekable):null},this.getErrorCode=function(){return l&&this.sound.error?this.sound.error.code:0},this.getErrorMessage=function(){if(!l)return null;switch(this.getErrorCode()){case 1:return"MEDIA_ERR_ABORTED";case 2:return"MEDIA_ERR_NETWORK";case 3:return"MEDIA_ERR_DECODE";case 4:return"MEDIA_ERR_SRC_NOT_SUPPORTED";default:return null}},this.getStateCode=function(){return l?this.sound.readyState:null},this.getStateMessage=function(){if(!l)return null;switch(this.getStateCode()){case 0:return"HAVE_NOTHING";case 1:return"HAVE_METADATA";case 2:return"HAVE_CURRENT_DATA";case 3:return"HAVE_FUTURE_DATA";case 4:return"HAVE_ENOUGH_DATA";default:return null}},this.getNetworkStateCode=function(){return l?this.sound.networkState:null},this.getNetworkStateMessage=function(){if(!l)return null;switch(this.getNetworkStateCode()){case 0:return"NETWORK_EMPTY";case 1:return"NETWORK_IDLE";case 2:return"NETWORK_LOADING";case 3:return"NETWORK_NO_SOURCE";default:return null}},this.set=function(e,t){return l?(this.sound[e]=t,this):this},this.get=function(e){return l?e?this.sound[e]:this.sound:null},this.bind=function(e,t){if(!l)return this;e=e.split(" ");for(var i=this,n=function(e){t.call(i,e)},r=0;r<e.length;r++){var o=e[r],s=o;o=s.split(".")[0],a.push({idx:s,func:n}),this.sound.addEventListener(o,n,!0)}return this},this.unbind=function(e){if(!l)return this;e=e.split(" ");for(var t=0;t<e.length;t++)for(var i=e[t],n=i.split(".")[0],r=0;r<a.length;r++){var o=a[r].idx.split(".");(a[r].idx===i||o[1]&&o[1]===i.replace(".",""))&&(this.sound.removeEventListener(n,a[r].func,!0),a.splice(r,1))}return this},this.bindOnce=function(e,t){if(!l)return this;var i=this;return h[s++]=!1,this.bind(e+"."+s,function(){h[s]||(h[s]=!0,t.call(i)),i.unbind(e+"."+s)}),this},this.trigger=function(e,t){if(!l)return this;e=e.split(" ");for(var i=0;i<e.length;i++)for(var n=e[i],r=0;r<a.length;r++){var s=a[r].idx.split(".");if(a[r].idx===n||s[0]&&s[0]===n.replace(".","")){var h=o.createEvent("HTMLEvents");h.initEvent(s[0],!1,!0),h.originalEvent=t,this.sound.dispatchEvent(h)}}return this},this.fadeTo=function(e,i,n){function r(){setTimeout(function(){e>o&&a.volume<e?(a.setVolume(a.volume+=1),r()):o>e&&a.volume>e?(a.setVolume(a.volume-=1),r()):n instanceof Function&&n.apply(a)},s)}if(!l)return this;i instanceof Function?(n=i,i=t.defaults.duration):i=i||t.defaults.duration;var o=this.volume,s=i/Math.abs(o-e),a=this;return this.play(),this.whenReady(function(){r()}),this},this.fadeIn=function(e,t){return l?this.setVolume(0).fadeTo(100,e,t):this},this.fadeOut=function(e,t){return l?this.fadeTo(0,e,t):this},this.fadeWith=function(e,t){return l?(this.fadeOut(t,function(){this.stop()}),e.play().fadeIn(t),this):this},this.whenReady=function(e){if(!l)return null;var t=this;0===this.sound.readyState?this.bind("canplay.buzzwhenready",function(){e.call(t)}):e.call(t)},this.addSource=function(e){var i=this,n=o.createElement("source");return n.src=e,t.types[r(e)]&&(n.type=t.types[r(e)]),this.sound.appendChild(n),n.addEventListener("error",function(e){i.trigger("sourceerror",e)}),n},l&&e){for(var c in t.defaults)t.defaults.hasOwnProperty(c)&&void 0===i[c]&&(i[c]=t.defaults[c]);if(this.sound=o.createElement("audio"),i.webAudioApi){var u=t.getAudioContext();u&&(this.source=u.createMediaElementSource(this.sound),this.source.connect(u.destination))}if(e instanceof Array)for(var p in e)e.hasOwnProperty(p)&&this.addSource(e[p]);else if(i.formats.length)for(var d in i.formats)i.formats.hasOwnProperty(d)&&this.addSource(e+"."+i.formats[d]);else this.addSource(e);i.loop&&this.loop(),i.autoplay&&(this.sound.autoplay="autoplay"),i.preload===!0?this.sound.preload="auto":i.preload===!1?this.sound.preload="none":this.sound.preload=i.preload,this.setVolume(i.volume),t.sounds.push(this)}},group:function(e){function t(){for(var t=i(null,arguments),n=t.shift(),r=0;r<e.length;r++)e[r][n].apply(e[r],t)}function i(e,t){return e instanceof Array?e:Array.prototype.slice.call(t)}e=i(e,arguments),this.getSounds=function(){return e},this.add=function(t){t=i(t,arguments);for(var n=0;n<t.length;n++)e.push(t[n])},this.remove=function(t){t=i(t,arguments);for(var n=0;n<t.length;n++)for(var r=0;r<e.length;r++)if(e[r]===t[n]){e.splice(r,1);break}},this.load=function(){return t("load"),this},this.play=function(){return t("play"),this},this.togglePlay=function(){return t("togglePlay"),this},this.pause=function(e){return t("pause",e),this},this.stop=function(){return t("stop"),this},this.mute=function(){return t("mute"),this},this.unmute=function(){return t("unmute"),this},this.toggleMute=function(){return t("toggleMute"),this},this.setVolume=function(e){return t("setVolume",e),this},this.increaseVolume=function(e){return t("increaseVolume",e),this},this.decreaseVolume=function(e){return t("decreaseVolume",e),this},this.loop=function(){return t("loop"),this},this.unloop=function(){return t("unloop"),this},this.setSpeed=function(e){return t("setSpeed",e),this},this.setTime=function(e){return t("setTime",e),this},this.set=function(e,i){return t("set",e,i),this},this.bind=function(e,i){return t("bind",e,i),this},this.unbind=function(e){return t("unbind",e),this},this.bindOnce=function(e,i){return t("bindOnce",e,i),this},this.trigger=function(e){return t("trigger",e),this},this.fade=function(e,i,n,r){return t("fade",e,i,n,r),this},this.fadeIn=function(e,i){return t("fadeIn",e,i),this},this.fadeOut=function(e,i){return t("fadeOut",e,i),this}},all:function(){return new t.group(t.sounds)},isSupported:function(){return!!t.el.canPlayType},isOGGSupported:function(){return!!t.el.canPlayType&&t.el.canPlayType('audio/ogg; codecs="vorbis"')},isWAVSupported:function(){return!!t.el.canPlayType&&t.el.canPlayType('audio/wav; codecs="1"')},isMP3Supported:function(){return!!t.el.canPlayType&&t.el.canPlayType("audio/mpeg;")},isAACSupported:function(){return!!t.el.canPlayType&&(t.el.canPlayType("audio/x-m4a;")||t.el.canPlayType("audio/aac;"))},toTimer:function(e,t){var i,n,r;return i=Math.floor(e/3600),i=isNaN(i)?"--":i>=10?i:"0"+i,n=t?Math.floor(e/60%60):Math.floor(e/60),n=isNaN(n)?"--":n>=10?n:"0"+n,r=Math.floor(e%60),r=isNaN(r)?"--":r>=10?r:"0"+r,t?i+":"+n+":"+r:n+":"+r},fromTimer:function(e){var t=e.toString().split(":");return t&&3===t.length&&(e=3600*parseInt(t[0],10)+60*parseInt(t[1],10)+parseInt(t[2],10)),t&&2===t.length&&(e=60*parseInt(t[0],10)+parseInt(t[1],10)),e},toPercent:function(e,t,i){var n=Math.pow(10,i||0);return Math.round(100*e/t*n)/n},fromPercent:function(e,t,i){var n=Math.pow(10,i||0);return Math.round(t/100*e*n)/n}};return t})},{}],4:[function(e,t,i){"use strict";var n=e("three");t.exports=function(){var e,t,i,r,o,s,a,h,l,c=!1,u=p,p={},d=new n.Vector3,f=new n.Vector3,m=new n.Matrix4,y=new n.Quaternion,g={WORLDREPORT:0,COLLISIONREPORT:1,VEHICLEREPORT:2,CONSTRAINTREPORT:3},v=14,b=5,_=9,x=6;return p.scripts={},t=function(){this._eventListeners={}},t.prototype.addEventListener=function(e,t){this._eventListeners.hasOwnProperty(e)||(this._eventListeners[e]=[]),this._eventListeners[e].push(t)},t.prototype.removeEventListener=function(e,t){var i;return this._eventListeners.hasOwnProperty(e)&&(i=this._eventListeners[e].indexOf(t))>=0?(this._eventListeners[e].splice(i,1),!0):!1},t.prototype.dispatchEvent=function(e){var t,i=Array.prototype.splice.call(arguments,1);if(this._eventListeners.hasOwnProperty(e))for(t=0;t<this._eventListeners[e].length;t++)this._eventListeners[e][t].apply(this,i)},t.make=function(e){e.prototype.addEventListener=t.prototype.addEventListener,e.prototype.removeEventListener=t.prototype.removeEventListener,e.prototype.dispatchEvent=t.prototype.dispatchEvent},i=function(){var e=1;return function(){return e++}}(),r=function(e,t,i,r){return new n.Vector3(Math.atan2(2*(e*r-t*i),r*r-e*e-t*t+i*i),Math.asin(2*(e*i+t*r)),Math.atan2(2*(i*r-e*t),r*r+e*e-t*t-i*i))},o=function(e,t,i){var n,r,o,s,a,h,l,c;return n=Math.cos(t),r=Math.sin(t),o=Math.cos(-i),s=Math.sin(-i),a=Math.cos(e),h=Math.sin(e),l=n*o,c=r*s,{w:l*a-c*h,x:l*h+c*a,y:r*o*a+n*s*h,z:n*s*a-r*o*h}},s=function(e,t){return m.identity(),m.identity().makeRotationFromQuaternion(t.quaternion),m.getInverse(m),d.copy(e),f.copy(t.position),d.sub(f).applyMatrix4(m)},p.noConflict=function(){return window.Physijs=u,p},p.createMaterial=function(e,t,i){var n=function(){};return n.prototype=e,n=new n,n._physijs={id:e.id,friction:void 0===t?.8:t,restitution:void 0===i?.2:i},n},p.PointConstraint=function(e,t,n){void 0===n&&(n=t,t=void 0),this.type="point",this.appliedImpulse=0,this.id=i(),this.objecta=e._physijs.id,this.positiona=s(n,e).clone(),t&&(this.objectb=t._physijs.id,this.positionb=s(n,t).clone())},p.PointConstraint.prototype.getDefinition=function(){return{type:this.type,id:this.id,objecta:this.objecta,objectb:this.objectb,positiona:this.positiona,positionb:this.positionb}},p.HingeConstraint=function(e,t,n,r){void 0===r&&(r=n,n=t,t=void 0),this.type="hinge",this.appliedImpulse=0,this.id=i(),this.scene=e.parent,this.objecta=e._physijs.id,this.positiona=s(n,e).clone(),this.position=n.clone(),this.axis=r,t&&(this.objectb=t._physijs.id,this.positionb=s(n,t).clone())},p.HingeConstraint.prototype.getDefinition=function(){return{type:this.type,id:this.id,objecta:this.objecta,objectb:this.objectb,positiona:this.positiona,positionb:this.positionb,axis:this.axis}},p.HingeConstraint.prototype.setLimits=function(e,t,i,n){this.scene.execute("hinge_setLimits",{constraint:this.id,low:e,high:t,bias_factor:i,relaxation_factor:n})},p.HingeConstraint.prototype.enableAngularMotor=function(e,t){this.scene.execute("hinge_enableAngularMotor",{constraint:this.id,velocity:e,acceleration:t})},p.HingeConstraint.prototype.disableMotor=function(e,t){this.scene.execute("hinge_disableMotor",{constraint:this.id})},p.SliderConstraint=function(e,t,n,r){void 0===r&&(r=n,n=t,t=void 0),this.type="slider",this.appliedImpulse=0,this.id=i(),this.scene=e.parent,this.objecta=e._physijs.id,this.positiona=s(n,e).clone(),this.axis=r,t&&(this.objectb=t._physijs.id,this.positionb=s(n,t).clone())},p.SliderConstraint.prototype.getDefinition=function(){return{type:this.type,id:this.id,objecta:this.objecta,objectb:this.objectb,positiona:this.positiona,positionb:this.positionb,axis:this.axis}},p.SliderConstraint.prototype.setLimits=function(e,t,i,n){this.scene.execute("slider_setLimits",{constraint:this.id,lin_lower:e,lin_upper:t,ang_lower:i,ang_upper:n})},p.SliderConstraint.prototype.setRestitution=function(e,t){this.scene.execute("slider_setRestitution",{constraint:this.id,linear:e,angular:t})},p.SliderConstraint.prototype.enableLinearMotor=function(e,t){this.scene.execute("slider_enableLinearMotor",{constraint:this.id,velocity:e,acceleration:t})},p.SliderConstraint.prototype.disableLinearMotor=function(){this.scene.execute("slider_disableLinearMotor",{constraint:this.id})},p.SliderConstraint.prototype.enableAngularMotor=function(e,t){this.scene.execute("slider_enableAngularMotor",{constraint:this.id,velocity:e,acceleration:t})},p.SliderConstraint.prototype.disableAngularMotor=function(){this.scene.execute("slider_disableAngularMotor",{constraint:this.id})},p.ConeTwistConstraint=function(e,t,n){if(void 0===n)throw"Both objects must be defined in a ConeTwistConstraint.";this.type="conetwist",this.appliedImpulse=0,this.id=i(),this.scene=e.parent,this.objecta=e._physijs.id,this.positiona=s(n,e).clone(),this.objectb=t._physijs.id,this.positionb=s(n,t).clone(),this.axisa={x:e.rotation.x,y:e.rotation.y,z:e.rotation.z},this.axisb={x:t.rotation.x,y:t.rotation.y,z:t.rotation.z}},p.ConeTwistConstraint.prototype.getDefinition=function(){return{type:this.type,id:this.id,objecta:this.objecta,objectb:this.objectb,positiona:this.positiona,positionb:this.positionb,axisa:this.axisa,axisb:this.axisb}},p.ConeTwistConstraint.prototype.setLimit=function(e,t,i){this.scene.execute("conetwist_setLimit",{constraint:this.id,x:e,y:t,z:i})},p.ConeTwistConstraint.prototype.enableMotor=function(){this.scene.execute("conetwist_enableMotor",{constraint:this.id})},p.ConeTwistConstraint.prototype.setMaxMotorImpulse=function(e){this.scene.execute("conetwist_setMaxMotorImpulse",{constraint:this.id,max_impulse:e})},p.ConeTwistConstraint.prototype.setMotorTarget=function(e){e instanceof n.Vector3?e=(new n.Quaternion).setFromEuler(new n.Euler(e.x,e.y,e.z)):e instanceof n.Euler?e=(new n.Quaternion).setFromEuler(e):e instanceof n.Matrix4&&(e=(new n.Quaternion).setFromRotationMatrix(e)),this.scene.execute("conetwist_setMotorTarget",{constraint:this.id,x:e.x,y:e.y,z:e.z,w:e.w})},p.ConeTwistConstraint.prototype.disableMotor=function(){this.scene.execute("conetwist_disableMotor",{constraint:this.id})},p.DOFConstraint=function(e,t,n){void 0===n&&(n=t,t=void 0),this.type="dof",this.appliedImpulse=0,this.id=i(),this.scene=e.parent,this.objecta=e._physijs.id,this.positiona=s(n,e).clone(),this.axisa={x:e.rotation.x,y:e.rotation.y,z:e.rotation.z},t&&(this.objectb=t._physijs.id,this.positionb=s(n,t).clone(),this.axisb={x:t.rotation.x,y:t.rotation.y,z:t.rotation.z})},p.DOFConstraint.prototype.getDefinition=function(){return{type:this.type,id:this.id,objecta:this.objecta,objectb:this.objectb,positiona:this.positiona,positionb:this.positionb,axisa:this.axisa,axisb:this.axisb}},p.DOFConstraint.prototype.setLinearLowerLimit=function(e){this.scene.execute("dof_setLinearLowerLimit",{constraint:this.id,x:e.x,y:e.y,z:e.z})},p.DOFConstraint.prototype.setLinearUpperLimit=function(e){this.scene.execute("dof_setLinearUpperLimit",{constraint:this.id,x:e.x,y:e.y,z:e.z})},p.DOFConstraint.prototype.setAngularLowerLimit=function(e){this.scene.execute("dof_setAngularLowerLimit",{constraint:this.id,x:e.x,y:e.y,z:e.z})},p.DOFConstraint.prototype.setAngularUpperLimit=function(e){this.scene.execute("dof_setAngularUpperLimit",{constraint:this.id,x:e.x,y:e.y,z:e.z})},p.DOFConstraint.prototype.enableAngularMotor=function(e){this.scene.execute("dof_enableAngularMotor",{constraint:this.id,which:e})},p.DOFConstraint.prototype.configureAngularMotor=function(e,t,i,n,r){this.scene.execute("dof_configureAngularMotor",{constraint:this.id,which:e,low_angle:t,high_angle:i,velocity:n,max_force:r})},p.DOFConstraint.prototype.disableAngularMotor=function(e){this.scene.execute("dof_disableAngularMotor",{constraint:this.id,which:e})},p.Scene=function(i){var r=this;t.call(this),n.Scene.call(this),this._worker=new Worker(p.scripts.worker||"/js/lib/physijs_worker.js"),this._worker.transferableMessage=this._worker.webkitPostMessage||this._worker.postMessage,this._materials_ref_counts={},this._objects={},this._vehicles={},this._constraints={};var o=new ArrayBuffer(1);this._worker.transferableMessage(o,[o]),e=0===o.byteLength,this._worker.onmessage=function(e){var t,i=e.data;if(i instanceof ArrayBuffer&&1!==i.byteLength&&(i=new Float32Array(i)),i instanceof Float32Array)switch(i[0]){case g.WORLDREPORT:r._updateScene(i);break;case g.COLLISIONREPORT:r._updateCollisions(i);break;case g.VEHICLEREPORT:r._updateVehicles(i);break;case g.CONSTRAINTREPORT:r._updateConstraints(i)}else if(i.cmd)switch(i.cmd){case"objectReady":t=i.params,r._objects[t]&&r._objects[t].dispatchEvent("ready");break;case"worldReady":r.dispatchEvent("ready");break;case"vehicle":window.test=i;break;default:console.debug("Received: "+i.cmd),console.dir(i.params)}else switch(i[0]){case g.WORLDREPORT:r._updateScene(i);break;case g.COLLISIONREPORT:r._updateCollisions(i);break;case g.VEHICLEREPORT:r._updateVehicles(i);break;case g.CONSTRAINTREPORT:r._updateConstraints(i)}},i=i||{},i.ammo=p.scripts.ammo||"/js/lib/ammo.js",i.fixedTimeStep=i.fixedTimeStep||1/60,i.rateLimit=i.rateLimit||!0,this.execute("init",i)},p.Scene.prototype=new n.Scene,p.Scene.prototype.constructor=p.Scene,t.make(p.Scene),p.Scene.prototype._updateScene=function(t){var i,n,r,o=t[1];for(n=0;o>n;n++)r=2+n*v,i=this._objects[t[r]],void 0!==i&&(i.__dirtyPosition===!1&&i.position.set(t[r+1],t[r+2],t[r+3]),i.__dirtyRotation===!1&&i.quaternion.set(t[r+4],t[r+5],t[r+6],t[r+7]),i._physijs.linearVelocity.set(t[r+8],t[r+9],t[r+10]),i._physijs.angularVelocity.set(t[r+11],t[r+12],t[r+13]));e&&this._worker.transferableMessage(t.buffer,[t.buffer]),c=!1,this.dispatchEvent("update")},p.Scene.prototype._updateVehicles=function(t){var i,n,r,o;for(r=0;r<(t.length-1)/_;r++)o=1+r*_,i=this._vehicles[t[o]],void 0!==i&&(n=i.wheels[t[o+1]],n.position.set(t[o+2],t[o+3],t[o+4]),n.quaternion.set(t[o+5],t[o+6],t[o+7],t[o+8]));e&&this._worker.transferableMessage(t.buffer,[t.buffer])},p.Scene.prototype._updateConstraints=function(t){var i,n,r,o;for(r=0;r<(t.length-1)/x;r++)o=1+r*x,i=this._constraints[t[o]],n=this._objects[t[o+1]],void 0!==i&&void 0!==n&&(d.set(t[o+2],t[o+3],t[o+4]),m.extractRotation(n.matrix),d.applyMatrix4(m),i.positiona.addVectors(n.position,d),i.appliedImpulse=t[o+5]);e&&this._worker.transferableMessage(t.buffer,[t.buffer])},p.Scene.prototype._updateCollisions=function(t){var i,n,r,o,s,a,c,u={},p={};for(i=0;i<t[1];i++)r=2+i*b,o=t[r],s=t[r+1],p[o+"-"+s]=r+2,p[s+"-"+o]=-1*(r+2),u[o]||(u[o]=[]),u[o].push(s),u[s]||(u[s]=[]),u[s].push(o);for(a in this._objects)if(this._objects.hasOwnProperty(a))if(o=this._objects[a],u[a]){for(n=0;n<o._physijs.touches.length;n++)-1===u[a].indexOf(o._physijs.touches[n])&&o._physijs.touches.splice(n--,1);for(n=0;n<u[a].length;n++)if(c=u[a][n],s=this._objects[c],s&&-1===o._physijs.touches.indexOf(c)){o._physijs.touches.push(c),d.subVectors(o.getLinearVelocity(),s.getLinearVelocity()),h=d.clone(),d.subVectors(o.getAngularVelocity(),s.getAngularVelocity()),l=d.clone();var f=p[o._physijs.id+"-"+s._physijs.id];f>0?d.set(-t[f],-t[f+1],-t[f+2]):(f*=-1,d.set(t[f],t[f+1],t[f+2])),o.dispatchEvent("collision",s,h,l,d)}}else o._physijs.touches.length=0;this.collisions=u,e&&this._worker.transferableMessage(t.buffer,[t.buffer])},p.Scene.prototype.addConstraint=function(e,t){if(this._constraints[e.id]=e,this.execute("addConstraint",e.getDefinition()),t){var i;switch(e.type){case"point":i=new n.Mesh(new n.SphereGeometry(1.5),new n.MeshNormalMaterial),i.position.copy(e.positiona),this._objects[e.objecta].add(i);break;case"hinge":i=new n.Mesh(new n.SphereGeometry(1.5),new n.MeshNormalMaterial),i.position.copy(e.positiona),this._objects[e.objecta].add(i);break;case"slider":i=new n.Mesh(new n.BoxGeometry(10,1,1),new n.MeshNormalMaterial),i.position.copy(e.positiona),i.rotation.set(e.axis.y,e.axis.x,e.axis.z),this._objects[e.objecta].add(i);break;case"conetwist":i=new n.Mesh(new n.SphereGeometry(1.5),new n.MeshNormalMaterial),i.position.copy(e.positiona),this._objects[e.objecta].add(i);break;case"dof":i=new n.Mesh(new n.SphereGeometry(1.5),new n.MeshNormalMaterial),i.position.copy(e.positiona),this._objects[e.objecta].add(i)}}return e},p.Scene.prototype.onSimulationResume=function(){this.execute("onSimulationResume",{})},p.Scene.prototype.removeConstraint=function(e){void 0!==this._constraints[e.id]&&(this.execute("removeConstraint",{id:e.id}),delete this._constraints[e.id])},p.Scene.prototype.execute=function(e,t){this._worker.postMessage({cmd:e,params:t})},a=function(e,t){var i;for(i=0;i<t.children.length;i++)t.children[i]._physijs&&(t.children[i].updateMatrix(),t.children[i].updateMatrixWorld(),d.setFromMatrixPosition(t.children[i].matrixWorld),y.setFromRotationMatrix(t.children[i].matrixWorld),t.children[i]._physijs.position_offset={x:d.x,y:d.y,z:d.z},t.children[i]._physijs.rotation={x:y.x,y:y.y,z:y.z,w:y.w},e._physijs.children.push(t.children[i]._physijs)),a(e,t.children[i])},p.Scene.prototype.add=function(e){if(n.Mesh.prototype.add.call(this,e),e._physijs)if(e.world=this,e instanceof p.Vehicle)this.add(e.mesh),this._vehicles[e._physijs.id]=e,this.execute("addVehicle",e._physijs);else{e.__dirtyPosition=!1,e.__dirtyRotation=!1,this._objects[e._physijs.id]=e,e.children.length&&(e._physijs.children=[],a(e,e)),e.material._physijs&&(this._materials_ref_counts.hasOwnProperty(e.material._physijs.id)?this._materials_ref_counts[e.material._physijs.id]++:(this.execute("registerMaterial",e.material._physijs),e._physijs.materialId=e.material._physijs.id,this._materials_ref_counts[e.material._physijs.id]=1)),e._physijs.position={x:e.position.x,y:e.position.y,z:e.position.z},e._physijs.rotation={x:e.quaternion.x,y:e.quaternion.y,z:e.quaternion.z,
w:e.quaternion.w};new n.Vector3(1,1,1);e._physijs.width&&(e._physijs.width*=e.scale.x),e._physijs.height&&(e._physijs.height*=e.scale.y),e._physijs.depth&&(e._physijs.depth*=e.scale.z),this.execute("addObject",e._physijs)}},p.Scene.prototype.remove=function(e){if(e instanceof p.Vehicle){for(this.execute("removeVehicle",{id:e._physijs.id});e.wheels.length;)this.remove(e.wheels.pop());this.remove(e.mesh),delete this._vehicles[e._physijs.id]}else n.Mesh.prototype.remove.call(this,e),e._physijs&&(delete this._objects[e._physijs.id],this.execute("removeObject",{id:e._physijs.id}));e.material&&e.material._physijs&&this._materials_ref_counts.hasOwnProperty(e.material._physijs.id)&&(this._materials_ref_counts[e.material._physijs.id]--,0==this._materials_ref_counts[e.material._physijs.id]&&(this.execute("unRegisterMaterial",e.material._physijs),delete this._materials_ref_counts[e.material._physijs.id]))},p.Scene.prototype.setFixedTimeStep=function(e){e&&this.execute("setFixedTimeStep",e)},p.Scene.prototype.setGravity=function(e){e&&this.execute("setGravity",e)},p.Scene.prototype.simulate=function(e,t){var i,n,r;if(c)return!1;c=!0;for(i in this._objects)this._objects.hasOwnProperty(i)&&(n=this._objects[i],(n.__dirtyPosition||n.__dirtyRotation)&&(r={id:n._physijs.id},n.__dirtyPosition&&(r.pos={x:n.position.x,y:n.position.y,z:n.position.z},n.__dirtyPosition=!1),n.__dirtyRotation&&(r.quat={x:n.quaternion.x,y:n.quaternion.y,z:n.quaternion.z,w:n.quaternion.w},n.__dirtyRotation=!1),this.execute("updateTransform",r)));return this.execute("simulate",{timeStep:e,maxSubSteps:t}),!0},p.Mesh=function(e,r,o){e&&(t.call(this),n.Mesh.call(this,e,r),e.boundingBox||e.computeBoundingBox(),this._physijs={type:null,id:i(),mass:o||0,touches:[],linearVelocity:new n.Vector3,angularVelocity:new n.Vector3})},p.Mesh.prototype=new n.Mesh,p.Mesh.prototype.constructor=p.Mesh,t.make(p.Mesh),p.Mesh.prototype.__defineGetter__("mass",function(){return this._physijs.mass}),p.Mesh.prototype.__defineSetter__("mass",function(e){this._physijs.mass=e,this.world&&this.world.execute("updateMass",{id:this._physijs.id,mass:e})}),p.Mesh.prototype.applyCentralImpulse=function(e){this.world&&this.world.execute("applyCentralImpulse",{id:this._physijs.id,x:e.x,y:e.y,z:e.z})},p.Mesh.prototype.applyImpulse=function(e,t){this.world&&this.world.execute("applyImpulse",{id:this._physijs.id,impulse_x:e.x,impulse_y:e.y,impulse_z:e.z,x:t.x,y:t.y,z:t.z})},p.Mesh.prototype.applyCentralForce=function(e){this.world&&this.world.execute("applyCentralForce",{id:this._physijs.id,x:e.x,y:e.y,z:e.z})},p.Mesh.prototype.applyForce=function(e,t){this.world&&this.world.execute("applyForce",{id:this._physijs.id,force_x:e.x,force_y:e.y,force_z:e.z,x:t.x,y:t.y,z:t.z})},p.Mesh.prototype.getAngularVelocity=function(){return this._physijs.angularVelocity},p.Mesh.prototype.setAngularVelocity=function(e){this.world&&this.world.execute("setAngularVelocity",{id:this._physijs.id,x:e.x,y:e.y,z:e.z})},p.Mesh.prototype.getLinearVelocity=function(){return this._physijs.linearVelocity},p.Mesh.prototype.setLinearVelocity=function(e){this.world&&this.world.execute("setLinearVelocity",{id:this._physijs.id,x:e.x,y:e.y,z:e.z})},p.Mesh.prototype.setAngularFactor=function(e){this.world&&this.world.execute("setAngularFactor",{id:this._physijs.id,x:e.x,y:e.y,z:e.z})},p.Mesh.prototype.setLinearFactor=function(e){this.world&&this.world.execute("setLinearFactor",{id:this._physijs.id,x:e.x,y:e.y,z:e.z})},p.Mesh.prototype.setDamping=function(e,t){this.world&&this.world.execute("setDamping",{id:this._physijs.id,linear:e,angular:t})},p.Mesh.prototype.setCcdMotionThreshold=function(e){this.world&&this.world.execute("setCcdMotionThreshold",{id:this._physijs.id,threshold:e})},p.Mesh.prototype.setCcdSweptSphereRadius=function(e){this.world&&this.world.execute("setCcdSweptSphereRadius",{id:this._physijs.id,radius:e})},p.PlaneMesh=function(e,t,i){var n,r;p.Mesh.call(this,e,t,i),e.boundingBox||e.computeBoundingBox(),n=e.boundingBox.max.x-e.boundingBox.min.x,r=e.boundingBox.max.y-e.boundingBox.min.y,this._physijs.type="plane",this._physijs.normal=e.faces[0].normal.clone(),this._physijs.mass="undefined"==typeof i?n*r:i},p.PlaneMesh.prototype=new p.Mesh,p.PlaneMesh.prototype.constructor=p.PlaneMesh,p.HeightfieldMesh=function(e,t,i,n,r){p.Mesh.call(this,e,t,i),this._physijs.type="heightfield",this._physijs.xsize=e.boundingBox.max.x-e.boundingBox.min.x,this._physijs.ysize=e.boundingBox.max.y-e.boundingBox.min.y,this._physijs.xpts="undefined"==typeof n?Math.sqrt(e.vertices.length):n+1,this._physijs.ypts="undefined"==typeof r?Math.sqrt(e.vertices.length):r+1,this._physijs.absMaxHeight=Math.max(e.boundingBox.max.z,Math.abs(e.boundingBox.min.z));for(var o,s,a=[],h=0;h<e.vertices.length;h++)o=h%this._physijs.xpts,s=Math.round(h/this._physijs.xpts-h%this._physijs.xpts/this._physijs.xpts),a[h]=e.vertices[o+(this._physijs.ypts-s-1)*this._physijs.ypts].z;this._physijs.points=a},p.HeightfieldMesh.prototype=new p.Mesh,p.HeightfieldMesh.prototype.constructor=p.HeightfieldMesh,p.BoxMesh=function(e,t,i){var n,r,o;p.Mesh.call(this,e,t,i),e.boundingBox||e.computeBoundingBox(),n=e.boundingBox.max.x-e.boundingBox.min.x,r=e.boundingBox.max.y-e.boundingBox.min.y,o=e.boundingBox.max.z-e.boundingBox.min.z,this._physijs.type="box",this._physijs.width=n,this._physijs.height=r,this._physijs.depth=o,this._physijs.mass="undefined"==typeof i?n*r*o:i},p.BoxMesh.prototype=new p.Mesh,p.BoxMesh.prototype.constructor=p.BoxMesh,p.SphereMesh=function(e,t,i){p.Mesh.call(this,e,t,i),e.boundingSphere||e.computeBoundingSphere(),this._physijs.type="sphere",this._physijs.radius=e.boundingSphere.radius,this._physijs.mass="undefined"==typeof i?4/3*Math.PI*Math.pow(this._physijs.radius,3):i},p.SphereMesh.prototype=new p.Mesh,p.SphereMesh.prototype.constructor=p.SphereMesh,p.CylinderMesh=function(e,t,i){var n,r,o;p.Mesh.call(this,e,t,i),e.boundingBox||e.computeBoundingBox(),n=e.boundingBox.max.x-e.boundingBox.min.x,r=e.boundingBox.max.y-e.boundingBox.min.y,o=e.boundingBox.max.z-e.boundingBox.min.z,this._physijs.type="cylinder",this._physijs.width=n,this._physijs.height=r,this._physijs.depth=o,this._physijs.mass="undefined"==typeof i?n*r*o:i},p.CylinderMesh.prototype=new p.Mesh,p.CylinderMesh.prototype.constructor=p.CylinderMesh,p.CapsuleMesh=function(e,t,i){var n,r,o;p.Mesh.call(this,e,t,i),e.boundingBox||e.computeBoundingBox(),n=e.boundingBox.max.x-e.boundingBox.min.x,r=e.boundingBox.max.y-e.boundingBox.min.y,o=e.boundingBox.max.z-e.boundingBox.min.z,this._physijs.type="capsule",this._physijs.radius=Math.max(n/2,o/2),this._physijs.height=r,this._physijs.mass="undefined"==typeof i?n*r*o:i},p.CapsuleMesh.prototype=new p.Mesh,p.CapsuleMesh.prototype.constructor=p.CapsuleMesh,p.ConeMesh=function(e,t,i){var n,r;p.Mesh.call(this,e,t,i),e.boundingBox||e.computeBoundingBox(),n=e.boundingBox.max.x-e.boundingBox.min.x,r=e.boundingBox.max.y-e.boundingBox.min.y,this._physijs.type="cone",this._physijs.radius=n/2,this._physijs.height=r,this._physijs.mass="undefined"==typeof i?n*r:i},p.ConeMesh.prototype=new p.Mesh,p.ConeMesh.prototype.constructor=p.ConeMesh,p.ConcaveMesh=function(e,t,i){var r,o,s,a,h,l,c=[];for(p.Mesh.call(this,e,t,i),e.boundingBox||e.computeBoundingBox(),h=e.vertices,r=0;r<e.faces.length;r++)l=e.faces[r],l instanceof n.Face3?c.push([{x:h[l.a].x,y:h[l.a].y,z:h[l.a].z},{x:h[l.b].x,y:h[l.b].y,z:h[l.b].z},{x:h[l.c].x,y:h[l.c].y,z:h[l.c].z}]):l instanceof n.Face4&&(c.push([{x:h[l.a].x,y:h[l.a].y,z:h[l.a].z},{x:h[l.b].x,y:h[l.b].y,z:h[l.b].z},{x:h[l.d].x,y:h[l.d].y,z:h[l.d].z}]),c.push([{x:h[l.b].x,y:h[l.b].y,z:h[l.b].z},{x:h[l.c].x,y:h[l.c].y,z:h[l.c].z},{x:h[l.d].x,y:h[l.d].y,z:h[l.d].z}]));o=e.boundingBox.max.x-e.boundingBox.min.x,s=e.boundingBox.max.y-e.boundingBox.min.y,a=e.boundingBox.max.z-e.boundingBox.min.z,this._physijs.type="concave",this._physijs.triangles=c,this._physijs.mass="undefined"==typeof i?o*s*a:i},p.ConcaveMesh.prototype=new p.Mesh,p.ConcaveMesh.prototype.constructor=p.ConcaveMesh,p.ConvexMesh=function(e,t,i){var n,r,o,s,a=[];for(p.Mesh.call(this,e,t,i),e.boundingBox||e.computeBoundingBox(),n=0;n<e.vertices.length;n++)a.push({x:e.vertices[n].x,y:e.vertices[n].y,z:e.vertices[n].z});r=e.boundingBox.max.x-e.boundingBox.min.x,o=e.boundingBox.max.y-e.boundingBox.min.y,s=e.boundingBox.max.z-e.boundingBox.min.z,this._physijs.type="convex",this._physijs.points=a,this._physijs.mass="undefined"==typeof i?r*o*s:i},p.ConvexMesh.prototype=new p.Mesh,p.ConvexMesh.prototype.constructor=p.ConvexMesh,p.Vehicle=function(e,t){t=t||new p.VehicleTuning,this.mesh=e,this.wheels=[],this._physijs={id:i(),rigidBody:e._physijs.id,suspension_stiffness:t.suspension_stiffness,suspension_compression:t.suspension_compression,suspension_damping:t.suspension_damping,max_suspension_travel:t.max_suspension_travel,friction_slip:t.friction_slip,max_suspension_force:t.max_suspension_force}},p.Vehicle.prototype.addWheel=function(e,t,i,r,o,s,a,h,l){var c=new n.Mesh(e,t);c.castShadow=c.receiveShadow=!0,c.position.copy(r).multiplyScalar(s/100).add(i),this.world.add(c),this.wheels.push(c),this.world.execute("addWheel",{id:this._physijs.id,connection_point:{x:i.x,y:i.y,z:i.z},wheel_direction:{x:r.x,y:r.y,z:r.z},wheel_axle:{x:o.x,y:o.y,z:o.z},suspension_rest_length:s,wheel_radius:a,is_front_wheel:h,tuning:l})},p.Vehicle.prototype.setSteering=function(e,t){if(void 0!==t&&void 0!==this.wheels[t])this.world.execute("setSteering",{id:this._physijs.id,wheel:t,steering:e});else if(this.wheels.length>0)for(var i=0;i<this.wheels.length;i++)this.world.execute("setSteering",{id:this._physijs.id,wheel:i,steering:e})},p.Vehicle.prototype.setBrake=function(e,t){if(void 0!==t&&void 0!==this.wheels[t])this.world.execute("setBrake",{id:this._physijs.id,wheel:t,brake:e});else if(this.wheels.length>0)for(var i=0;i<this.wheels.length;i++)this.world.execute("setBrake",{id:this._physijs.id,wheel:i,brake:e})},p.Vehicle.prototype.applyEngineForce=function(e,t){if(void 0!==t&&void 0!==this.wheels[t])this.world.execute("applyEngineForce",{id:this._physijs.id,wheel:t,force:e});else if(this.wheels.length>0)for(var i=0;i<this.wheels.length;i++)this.world.execute("applyEngineForce",{id:this._physijs.id,wheel:i,force:e})},p.VehicleTuning=function(e,t,i,n,r,o){this.suspension_stiffness=void 0!==e?e:5.88,this.suspension_compression=void 0!==t?t:.83,this.suspension_damping=void 0!==i?i:.88,this.max_suspension_travel=void 0!==n?n:500,this.friction_slip=void 0!==r?r:10.5,this.max_suspension_force=void 0!==o?o:6e3},p}()},{three:110}],5:[function(e,t,i){"use strict";function n(e,t){var i=e.indexOf(t);i>-1&&e.splice(i,1)}function r(e){var t=/(https?:\/\/[^\s]+)/g;return e.replace(t,function(e){return'<a target="_blank" href="'+e+'">'+e+"</a>"})}function o(e,t){for(var i=document.querySelectorAll(e),n=0;n<i.length;n++)i[n].classList.add(t)}function s(e,t){for(var i=document.querySelectorAll(e),n=0;n<i.length;n++)i[n].classList.remove(t)}var a=function(){function e(e,t){for(var i in t){var n=t[i];n.configurable=!0,n.value&&(n.writable=!0)}Object.defineProperties(e,t)}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),h=function x(e,t,i){var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var r=Object.getPrototypeOf(e);return null===r?void 0:x(r,t,i)}if("value"in n&&n.writable)return n.value;var o=n.get;return void 0===o?void 0:o.call(i)},l=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)},c=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(i,"__esModule",{value:!0});var u=e("three"),p=e("./lib/buzz"),d=e("tween.js"),f=e("socket.io-client"),m=e("kutility"),y=e("tone"),g=e("nlp_compromise"),v=e("./sheen-scene.es6").SheenScene,b=e("./word-tracker.es6").WordTracker,_=4;i.MainScene=function(e){function t(e,i,n,r){c(this,t),h(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,i,n,r),this.onPhone=r.onPhone||!1,this.pushDelay=r.pushDelay||3e3,this.maxMeshCount=r.maxMeshCount||100,this.skyStyle=void 0!==r.skyStyle?r.skyStyle:{type:"sphere",number:11},this.controlHudVisible=!1,this.skymeshVisible=!0,this.dataVisible=!0,this.useMeshImages=!0,this.meshColorStyle="sentiment",this.usePercussion=!0,this.useInstruments=!0,this.useSynth=!0,this.soundOn=!0,this.tweetPaused=!1,this.rotationRadius=100,this.zoomIncrement=.5,this.cameraRotationIncrement=.002,this.rotateCamera=!0,this.zoomingIn=!1,this.zoomingOut=!1,this.rotatingLeft=!1,this.rotatingRight=!1,this.cameraRotationAngle=0,this.raycaster=new u.Raycaster,this.mouse=new u.Vector2,this.tweetMeshes=[],this.goodTweetCount=0,this.badTweetCount=0,this.totalSentiment=0,this.nounTracker=new b({bannedWords:["god","rt"]}),this.verbTracker=new b({bannedWords:["is","rt","god"]}),this.adjectiveTracker=new b,this.detailTweetTextElement=document.querySelector("#detail-tweet-text"),this.tickerTweetTextElement=document.querySelector("#ticker-tweet-text"),this.goodTweetCountElement=document.querySelector("#good-tweet-count"),this.badTweetCountElement=document.querySelector("#bad-tweet-count"),this.totalSentimentElement=document.querySelector("#total-sentiment"),this.godAdjectiveElement=document.querySelector("#god-adjective"),this.godVerbElement=document.querySelector("#god-verb"),this.mostFrequentNounsElement=document.querySelector("#most-frequent-nouns-list"),this.mostFrequentVerbsElement=document.querySelector("#most-frequent-verbs-list"),this.mostFrequentAdjectivesElement=document.querySelector("#most-frequent-adjectives-list"),this.setupControlHud(),this.setupSkyWithStyle(this.skyStyle),this.setupSound()}return l(t,e),a(t,{doTimedWork:{value:function(e){h(Object.getPrototypeOf(t.prototype),"doTimedWork",this).call(this),this.useMeshes=!e,this.updateForUseMeshes(),this.socket=f("http://104.131.72.3:3201"),this.socket.on("fresh-tweet",this.handleNewTweet.bind(this))}},updateForUseMeshes:{value:function(){this.useMeshes?(s(".tweet-ticker","nomesh"),s(".ticker-tweet-text","nomesh"),s(".stat-hud","nomesh"),s("#control-hud-mesh-section","hidden")):(o(".tweet-ticker","nomesh"),o(".ticker-tweet-text","nomesh"),o(".stat-hud","nomesh"),o("#control-hud-mesh-section","hidden"));for(var e=0;e<this.tweetMeshes.length;e++){var t=this.tweetMeshes[e];t.visible=this.useMeshes}}},setupControlHud:{value:function(){var e=this,t=function(t,i,n){t.addEventListener("click",function(){t.classList.toggle("active"),e[i]=!e[i],n&&n()},!1)},i=function(t,i,n,r,o){t.addEventListener("click",function(){var s=t.innerText,a=r.indexOf(s);-1===a&&(a=0);var h=a<n.length-1?a+1:0;t.innerText=r[h],e[i]=n[h],o&&o()},!1)};t(document.querySelector("#control-hud-toggle"),"controlHudVisible",function(){e.controlHudVisible?s("#control-hud-options","hidden"):o("#control-hud-options","hidden")}),t(document.querySelector("#mesh-toggle"),"useMeshes",function(){e.updateForUseMeshes()}),t(document.querySelector("#skybox-toggle"),"skymeshVisible",function(){e.skymesh.visible=e.skymeshVisible,e.skymeshVisible?(s(".ticker-tweet-text","light-background"),s(".stat-hud","light-background")):(o(".ticker-tweet-text","light-background"),o(".stat-hud","light-background"))}),t(document.querySelector("#data-toggle"),"dataVisible",function(){e.dataVisible?(s(".stat-hud","hidden"),s(".tweet-ticker","hidden")):(o(".stat-hud","hidden"),o(".tweet-ticker","hidden"))}),i(document.querySelector("#mesh-color-options"),"meshColorStyle",["sentiment","random","none"],["sentiment colors","random colors","no colors"],function(){for(var t=0;t<e.tweetMeshes.length;t++){var i=e.tweetMeshes[t];i.material.color=e.colorForTweetData(i.__tweetData)}}),t(document.querySelector("#mesh-images-toggle"),"useMeshImages"),t(document.querySelector("#sound-toggle"),"soundOn",function(){for(var t in e.sounds)if(e.sounds.hasOwnProperty(t)){var i=e.sounds[t];e.soundOn?i.unmute():i.mute()}}),t(document.querySelector("#instruments-toggle"),"useInstruments"),t(document.querySelector("#percussion-toggle"),"usePercussion"),t(document.querySelector("#synth-toggle"),"useSynth")}},setupSkyWithStyle:{value:function(e){if("box"===e.type){for(var t="media/textures/skybox"+e.number+"/",i=["px","nx","py","ny","pz","nz"],n=".jpg",r=new u.CubeGeometry(1e3,1e3,1e3),o=[],s=0;6>s;s++)o.push(new u.MeshBasicMaterial({map:u.ImageUtils.loadTexture(t+i[s]+n),side:u.BackSide}));var a=new u.MeshFaceMaterial(o);this.skymesh=new u.Mesh(r,a),this.scene.add(this.skymesh)}else{var h=u.ImageUtils.loadTexture("media/textures/360sky/360sky"+e.number+".jpg",u.UVMapping);h.minFilter=u.LinearFilter,this.skymesh=new u.Mesh(new u.SphereGeometry(500,60,40),new u.MeshBasicMaterial({map:h})),this.skymesh.scale.x=-1,this.scene.add(this.skymesh)}}},setupSound:{value:function(){var e=this;this.sounds={},this.synthVolume=-14,this.percussionVolume=15,this.holdVolume=40,this.instrumentVolume=40,this.backgroundVolume=65,this.panner=(new y.Panner).toMaster(),this.sineSynth=new y.SimpleSynth({oscillator:{type:"sine"},envelope:{attack:.01,decay:.2,sustain:.4,release:.2}}).connect(this.panner),this.triSynth=new y.SimpleSynth({oscillator:{type:"triangle"},envelope:{attack:.01,decay:.2,sustain:.4,release:.2}}).connect(this.panner),this.panner.pan.value=.5,this.sineSynth.volume.value=this.triSynth.volume.value=this.synthVolume;var t=["altglock1","altglock2","altglock3","altglock4","altglock5","altglock6","altglock7","altglock8","badmallet1","badmallet2","badmallet3","badmallet4","badmallet5","badmallet6","badmallet7","badmallet8","background1loud","bell1","bell2","bell3","bell4","clouds1","clouds2","clouds3","clouds4","clouds5","clouds6","clouds7","clouds8","dbass1","dbass2","dbass3","dbass4","dbass5","dbass6","dbass7","dbass8","glock1","glock2","glock3","glock4","glock5","glock6","glock7","glock8","glock9","glock10","glock11","glock12","glock13","mallet1","mallet2","mallet3","mallet4","mallet5","mallet6","mallet7","mallet8","tile1","tile2","tile3","tile4","tile5","tile6","tile7","tile8"];t.forEach(function(t){var i=new p.sound("/media/sound/instruments/"+t,{formats:["mp3","ogg"],webAudioApi:!0,volume:e.instrumentVolume});e.sounds[t]=i});var i=["A","C","C2","D","E","F","G"];i.forEach(function(t){var i=new p.sound("/media/sound/holds/"+t,{formats:["mp3","ogg"],webAudioApi:!0,volume:e.holdVolume});e.sounds[t]=i});for(var n=[],r=1;31>=r;r++)n.push("hh"+r);for(var r=1;19>=r;r++)n.push("kick"+r);n.forEach(function(t){var i=new p.sound("/media/sound/percussion/"+t,{formats:["mp3"],webAudioApi:!0,volume:e.percussionVolume});e.sounds[t]=i}),this.sounds.background1loud.setVolume(this.backgroundVolume),this.sounds.background1loud.setTime(0),this.sounds.background1loud.loop().play(),this.makeHoldNotes(1e4),this.makeHoldNotes(2e4)}},enter:{value:function(){h(Object.getPrototypeOf(t.prototype),"enter",this).call(this),this.renderer.setClearColor(15790320);var e=new u.SpotLight(16777215,1.5);e.position.set(0,500,2e3),e.castShadow=!0,e.shadowCameraNear=200,e.shadowCameraFar=this.camera.far,e.shadowCameraFov=50,e.shadowBias=-22e-5,e.shadowMapWidth=2048,e.shadowMapHeight=2048,this.scene.add(e)}},update:{value:function(e){h(Object.getPrototypeOf(t.prototype),"update",this).call(this,e),this.rotateCamera&&(this.cameraRotationAngle+=this.cameraRotationIncrement),this.camera.position.x=this.rotationRadius*Math.sin(this.cameraRotationAngle),this.camera.position.y=this.camera.position.x,this.camera.position.z=this.rotationRadius*Math.cos(this.cameraRotationAngle),this.camera.lookAt(this.scene.position),this.detailedTweetMesh&&(this.detailedTweetMesh.rotation.x+=this.detailedTweetMeshRotation.x,this.detailedTweetMesh.rotation.y+=this.detailedTweetMeshRotation.y,this.detailedTweetMesh.rotation.z+=this.detailedTweetMeshRotation.z),this.zoomingIn&&this.zoomIn(),this.zoomingOut&&this.zoomOut(),this.rotatingLeft&&this.rotateLeft(),this.rotatingRight&&this.rotateRight()}},zoomIn:{value:function(){this.rotationRadius>1&&(this.rotationRadius-=this.zoomIncrement)}},zoomOut:{value:function(){this.rotationRadius<250&&(this.rotationRadius+=this.zoomIncrement)}},rotateLeft:{value:function(){this.rotateCamera?this.cameraRotationIncrement>2e-4&&(this.cameraRotationIncrement-=1e-4):this.cameraRotationAngle-=6*this.cameraRotationIncrement}},rotateRight:{value:function(){this.rotateCamera?this.cameraRotationIncrement<.01&&(this.cameraRotationIncrement+=1e-4):this.cameraRotationAngle+=6*this.cameraRotationIncrement}},randomJump:{value:function(){this.cameraRotationAngle+=6*Math.random()}},spacebarPressed:{value:function(){this.useMeshes?this.rotateCamera=!this.rotateCamera:this.tweetPaused=!this.tweetPaused}},keypress:{value:function(e){switch(h(Object.getPrototypeOf(t.prototype),"keypress",this).call(this,e),e){case 106:this.randomJump()}}},keydown:{value:function(e){switch(h(Object.getPrototypeOf(t.prototype),"keydown",this).call(this,e),e){case 38:case 87:this.zoomingIn=!0;break;case 40:case 83:this.zoomingOut=!0;break;case 37:case 65:this.rotatingLeft=!0;break;case 39:case 68:this.rotatingRight=!0}}},keyup:{value:function(e){switch(h(Object.getPrototypeOf(t.prototype),"keyup",this).call(this,e),e){case 38:case 87:this.zoomingIn=!1;break;case 40:case 83:this.zoomingOut=!1;break;case 37:case 65:this.rotatingLeft=!1;break;case 39:case 68:this.rotatingRight=!1}}},move:{value:function(e){h(Object.getPrototypeOf(t.prototype),"move",this).call(this,e);var i="auto";if(!this.detailedTweetMesh){var n=this.mouseIntersections(e);n.length>0&&(i="pointer")}this.domContainer.css("cursor",i)}},click:{value:function(e){if(h(Object.getPrototypeOf(t.prototype),"click",this).call(this,e),this.detailedTweetMesh)return void this.bringDetailTweetBackHome();var i=this.mouseIntersections(e);if(i.length>0){var n=i[0].object;this.bringMeshToDetail(n)}}},mouseIntersections:{value:function(e){this.mouse.x=e.clientX/this.renderer.domElement.clientWidth*2-1,this.mouse.y=2*-(e.clientY/this.renderer.domElement.clientHeight)+1,this.raycaster.setFromCamera(this.mouse,this.camera);var t=this.raycaster.intersectObjects(this.tweetMeshes);return t}},bringMeshToDetail:{value:function(e){this.detailedTweetMesh=e,this.detailedTweetMesh.__positionBeforeDetail=e.position.clone(),this.detailedTweetMeshRotation={x:.01*(Math.random()-.5),y:.01*(Math.random()-.5),z:.01*(Math.random()-.5)};var t=e.__tweetData.tweet;this.detailTweetTextElement.innerHTML="<b>"+t.username+"</b><br>"+r(t.text),u.SceneUtils.attach(e,this.scene,this.camera),this.tweenMeshSickStyles(e,{position:{x:0,y:1,z:-25},scale:12,detailOpacity:1})}},bringDetailTweetBackHome:{value:function(){var e=this.detailedTweetMesh;this.detailedTweetMesh=null,u.SceneUtils.detach(e,this.camera,this.scene),this.tweenMeshSickStyles(e,{position:e.__positionBeforeDetail,scale:4*Math.random()+.1,detailOpacity:0})}},tweenMeshSickStyles:{value:function(e,t){var i=this,n=t.position,r=void 0!==t.scale?t.scale:1,o=void 0!==t.detailOpacity?t.detailOpacity:1,s={x:e.position.x,y:e.position.y,z:e.position.z,scale:e.scale.x,opacity:parseFloat(this.detailTweetTextElement.style.opacity)},a={x:n.x,y:n.y,z:n.z,scale:r,opacity:o};new d.Tween(s).to(a,500).onUpdate(function(){e.position.set(s.x,s.y,s.z),e.scale.set(s.scale,s.scale,s.scale),i.detailTweetTextElement.style.opacity=s.opacity}).easing(d.Easing.Cubic.Out).start()}},handleNewTweet:{value:function(e){var t=this;setTimeout(function(){t.tweetPaused||(t.tickerTweetTextElement.innerHTML=r(e.tweet.text)),t.totalSentiment+=e.sentiment,t.totalSentimentElement.innerText=t.totalSentiment,e.sentiment>=0?(t.goodTweetCount+=1,t.goodTweetCountElement.innerText=t.goodTweetCount):(t.badTweetCount+=1,t.badTweetCountElement.innerText=t.badTweetCount),t.processLanguage(e.tweet),t.soundOn&&t.makeGodSound(e.sentiment)},this.pushDelay);var i=Math.random()*this.pushDelay;Math.random()<.5&&(i*=Math.random()),setTimeout(function(){t.useMeshes&&(t.addTweetMesh(e,t.pushDelay-i),t.tweetPaused=!1)},i)}},processLanguage:{value:function(e){function t(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].text);return t}var i=g.pos(e.text).sentences[0],n=i.nouns(),r=i.verbs(),o=i.adjectives();if(n.length>0&&(this.nounTracker.track(t(n)),this.mostFrequentNounsElement.innerText=this.nounTracker.mostFrequentWordsList()),r.length>0){this.verbTracker.track(t(r)),this.mostFrequentVerbsElement.innerText=this.verbTracker.mostFrequentWordsList();var s=m.choice(r).analysis.conjugate();this.godVerbElement.innerText=s.gerund}if(o.length>0){var a=t(o);this.adjectiveTracker.track(a),this.mostFrequentAdjectivesElement.innerText=this.adjectiveTracker.mostFrequentWordsList(),this.godAdjectiveElement.innerText=m.choice(a)}}},addTweetMesh:{value:function(e,t){var i=this,r=new u.Mesh(new u.SphereGeometry(1,32,32),new u.MeshLambertMaterial({color:this.colorForTweetData(e)}));this.useMeshImages&&(r.material.map=this.religionTextureForSentiment(e.sentiment)),r.__tweetData=e,r.castShadow=!0,r.receiveShadow=!0,r.position.copy(this.randomTweetMeshPosition());var o={value:.05},s={value:2*Math.random()+e.tweet.text.length/40},a=function(){r.scale.set(o.value,o.value,o.value)};a(),setTimeout(function(){if(i.appIsActive){var e=new d.Tween(o).to(s,500);e.onUpdate(a),e.easing(d.Easing.Circular.Out),e.start()}else o.value=s.value,a()},t),this.scene.add(r),this.tweetMeshes.push(r);var h=this.maxMeshCount/_*1e3-500;setTimeout(function(){n(i.tweetMeshes,r),r===i.detailedTweetMesh&&i.bringDetailTweetBackHome();var e=new d.Tween(o).to({value:.01},500);e.onUpdate(a),e.easing(d.Easing.Circular.Out),e.onComplete(function(){i.scene.remove(r)}),e.start()},h)}},randomTweetMeshPosition:{value:function(){return new u.Vector3(100*(Math.random()-.5),100*(Math.random()-.5),100*(Math.random()-.5))}},religionTextureForSentiment:{value:function(e){var t={amazing:454,great:759,good:473,ok:535,bad:322,worse:361,horrible:456},i=this.fuzzySentiment(e),n="/media/photos/"+i+"/"+i,r=m.randInt(t[i]-1)+1,o=n+r+".jpg",s=u.ImageUtils.loadTexture(o);return s.minFilter=u.NearestFilter,s.wrapS=s.wrapT=u.ClampToEdgeWrapping,s}},fuzzySentiment:{value:function(e){return e>10?"amazing":e>0?"great":e>-5?"worse":"horrible"}},colorForTweetData:{value:function(e){var t=e.sentiment,i=new u.Color(16777215);switch(this.meshColorStyle){case"sentiment":var n=10,r=0>t?Math.min(-t,n):Math.min(t,n),o=r/n;return 0>t?i.setRGB(1,1-o,1-o):i.setRGB(1-o,1,1-o),i;case"random":return i.setRGB(Math.random(),Math.random(),Math.random()),i;default:return i}}},makeHoldNotes:{value:function(e){var t=this,i=this.sounds,n=[i.A,i.C,i.C2,i.D,i.E,i.F,i.G],r=m.choice(n);(r.isPaused()||r.getTime()>.2)&&(r.setTime(0),r.play());var o=3e3+Math.random()*Math.random()*e;setTimeout(function(){t.makeHoldNotes(e)},o)}},makeGodSound:{value:function(e){var t,i,n=this.sounds,r=[],o=[],s=[];e>15?(r=[n.glock13],o=[n.hh28,n.hh29,n.hh30,n.hh31,n.hh32]):e>14?(r=[n.glock12],o=[n.hh27,n.hh28,n.hh29,n.hh30,n.hh31]):e>13?(r=[n.glock11],o=[n.hh26,n.hh27,n.hh28,n.hh29,n.hh30]):e>12?(r=[n.glock10],o=[n.hh25,n.hh26,n.hh27,n.hh28,n.hh29]):e>11?(r=[n.glock9],o=[n.hh24,n.hh25,n.hh26,n.hh27,n.hh28]):e>10?(r=[n.glock8],o=[n.hh23,n.hh24,n.hh25,n.hh26,n.hh27]):e>9?(r=[n.glock7],o=[n.hh22,n.hh23,n.hh24,n.hh25,n.hh26]):e>8?(r=[n.altglock6],o=[n.hh21,n.hh22,n.hh23,n.hh24,n.hh25]):e>7?(r=[n.altglock5],o=[n.hh20,n.hh21,n.hh22,n.hh23,n.hh24]):e>6?(r=[n.altglock4],o=[n.hh10,n.hh11,n.hh12,n.hh13,n.hh14]):e>5?(r=[n.altglock3],o=[n.hh9,n.hh10,n.hh11,n.hh12,n.hh13]):e>4?(r=[n.altglock2],o=[n.hh8,n.hh9,n.hh10,n.hh11,n.hh12]):e>3?(r=[n.altglock1],o=[n.hh7,n.hh8,n.hh9,n.hh10,n.hh11]):e>2?(r=[n.mallet4,n.mallet5,n.mallet6,n.mallet7,n.mallet8],o=[n.hh6,n.hh7,n.hh8,n.hh9,n.hh10]):e>1?(r=[n.mallet3,n.mallet4,n.mallet5,n.mallet6,n.mallet7],o=[n.hh5,n.hh6,n.hh7,n.hh8,n.hh9]):e>0?(r=[n.mallet2,n.mallet3,n.mallet4,n.mallet5,n.mallet6],o=[n.hh4,n.hh5,n.hh6,n.hh7,n.hh8]):e>-1?(r=[n.mallet1,n.mallet2,n.mallet3,n.mallet4,n.mallet5],o=[n.hh3,n.hh4,n.hh5,n.hh6,n.hh7]):e>-2?(r=[n.dbass4,n.dbass5,n.dbass6,n.dbass7,n.dbass8],o=[n.hh2,n.hh3,n.hh4,n.hh5,n.hh6]):e>-3?(r=[n.dbass1note,n.dbass2,n.dbass3,n.dbass4,n.dbass5],o=[n.hh1,n.hh2,n.hh3,n.hh4,n.hh5]):e>-4?(r=[n.cloud8],o=[n.kick17,n.kick18,n.kick19,n.kick20]):e>-5?(r=[n.clouds7],o=[n.kick13,n.kick14,n.kick15,n.kick16]):e>-6?(r=[n.clouds6],o=[n.kick9,n.kick10,n.kick11,n.kick12]):e>-7?(r=[n.clouds5],o=[n.kick6,n.kick7,n.kick8]):e>-8?(r=[n.clouds4],o=[n.kick4,n.kick5]):e>-9?(r=[n.clouds3],o=[n.kick3]):e>-10?(r=[n.clouds2],o=[n.kick2]):(r=[n.clouds1],o=[n.kick1]),s=e>15?["C8","D8","E8","F8","G8","A8","C9","D9","E9","F9","G9","A9"]:e>10?["C7","D7","E7","F7","G7","A7"]:e>5?["C6","D6","E6","F6","G6","A6"]:e>0?["C4","D4","E4","F4","G4","A4","C5","D5","E5","F5","G5","A5"]:e>-5?["C3","D3","E3","F3","G3","A3"]:e>-10?["C2","D2","E2","F2","G2","A2"]:["C1","D1","E1","F1","G1","A1"],this.useInstruments&&(t=m.choice(r),(t.isPaused()||t.getTime()>.2)&&(t.setTime(0),t.play())),this.usePercussion&&(i=m.choice(o),(i.isPaused()||i.getTime()>.2)&&(i.setTime(0),i.play()));var a=30,h=0>e?e:Math.min(e,a),l=h/a/2;if(this.useSynth){var c=m.choice(s);this.panner.pan.value=.5+l,this.sineSynth.triggerAttackRelease(c,"32n")}}}}),t}(v)},{"./lib/buzz":3,"./sheen-scene.es6":7,"./word-tracker.es6":11,kutility:13,nlp_compromise:14,"socket.io-client":62,three:110,tone:111,"tween.js":112}],6:[function(e,t,i){"use strict";var n=function(){function e(e,t){for(var i in t){var n=t[i];n.configurable=!0,n.value&&(n.writable=!0)}Object.defineProperties(e,t)}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function g(e,t,i){var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var r=Object.getPrototypeOf(e);return null===r?void 0:g(r,t,i)}if("value"in n&&n.writable)return n.value;var o=n.get;return void 0===o?void 0:o.call(i)},o=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)},s=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},a=e("jquery"),h=e("three"),l=e("./lib/physi.js"),c=e("tween.js"),u=e("./three-boiler.es6").ThreeBoiler,p=e("./main-scene.es6").MainScene;e("./controls/fly-controls");e("./social-evader")();var d=/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),f="is loading",m=a("#splash-status"),y=function(e){function t(){var e=this;s(this,t),r(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,{antialias:!0,alpha:!0,onPhone:d});var i=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor);i||a("#splash-please-use-chrome").show(),this.renderer&&(this.renderer.shadowMapEnabled=!0,this.renderer.shadowMapCullFace=h.CullFaceBack,this.renderer.shadowMapType=h.PCFSoftShadowMap,this.renderer.gammaInput=!0,this.renderer.gammaOutput=!0),this.mainScene=new p(this.renderer,this.camera,this.scene,{onPhone:d}),this.mainScene.controls=this.controls,this.clock=new h.Clock,a(document).click(function(t){a(t.target).is("a")||e.loading||e.hasStarted&&e.mainScene.click(t)}),a("#click-to-start").click(function(){e.hasStarted||e.start(!1)}),a("#click-to-start-simple").click(function(){e.hasStarted||e.start(!0)}),a(document).mousemove(function(t){e.mainScene.move(t)})}return o(t,e),n(t,{createScene:{value:function(){var e=new l.Scene;return e.setGravity(new h.Vector3(0,-50,0)),e.addEventListener("update",function(){e.simulate(void 0,1)}),e}},createAmbientLight:{value:function(){return new h.AmbientLight(5263440)}},activate:{value:function(){var e=this;r(Object.getPrototypeOf(t.prototype),"activate",this).call(this),this.loading=!0,this.updateLoadingView(),setTimeout(function(){e.didFinishLoading()},500),this.scene.simulate(),this.mainScene.startScene()}},render:{value:function(){r(Object.getPrototypeOf(t.prototype),"render",this).call(this),c.update(),this.mainScene.update(this.clock.getDelta());
}},setAppActive:{value:function(e){r(Object.getPrototypeOf(t.prototype),"setAppActive",this).call(this,e),this.mainScene&&this.mainScene.setAppActive(e)}},keypress:{value:function(e){r(Object.getPrototypeOf(t.prototype),"keypress",this).call(this,e),this.mainScene.keypress(e)}},keydown:{value:function(e){r(Object.getPrototypeOf(t.prototype),"keydown",this).call(this,e),this.mainScene.keydown(e)}},keyup:{value:function(e){r(Object.getPrototypeOf(t.prototype),"keyup",this).call(this,e),this.mainScene.keyup(e)}},spacebarPressed:{value:function(){this.mainScene.spacebarPressed()}},updateLoadingView:{value:function(){var e=this;if(this.loading){var t=m.text();t.length<f.length+3?(t+=".",m.text(t)):m.text(f),setTimeout(function(){e.updateLoadingView()},250)}}},didFinishLoading:{value:function(){var e=this;this.loading=!1,m.text("is ready"),m.css("font-style","italic"),this.onPhone&&a("#splash-mobile-warning").fadeIn(1e3),setTimeout(function(){e.hasStarted||a("#splash-controls").fadeIn(1e3)},250),setTimeout(function(){e.hasStarted||a(".click-to-start-container").fadeIn(1e3)},1750)}},start:{value:function(e){a(".splash-overlay").fadeOut(1e3),this.onPhone&&a("#mobile-error-overlay").fadeOut(1e3),this.mainScene.doTimedWork(e),this.hasStarted=!0}}}),t}(u);a(function(){var e=new y;e.activate()})},{"./controls/fly-controls":1,"./lib/physi.js":4,"./main-scene.es6":5,"./social-evader":8,"./three-boiler.es6":9,jquery:12,three:110,"tween.js":112}],7:[function(e,t,i){"use strict";var n=function(){function e(e,t){for(var i in t){var n=t[i];n.configurable=!0,n.value&&(n.writable=!0)}Object.defineProperties(e,t)}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(i,"__esModule",{value:!0});var o=(e("three"),e("jquery"));i.SheenScene=function(){function e(t,i,n,s){r(this,e),this.renderer=t,this.camera=i,this.scene=n,this.options=s,this.name="sheen scene",this.domContainer=o("body"),o(window).resize(this.resize.bind(this)),this.hasStarted=!1,this.appIsActive=!0}return n(e,{update:{value:function(){}},setAppActive:{value:function(e){this.appIsActive=e}},startScene:{value:function(){this.enter(),this.startAutomatically&&this.doTimedWork()}},enter:{value:function(){this.active=!0,this.camera.position.set(0,0,0),this.camera.rotation.x=0,this.camera.rotation.y=0,this.camera.rotation.z=0}},doTimedWork:{value:function(){}},exit:{value:function(){this.active=!1;for(var e=this.children(),t=0;t<e.length;t++){var i=e[t];this.scene.remove(i)}}},iWantOut:{value:function(){this.exitCallback&&this.exitCallback(this)}},addMesh:{value:function(){}},click:{value:function(){this.active&&this.isLive&&!this.hasStarted&&(this.doTimedWork(),this.hasStarted=!0)}},move:{value:function(){}},resize:{value:function(){}},keypress:{value:function(){}},keydown:{value:function(){}},keyup:{value:function(){}},children:{value:function(){return[]}},makeAudio:{value:function(e){var t=document.createElement("audio");return t.src=e+".mp3",t.preload=!0,t}},makeVideo:{value:function(e,t,i){var n,r=document.createElement("video");return n=r.canPlayType("video/mp4").length>0?e+".mp4":e+".webm",r.src=n,r.preload=!0,r.loop=!0,t?o(r).addClass("full-screen-video"):o(r).addClass("video-overlay"),void 0!==i&&o(r).css("z-index",i),this.domContainer.append(r),r}},makeImage:{value:function(e,t,i){var n=o('<img src="'+e+'" class="image-overlay"/>');return t&&(n.css("top","0px"),n.css("left","0px"),n.css("width","100%"),n.css("height","100%")),void 0!==i&&n.css("z-index",i),this.domContainer.append(n),n}},makeCanvas:{value:function(e){var t=o('<canvas class="canvas-overlay"></canvas>');return void 0!==e&&t.css("z-index",e),this.domContainer.append(t),t.get(0)}}}),e}()},{jquery:12,three:110}],8:[function(e,t,i){"use strict";function n(e){var t=a(this),i=t.offset(),n={x:i.left+t.outerWidth()/2,y:i.top+t.outerHeight()/2},o=new h(n.x-e.pageX,n.y-e.pageY),s=t.outerWidth()/2;if(!(o.length()>=s)){var l=o.normal().multeq(s).sub(o),c={left:i.left+l.x,top:i.top+l.y},u=12;c.left=r(c.left,-u,window.innerWidth-t.outerWidth()+u),c.top=r(c.top,-u,window.innerHeight-t.outerHeight()+u),setTimeout(function(){t.offset(c)},100)}}function r(e,t,i){return t>e?t:e>i?i:e}function o(){a(this).bind("mousemove",n)}function s(){a(this).unbind("mousemove",n)}var a=e("jquery"),h=e("./vector");t.exports=function(){a(function(){a(".social-button").bind("mouseenter",o),a(".social-button").bind("mouseleave",s)})}},{"./vector":10,jquery:12}],9:[function(e,t,i){"use strict";var n=function(){function e(e,t){for(var i in t){var n=t[i];n.configurable=!0,n.value&&(n.writable=!0)}Object.defineProperties(e,t)}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(i,"__esModule",{value:!0});var o=e("jquery"),s=e("three");i.ThreeBoiler=function(){function e(t){var i=this;if(r(this,e),this.onPhone=t.onPhone||!1,!this.onPhone){try{this.renderer=new s.WebGLRenderer(t),this.renderMode="webgl"}catch(n){o(".webgl-error").show(),setTimeout(function(){o(".webgl-error").fadeOut()},6666),this.renderer=new s.CanvasRenderer,this.renderMode="canvas"}this.renderer.setClearColor(16777215,1),document.body.appendChild(this.renderer.domElement)}this.scene=this.createScene(),this.camera=this.createCamera(),this.scene.add(this.camera),this.ambientLight=this.createAmbientLight(),this.scene.add(this.ambientLight),o(window).resize(function(){i.resize()}),this.resize(),o("body").keypress(function(e){i.keypress(e.which)}),o("body").keydown(function(e){i.keydown(e.which)}),o("body").keyup(function(e){i.keyup(e.which)}),this.setAppActive(!0),o(window).blur(function(){i.setAppActive(!1)}),o(window).focus(function(){i.setAppActive(!0)})}return n(e,{createScene:{value:function(){return new s.Scene}},createCamera:{value:function(){return new s.PerspectiveCamera(65,window.innerWidth/window.innerHeight,1,5e3)}},createAmbientLight:{value:function(){return new s.AmbientLight(4210752)}},activate:{value:function(){this.frame=0,this.render()}},render:{value:function(){var e=this;requestAnimationFrame(function(){e.render()}),this.frame+=1,this.renderer&&this.renderer.render(this.scene,this.camera)}},resize:{value:function(){this.renderer&&this.renderer.setSize(window.innerWidth,window.innerHeight),this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix()}},setAppActive:{value:function(e){this.appIsActive=e}},fadeSceneOverlay:{value:function(e,t){t||(t={});var i=t.duration||1e3;$sceneOverlay.fadeIn(i,function(){e(),$sceneOverlay.fadeOut(i)})}},keypress:{value:function(e){switch(e){case 32:this.spacebarPressed()}}},keydown:{value:function(e){}},keyup:{value:function(e){}},spacebarPressed:{value:function(){}}}),e}();window._typeface_js={faces:s.FontUtils.faces,loadFace:s.FontUtils.loadFace},s.typeface_js=window._typeface_js,function(){for(var e=0,t=["ms","moz","webkit","o"],i=0;i<t.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[t[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[i]+"CancelAnimationFrame"]||window[t[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var i=(new Date).getTime(),n=Math.max(0,16-(i-e)),r=window.setTimeout(function(){t(i+n)},n);return e=i+n,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}()},{jquery:12,three:110}],10:[function(e,t,i){"use strict";function n(e,t){this.x=e,this.y=t}t.exports=n,n.prototype={clone:function(){return new n(this.x,this.y)},negate:function(){return this.x=-this.x,this.y=-this.y,this},neg:function(){return this.clone().negate()},addeq:function(e){return this.x+=e.x,this.y+=e.y,this},subeq:function(e){return this.addeq(e.neg())},add:function(e){return this.clone().addeq(e)},sub:function(e){return this.clone().subeq(e)},multeq:function(e){return this.x*=e,this.y*=e,this},diveq:function(e){return this.x/=e,this.y/=e,this},mult:function(e){return this.clone().multeq(e)},div:function(e){return this.clone().diveq(e)},dot:function(e){return this.x*e.x+this.y*e.y},length:function(){return Math.sqrt(this.dot(this))},normal:function(){return this.clone().diveq(this.length())}}},{}],11:[function(e,t,i){"use strict";var n=function(){function e(e,t){for(var i in t){var n=t[i];n.configurable=!0,n.value&&(n.writable=!0)}Object.defineProperties(e,t)}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(i,"__esModule",{value:!0});i.WordTracker=function(){function e(t){r(this,e),t||(t={}),this.numberOfMostFrequentWords=t.numberOfMostFrequentWords||3,this.bannedWords=t.bannedWords||[],this.countmap={},this.mostFrequentWords=[]}return n(e,{track:{value:function(e){for(var t=0;t<e.length;t++){var i=e[t].replace(/\s/g,"").toLowerCase();if(!(0===i.length||this.bannedWords.indexOf(i)>=0)){var n=this.countmap[i]||0;n+=1,this.countmap[i]=n;for(var r=0;r<this.numberOfMostFrequentWords;r++){var o=this.mostFrequentWords[r],s=this.countmap[o]||0;if(n>s){var a=this.mostFrequentWords.indexOf(i);a>=0?(this.mostFrequentWords[a]=o,this.mostFrequentWords[r]=i):(this.mostFrequentWords.splice(r,0,i),this.mostFrequentWords.length>this.numberOfMostFrequentWords&&this.mostFrequentWords.pop());break}}}}}},mostFrequentWordsList:{value:function(){return this.mostFrequentWords.join(", ")}}}),e}()},{}],12:[function(e,t,i){!function(e,i){"object"==typeof t&&"object"==typeof t.exports?t.exports=e.document?i(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return i(e)}:i(e)}("undefined"!=typeof window?window:this,function(e,t){function i(e){var t=e.length,i=Z.type(e);return"function"===i||Z.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e}function n(e,t,i){if(Z.isFunction(t))return Z.grep(e,function(e,n){return!!t.call(e,n,e)!==i});if(t.nodeType)return Z.grep(e,function(e){return e===t!==i});if("string"==typeof t){if(ae.test(t))return Z.filter(t,e,i);t=Z.filter(t,e)}return Z.grep(e,function(e){return W.call(t,e)>=0!==i})}function r(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function o(e){var t=fe[e]={};return Z.each(e.match(de)||[],function(e,i){t[i]=!0}),t}function s(){Q.removeEventListener("DOMContentLoaded",s,!1),e.removeEventListener("load",s,!1),Z.ready()}function a(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=Z.expando+a.uid++}function h(e,t,i){var n;if(void 0===i&&1===e.nodeType)if(n="data-"+t.replace(_e,"-$1").toLowerCase(),i=e.getAttribute(n),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:be.test(i)?Z.parseJSON(i):i}catch(r){}ve.set(e,t,i)}else i=void 0;return i}function l(){return!0}function c(){return!1}function u(){try{return Q.activeElement}catch(e){}}function p(e,t){return Z.nodeName(e,"table")&&Z.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function d(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function f(e){var t=Be.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function m(e,t){for(var i=0,n=e.length;n>i;i++)ge.set(e[i],"globalEval",!t||ge.get(t[i],"globalEval"))}function y(e,t){var i,n,r,o,s,a,h,l;if(1===t.nodeType){if(ge.hasData(e)&&(o=ge.access(e),s=ge.set(t,o),l=o.events)){delete s.handle,s.events={};for(r in l)for(i=0,n=l[r].length;n>i;i++)Z.event.add(t,r,l[r][i])}ve.hasData(e)&&(a=ve.access(e),h=Z.extend({},a),ve.set(t,h))}}function g(e,t){var i=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&Z.nodeName(e,t)?Z.merge([e],i):i}function v(e,t){var i=t.nodeName.toLowerCase();"input"===i&&Me.test(e.type)?t.checked=e.checked:("input"===i||"textarea"===i)&&(t.defaultValue=e.defaultValue)}function b(t,i){var n,r=Z(i.createElement(t)).appendTo(i.body),o=e.getDefaultComputedStyle&&(n=e.getDefaultComputedStyle(r[0]))?n.display:Z.css(r[0],"display");return r.detach(),o}function _(e){var t=Q,i=ze[e];return i||(i=b(e,t),"none"!==i&&i||(Ve=(Ve||Z("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=Ve[0].contentDocument,t.write(),t.close(),i=b(e,t),Ve.detach()),ze[e]=i),i}function x(e,t,i){var n,r,o,s,a=e.style;return i=i||Ge(e),i&&(s=i.getPropertyValue(t)||i[t]),i&&(""!==s||Z.contains(e.ownerDocument,e)||(s=Z.style(e,t)),Ie.test(s)&&Ue.test(t)&&(n=a.width,r=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=i.width,a.width=n,a.minWidth=r,a.maxWidth=o)),void 0!==s?s+"":s}function w(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function S(e,t){if(t in e)return t;for(var i=t[0].toUpperCase()+t.slice(1),n=t,r=Je.length;r--;)if(t=Je[r]+i,t in e)return t;return n}function M(e,t,i){var n=He.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function T(e,t,i,n,r){for(var o=i===(n?"border":"content")?4:"width"===t?1:0,s=0;4>o;o+=2)"margin"===i&&(s+=Z.css(e,i+we[o],!0,r)),n?("content"===i&&(s-=Z.css(e,"padding"+we[o],!0,r)),"margin"!==i&&(s-=Z.css(e,"border"+we[o]+"Width",!0,r))):(s+=Z.css(e,"padding"+we[o],!0,r),"padding"!==i&&(s+=Z.css(e,"border"+we[o]+"Width",!0,r)));return s}function E(e,t,i){var n=!0,r="width"===t?e.offsetWidth:e.offsetHeight,o=Ge(e),s="border-box"===Z.css(e,"boxSizing",!1,o);if(0>=r||null==r){if(r=x(e,t,o),(0>r||null==r)&&(r=e.style[t]),Ie.test(r))return r;n=s&&(Y.boxSizingReliable()||r===e.style[t]),r=parseFloat(r)||0}return r+T(e,t,i||(s?"border":"content"),n,o)+"px"}function k(e,t){for(var i,n,r,o=[],s=0,a=e.length;a>s;s++)n=e[s],n.style&&(o[s]=ge.get(n,"olddisplay"),i=n.style.display,t?(o[s]||"none"!==i||(n.style.display=""),""===n.style.display&&Se(n)&&(o[s]=ge.access(n,"olddisplay",_(n.nodeName)))):(r=Se(n),"none"===i&&r||ge.set(n,"olddisplay",r?i:Z.css(n,"display"))));for(s=0;a>s;s++)n=e[s],n.style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?o[s]||"":"none"));return e}function A(e,t,i,n,r){return new A.prototype.init(e,t,i,n,r)}function C(){return setTimeout(function(){Ye=void 0}),Ye=Z.now()}function P(e,t){var i,n=0,r={height:e};for(t=t?1:0;4>n;n+=2-t)i=we[n],r["margin"+i]=r["padding"+i]=e;return t&&(r.opacity=r.width=e),r}function L(e,t,i){for(var n,r=(it[t]||[]).concat(it["*"]),o=0,s=r.length;s>o;o++)if(n=r[o].call(i,t,e))return n}function R(e,t,i){var n,r,o,s,a,h,l,c,u=this,p={},d=e.style,f=e.nodeType&&Se(e),m=ge.get(e,"fxshow");i.queue||(a=Z._queueHooks(e,"fx"),null==a.unqueued&&(a.unqueued=0,h=a.empty.fire,a.empty.fire=function(){a.unqueued||h()}),a.unqueued++,u.always(function(){u.always(function(){a.unqueued--,Z.queue(e,"fx").length||a.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[d.overflow,d.overflowX,d.overflowY],l=Z.css(e,"display"),c="none"===l?ge.get(e,"olddisplay")||_(e.nodeName):l,"inline"===c&&"none"===Z.css(e,"float")&&(d.display="inline-block")),i.overflow&&(d.overflow="hidden",u.always(function(){d.overflow=i.overflow[0],d.overflowX=i.overflow[1],d.overflowY=i.overflow[2]}));for(n in t)if(r=t[n],Ke.exec(r)){if(delete t[n],o=o||"toggle"===r,r===(f?"hide":"show")){if("show"!==r||!m||void 0===m[n])continue;f=!0}p[n]=m&&m[n]||Z.style(e,n)}else l=void 0;if(Z.isEmptyObject(p))"inline"===("none"===l?_(e.nodeName):l)&&(d.display=l);else{m?"hidden"in m&&(f=m.hidden):m=ge.access(e,"fxshow",{}),o&&(m.hidden=!f),f?Z(e).show():u.done(function(){Z(e).hide()}),u.done(function(){var t;ge.remove(e,"fxshow");for(t in p)Z.style(e,t,p[t])});for(n in p)s=L(f?m[n]:0,n,u),n in m||(m[n]=s.start,f&&(s.end=s.start,s.start="width"===n||"height"===n?1:0))}}function O(e,t){var i,n,r,o,s;for(i in e)if(n=Z.camelCase(i),r=t[n],o=e[i],Z.isArray(o)&&(r=o[1],o=e[i]=o[0]),i!==n&&(e[n]=o,delete e[i]),s=Z.cssHooks[n],s&&"expand"in s){o=s.expand(o),delete e[n];for(i in o)i in e||(e[i]=o[i],t[i]=r)}else t[n]=r}function F(e,t,i){var n,r,o=0,s=tt.length,a=Z.Deferred().always(function(){delete h.elem}),h=function(){if(r)return!1;for(var t=Ye||C(),i=Math.max(0,l.startTime+l.duration-t),n=i/l.duration||0,o=1-n,s=0,h=l.tweens.length;h>s;s++)l.tweens[s].run(o);return a.notifyWith(e,[l,o,i]),1>o&&h?i:(a.resolveWith(e,[l]),!1)},l=a.promise({elem:e,props:Z.extend({},t),opts:Z.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:Ye||C(),duration:i.duration,tweens:[],createTween:function(t,i){var n=Z.Tween(e,l.opts,t,i,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(n),n},stop:function(t){var i=0,n=t?l.tweens.length:0;if(r)return this;for(r=!0;n>i;i++)l.tweens[i].run(1);return t?a.resolveWith(e,[l,t]):a.rejectWith(e,[l,t]),this}}),c=l.props;for(O(c,l.opts.specialEasing);s>o;o++)if(n=tt[o].call(l,e,c,l.opts))return n;return Z.map(c,L,l),Z.isFunction(l.opts.start)&&l.opts.start.call(e,l),Z.fx.timer(Z.extend(h,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function D(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,r=0,o=t.toLowerCase().match(de)||[];if(Z.isFunction(i))for(;n=o[r++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function B(e,t,i,n){function r(a){var h;return o[a]=!0,Z.each(e[a]||[],function(e,a){var l=a(t,i,n);return"string"!=typeof l||s||o[l]?s?!(h=l):void 0:(t.dataTypes.unshift(l),r(l),!1)}),h}var o={},s=e===bt;return r(t.dataTypes[0])||!o["*"]&&r("*")}function N(e,t){var i,n,r=Z.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((r[i]?e:n||(n={}))[i]=t[i]);return n&&Z.extend(!0,e,n),e}function j(e,t,i){for(var n,r,o,s,a=e.contents,h=e.dataTypes;"*"===h[0];)h.shift(),void 0===n&&(n=e.mimeType||t.getResponseHeader("Content-Type"));if(n)for(r in a)if(a[r]&&a[r].test(n)){h.unshift(r);break}if(h[0]in i)o=h[0];else{for(r in i){if(!h[0]||e.converters[r+" "+h[0]]){o=r;break}s||(s=r)}o=o||s}return o?(o!==h[0]&&h.unshift(o),i[o]):void 0}function V(e,t,i,n){var r,o,s,a,h,l={},c=e.dataTypes.slice();if(c[1])for(s in e.converters)l[s.toLowerCase()]=e.converters[s];for(o=c.shift();o;)if(e.responseFields[o]&&(i[e.responseFields[o]]=t),!h&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),h=o,o=c.shift())if("*"===o)o=h;else if("*"!==h&&h!==o){if(s=l[h+" "+o]||l["* "+o],!s)for(r in l)if(a=r.split(" "),a[1]===o&&(s=l[h+" "+a[0]]||l["* "+a[0]])){s===!0?s=l[r]:l[r]!==!0&&(o=a[0],c.unshift(a[1]));break}if(s!==!0)if(s&&e["throws"])t=s(t);else try{t=s(t)}catch(u){return{state:"parsererror",error:s?u:"No conversion from "+h+" to "+o}}}return{state:"success",data:t}}function z(e,t,i,n){var r;if(Z.isArray(t))Z.each(t,function(t,r){i||Mt.test(e)?n(e,r):z(e+"["+("object"==typeof r?t:"")+"]",r,i,n)});else if(i||"object"!==Z.type(t))n(e,t);else for(r in t)z(e+"["+r+"]",t[r],i,n)}function U(e){return Z.isWindow(e)?e:9===e.nodeType&&e.defaultView}var I=[],G=I.slice,q=I.concat,H=I.push,W=I.indexOf,$={},X=$.toString,J=$.hasOwnProperty,Y={},Q=e.document,K="2.1.3",Z=function(e,t){return new Z.fn.init(e,t)},ee=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,te=/^-ms-/,ie=/-([\da-z])/gi,ne=function(e,t){return t.toUpperCase()};Z.fn=Z.prototype={jquery:K,constructor:Z,selector:"",length:0,toArray:function(){return G.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:G.call(this)},pushStack:function(e){var t=Z.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return Z.each(this,e,t)},map:function(e){return this.pushStack(Z.map(this,function(t,i){return e.call(t,i,t)}))},slice:function(){return this.pushStack(G.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(0>e?t:0);return this.pushStack(i>=0&&t>i?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:H,sort:I.sort,splice:I.splice},Z.extend=Z.fn.extend=function(){var e,t,i,n,r,o,s=arguments[0]||{},a=1,h=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[a]||{},a++),"object"==typeof s||Z.isFunction(s)||(s={}),a===h&&(s=this,a--);h>a;a++)if(null!=(e=arguments[a]))for(t in e)i=s[t],n=e[t],s!==n&&(l&&n&&(Z.isPlainObject(n)||(r=Z.isArray(n)))?(r?(r=!1,o=i&&Z.isArray(i)?i:[]):o=i&&Z.isPlainObject(i)?i:{},s[t]=Z.extend(l,o,n)):void 0!==n&&(s[t]=n));return s},Z.extend({expando:"jQuery"+(K+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===Z.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!Z.isArray(e)&&e-parseFloat(e)+1>=0},isPlainObject:function(e){return"object"!==Z.type(e)||e.nodeType||Z.isWindow(e)?!1:e.constructor&&!J.call(e.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?$[X.call(e)]||"object":typeof e},globalEval:function(e){var t,i=eval;e=Z.trim(e),e&&(1===e.indexOf("use strict")?(t=Q.createElement("script"),t.text=e,Q.head.appendChild(t).parentNode.removeChild(t)):i(e))},camelCase:function(e){return e.replace(te,"ms-").replace(ie,ne)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,o=0,s=e.length,a=i(e);if(n){if(a)for(;s>o&&(r=t.apply(e[o],n),r!==!1);o++);else for(o in e)if(r=t.apply(e[o],n),r===!1)break}else if(a)for(;s>o&&(r=t.call(e[o],o,e[o]),r!==!1);o++);else for(o in e)if(r=t.call(e[o],o,e[o]),r===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(ee,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(i(Object(e))?Z.merge(n,"string"==typeof e?[e]:e):H.call(n,e)),n},inArray:function(e,t,i){return null==t?-1:W.call(t,e,i)},merge:function(e,t){for(var i=+t.length,n=0,r=e.length;i>n;n++)e[r++]=t[n];return e.length=r,e},grep:function(e,t,i){for(var n,r=[],o=0,s=e.length,a=!i;s>o;o++)n=!t(e[o],o),n!==a&&r.push(e[o]);return r},map:function(e,t,n){var r,o=0,s=e.length,a=i(e),h=[];if(a)for(;s>o;o++)r=t(e[o],o,n),null!=r&&h.push(r);else for(o in e)r=t(e[o],o,n),null!=r&&h.push(r);return q.apply([],h)},guid:1,proxy:function(e,t){var i,n,r;return"string"==typeof t&&(i=e[t],t=e,e=i),Z.isFunction(e)?(n=G.call(arguments,2),r=function(){return e.apply(t||this,n.concat(G.call(arguments)))},r.guid=e.guid=e.guid||Z.guid++,r):void 0},now:Date.now,support:Y}),Z.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){$["[object "+t+"]"]=t.toLowerCase()});var re=function(e){function t(e,t,i,n){var r,o,s,a,h,l,u,d,f,m;if((t?t.ownerDocument||t:z)!==R&&L(t),t=t||R,i=i||[],a=t.nodeType,"string"!=typeof e||!e||1!==a&&9!==a&&11!==a)return i;if(!n&&F){if(11!==a&&(r=ve.exec(e)))if(s=r[1]){if(9===a){if(o=t.getElementById(s),!o||!o.parentNode)return i;if(o.id===s)return i.push(o),i}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(s))&&j(t,o)&&o.id===s)return i.push(o),i}else{if(r[2])return K.apply(i,t.getElementsByTagName(e)),i;if((s=r[3])&&x.getElementsByClassName)return K.apply(i,t.getElementsByClassName(s)),i}if(x.qsa&&(!D||!D.test(e))){if(d=u=V,f=t,m=1!==a&&e,1===a&&"object"!==t.nodeName.toLowerCase()){for(l=T(e),(u=t.getAttribute("id"))?d=u.replace(_e,"\\$&"):t.setAttribute("id",d),d="[id='"+d+"'] ",h=l.length;h--;)l[h]=d+p(l[h]);f=be.test(e)&&c(t.parentNode)||t,m=l.join(",")}if(m)try{return K.apply(i,f.querySelectorAll(m)),i}catch(y){}finally{u||t.removeAttribute("id")}}}return k(e.replace(he,"$1"),t,i,n)}function i(){function e(i,n){return t.push(i+" ")>w.cacheLength&&delete e[t.shift()],e[i+" "]=n}var t=[];return e}function n(e){return e[V]=!0,e}function r(e){var t=R.createElement("div");try{return!!e(t)}catch(i){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function o(e,t){for(var i=e.split("|"),n=e.length;n--;)w.attrHandle[i[n]]=t}function s(e,t){var i=t&&e,n=i&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||$)-(~e.sourceIndex||$);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function a(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e}}function h(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function l(e){return n(function(t){return t=+t,n(function(i,n){for(var r,o=e([],i.length,t),s=o.length;s--;)i[r=o[s]]&&(i[r]=!(n[r]=i[r]))})})}function c(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function u(){}function p(e){for(var t=0,i=e.length,n="";i>t;t++)n+=e[t].value;return n}function d(e,t,i){var n=t.dir,r=i&&"parentNode"===n,o=I++;return t.first?function(t,i,o){for(;t=t[n];)if(1===t.nodeType||r)return e(t,i,o)}:function(t,i,s){var a,h,l=[U,o];if(s){for(;t=t[n];)if((1===t.nodeType||r)&&e(t,i,s))return!0}else for(;t=t[n];)if(1===t.nodeType||r){if(h=t[V]||(t[V]={}),(a=h[n])&&a[0]===U&&a[1]===o)return l[2]=a[2];if(h[n]=l,l[2]=e(t,i,s))return!0}}}function f(e){return e.length>1?function(t,i,n){for(var r=e.length;r--;)if(!e[r](t,i,n))return!1;return!0}:e[0]}function m(e,i,n){for(var r=0,o=i.length;o>r;r++)t(e,i[r],n);return n}function y(e,t,i,n,r){for(var o,s=[],a=0,h=e.length,l=null!=t;h>a;a++)(o=e[a])&&(!i||i(o,n,r))&&(s.push(o),l&&t.push(a));return s}function g(e,t,i,r,o,s){return r&&!r[V]&&(r=g(r)),o&&!o[V]&&(o=g(o,s)),n(function(n,s,a,h){var l,c,u,p=[],d=[],f=s.length,g=n||m(t||"*",a.nodeType?[a]:a,[]),v=!e||!n&&t?g:y(g,p,e,a,h),b=i?o||(n?e:f||r)?[]:s:v;if(i&&i(v,b,a,h),r)for(l=y(b,d),r(l,[],a,h),c=l.length;c--;)(u=l[c])&&(b[d[c]]=!(v[d[c]]=u));if(n){if(o||e){if(o){for(l=[],c=b.length;c--;)(u=b[c])&&l.push(v[c]=u);o(null,b=[],l,h)}for(c=b.length;c--;)(u=b[c])&&(l=o?ee(n,u):p[c])>-1&&(n[l]=!(s[l]=u))}}else b=y(b===s?b.splice(f,b.length):b),o?o(null,s,b,h):K.apply(s,b)})}function v(e){for(var t,i,n,r=e.length,o=w.relative[e[0].type],s=o||w.relative[" "],a=o?1:0,h=d(function(e){return e===t},s,!0),l=d(function(e){return ee(t,e)>-1},s,!0),c=[function(e,i,n){var r=!o&&(n||i!==A)||((t=i).nodeType?h(e,i,n):l(e,i,n));return t=null,r}];r>a;a++)if(i=w.relative[e[a].type])c=[d(f(c),i)];else{if(i=w.filter[e[a].type].apply(null,e[a].matches),i[V]){for(n=++a;r>n&&!w.relative[e[n].type];n++);return g(a>1&&f(c),a>1&&p(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(he,"$1"),i,n>a&&v(e.slice(a,n)),r>n&&v(e=e.slice(n)),r>n&&p(e))}c.push(i)}return f(c)}function b(e,i){var r=i.length>0,o=e.length>0,s=function(n,s,a,h,l){var c,u,p,d=0,f="0",m=n&&[],g=[],v=A,b=n||o&&w.find.TAG("*",l),_=U+=null==v?1:Math.random()||.1,x=b.length;for(l&&(A=s!==R&&s);f!==x&&null!=(c=b[f]);f++){if(o&&c){for(u=0;p=e[u++];)if(p(c,s,a)){h.push(c);break}l&&(U=_)}r&&((c=!p&&c)&&d--,n&&m.push(c))}if(d+=f,r&&f!==d){for(u=0;p=i[u++];)p(m,g,s,a);if(n){if(d>0)for(;f--;)m[f]||g[f]||(g[f]=Y.call(h));g=y(g)}K.apply(h,g),l&&!n&&g.length>0&&d+i.length>1&&t.uniqueSort(h)}return l&&(U=_,A=v),m};return r?n(s):s}var _,x,w,S,M,T,E,k,A,C,P,L,R,O,F,D,B,N,j,V="sizzle"+1*new Date,z=e.document,U=0,I=0,G=i(),q=i(),H=i(),W=function(e,t){return e===t&&(P=!0),0},$=1<<31,X={}.hasOwnProperty,J=[],Y=J.pop,Q=J.push,K=J.push,Z=J.slice,ee=function(e,t){for(var i=0,n=e.length;n>i;i++)if(e[i]===t)return i;return-1},te="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ie="[\\x20\\t\\r\\n\\f]",ne="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",re=ne.replace("w","w#"),oe="\\["+ie+"*("+ne+")(?:"+ie+"*([*^$|!~]?=)"+ie+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+re+"))|)"+ie+"*\\]",se=":("+ne+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+oe+")*)|.*)\\)|)",ae=new RegExp(ie+"+","g"),he=new RegExp("^"+ie+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ie+"+$","g"),le=new RegExp("^"+ie+"*,"+ie+"*"),ce=new RegExp("^"+ie+"*([>+~]|"+ie+")"+ie+"*"),ue=new RegExp("="+ie+"*([^\\]'\"]*?)"+ie+"*\\]","g"),pe=new RegExp(se),de=new RegExp("^"+re+"$"),fe={ID:new RegExp("^#("+ne+")"),CLASS:new RegExp("^\\.("+ne+")"),TAG:new RegExp("^("+ne.replace("w","w*")+")"),ATTR:new RegExp("^"+oe),PSEUDO:new RegExp("^"+se),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ie+"*(even|odd|(([+-]|)(\\d*)n|)"+ie+"*(?:([+-]|)"+ie+"*(\\d+)|))"+ie+"*\\)|)","i"),bool:new RegExp("^(?:"+te+")$","i"),needsContext:new RegExp("^"+ie+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ie+"*((?:-\\d)?\\d*)"+ie+"*\\)|)(?=[^-]|$)","i")},me=/^(?:input|select|textarea|button)$/i,ye=/^h\d$/i,ge=/^[^{]+\{\s*\[native \w/,ve=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,be=/[+~]/,_e=/'|\\/g,xe=new RegExp("\\\\([\\da-f]{1,6}"+ie+"?|("+ie+")|.)","ig"),we=function(e,t,i){var n="0x"+t-65536;return n!==n||i?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},Se=function(){L()};try{K.apply(J=Z.call(z.childNodes),z.childNodes),J[z.childNodes.length].nodeType}catch(Me){K={apply:J.length?function(e,t){Q.apply(e,Z.call(t))}:function(e,t){for(var i=e.length,n=0;e[i++]=t[n++];);e.length=i-1}}}x=t.support={},M=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},L=t.setDocument=function(e){var t,i,n=e?e.ownerDocument||e:z;return n!==R&&9===n.nodeType&&n.documentElement?(R=n,O=n.documentElement,i=n.defaultView,i&&i!==i.top&&(i.addEventListener?i.addEventListener("unload",Se,!1):i.attachEvent&&i.attachEvent("onunload",Se)),F=!M(n),x.attributes=r(function(e){return e.className="i",!e.getAttribute("className")}),x.getElementsByTagName=r(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),x.getElementsByClassName=ge.test(n.getElementsByClassName),x.getById=r(function(e){return O.appendChild(e).id=V,!n.getElementsByName||!n.getElementsByName(V).length}),x.getById?(w.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&F){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},w.filter.ID=function(e){var t=e.replace(xe,we);return function(e){return e.getAttribute("id")===t}}):(delete w.find.ID,w.filter.ID=function(e){var t=e.replace(xe,we);return function(e){var i="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}}),w.find.TAG=x.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):x.qsa?t.querySelectorAll(e):void 0}:function(e,t){var i,n=[],r=0,o=t.getElementsByTagName(e);if("*"===e){for(;i=o[r++];)1===i.nodeType&&n.push(i);return n}return o},w.find.CLASS=x.getElementsByClassName&&function(e,t){return F?t.getElementsByClassName(e):void 0},B=[],D=[],(x.qsa=ge.test(n.querySelectorAll))&&(r(function(e){O.appendChild(e).innerHTML="<a id='"+V+"'></a><select id='"+V+"-\f]' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&D.push("[*^$]="+ie+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||D.push("\\["+ie+"*(?:value|"+te+")"),e.querySelectorAll("[id~="+V+"-]").length||D.push("~="),e.querySelectorAll(":checked").length||D.push(":checked"),e.querySelectorAll("a#"+V+"+*").length||D.push(".#.+[+~]")}),r(function(e){var t=n.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&D.push("name"+ie+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||D.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),D.push(",.*:")})),(x.matchesSelector=ge.test(N=O.matches||O.webkitMatchesSelector||O.mozMatchesSelector||O.oMatchesSelector||O.msMatchesSelector))&&r(function(e){x.disconnectedMatch=N.call(e,"div"),N.call(e,"[s!='']:x"),B.push("!=",se)}),D=D.length&&new RegExp(D.join("|")),B=B.length&&new RegExp(B.join("|")),t=ge.test(O.compareDocumentPosition),j=t||ge.test(O.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;
return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},W=t?function(e,t){if(e===t)return P=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i?i:(i=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&i||!x.sortDetached&&t.compareDocumentPosition(e)===i?e===n||e.ownerDocument===z&&j(z,e)?-1:t===n||t.ownerDocument===z&&j(z,t)?1:C?ee(C,e)-ee(C,t):0:4&i?-1:1)}:function(e,t){if(e===t)return P=!0,0;var i,r=0,o=e.parentNode,a=t.parentNode,h=[e],l=[t];if(!o||!a)return e===n?-1:t===n?1:o?-1:a?1:C?ee(C,e)-ee(C,t):0;if(o===a)return s(e,t);for(i=e;i=i.parentNode;)h.unshift(i);for(i=t;i=i.parentNode;)l.unshift(i);for(;h[r]===l[r];)r++;return r?s(h[r],l[r]):h[r]===z?-1:l[r]===z?1:0},n):R},t.matches=function(e,i){return t(e,null,null,i)},t.matchesSelector=function(e,i){if((e.ownerDocument||e)!==R&&L(e),i=i.replace(ue,"='$1']"),x.matchesSelector&&F&&(!B||!B.test(i))&&(!D||!D.test(i)))try{var n=N.call(e,i);if(n||x.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(r){}return t(i,R,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==R&&L(e),j(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==R&&L(e);var i=w.attrHandle[t.toLowerCase()],n=i&&X.call(w.attrHandle,t.toLowerCase())?i(e,t,!F):void 0;return void 0!==n?n:x.attributes||!F?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,i=[],n=0,r=0;if(P=!x.detectDuplicates,C=!x.sortStable&&e.slice(0),e.sort(W),P){for(;t=e[r++];)t===e[r]&&(n=i.push(r));for(;n--;)e.splice(i[n],1)}return C=null,e},S=t.getText=function(e){var t,i="",n=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=S(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[n++];)i+=S(t);return i},w=t.selectors={cacheLength:50,createPseudo:n,match:fe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(xe,we),e[3]=(e[3]||e[4]||e[5]||"").replace(xe,we),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,i=!e[6]&&e[2];return fe.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&pe.test(i)&&(t=T(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(xe,we).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=G[e+" "];return t||(t=new RegExp("(^|"+ie+")"+e+"("+ie+"|$)"))&&G(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,i,n){return function(r){var o=t.attr(r,e);return null==o?"!="===i:i?(o+="","="===i?o===n:"!="===i?o!==n:"^="===i?n&&0===o.indexOf(n):"*="===i?n&&o.indexOf(n)>-1:"$="===i?n&&o.slice(-n.length)===n:"~="===i?(" "+o.replace(ae," ")+" ").indexOf(n)>-1:"|="===i?o===n||o.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,i,n,r){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===n&&0===r?function(e){return!!e.parentNode}:function(t,i,h){var l,c,u,p,d,f,m=o!==s?"nextSibling":"previousSibling",y=t.parentNode,g=a&&t.nodeName.toLowerCase(),v=!h&&!a;if(y){if(o){for(;m;){for(u=t;u=u[m];)if(a?u.nodeName.toLowerCase()===g:1===u.nodeType)return!1;f=m="only"===e&&!f&&"nextSibling"}return!0}if(f=[s?y.firstChild:y.lastChild],s&&v){for(c=y[V]||(y[V]={}),l=c[e]||[],d=l[0]===U&&l[1],p=l[0]===U&&l[2],u=d&&y.childNodes[d];u=++d&&u&&u[m]||(p=d=0)||f.pop();)if(1===u.nodeType&&++p&&u===t){c[e]=[U,d,p];break}}else if(v&&(l=(t[V]||(t[V]={}))[e])&&l[0]===U)p=l[1];else for(;(u=++d&&u&&u[m]||(p=d=0)||f.pop())&&((a?u.nodeName.toLowerCase()!==g:1!==u.nodeType)||!++p||(v&&((u[V]||(u[V]={}))[e]=[U,p]),u!==t)););return p-=r,p===n||p%n===0&&p/n>=0}}},PSEUDO:function(e,i){var r,o=w.pseudos[e]||w.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return o[V]?o(i):o.length>1?(r=[e,e,"",i],w.setFilters.hasOwnProperty(e.toLowerCase())?n(function(e,t){for(var n,r=o(e,i),s=r.length;s--;)n=ee(e,r[s]),e[n]=!(t[n]=r[s])}):function(e){return o(e,0,r)}):o}},pseudos:{not:n(function(e){var t=[],i=[],r=E(e.replace(he,"$1"));return r[V]?n(function(e,t,i,n){for(var o,s=r(e,null,n,[]),a=e.length;a--;)(o=s[a])&&(e[a]=!(t[a]=o))}):function(e,n,o){return t[0]=e,r(t,null,o,i),t[0]=null,!i.pop()}}),has:n(function(e){return function(i){return t(e,i).length>0}}),contains:n(function(e){return e=e.replace(xe,we),function(t){return(t.textContent||t.innerText||S(t)).indexOf(e)>-1}}),lang:n(function(e){return de.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(xe,we).toLowerCase(),function(t){var i;do if(i=F?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return i=i.toLowerCase(),i===e||0===i.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===O},focus:function(e){return e===R.activeElement&&(!R.hasFocus||R.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!w.pseudos.empty(e)},header:function(e){return ye.test(e.nodeName)},input:function(e){return me.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:l(function(){return[0]}),last:l(function(e,t){return[t-1]}),eq:l(function(e,t,i){return[0>i?i+t:i]}),even:l(function(e,t){for(var i=0;t>i;i+=2)e.push(i);return e}),odd:l(function(e,t){for(var i=1;t>i;i+=2)e.push(i);return e}),lt:l(function(e,t,i){for(var n=0>i?i+t:i;--n>=0;)e.push(n);return e}),gt:l(function(e,t,i){for(var n=0>i?i+t:i;++n<t;)e.push(n);return e})}},w.pseudos.nth=w.pseudos.eq;for(_ in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[_]=a(_);for(_ in{submit:!0,reset:!0})w.pseudos[_]=h(_);return u.prototype=w.filters=w.pseudos,w.setFilters=new u,T=t.tokenize=function(e,i){var n,r,o,s,a,h,l,c=q[e+" "];if(c)return i?0:c.slice(0);for(a=e,h=[],l=w.preFilter;a;){(!n||(r=le.exec(a)))&&(r&&(a=a.slice(r[0].length)||a),h.push(o=[])),n=!1,(r=ce.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(he," ")}),a=a.slice(n.length));for(s in w.filter)!(r=fe[s].exec(a))||l[s]&&!(r=l[s](r))||(n=r.shift(),o.push({value:n,type:s,matches:r}),a=a.slice(n.length));if(!n)break}return i?a.length:a?t.error(e):q(e,h).slice(0)},E=t.compile=function(e,t){var i,n=[],r=[],o=H[e+" "];if(!o){for(t||(t=T(e)),i=t.length;i--;)o=v(t[i]),o[V]?n.push(o):r.push(o);o=H(e,b(r,n)),o.selector=e}return o},k=t.select=function(e,t,i,n){var r,o,s,a,h,l="function"==typeof e&&e,u=!n&&T(e=l.selector||e);if(i=i||[],1===u.length){if(o=u[0]=u[0].slice(0),o.length>2&&"ID"===(s=o[0]).type&&x.getById&&9===t.nodeType&&F&&w.relative[o[1].type]){if(t=(w.find.ID(s.matches[0].replace(xe,we),t)||[])[0],!t)return i;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(r=fe.needsContext.test(e)?0:o.length;r--&&(s=o[r],!w.relative[a=s.type]);)if((h=w.find[a])&&(n=h(s.matches[0].replace(xe,we),be.test(o[0].type)&&c(t.parentNode)||t))){if(o.splice(r,1),e=n.length&&p(o),!e)return K.apply(i,n),i;break}}return(l||E(e,u))(n,t,!F,i,be.test(e)&&c(t.parentNode)||t),i},x.sortStable=V.split("").sort(W).join("")===V,x.detectDuplicates=!!P,L(),x.sortDetached=r(function(e){return 1&e.compareDocumentPosition(R.createElement("div"))}),r(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||o("type|href|height|width",function(e,t,i){return i?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),x.attributes&&r(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||o("value",function(e,t,i){return i||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),r(function(e){return null==e.getAttribute("disabled")})||o(te,function(e,t,i){var n;return i?void 0:e[t]===!0?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),t}(e);Z.find=re,Z.expr=re.selectors,Z.expr[":"]=Z.expr.pseudos,Z.unique=re.uniqueSort,Z.text=re.getText,Z.isXMLDoc=re.isXML,Z.contains=re.contains;var oe=Z.expr.match.needsContext,se=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ae=/^.[^:#\[\.,]*$/;Z.filter=function(e,t,i){var n=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?Z.find.matchesSelector(n,e)?[n]:[]:Z.find.matches(e,Z.grep(t,function(e){return 1===e.nodeType}))},Z.fn.extend({find:function(e){var t,i=this.length,n=[],r=this;if("string"!=typeof e)return this.pushStack(Z(e).filter(function(){for(t=0;i>t;t++)if(Z.contains(r[t],this))return!0}));for(t=0;i>t;t++)Z.find(e,r[t],n);return n=this.pushStack(i>1?Z.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},filter:function(e){return this.pushStack(n(this,e||[],!1))},not:function(e){return this.pushStack(n(this,e||[],!0))},is:function(e){return!!n(this,"string"==typeof e&&oe.test(e)?Z(e):e||[],!1).length}});var he,le=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ce=Z.fn.init=function(e,t){var i,n;if(!e)return this;if("string"==typeof e){if(i="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:le.exec(e),!i||!i[1]&&t)return!t||t.jquery?(t||he).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof Z?t[0]:t,Z.merge(this,Z.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:Q,!0)),se.test(i[1])&&Z.isPlainObject(t))for(i in t)Z.isFunction(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return n=Q.getElementById(i[2]),n&&n.parentNode&&(this.length=1,this[0]=n),this.context=Q,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):Z.isFunction(e)?"undefined"!=typeof he.ready?he.ready(e):e(Z):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),Z.makeArray(e,this))};ce.prototype=Z.fn,he=Z(Q);var ue=/^(?:parents|prev(?:Until|All))/,pe={children:!0,contents:!0,next:!0,prev:!0};Z.extend({dir:function(e,t,i){for(var n=[],r=void 0!==i;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(r&&Z(e).is(i))break;n.push(e)}return n},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}}),Z.fn.extend({has:function(e){var t=Z(e,this),i=t.length;return this.filter(function(){for(var e=0;i>e;e++)if(Z.contains(this,t[e]))return!0})},closest:function(e,t){for(var i,n=0,r=this.length,o=[],s=oe.test(e)||"string"!=typeof e?Z(e,t||this.context):0;r>n;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(s?s.index(i)>-1:1===i.nodeType&&Z.find.matchesSelector(i,e))){o.push(i);break}return this.pushStack(o.length>1?Z.unique(o):o)},index:function(e){return e?"string"==typeof e?W.call(Z(e),this[0]):W.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(Z.unique(Z.merge(this.get(),Z(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),Z.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Z.dir(e,"parentNode")},parentsUntil:function(e,t,i){return Z.dir(e,"parentNode",i)},next:function(e){return r(e,"nextSibling")},prev:function(e){return r(e,"previousSibling")},nextAll:function(e){return Z.dir(e,"nextSibling")},prevAll:function(e){return Z.dir(e,"previousSibling")},nextUntil:function(e,t,i){return Z.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return Z.dir(e,"previousSibling",i)},siblings:function(e){return Z.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return Z.sibling(e.firstChild)},contents:function(e){return e.contentDocument||Z.merge([],e.childNodes)}},function(e,t){Z.fn[e]=function(i,n){var r=Z.map(this,t,i);return"Until"!==e.slice(-5)&&(n=i),n&&"string"==typeof n&&(r=Z.filter(n,r)),this.length>1&&(pe[e]||Z.unique(r),ue.test(e)&&r.reverse()),this.pushStack(r)}});var de=/\S+/g,fe={};Z.Callbacks=function(e){e="string"==typeof e?fe[e]||o(e):Z.extend({},e);var t,i,n,r,s,a,h=[],l=!e.once&&[],c=function(o){for(t=e.memory&&o,i=!0,a=r||0,r=0,s=h.length,n=!0;h&&s>a;a++)if(h[a].apply(o[0],o[1])===!1&&e.stopOnFalse){t=!1;break}n=!1,h&&(l?l.length&&c(l.shift()):t?h=[]:u.disable())},u={add:function(){if(h){var i=h.length;!function o(t){Z.each(t,function(t,i){var n=Z.type(i);"function"===n?e.unique&&u.has(i)||h.push(i):i&&i.length&&"string"!==n&&o(i)})}(arguments),n?s=h.length:t&&(r=i,c(t))}return this},remove:function(){return h&&Z.each(arguments,function(e,t){for(var i;(i=Z.inArray(t,h,i))>-1;)h.splice(i,1),n&&(s>=i&&s--,a>=i&&a--)}),this},has:function(e){return e?Z.inArray(e,h)>-1:!(!h||!h.length)},empty:function(){return h=[],s=0,this},disable:function(){return h=l=t=void 0,this},disabled:function(){return!h},lock:function(){return l=void 0,t||u.disable(),this},locked:function(){return!l},fireWith:function(e,t){return!h||i&&!l||(t=t||[],t=[e,t.slice?t.slice():t],n?l.push(t):c(t)),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!i}};return u},Z.extend({Deferred:function(e){var t=[["resolve","done",Z.Callbacks("once memory"),"resolved"],["reject","fail",Z.Callbacks("once memory"),"rejected"],["notify","progress",Z.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var e=arguments;return Z.Deferred(function(i){Z.each(t,function(t,o){var s=Z.isFunction(e[t])&&e[t];r[o[1]](function(){var e=s&&s.apply(this,arguments);e&&Z.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[o[0]+"With"](this===n?i.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?Z.extend(e,n):n}},r={};return n.pipe=n.then,Z.each(t,function(e,o){var s=o[2],a=o[3];n[o[1]]=s.add,a&&s.add(function(){i=a},t[1^e][2].disable,t[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?n:this,arguments),this},r[o[0]+"With"]=s.fireWith}),n.promise(r),e&&e.call(r,r),r},when:function(e){var t,i,n,r=0,o=G.call(arguments),s=o.length,a=1!==s||e&&Z.isFunction(e.promise)?s:0,h=1===a?e:Z.Deferred(),l=function(e,i,n){return function(r){i[e]=this,n[e]=arguments.length>1?G.call(arguments):r,n===t?h.notifyWith(i,n):--a||h.resolveWith(i,n)}};if(s>1)for(t=new Array(s),i=new Array(s),n=new Array(s);s>r;r++)o[r]&&Z.isFunction(o[r].promise)?o[r].promise().done(l(r,n,o)).fail(h.reject).progress(l(r,i,t)):--a;return a||h.resolveWith(n,o),h.promise()}});var me;Z.fn.ready=function(e){return Z.ready.promise().done(e),this},Z.extend({isReady:!1,readyWait:1,holdReady:function(e){e?Z.readyWait++:Z.ready(!0)},ready:function(e){(e===!0?--Z.readyWait:Z.isReady)||(Z.isReady=!0,e!==!0&&--Z.readyWait>0||(me.resolveWith(Q,[Z]),Z.fn.triggerHandler&&(Z(Q).triggerHandler("ready"),Z(Q).off("ready"))))}}),Z.ready.promise=function(t){return me||(me=Z.Deferred(),"complete"===Q.readyState?setTimeout(Z.ready):(Q.addEventListener("DOMContentLoaded",s,!1),e.addEventListener("load",s,!1))),me.promise(t)},Z.ready.promise();var ye=Z.access=function(e,t,i,n,r,o,s){var a=0,h=e.length,l=null==i;if("object"===Z.type(i)){r=!0;for(a in i)Z.access(e,t,a,i[a],!0,o,s)}else if(void 0!==n&&(r=!0,Z.isFunction(n)||(s=!0),l&&(s?(t.call(e,n),t=null):(l=t,t=function(e,t,i){return l.call(Z(e),i)})),t))for(;h>a;a++)t(e[a],i,s?n:n.call(e[a],a,t(e[a],i)));return r?e:l?t.call(e):h?t(e[0],i):o};Z.acceptData=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},a.uid=1,a.accepts=Z.acceptData,a.prototype={key:function(e){if(!a.accepts(e))return 0;var t={},i=e[this.expando];if(!i){i=a.uid++;try{t[this.expando]={value:i},Object.defineProperties(e,t)}catch(n){t[this.expando]=i,Z.extend(e,t)}}return this.cache[i]||(this.cache[i]={}),i},set:function(e,t,i){var n,r=this.key(e),o=this.cache[r];if("string"==typeof t)o[t]=i;else if(Z.isEmptyObject(o))Z.extend(this.cache[r],t);else for(n in t)o[n]=t[n];return o},get:function(e,t){var i=this.cache[this.key(e)];return void 0===t?i:i[t]},access:function(e,t,i){var n;return void 0===t||t&&"string"==typeof t&&void 0===i?(n=this.get(e,t),void 0!==n?n:this.get(e,Z.camelCase(t))):(this.set(e,t,i),void 0!==i?i:t)},remove:function(e,t){var i,n,r,o=this.key(e),s=this.cache[o];if(void 0===t)this.cache[o]={};else{Z.isArray(t)?n=t.concat(t.map(Z.camelCase)):(r=Z.camelCase(t),t in s?n=[t,r]:(n=r,n=n in s?[n]:n.match(de)||[])),i=n.length;for(;i--;)delete s[n[i]]}},hasData:function(e){return!Z.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var ge=new a,ve=new a,be=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,_e=/([A-Z])/g;Z.extend({hasData:function(e){return ve.hasData(e)||ge.hasData(e)},data:function(e,t,i){return ve.access(e,t,i)},removeData:function(e,t){ve.remove(e,t)},_data:function(e,t,i){return ge.access(e,t,i)},_removeData:function(e,t){ge.remove(e,t)}}),Z.fn.extend({data:function(e,t){var i,n,r,o=this[0],s=o&&o.attributes;if(void 0===e){if(this.length&&(r=ve.get(o),1===o.nodeType&&!ge.get(o,"hasDataAttrs"))){for(i=s.length;i--;)s[i]&&(n=s[i].name,0===n.indexOf("data-")&&(n=Z.camelCase(n.slice(5)),h(o,n,r[n])));ge.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof e?this.each(function(){ve.set(this,e)}):ye(this,function(t){var i,n=Z.camelCase(e);if(o&&void 0===t){if(i=ve.get(o,e),void 0!==i)return i;if(i=ve.get(o,n),void 0!==i)return i;if(i=h(o,n,void 0),void 0!==i)return i}else this.each(function(){var i=ve.get(this,n);ve.set(this,n,t),-1!==e.indexOf("-")&&void 0!==i&&ve.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){ve.remove(this,e)})}}),Z.extend({queue:function(e,t,i){var n;return e?(t=(t||"fx")+"queue",n=ge.get(e,t),i&&(!n||Z.isArray(i)?n=ge.access(e,t,Z.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(e,t){t=t||"fx";var i=Z.queue(e,t),n=i.length,r=i.shift(),o=Z._queueHooks(e,t),s=function(){Z.dequeue(e,t)};"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===t&&i.unshift("inprogress"),delete o.stop,r.call(e,s,o)),!n&&o&&o.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return ge.get(e,i)||ge.access(e,i,{empty:Z.Callbacks("once memory").add(function(){ge.remove(e,[t+"queue",i])})})}}),Z.fn.extend({queue:function(e,t){var i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?Z.queue(this[0],e):void 0===t?this:this.each(function(){var i=Z.queue(this,e,t);Z._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&Z.dequeue(this,e)})},dequeue:function(e){return this.each(function(){Z.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,n=1,r=Z.Deferred(),o=this,s=this.length,a=function(){--n||r.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)i=ge.get(o[s],e+"queueHooks"),i&&i.empty&&(n++,i.empty.add(a));return a(),r.promise(t)}});var xe=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,we=["Top","Right","Bottom","Left"],Se=function(e,t){return e=t||e,"none"===Z.css(e,"display")||!Z.contains(e.ownerDocument,e)},Me=/^(?:checkbox|radio)$/i;!function(){var e=Q.createDocumentFragment(),t=e.appendChild(Q.createElement("div")),i=Q.createElement("input");i.setAttribute("type","radio"),i.setAttribute("checked","checked"),i.setAttribute("name","t"),t.appendChild(i),Y.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",Y.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var Te="undefined";Y.focusinBubbles="onfocusin"in e;var Ee=/^key/,ke=/^(?:mouse|pointer|contextmenu)|click/,Ae=/^(?:focusinfocus|focusoutblur)$/,Ce=/^([^.]*)(?:\.(.+)|)$/;Z.event={global:{},add:function(e,t,i,n,r){var o,s,a,h,l,c,u,p,d,f,m,y=ge.get(e);if(y)for(i.handler&&(o=i,i=o.handler,r=o.selector),i.guid||(i.guid=Z.guid++),(h=y.events)||(h=y.events={}),(s=y.handle)||(s=y.handle=function(t){return typeof Z!==Te&&Z.event.triggered!==t.type?Z.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(de)||[""],l=t.length;l--;)a=Ce.exec(t[l])||[],d=m=a[1],f=(a[2]||"").split(".").sort(),d&&(u=Z.event.special[d]||{},d=(r?u.delegateType:u.bindType)||d,u=Z.event.special[d]||{},c=Z.extend({type:d,origType:m,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&Z.expr.match.needsContext.test(r),namespace:f.join(".")},o),(p=h[d])||(p=h[d]=[],p.delegateCount=0,u.setup&&u.setup.call(e,n,f,s)!==!1||e.addEventListener&&e.addEventListener(d,s,!1)),u.add&&(u.add.call(e,c),c.handler.guid||(c.handler.guid=i.guid)),r?p.splice(p.delegateCount++,0,c):p.push(c),Z.event.global[d]=!0)},remove:function(e,t,i,n,r){var o,s,a,h,l,c,u,p,d,f,m,y=ge.hasData(e)&&ge.get(e);if(y&&(h=y.events)){for(t=(t||"").match(de)||[""],l=t.length;l--;)if(a=Ce.exec(t[l])||[],d=m=a[1],f=(a[2]||"").split(".").sort(),d){for(u=Z.event.special[d]||{},d=(n?u.delegateType:u.bindType)||d,p=h[d]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=p.length;o--;)c=p[o],!r&&m!==c.origType||i&&i.guid!==c.guid||a&&!a.test(c.namespace)||n&&n!==c.selector&&("**"!==n||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,u.remove&&u.remove.call(e,c));s&&!p.length&&(u.teardown&&u.teardown.call(e,f,y.handle)!==!1||Z.removeEvent(e,d,y.handle),delete h[d])}else for(d in h)Z.event.remove(e,d+t[l],i,n,!0);Z.isEmptyObject(h)&&(delete y.handle,ge.remove(e,"events"))}},trigger:function(t,i,n,r){var o,s,a,h,l,c,u,p=[n||Q],d=J.call(t,"type")?t.type:t,f=J.call(t,"namespace")?t.namespace.split("."):[];if(s=a=n=n||Q,3!==n.nodeType&&8!==n.nodeType&&!Ae.test(d+Z.event.triggered)&&(d.indexOf(".")>=0&&(f=d.split("."),d=f.shift(),f.sort()),l=d.indexOf(":")<0&&"on"+d,t=t[Z.expando]?t:new Z.Event(d,"object"==typeof t&&t),t.isTrigger=r?2:3,t.namespace=f.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),i=null==i?[t]:Z.makeArray(i,[t]),u=Z.event.special[d]||{},r||!u.trigger||u.trigger.apply(n,i)!==!1)){if(!r&&!u.noBubble&&!Z.isWindow(n)){for(h=u.delegateType||d,Ae.test(h+d)||(s=s.parentNode);s;s=s.parentNode)p.push(s),a=s;a===(n.ownerDocument||Q)&&p.push(a.defaultView||a.parentWindow||e)}for(o=0;(s=p[o++])&&!t.isPropagationStopped();)t.type=o>1?h:u.bindType||d,c=(ge.get(s,"events")||{})[t.type]&&ge.get(s,"handle"),c&&c.apply(s,i),c=l&&s[l],c&&c.apply&&Z.acceptData(s)&&(t.result=c.apply(s,i),t.result===!1&&t.preventDefault());return t.type=d,r||t.isDefaultPrevented()||u._default&&u._default.apply(p.pop(),i)!==!1||!Z.acceptData(n)||l&&Z.isFunction(n[d])&&!Z.isWindow(n)&&(a=n[l],a&&(n[l]=null),Z.event.triggered=d,n[d](),Z.event.triggered=void 0,a&&(n[l]=a)),t.result}},dispatch:function(e){e=Z.event.fix(e);var t,i,n,r,o,s=[],a=G.call(arguments),h=(ge.get(this,"events")||{})[e.type]||[],l=Z.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,e)!==!1){for(s=Z.event.handlers.call(this,e,h),t=0;(r=s[t++])&&!e.isPropagationStopped();)for(e.currentTarget=r.elem,i=0;(o=r.handlers[i++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(o.namespace))&&(e.handleObj=o,e.data=o.data,n=((Z.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,a),void 0!==n&&(e.result=n)===!1&&(e.preventDefault(),e.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,t){var i,n,r,o,s=[],a=t.delegateCount,h=e.target;if(a&&h.nodeType&&(!e.button||"click"!==e.type))for(;h!==this;h=h.parentNode||this)if(h.disabled!==!0||"click"!==e.type){for(n=[],i=0;a>i;i++)o=t[i],r=o.selector+" ",void 0===n[r]&&(n[r]=o.needsContext?Z(r,this).index(h)>=0:Z.find(r,this,null,[h]).length),n[r]&&n.push(o);n.length&&s.push({elem:h,handlers:n})}return a<t.length&&s.push({elem:this,handlers:t.slice(a)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var i,n,r,o=t.button;return null==e.pageX&&null!=t.clientX&&(i=e.target.ownerDocument||Q,n=i.documentElement,r=i.body,e.pageX=t.clientX+(n&&n.scrollLeft||r&&r.scrollLeft||0)-(n&&n.clientLeft||r&&r.clientLeft||0),e.pageY=t.clientY+(n&&n.scrollTop||r&&r.scrollTop||0)-(n&&n.clientTop||r&&r.clientTop||0)),e.which||void 0===o||(e.which=1&o?1:2&o?3:4&o?2:0),e}},fix:function(e){if(e[Z.expando])return e;var t,i,n,r=e.type,o=e,s=this.fixHooks[r];for(s||(this.fixHooks[r]=s=ke.test(r)?this.mouseHooks:Ee.test(r)?this.keyHooks:{}),n=s.props?this.props.concat(s.props):this.props,e=new Z.Event(o),t=n.length;t--;)i=n[t],e[i]=o[i];return e.target||(e.target=Q),3===e.target.nodeType&&(e.target=e.target.parentNode),s.filter?s.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==u()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===u()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&Z.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return Z.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,n){var r=Z.extend(new Z.Event,i,{type:e,isSimulated:!0,originalEvent:{}});n?Z.event.trigger(r,null,t):Z.event.dispatch.call(t,r),r.isDefaultPrevented()&&i.preventDefault()}},Z.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)},Z.Event=function(e,t){return this instanceof Z.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?l:c):this.type=e,t&&Z.extend(this,t),this.timeStamp=e&&e.timeStamp||Z.now(),void(this[Z.expando]=!0)):new Z.Event(e,t)},Z.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=l,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=l,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=l,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},Z.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){Z.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,r=e.relatedTarget,o=e.handleObj;return(!r||r!==n&&!Z.contains(n,r))&&(e.type=o.origType,i=o.handler.apply(this,arguments),e.type=t),i}}}),Y.focusinBubbles||Z.each({focus:"focusin",blur:"focusout"},function(e,t){var i=function(e){Z.event.simulate(t,e.target,Z.event.fix(e),!0)};Z.event.special[t]={setup:function(){var n=this.ownerDocument||this,r=ge.access(n,t);r||n.addEventListener(e,i,!0),ge.access(n,t,(r||0)+1)},teardown:function(){var n=this.ownerDocument||this,r=ge.access(n,t)-1;r?ge.access(n,t,r):(n.removeEventListener(e,i,!0),ge.remove(n,t))}}}),Z.fn.extend({on:function(e,t,i,n,r){var o,s;if("object"==typeof e){"string"!=typeof t&&(i=i||t,t=void 0);for(s in e)this.on(s,t,i,e[s],r);return this}if(null==i&&null==n?(n=t,i=t=void 0):null==n&&("string"==typeof t?(n=i,i=void 0):(n=i,i=t,t=void 0)),n===!1)n=c;else if(!n)return this;return 1===r&&(o=n,n=function(e){return Z().off(e),o.apply(this,arguments)},n.guid=o.guid||(o.guid=Z.guid++)),this.each(function(){Z.event.add(this,e,n,i,t)})},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,t,i){var n,r;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,Z(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(r in e)this.off(r,t,e[r]);return this}return(t===!1||"function"==typeof t)&&(i=t,t=void 0),i===!1&&(i=c),this.each(function(){Z.event.remove(this,e,i,t)})},trigger:function(e,t){return this.each(function(){Z.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];return i?Z.event.trigger(e,t,i,!0):void 0}});var Pe=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Le=/<([\w:]+)/,Re=/<|&#?\w+;/,Oe=/<(?:script|style|link)/i,Fe=/checked\s*(?:[^=]|=\s*.checked.)/i,De=/^$|\/(?:java|ecma)script/i,Be=/^true\/(.*)/,Ne=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,je={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};je.optgroup=je.option,je.tbody=je.tfoot=je.colgroup=je.caption=je.thead,je.th=je.td,Z.extend({clone:function(e,t,i){var n,r,o,s,a=e.cloneNode(!0),h=Z.contains(e.ownerDocument,e);if(!(Y.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||Z.isXMLDoc(e)))for(s=g(a),o=g(e),n=0,r=o.length;r>n;n++)v(o[n],s[n]);if(t)if(i)for(o=o||g(e),s=s||g(a),n=0,r=o.length;r>n;n++)y(o[n],s[n]);else y(e,a);return s=g(a,"script"),s.length>0&&m(s,!h&&g(e,"script")),a},buildFragment:function(e,t,i,n){for(var r,o,s,a,h,l,c=t.createDocumentFragment(),u=[],p=0,d=e.length;d>p;p++)if(r=e[p],r||0===r)if("object"===Z.type(r))Z.merge(u,r.nodeType?[r]:r);else if(Re.test(r)){for(o=o||c.appendChild(t.createElement("div")),s=(Le.exec(r)||["",""])[1].toLowerCase(),a=je[s]||je._default,o.innerHTML=a[1]+r.replace(Pe,"<$1></$2>")+a[2],l=a[0];l--;)o=o.lastChild;Z.merge(u,o.childNodes),o=c.firstChild,o.textContent=""}else u.push(t.createTextNode(r));for(c.textContent="",p=0;r=u[p++];)if((!n||-1===Z.inArray(r,n))&&(h=Z.contains(r.ownerDocument,r),o=g(c.appendChild(r),"script"),h&&m(o),i))for(l=0;r=o[l++];)De.test(r.type||"")&&i.push(r);return c},cleanData:function(e){for(var t,i,n,r,o=Z.event.special,s=0;void 0!==(i=e[s]);s++){if(Z.acceptData(i)&&(r=i[ge.expando],r&&(t=ge.cache[r]))){if(t.events)for(n in t.events)o[n]?Z.event.remove(i,n):Z.removeEvent(i,n,t.handle);ge.cache[r]&&delete ge.cache[r]}delete ve.cache[i[ve.expando]]}}}),Z.fn.extend({text:function(e){return ye(this,function(e){return void 0===e?Z.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=e)})},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=p(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=p(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling);
})},remove:function(e,t){for(var i,n=e?Z.filter(e,this):this,r=0;null!=(i=n[r]);r++)t||1!==i.nodeType||Z.cleanData(g(i)),i.parentNode&&(t&&Z.contains(i.ownerDocument,i)&&m(g(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(Z.cleanData(g(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return Z.clone(this,e,t)})},html:function(e){return ye(this,function(e){var t=this[0]||{},i=0,n=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Oe.test(e)&&!je[(Le.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Pe,"<$1></$2>");try{for(;n>i;i++)t=this[i]||{},1===t.nodeType&&(Z.cleanData(g(t,!1)),t.innerHTML=e);t=0}catch(r){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,Z.cleanData(g(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=q.apply([],e);var i,n,r,o,s,a,h=0,l=this.length,c=this,u=l-1,p=e[0],m=Z.isFunction(p);if(m||l>1&&"string"==typeof p&&!Y.checkClone&&Fe.test(p))return this.each(function(i){var n=c.eq(i);m&&(e[0]=p.call(this,i,n.html())),n.domManip(e,t)});if(l&&(i=Z.buildFragment(e,this[0].ownerDocument,!1,this),n=i.firstChild,1===i.childNodes.length&&(i=n),n)){for(r=Z.map(g(i,"script"),d),o=r.length;l>h;h++)s=i,h!==u&&(s=Z.clone(s,!0,!0),o&&Z.merge(r,g(s,"script"))),t.call(this[h],s,h);if(o)for(a=r[r.length-1].ownerDocument,Z.map(r,f),h=0;o>h;h++)s=r[h],De.test(s.type||"")&&!ge.access(s,"globalEval")&&Z.contains(a,s)&&(s.src?Z._evalUrl&&Z._evalUrl(s.src):Z.globalEval(s.textContent.replace(Ne,"")))}return this}}),Z.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){Z.fn[e]=function(e){for(var i,n=[],r=Z(e),o=r.length-1,s=0;o>=s;s++)i=s===o?this:this.clone(!0),Z(r[s])[t](i),H.apply(n,i.get());return this.pushStack(n)}});var Ve,ze={},Ue=/^margin/,Ie=new RegExp("^("+xe+")(?!px)[a-z%]+$","i"),Ge=function(t){return t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView.getComputedStyle(t,null):e.getComputedStyle(t,null)};!function(){function t(){s.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",s.innerHTML="",r.appendChild(o);var t=e.getComputedStyle(s,null);i="1%"!==t.top,n="4px"===t.width,r.removeChild(o)}var i,n,r=Q.documentElement,o=Q.createElement("div"),s=Q.createElement("div");s.style&&(s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",Y.clearCloneStyle="content-box"===s.style.backgroundClip,o.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",o.appendChild(s),e.getComputedStyle&&Z.extend(Y,{pixelPosition:function(){return t(),i},boxSizingReliable:function(){return null==n&&t(),n},reliableMarginRight:function(){var t,i=s.appendChild(Q.createElement("div"));return i.style.cssText=s.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",i.style.marginRight=i.style.width="0",s.style.width="1px",r.appendChild(o),t=!parseFloat(e.getComputedStyle(i,null).marginRight),r.removeChild(o),s.removeChild(i),t}}))}(),Z.swap=function(e,t,i,n){var r,o,s={};for(o in t)s[o]=e.style[o],e.style[o]=t[o];r=i.apply(e,n||[]);for(o in t)e.style[o]=s[o];return r};var qe=/^(none|table(?!-c[ea]).+)/,He=new RegExp("^("+xe+")(.*)$","i"),We=new RegExp("^([+-])=("+xe+")","i"),$e={position:"absolute",visibility:"hidden",display:"block"},Xe={letterSpacing:"0",fontWeight:"400"},Je=["Webkit","O","Moz","ms"];Z.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=x(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,i,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,o,s,a=Z.camelCase(t),h=e.style;return t=Z.cssProps[a]||(Z.cssProps[a]=S(h,a)),s=Z.cssHooks[t]||Z.cssHooks[a],void 0===i?s&&"get"in s&&void 0!==(r=s.get(e,!1,n))?r:h[t]:(o=typeof i,"string"===o&&(r=We.exec(i))&&(i=(r[1]+1)*r[2]+parseFloat(Z.css(e,t)),o="number"),null!=i&&i===i&&("number"!==o||Z.cssNumber[a]||(i+="px"),Y.clearCloneStyle||""!==i||0!==t.indexOf("background")||(h[t]="inherit"),s&&"set"in s&&void 0===(i=s.set(e,i,n))||(h[t]=i)),void 0)}},css:function(e,t,i,n){var r,o,s,a=Z.camelCase(t);return t=Z.cssProps[a]||(Z.cssProps[a]=S(e.style,a)),s=Z.cssHooks[t]||Z.cssHooks[a],s&&"get"in s&&(r=s.get(e,!0,i)),void 0===r&&(r=x(e,t,n)),"normal"===r&&t in Xe&&(r=Xe[t]),""===i||i?(o=parseFloat(r),i===!0||Z.isNumeric(o)?o||0:r):r}}),Z.each(["height","width"],function(e,t){Z.cssHooks[t]={get:function(e,i,n){return i?qe.test(Z.css(e,"display"))&&0===e.offsetWidth?Z.swap(e,$e,function(){return E(e,t,n)}):E(e,t,n):void 0},set:function(e,i,n){var r=n&&Ge(e);return M(e,i,n?T(e,t,n,"border-box"===Z.css(e,"boxSizing",!1,r),r):0)}}}),Z.cssHooks.marginRight=w(Y.reliableMarginRight,function(e,t){return t?Z.swap(e,{display:"inline-block"},x,[e,"marginRight"]):void 0}),Z.each({margin:"",padding:"",border:"Width"},function(e,t){Z.cssHooks[e+t]={expand:function(i){for(var n=0,r={},o="string"==typeof i?i.split(" "):[i];4>n;n++)r[e+we[n]+t]=o[n]||o[n-2]||o[0];return r}},Ue.test(e)||(Z.cssHooks[e+t].set=M)}),Z.fn.extend({css:function(e,t){return ye(this,function(e,t,i){var n,r,o={},s=0;if(Z.isArray(t)){for(n=Ge(e),r=t.length;r>s;s++)o[t[s]]=Z.css(e,t[s],!1,n);return o}return void 0!==i?Z.style(e,t,i):Z.css(e,t)},e,t,arguments.length>1)},show:function(){return k(this,!0)},hide:function(){return k(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Se(this)?Z(this).show():Z(this).hide()})}}),Z.Tween=A,A.prototype={constructor:A,init:function(e,t,i,n,r,o){this.elem=e,this.prop=i,this.easing=r||"swing",this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=o||(Z.cssNumber[i]?"":"px")},cur:function(){var e=A.propHooks[this.prop];return e&&e.get?e.get(this):A.propHooks._default.get(this)},run:function(e){var t,i=A.propHooks[this.prop];return this.options.duration?this.pos=t=Z.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):A.propHooks._default.set(this),this}},A.prototype.init.prototype=A.prototype,A.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=Z.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){Z.fx.step[e.prop]?Z.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[Z.cssProps[e.prop]]||Z.cssHooks[e.prop])?Z.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},A.propHooks.scrollTop=A.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},Z.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},Z.fx=A.prototype.init,Z.fx.step={};var Ye,Qe,Ke=/^(?:toggle|show|hide)$/,Ze=new RegExp("^(?:([+-])=|)("+xe+")([a-z%]*)$","i"),et=/queueHooks$/,tt=[R],it={"*":[function(e,t){var i=this.createTween(e,t),n=i.cur(),r=Ze.exec(t),o=r&&r[3]||(Z.cssNumber[e]?"":"px"),s=(Z.cssNumber[e]||"px"!==o&&+n)&&Ze.exec(Z.css(i.elem,e)),a=1,h=20;if(s&&s[3]!==o){o=o||s[3],r=r||[],s=+n||1;do a=a||".5",s/=a,Z.style(i.elem,e,s+o);while(a!==(a=i.cur()/n)&&1!==a&&--h)}return r&&(s=i.start=+s||+n||0,i.unit=o,i.end=r[1]?s+(r[1]+1)*r[2]:+r[2]),i}]};Z.Animation=Z.extend(F,{tweener:function(e,t){Z.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,n=0,r=e.length;r>n;n++)i=e[n],it[i]=it[i]||[],it[i].unshift(t)},prefilter:function(e,t){t?tt.unshift(e):tt.push(e)}}),Z.speed=function(e,t,i){var n=e&&"object"==typeof e?Z.extend({},e):{complete:i||!i&&t||Z.isFunction(e)&&e,duration:e,easing:i&&t||t&&!Z.isFunction(t)&&t};return n.duration=Z.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in Z.fx.speeds?Z.fx.speeds[n.duration]:Z.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){Z.isFunction(n.old)&&n.old.call(this),n.queue&&Z.dequeue(this,n.queue)},n},Z.fn.extend({fadeTo:function(e,t,i,n){return this.filter(Se).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var r=Z.isEmptyObject(e),o=Z.speed(t,i,n),s=function(){var t=F(this,Z.extend({},e),o);(r||ge.get(this,"finish"))&&t.stop(!0)};return s.finish=s,r||o.queue===!1?this.each(s):this.queue(o.queue,s)},stop:function(e,t,i){var n=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,r=null!=e&&e+"queueHooks",o=Z.timers,s=ge.get(this);if(r)s[r]&&s[r].stop&&n(s[r]);else for(r in s)s[r]&&s[r].stop&&et.test(r)&&n(s[r]);for(r=o.length;r--;)o[r].elem!==this||null!=e&&o[r].queue!==e||(o[r].anim.stop(i),t=!1,o.splice(r,1));(t||!i)&&Z.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=ge.get(this),n=i[e+"queue"],r=i[e+"queueHooks"],o=Z.timers,s=n?n.length:0;for(i.finish=!0,Z.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;s>t;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish})}}),Z.each(["toggle","show","hide"],function(e,t){var i=Z.fn[t];Z.fn[t]=function(e,n,r){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(P(t,!0),e,n,r)}}),Z.each({slideDown:P("show"),slideUp:P("hide"),slideToggle:P("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){Z.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}}),Z.timers=[],Z.fx.tick=function(){var e,t=0,i=Z.timers;for(Ye=Z.now();t<i.length;t++)e=i[t],e()||i[t]!==e||i.splice(t--,1);i.length||Z.fx.stop(),Ye=void 0},Z.fx.timer=function(e){Z.timers.push(e),e()?Z.fx.start():Z.timers.pop()},Z.fx.interval=13,Z.fx.start=function(){Qe||(Qe=setInterval(Z.fx.tick,Z.fx.interval))},Z.fx.stop=function(){clearInterval(Qe),Qe=null},Z.fx.speeds={slow:600,fast:200,_default:400},Z.fn.delay=function(e,t){return e=Z.fx?Z.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var n=setTimeout(t,e);i.stop=function(){clearTimeout(n)}})},function(){var e=Q.createElement("input"),t=Q.createElement("select"),i=t.appendChild(Q.createElement("option"));e.type="checkbox",Y.checkOn=""!==e.value,Y.optSelected=i.selected,t.disabled=!0,Y.optDisabled=!i.disabled,e=Q.createElement("input"),e.value="t",e.type="radio",Y.radioValue="t"===e.value}();var nt,rt,ot=Z.expr.attrHandle;Z.fn.extend({attr:function(e,t){return ye(this,Z.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){Z.removeAttr(this,e)})}}),Z.extend({attr:function(e,t,i){var n,r,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return typeof e.getAttribute===Te?Z.prop(e,t,i):(1===o&&Z.isXMLDoc(e)||(t=t.toLowerCase(),n=Z.attrHooks[t]||(Z.expr.match.bool.test(t)?rt:nt)),void 0===i?n&&"get"in n&&null!==(r=n.get(e,t))?r:(r=Z.find.attr(e,t),null==r?void 0:r):null!==i?n&&"set"in n&&void 0!==(r=n.set(e,i,t))?r:(e.setAttribute(t,i+""),i):void Z.removeAttr(e,t))},removeAttr:function(e,t){var i,n,r=0,o=t&&t.match(de);if(o&&1===e.nodeType)for(;i=o[r++];)n=Z.propFix[i]||i,Z.expr.match.bool.test(i)&&(e[n]=!1),e.removeAttribute(i)},attrHooks:{type:{set:function(e,t){if(!Y.radioValue&&"radio"===t&&Z.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}}}),rt={set:function(e,t,i){return t===!1?Z.removeAttr(e,i):e.setAttribute(i,i),i}},Z.each(Z.expr.match.bool.source.match(/\w+/g),function(e,t){var i=ot[t]||Z.find.attr;ot[t]=function(e,t,n){var r,o;return n||(o=ot[t],ot[t]=r,r=null!=i(e,t,n)?t.toLowerCase():null,ot[t]=o),r}});var st=/^(?:input|select|textarea|button)$/i;Z.fn.extend({prop:function(e,t){return ye(this,Z.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[Z.propFix[e]||e]})}}),Z.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,i){var n,r,o,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return o=1!==s||!Z.isXMLDoc(e),o&&(t=Z.propFix[t]||t,r=Z.propHooks[t]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(e,i,t))?n:e[t]=i:r&&"get"in r&&null!==(n=r.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||st.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),Y.optSelected||(Z.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),Z.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){Z.propFix[this.toLowerCase()]=this});var at=/[\t\r\n\f]/g;Z.fn.extend({addClass:function(e){var t,i,n,r,o,s,a="string"==typeof e&&e,h=0,l=this.length;if(Z.isFunction(e))return this.each(function(t){Z(this).addClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(de)||[];l>h;h++)if(i=this[h],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(at," "):" ")){for(o=0;r=t[o++];)n.indexOf(" "+r+" ")<0&&(n+=r+" ");s=Z.trim(n),i.className!==s&&(i.className=s)}return this},removeClass:function(e){var t,i,n,r,o,s,a=0===arguments.length||"string"==typeof e&&e,h=0,l=this.length;if(Z.isFunction(e))return this.each(function(t){Z(this).removeClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(de)||[];l>h;h++)if(i=this[h],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(at," "):"")){for(o=0;r=t[o++];)for(;n.indexOf(" "+r+" ")>=0;)n=n.replace(" "+r+" "," ");s=e?Z.trim(n):"",i.className!==s&&(i.className=s)}return this},toggleClass:function(e,t){var i=typeof e;return"boolean"==typeof t&&"string"===i?t?this.addClass(e):this.removeClass(e):Z.isFunction(e)?this.each(function(i){Z(this).toggleClass(e.call(this,i,this.className,t),t)}):this.each(function(){if("string"===i)for(var t,n=0,r=Z(this),o=e.match(de)||[];t=o[n++];)r.hasClass(t)?r.removeClass(t):r.addClass(t);else(i===Te||"boolean"===i)&&(this.className&&ge.set(this,"__className__",this.className),this.className=this.className||e===!1?"":ge.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(at," ").indexOf(t)>=0)return!0;return!1}});var ht=/\r/g;Z.fn.extend({val:function(e){var t,i,n,r=this[0];{if(arguments.length)return n=Z.isFunction(e),this.each(function(i){var r;1===this.nodeType&&(r=n?e.call(this,i,Z(this).val()):e,null==r?r="":"number"==typeof r?r+="":Z.isArray(r)&&(r=Z.map(r,function(e){return null==e?"":e+""})),t=Z.valHooks[this.type]||Z.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,r,"value")||(this.value=r))});if(r)return t=Z.valHooks[r.type]||Z.valHooks[r.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(i=t.get(r,"value"))?i:(i=r.value,"string"==typeof i?i.replace(ht,""):null==i?"":i)}}}),Z.extend({valHooks:{option:{get:function(e){var t=Z.find.attr(e,"value");return null!=t?t:Z.trim(Z.text(e))}},select:{get:function(e){for(var t,i,n=e.options,r=e.selectedIndex,o="select-one"===e.type||0>r,s=o?null:[],a=o?r+1:n.length,h=0>r?a:o?r:0;a>h;h++)if(i=n[h],(i.selected||h===r)&&(Y.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!Z.nodeName(i.parentNode,"optgroup"))){if(t=Z(i).val(),o)return t;s.push(t)}return s},set:function(e,t){for(var i,n,r=e.options,o=Z.makeArray(t),s=r.length;s--;)n=r[s],(n.selected=Z.inArray(n.value,o)>=0)&&(i=!0);return i||(e.selectedIndex=-1),o}}}}),Z.each(["radio","checkbox"],function(){Z.valHooks[this]={set:function(e,t){return Z.isArray(t)?e.checked=Z.inArray(Z(e).val(),t)>=0:void 0}},Y.checkOn||(Z.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),Z.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){Z.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),Z.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}});var lt=Z.now(),ct=/\?/;Z.parseJSON=function(e){return JSON.parse(e+"")},Z.parseXML=function(e){var t,i;if(!e||"string"!=typeof e)return null;try{i=new DOMParser,t=i.parseFromString(e,"text/xml")}catch(n){t=void 0}return(!t||t.getElementsByTagName("parsererror").length)&&Z.error("Invalid XML: "+e),t};var ut=/#.*$/,pt=/([?&])_=[^&]*/,dt=/^(.*?):[ \t]*([^\r\n]*)$/gm,ft=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,mt=/^(?:GET|HEAD)$/,yt=/^\/\//,gt=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,vt={},bt={},_t="*/".concat("*"),xt=e.location.href,wt=gt.exec(xt.toLowerCase())||[];Z.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:xt,type:"GET",isLocal:ft.test(wt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":_t,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":Z.parseJSON,"text xml":Z.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?N(N(e,Z.ajaxSettings),t):N(Z.ajaxSettings,e)},ajaxPrefilter:D(vt),ajaxTransport:D(bt),ajax:function(e,t){function i(e,t,i,s){var h,c,g,v,_,w=t;2!==b&&(b=2,a&&clearTimeout(a),n=void 0,o=s||"",x.readyState=e>0?4:0,h=e>=200&&300>e||304===e,i&&(v=j(u,x,i)),v=V(u,v,x,h),h?(u.ifModified&&(_=x.getResponseHeader("Last-Modified"),_&&(Z.lastModified[r]=_),_=x.getResponseHeader("etag"),_&&(Z.etag[r]=_)),204===e||"HEAD"===u.type?w="nocontent":304===e?w="notmodified":(w=v.state,c=v.data,g=v.error,h=!g)):(g=w,(e||!w)&&(w="error",0>e&&(e=0))),x.status=e,x.statusText=(t||w)+"",h?f.resolveWith(p,[c,w,x]):f.rejectWith(p,[x,w,g]),x.statusCode(y),y=void 0,l&&d.trigger(h?"ajaxSuccess":"ajaxError",[x,u,h?c:g]),m.fireWith(p,[x,w]),l&&(d.trigger("ajaxComplete",[x,u]),--Z.active||Z.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,r,o,s,a,h,l,c,u=Z.ajaxSetup({},t),p=u.context||u,d=u.context&&(p.nodeType||p.jquery)?Z(p):Z.event,f=Z.Deferred(),m=Z.Callbacks("once memory"),y=u.statusCode||{},g={},v={},b=0,_="canceled",x={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!s)for(s={};t=dt.exec(o);)s[t[1].toLowerCase()]=t[2];t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?o:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return b||(e=v[i]=v[i]||e,g[e]=t),this},overrideMimeType:function(e){return b||(u.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>b)for(t in e)y[t]=[y[t],e[t]];else x.always(e[x.status]);return this},abort:function(e){var t=e||_;return n&&n.abort(t),i(0,t),this}};if(f.promise(x).complete=m.add,x.success=x.done,x.error=x.fail,u.url=((e||u.url||xt)+"").replace(ut,"").replace(yt,wt[1]+"//"),u.type=t.method||t.type||u.method||u.type,u.dataTypes=Z.trim(u.dataType||"*").toLowerCase().match(de)||[""],null==u.crossDomain&&(h=gt.exec(u.url.toLowerCase()),u.crossDomain=!(!h||h[1]===wt[1]&&h[2]===wt[2]&&(h[3]||("http:"===h[1]?"80":"443"))===(wt[3]||("http:"===wt[1]?"80":"443")))),u.data&&u.processData&&"string"!=typeof u.data&&(u.data=Z.param(u.data,u.traditional)),B(vt,u,t,x),2===b)return x;l=Z.event&&u.global,l&&0===Z.active++&&Z.event.trigger("ajaxStart"),u.type=u.type.toUpperCase(),u.hasContent=!mt.test(u.type),r=u.url,u.hasContent||(u.data&&(r=u.url+=(ct.test(r)?"&":"?")+u.data,delete u.data),u.cache===!1&&(u.url=pt.test(r)?r.replace(pt,"$1_="+lt++):r+(ct.test(r)?"&":"?")+"_="+lt++)),u.ifModified&&(Z.lastModified[r]&&x.setRequestHeader("If-Modified-Since",Z.lastModified[r]),Z.etag[r]&&x.setRequestHeader("If-None-Match",Z.etag[r])),(u.data&&u.hasContent&&u.contentType!==!1||t.contentType)&&x.setRequestHeader("Content-Type",u.contentType),x.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+_t+"; q=0.01":""):u.accepts["*"]);for(c in u.headers)x.setRequestHeader(c,u.headers[c]);if(u.beforeSend&&(u.beforeSend.call(p,x,u)===!1||2===b))return x.abort();_="abort";for(c in{success:1,error:1,complete:1})x[c](u[c]);if(n=B(bt,u,t,x)){x.readyState=1,l&&d.trigger("ajaxSend",[x,u]),u.async&&u.timeout>0&&(a=setTimeout(function(){x.abort("timeout")},u.timeout));try{b=1,n.send(g,i)}catch(w){if(!(2>b))throw w;i(-1,w)}}else i(-1,"No Transport");return x},getJSON:function(e,t,i){return Z.get(e,t,i,"json")},getScript:function(e,t){return Z.get(e,void 0,t,"script")}}),Z.each(["get","post"],function(e,t){Z[t]=function(e,i,n,r){return Z.isFunction(i)&&(r=r||n,n=i,i=void 0),Z.ajax({url:e,type:t,dataType:r,data:i,success:n})}}),Z._evalUrl=function(e){return Z.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},Z.fn.extend({wrapAll:function(e){var t;return Z.isFunction(e)?this.each(function(t){Z(this).wrapAll(e.call(this,t))}):(this[0]&&(t=Z(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return Z.isFunction(e)?this.each(function(t){Z(this).wrapInner(e.call(this,t))}):this.each(function(){var t=Z(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=Z.isFunction(e);return this.each(function(i){Z(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){Z.nodeName(this,"body")||Z(this).replaceWith(this.childNodes)}).end()}}),Z.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},Z.expr.filters.visible=function(e){return!Z.expr.filters.hidden(e)};var St=/%20/g,Mt=/\[\]$/,Tt=/\r?\n/g,Et=/^(?:submit|button|image|reset|file)$/i,kt=/^(?:input|select|textarea|keygen)/i;Z.param=function(e,t){var i,n=[],r=function(e,t){t=Z.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=Z.ajaxSettings&&Z.ajaxSettings.traditional),Z.isArray(e)||e.jquery&&!Z.isPlainObject(e))Z.each(e,function(){r(this.name,this.value)});else for(i in e)z(i,e[i],t,r);return n.join("&").replace(St,"+")},Z.fn.extend({serialize:function(){return Z.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=Z.prop(this,"elements");return e?Z.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!Z(this).is(":disabled")&&kt.test(this.nodeName)&&!Et.test(e)&&(this.checked||!Me.test(e))}).map(function(e,t){var i=Z(this).val();return null==i?null:Z.isArray(i)?Z.map(i,function(e){return{name:t.name,value:e.replace(Tt,"\r\n")}}):{name:t.name,value:i.replace(Tt,"\r\n")}}).get()}}),Z.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var At=0,Ct={},Pt={0:200,1223:204},Lt=Z.ajaxSettings.xhr();e.attachEvent&&e.attachEvent("onunload",function(){for(var e in Ct)Ct[e]()}),Y.cors=!!Lt&&"withCredentials"in Lt,Y.ajax=Lt=!!Lt,Z.ajaxTransport(function(e){var t;return Y.cors||Lt&&!e.crossDomain?{send:function(i,n){var r,o=e.xhr(),s=++At;if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(r in e.xhrFields)o[r]=e.xhrFields[r];e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(r in i)o.setRequestHeader(r,i[r]);t=function(e){return function(){t&&(delete Ct[s],t=o.onload=o.onerror=null,"abort"===e?o.abort():"error"===e?n(o.status,o.statusText):n(Pt[o.status]||o.status,o.statusText,"string"==typeof o.responseText?{text:o.responseText}:void 0,o.getAllResponseHeaders()))}},o.onload=t(),o.onerror=t("error"),t=Ct[s]=t("abort");try{o.send(e.hasContent&&e.data||null)}catch(a){if(t)throw a}},abort:function(){t&&t()}}:void 0}),Z.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return Z.globalEval(e),e}}}),Z.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),Z.ajaxTransport("script",function(e){if(e.crossDomain){var t,i;return{send:function(n,r){t=Z("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&r("error"===e.type?404:200,e.type)}),Q.head.appendChild(t[0])},abort:function(){i&&i()}}}});var Rt=[],Ot=/(=)\?(?=&|$)|\?\?/;Z.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Rt.pop()||Z.expando+"_"+lt++;return this[e]=!0,e}}),Z.ajaxPrefilter("json jsonp",function(t,i,n){var r,o,s,a=t.jsonp!==!1&&(Ot.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ot.test(t.data)&&"data");return a||"jsonp"===t.dataTypes[0]?(r=t.jsonpCallback=Z.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Ot,"$1"+r):t.jsonp!==!1&&(t.url+=(ct.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return s||Z.error(r+" was not called"),s[0]},t.dataTypes[0]="json",o=e[r],e[r]=function(){s=arguments},n.always(function(){e[r]=o,t[r]&&(t.jsonpCallback=i.jsonpCallback,Rt.push(r)),s&&Z.isFunction(o)&&o(s[0]),s=o=void 0}),"script"):void 0}),Z.parseHTML=function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||Q;var n=se.exec(e),r=!i&&[];return n?[t.createElement(n[1])]:(n=Z.buildFragment([e],t,r),r&&r.length&&Z(r).remove(),Z.merge([],n.childNodes))};var Ft=Z.fn.load;Z.fn.load=function(e,t,i){if("string"!=typeof e&&Ft)return Ft.apply(this,arguments);var n,r,o,s=this,a=e.indexOf(" ");return a>=0&&(n=Z.trim(e.slice(a)),e=e.slice(0,a)),Z.isFunction(t)?(i=t,t=void 0):t&&"object"==typeof t&&(r="POST"),s.length>0&&Z.ajax({url:e,type:r,dataType:"html",data:t}).done(function(e){o=arguments,s.html(n?Z("<div>").append(Z.parseHTML(e)).find(n):e)}).complete(i&&function(e,t){s.each(i,o||[e.responseText,t,e])}),this},Z.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){Z.fn[t]=function(e){return this.on(t,e)}}),Z.expr.filters.animated=function(e){return Z.grep(Z.timers,function(t){return e===t.elem}).length};var Dt=e.document.documentElement;Z.offset={setOffset:function(e,t,i){var n,r,o,s,a,h,l,c=Z.css(e,"position"),u=Z(e),p={};"static"===c&&(e.style.position="relative"),a=u.offset(),o=Z.css(e,"top"),h=Z.css(e,"left"),l=("absolute"===c||"fixed"===c)&&(o+h).indexOf("auto")>-1,l?(n=u.position(),s=n.top,r=n.left):(s=parseFloat(o)||0,r=parseFloat(h)||0),Z.isFunction(t)&&(t=t.call(e,i,a)),null!=t.top&&(p.top=t.top-a.top+s),null!=t.left&&(p.left=t.left-a.left+r),"using"in t?t.using.call(e,p):u.css(p)}},Z.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){Z.offset.setOffset(this,e,t)});var t,i,n=this[0],r={top:0,left:0},o=n&&n.ownerDocument;if(o)return t=o.documentElement,Z.contains(t,n)?(typeof n.getBoundingClientRect!==Te&&(r=n.getBoundingClientRect()),i=U(o),{top:r.top+i.pageYOffset-t.clientTop,left:r.left+i.pageXOffset-t.clientLeft}):r},position:function(){if(this[0]){var e,t,i=this[0],n={top:0,left:0};return"fixed"===Z.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),Z.nodeName(e[0],"html")||(n=e.offset()),n.top+=Z.css(e[0],"borderTopWidth",!0),n.left+=Z.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-Z.css(i,"marginTop",!0),left:t.left-n.left-Z.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||Dt;e&&!Z.nodeName(e,"html")&&"static"===Z.css(e,"position");)e=e.offsetParent;return e||Dt})}}),Z.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var n="pageYOffset"===i;Z.fn[t]=function(r){return ye(this,function(t,r,o){var s=U(t);return void 0===o?s?s[i]:t[r]:void(s?s.scrollTo(n?e.pageXOffset:o,n?o:e.pageYOffset):t[r]=o)},t,r,arguments.length,null)}}),Z.each(["top","left"],function(e,t){Z.cssHooks[t]=w(Y.pixelPosition,function(e,i){return i?(i=x(e,t),Ie.test(i)?Z(e).position()[t]+"px":i):void 0})}),Z.each({Height:"height",Width:"width"},function(e,t){Z.each({padding:"inner"+e,content:t,"":"outer"+e},function(i,n){Z.fn[n]=function(n,r){var o=arguments.length&&(i||"boolean"!=typeof n),s=i||(n===!0||r===!0?"margin":"border");return ye(this,function(t,i,n){var r;return Z.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(r=t.documentElement,Math.max(t.body["scroll"+e],r["scroll"+e],t.body["offset"+e],r["offset"+e],r["client"+e])):void 0===n?Z.css(t,i,s):Z.style(t,i,n,s)},t,o?n:void 0,o,null)}})}),Z.fn.size=function(){return this.length},Z.fn.andSelf=Z.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return Z});var Bt=e.jQuery,Nt=e.$;return Z.noConflict=function(t){return e.$===Z&&(e.$=Nt),t&&e.jQuery===Z&&(e.jQuery=Bt),Z},typeof t===Te&&(e.jQuery=e.$=Z),Z})},{}],13:[function(e,t,i){function n(){}function r(e,t){e.css("-webkit-box-shadow",t),e.css("-moz-box-shadow",t),e.css("box-shadow",t)}t.exports=new n,n.prototype.choice=function(e){var t=Math.floor(Math.random()*e.length);return e[t]},n.prototype.shuffle=function(e){for(var t=new Array(e.length),i=0;i<e.length;i++)t[i]=e[i];return t.sort(function(){return.5-Math.random()}),t},n.prototype.randColor=function(){var e=Math.floor(256*Math.random()),t=Math.floor(256*Math.random()),i=Math.floor(256*Math.random());return"rgb("+e+","+t+","+i+")"},n.prototype.randInt=function(e,t){var i,n;return void 0!==e&&void 0!==t?(i=e,n=t):n=void 0!==e?e:0,i?Math.floor(Math.random()*(n-i))+i:Math.floor(Math.random()*n)},n.prototype.colorWheel=function(e){var t="rgb(",i=e%1536;return e=i%256,256>i?t+"0,255,"+e+")":512>i?t+"0,"+(255-e)+",255)":768>i?t+e+",0,255)":1024>i?t+"255,0,"+(255-e)+")":1280>i?t+"255,"+e+",0)":t+(255-e)+",255,0)"},n.prototype.alphize=function(e,t){return e.replace("rgb","rgba"),e.replace(")",", "+t+")"),e},n.prototype.contrasters=function(){var e=Math.floor(1536*Math.random()),t=this.colorWheel(e),i=this.colorWheel(e+650);return[t,i]},n.prototype.randomShadow=function(e,t){var i=t+"px",n="0px 0px "+i+" "+i+" "+this.randColor();r(e,n)},n.prototype.shadow=function(e,t,i,n,o,s){var a=t+"px",h=i+"px",l=n+"px",c=o+"px",u=a+" "+h+" "+l+" "+c+" "+s;r(e,u)},n.prototype.addTransform=function(e,t){var i=this.getTransform(e);i=i.replace("none","");var n=i+t;this.setTransform(e,n)},n.prototype.setTransform=function(e,t){e.css("-webkit-transform",t),e.css("-moz-transform",t),e.css("-ms-transform",t),e.css("-o-transform",t),e.css("transform",t)},n.prototype.getTransform=function(e){for(var t=["transform","-webkit-transform","-moz-transform","-ms-transform","-o-transform"],i=0;i<t.length;i++){var n=e.css(t[i]);if("none"===n&&i+1<t.length){var r=e.css(t[i+1]);if(r)continue}return n}},n.prototype.clearTransforms=function(e){e.css("-webkit-transform",""),e.css("-moz-transform",""),e.css("-ms-transform",""),e.css("-o-transform",""),e.css("transform","")},n.prototype.rotate=function(e,t){var i=this.getTransform(e);i=i.replace(/matrix\(.*?\)/,"").replace("none","");var n=" rotate("+t+"deg)";this.setTransform(e,i+n)},n.prototype.scale=function(e,t){
var i=this.getTransform(e);i=i.replace(/matrix\(.*?\)/,"").replace("none","");var n=" scale("+t+","+t+")";this.setTransform(e,i+n)},n.prototype.translate=function(e,t,i){var n=this.getTransform(e);n=n.replace(/matrix\(.*?\)/,"").replace("none","");var r=" translate("+t+", "+i+")";this.setTransform(e,n+r)},n.prototype.skew=function(e,t,i){var n=this.getTransform(e);n=n.replace(/skew\(.*?\)/,"").replace(/matrix\(.*?\)/,"").replace("none","");var r=t+"deg",o=i+"deg",s=" skew("+r+", "+o+")";this.setTransform(e,n+s)},n.prototype.warp=function(e,t,i,n){var r=this.getTransform(e);r=r.replace(/matrix\(.*?\)/,"").replace("none","");var o=" rotate("+t+"deg)",s=i+"deg",a=n+"deg",h=" skew("+s+", "+a+")";this.setTransform(e,r+o+h)},n.prototype.slaw=function(e,t,i,n){var r=this.getTransform(e);r=r.replace(/matrix\(.*?\)/,"").replace("none","");var o=" scale("+t+","+t+")",s=" translate("+i+", "+n+")";this.setTransform(e,r+o+s)},n.prototype.straw=function(e,t,i){var n=this.getTransform(e);n=n.replace(/matrix\(.*?\)/,"").replace("none","");var r=" scale("+t+","+t+")",o=" rotate("+i+"deg)";this.setTransform(e,n+r+o)},n.prototype.perp=function(e,t){var i=t+"px";e.css("-webkit-perspective",i),e.css("-moz-perspective",i),e.css("-ms-perspective",i),e.css("-o-perspective",i),e.css("perspective",i)},n.prototype.perpo=function(e,t,i){var n=t+"% "+i+"%";e.css("-webkit-perspective-origin",n),e.css("-moz-perspective-origin",n),e.css("-ms-perspective-origin",n),e.css("-o-perspective-origin",n),e.css("perspective-origin",n)},n.prototype.trans3d=function(e,t,i,n){var r=this.getTransform(e);r=r.replace(/matrix3d\(.*?\)/,"").replace("none","");var o=" translate3d("+t+"px, "+i+"px, "+n+"px)";this.setTransform(e,r+o)},n.prototype.scale3d=function(e,t){var i=this.getTransform(e);i=i.replace(/matrix3d\(.*?\)/,"").replace("none","");var n=" scale3d("+t+", "+t+", "+t+")";this.setTransform(e,i+n)},n.prototype.rotate3d=function(e,t,i,n,r){var o=this.getTransform(e);o=o.replace(/matrix3d\(.*?\)/,"").replace("none","");var s=" rotate3d("+t+", "+i+", "+n+", "+r+"deg)";this.setTransform(e,o+s)},n.prototype.rotate3dx=function(e,t){this.rotate3d(e,1,0,0,t)},n.prototype.rotate3dy=function(e,t){this.rotate3d(e,0,1,0,t)},n.prototype.rotate3dz=function(e,t){this.rotate3d(e,0,0,1,t)},n.prototype.addFilter=function(e,t){var i=this.getFilter(e);i=i.replace("none","");var n=i+" "+t;this.setFilter(e,n)},n.prototype.setFilter=function(e,t){e.css("-webkit-filter",t),e.css("-moz-filter",t),e.css("-ms-filter",t),e.css("-o-filter",t),e.css("filter",t)},n.prototype.getFilter=function(e){for(var t=["filter","-webkit-filter","-moz-filter","-ms-filter","-o-filter"],i=0;i<t.length;i++){var n=e.css(t[i]);if("none"===n&&i+1<t.length){var r=e.css(t[i+1]);if(r)continue}return n}},n.prototype.clearFilters=function(e){e.css("-webkit-filter",""),e.css("-moz-filter",""),e.css("-ms-filter",""),e.css("-o-filter",""),e.css("filter","")},n.prototype.grayscale=function(e,t){var i=this.getFilter(e);i=i.replace(/grayscale\(.*?\)/,"").replace("none","");var n=" grayscale("+t+"%)";this.setFilter(e,i+n)},n.prototype.sepia=function(e,t){var i=this.getFilter(e);i=i.replace(/sepia\(.*?\)/,"").replace("none","");var n=" sepia("+t+"%)";this.setFilter(e,i+n)},n.prototype.saturate=function(e,t){var i=this.getFilter(e);i=i.replace(/saturate\(.*?\)/,"").replace("none","");var n=" saturate("+t+"%)";this.setFilter(e,i+n)},n.prototype.invert=function(e,t){var i=this.getFilter(e);i=i.replace(/invert\(.*?\)/,"").replace("none","");var n=" invert("+t+"%)";this.setFilter(e,i+n)},n.prototype.hutate=function(e,t){var i=this.getFilter(e);i=i.replace(/hue-rotate\(.*?\)/,"").replace("none","");var n=" hue-rotate("+t+"deg)";this.setFilter(e,i+n)},n.prototype.opace=function(e,t){var i=this.getFilter(e);i=i.replace(/opacity\(.*?\)/,"").replace("none","");var n=" opacity("+t+"%)";this.setFilter(e,i+n)},n.prototype.brightness=function(e,t){var i=this.getFilter(e);i=i.replace(/brightness\(.*?\)/,"").replace("none","");var n=" brightness("+t+"%)";this.setFilter(e,i+n)},n.prototype.contrast=function(e,t){var i=this.getFilter(e);i=i.replace(/contrast\(.*?\)/,"").replace("none","");var n=" contrast("+t+"%)";this.setFilter(e,i+n)},n.prototype.blur=function(e,t){var i=this.getFilter(e);i=i.replace(/blur\(.*?\)/,"").replace("none","");var n=" blur("+t+"px)";this.setFilter(e,i+n)}},{}],14:[function(e,t,i){var n=e("./src/parents/parents"),r=e("./src/methods/tokenization/sentence"),o=e("./src/methods/tokenization/tokenize"),s=e("./src/methods/tokenization/ngram"),a=e("./src/methods/transliteration/unicode_normalisation"),h=e("./src/methods/syllables/syllable"),l=e("./src/methods/localization/americanize"),c=e("./src/methods/localization/britishize"),u=e("./src/pos"),p=e("./src/spot"),d={noun:n.noun,adjective:n.adjective,verb:n.verb,adverb:n.adverb,value:n.value,sentences:r,ngram:s,tokenize:o,americanize:l,britishize:c,syllables:h,normalize:a.normalize,denormalize:a.denormalize,pos:u,spot:p};("object"==typeof window||"function"==typeof DedicatedWorkerGlobalScope)&&(self.nlp=d),t.exports=d},{"./src/methods/localization/americanize":30,"./src/methods/localization/britishize":31,"./src/methods/syllables/syllable":32,"./src/methods/tokenization/ngram":33,"./src/methods/tokenization/sentence":34,"./src/methods/tokenization/tokenize":35,"./src/methods/transliteration/unicode_normalisation":36,"./src/parents/parents":48,"./src/pos":58,"./src/spot":61}],15:[function(e,t,i){var n,r,o=e("./lexicon/multiples"),s=e("./lexicon/values"),a=e("./lexicon/demonyms"),h=e("./lexicon/abbreviations"),l=e("./lexicon/honourifics"),c=e("./lexicon/uncountables"),u=e("./lexicon/firstnames"),p=e("./lexicon/irregular_nouns"),d=e("./lexicon/verbs"),f=e("../parents/verb/conjugate/conjugate"),m=e("../parents/verb/conjugate/verb_irregulars"),y=e("./lexicon/phrasal_verbs"),g=e("./lexicon/adjectives"),v=e("../parents/adjective/conjugate/to_adverb"),b=e("../parents/adjective/conjugate/to_superlative"),_=e("../parents/adjective/conjugate/to_comparative"),x=e("../parents/adjective/conjugate/convertables"),w={etc:"FW",ie:"FW",there:"EX",better:"JJR",earlier:"JJR",has:"VB",more:"RBR",sounds:"VBZ"},S={CC:["yet","therefore","or","while","nor","whether","though","because","but","for","and","if","however","before","although","how","plus","versus","not"],VBD:["where'd","when'd","how'd","what'd","said","had","been","began","came","did","meant","went"],VBN:["given","known","shown","seen","born"],VBG:["going","being","according","resulting","developing","staining"],CP:["is","will be","are","was","were","am","isn't","ain't","aren't"],DT:["this","any","enough","each","whatever","every","which","these","another","plenty","whichever","neither","an","a","least","own","few","both","those","the","that","various","what","either","much","some","else","no","la","le","les","des","de","du","el"],IN:["until","onto","of","into","out","except","across","by","between","at","down","as","from","around","with","among","upon","amid","to","along","since","about","off","on","within","in","during","per","without","throughout","through","than","via","up","unlike","despite","below","unless","towards","besides","after","whereas","'o","amidst","amongst","apropos","atop","barring","chez","circa","mid","midst","notwithstanding","qua","sans","vis-a-vis","thru","till","versus","without","w/o","o'","a'"],MD:["can","may","could","might","will","ought to","would","must","shall","should","ought","shouldn't","wouldn't","couldn't","mustn't","shan't","shant","lets","who'd","let's"],PP:["mine","something","none","anything","anyone","theirs","himself","ours","his","my","their","yours","your","our","its","nothing","herself","hers","themselves","everything","myself","itself","her","who","whom","whose"],PRP:["it","they","i","them","you","she","me","he","him","ourselves","us","we","thou","il","elle","yourself","'em"],RB:["now","again","already","soon","directly","toward","forever","apart","instead","yes","alone","ago","indeed","ever","quite","perhaps","where","then","here","thus","very","often","once","never","why","when","away","always","sometimes","also","maybe","so","just","well","several","such","randomly","too","rather","abroad","almost","anyway","twice","aside","moreover","anymore","newly","damn","somewhat","somehow","meanwhile","hence","further","furthermore"],UH:["uhh","uh-oh","ugh","sheesh","eww","pff","voila","oy","eep","hurrah","yuck","ow","duh","oh","hmm","yeah","whoa","ooh","whee","ah","bah","gah","yaa","phew","gee","ahem","eek","meh","yahoo","oops","d'oh","psst","argh","grr","nah","shhh","whew","mmm","yay","uh-huh","boo","wow","nope"],NN:["president","dollar","student","patent","funding","morning","banking","ceiling","energy","secretary","purpose","friends","event"]},M=Object.keys(S),T=M.length;for(n=0;T>n;n++)for(r=S[M[n]],i2=0;i2<r.length;i2++)w[r[i2]]=M[n];for(M=Object.keys(s),T=M.length,n=0;T>n;n++)w[M[n]]="CD";for(T=a.length,n=0;T>n;n++)w[a[n]]="JJ";for(T=h.length,n=0;T>n;n++)w[h[n]]="NNAB";for(T=l.length,n=0;T>n;n++)w[l[n]]="NNAB";for(T=c.length,n=0;T>n;n++)w[c[n]]="NN";for(T=p.length,n=0;T>n;n++)w[p[n][0]]="NN",w[p[n][1]]="NNS";Object.keys(u).forEach(function(e){w[e]="NNP"}),Object.keys(o).forEach(function(e){w[e]=o[e]}),Object.keys(y).forEach(function(e){w[e]=y[e]});var E;for(T=d.length,n=0;T>n;n++)E=f(d[n]),w[E.infinitive]=w[E.infinitive]||"VBP",w[E.past]=w[E.past]||"VBD",w[E.gerund]=w[E.gerund]||"VBG",w[E.present]=w[E.present]||"VBZ",E.doer&&(w[E.doer]=w[E.doer]||"NNA"),E.participle&&(w[E.participle]=w[E.participle]||"VBN");for(T=m.length,n=0;T>n;n++)E=m[n],w[E.infinitive]=w[E.infinitive]||"VBP",w[E.gerund]=w[E.gerund]||"VBG",w[E.past]=w[E.past]||"VBD",w[E.present]=w[E.present]||"VBZ",E.doer&&(w[E.doer]=w[E.doer]||"NNA"),E.participle&&(w[E.future]=w[E.future]||"VB");var k,A;for(T=g.length,n=0;T>n;n++)w[g[n]]="JJ";for(M=Object.keys(x),T=M.length,n=0;T>n;n++)A=M[n],w[A]="JJ",k=v(A),k&&k!==A&&!w[k]&&(w[k]=w[k]||"RB"),k=_(A),!k||k.match(/^more ./)||k===A||w[k]||(w[k]=w[k]||"JJR"),k=b(A),!k||k.match(/^most ./)||k===A||w[k]||(w[k]=w[k]||"JJS");t.exports=w},{"../parents/adjective/conjugate/convertables":37,"../parents/adjective/conjugate/to_adverb":38,"../parents/adjective/conjugate/to_comparative":39,"../parents/adjective/conjugate/to_superlative":41,"../parents/verb/conjugate/conjugate":52,"../parents/verb/conjugate/verb_irregulars":55,"./lexicon/abbreviations":16,"./lexicon/adjectives":17,"./lexicon/demonyms":18,"./lexicon/firstnames":19,"./lexicon/honourifics":20,"./lexicon/irregular_nouns":21,"./lexicon/multiples":22,"./lexicon/phrasal_verbs":23,"./lexicon/uncountables":24,"./lexicon/values":25,"./lexicon/verbs":26}],16:[function(e,t,i){var n=e("./honourifics"),r=["arc","al","ave","blvd","cl","ct","cres","exp","rd","st","dist","mt","fy","hwy","pd","pl","plz","tce","llb","md","bl","ma","ba","lit","ala","ariz","ark","cal","calif","col","colo","conn","del","fed","fla","fl","ga","ida","ind","ia","la","kan","kans","ken","ky","la","md","mich","minn","mont","neb","nebr","nev","okla","penna","penn","pa","dak","tenn","tex","ut","vt","va","wash","wis","wisc","wy","wyo","usafa","alta","ont","que","sask","yuk","dept","univ","assn","bros","inc","ltd","co","corp","yahoo","joomla","jeopardy"];r=r.concat(n),t.exports=r},{"./honourifics":20}],17:[function(e,t,i){t.exports=["colonial","moody","literal","actual","probable","apparent","usual","aberrant","ablaze","able","absolute","aboard","abrupt","absent","absorbing","abundant","accurate","adult","afraid","agonizing","ahead","aloof","amazing","arbitrary","arrogant","asleep","astonishing","average","awake","aware","awkward","back","bad","bankrupt","bawdy","beneficial","bent","best","better","bizarre","bloody","bouncy","brilliant","broken","burly","busy","cagey","careful","caring","certain","chief","chilly","civil","clever","closed","cloudy","colossal","commercial","common","complete","complex","concerned","concrete","congruent","constant","cooing","correct","cowardly","craven","cuddly","daily","damaged","damaging","dapper","dashing","deadpan","deeply","defiant","degenerate","delicate","delightful","desperate","determined","didactic","difficult","discreet","done","double","doubtful","downtown","dreary","east","eastern","elderly","elegant","elfin","elite","eminent","encouraging","entire","erect","ethereal","exact","expert","extra","exuberant","exultant","false","fancy","faulty","female","fertile","fierce ","financial","first","fit","fixed","flagrant","foamy","foolish","foregoing","foreign","former","fortunate","frantic","freezing","frequent","fretful","friendly","fun","furry","future","gainful","gaudy","giant","giddy","gigantic","gleaming","global","gold","gone","good","goofy","graceful","grateful","gratis","gray","grey","groovy","gross","guarded","half","handy","hanging","hateful","heady","heavenly","hellish","helpful","hesitant","highfalutin","homely","honest","huge","humdrum","hurried","hurt","icy","ignorant","ill","illegal","immediate","immense","imminent","impartial","imperfect","imported","initial","innate","inner","inside","irate","jolly","juicy","junior","juvenile","kaput","kindly","knowing","labored","languid","latter","learned","left","legal","lethal","level","lewd","likely","literate","lively","living","lonely","longing","loutish","lovely","loving","lowly","luxuriant","lying","macabre","madly","magenta","main","major","makeshift","male","mammoth","measly","meaty","medium","mere","middle","miniature","minor","miscreant","mobile","moldy","mute","naive","nearby","necessary","neighborly","next","nimble","nonchalant","nondescript","nonstop","north","nosy","obeisant","obese","obscene","observant","obsolete","offbeat","official","ok","open","opposite","organic","outdoor","outer","outgoing","oval","over","overall","overt","overweight","overwrought","painful","past","peaceful","perfect","petite","picayune","placid","plant","pleasant","polite","potential","pregnant","premium","present","pricey","prickly","primary","prior","private","profuse","proper","public","pumped","puny","quack","quaint","quickest","rabid","racial","ready","real","rebel","recondite","redundant","relevant","remote","resolute","resonant","right","rightful","ritzy","robust","romantic","roomy","rough","royal","salty","same","scary","scientific","screeching","second","secret","secure","sedate","seemly","selfish","senior","separate","severe","shiny","shocking","shut","shy","sick","significant","silly","sincere","single","skinny","slight","slimy","smelly","snobbish","social","somber","sordid","sorry","southern","spare","special","specific","spicy","splendid","squeamish","standard","standing","steadfast","steady","stereotyped","still","striped","stupid","sturdy","subdued","subsequent","substantial","sudden","super","superb","superficial","supreme","sure","taboo","tan","tasteful","tawdry","telling","temporary","terrific","tested","thoughtful","tidy","tiny","top","torpid","tranquil","trite","ugly","ultra","unbecoming","understood","uneven","unfair","unlikely","unruly","unsightly","untidy","unwritten","upbeat","upper","uppity","upset","upstairs","uptight","used","useful","utter","uttermost","vagabond","vanilla","various","vengeful","verdant","violet","volatile","wanting","wary","wasteful","weary","weekly","welcome","western","whole","wholesale","wiry","wistful","womanly","wooden","woozy","wound","wrong","wry","zany","sacred","unknown","detailed","ongoing","prominent","permanent","diverse","partial","moderate","contemporary","intense","widespread","ultimate","ideal","adequate","sophisticated","naked","dominant","precise","intact","adverse","genuine","subtle","universal","resistant","routine","distant","unexpected","soviet","blind","artificial","mild","legitimate","unpublished","superior","intermediate","everyday","dumb","excess","sexy","fake","monthly","premature","sheer","generic","insane","contrary","twin","upcoming","bottom","costly","indirect","sole","unrelated","hispanic","improper","underground","legendary","reluctant","beloved","inappropriate","corrupt","irrelevant","justified","obscure","profound","hostile","influential","inadequate","abstract","timely","authentic","bold","intimate","straightforward","rival","right-wing","racist","symbolic","unprecedented","loyal","talented","troubled","noble","instant","incorrect","dense","blond","deliberate","blank","rear","feminine","apt","stark","alcoholic","teenage","vibrant","humble","vain","covert","bland","trendy","foul","populist","alarming","hooked","wicked","deaf","left-wing","lousy","malignant","stylish","upscale","hourly","refreshing","cozy","slick","dire","yearly","inbred","part-time","finite","backwards","nightly","unauthorized","cheesy","indoor","surreal","bald","masculine","shady","spirited","eerie","horrific","smug","stern","hefty","savvy","bogus","elaborate","gloomy","pristine","extravagant","serene","advanced","perverse","devout","crisp","rosy","slender","melancholy","faux","phony","danish","lofty","nuanced","lax","adept","barren","shameful","sleek","solemn","vacant","dishonest","brisk","fluent","insecure","humid","menacing","moot","soothing","self-loathing","far-reaching","harrowing","scathing","perplexing","calming","unconvincing","unsuspecting","unassuming","surprising","unappealing","vexing","unending","easygoing","appetizing","disgruntled","retarded","undecided","unregulated","unsupervised","unrecognized","crazed","distressed","jagged","paralleled","cramped","warped","antiquated","fabled","deranged","diseased","ragged","intoxicated","hallowed","crowded","ghastly","disorderly","saintly","wily","sly","sprightly","ghostly","oily","hilly","grisly","earthly","friendly","unwieldy","many","most","last","expected","far","due","divine","all","together","only","outside","multiple","appropriate","evil","favorite","limited","random","republican","okay","essential","secondary","gay","south","pro","northern","urban","acute","prime","arab","overnight","mixed","crucial","behind","above","beyond","against","under","other","less"]},{}],18:[function(e,t,i){t.exports=["afghan","albanian","algerian","argentine","armenian","australian","aussie","austrian","bangladeshi","belgian","bolivian","bosnian","brazilian","bulgarian","cambodian","canadian","chilean","chinese","colombian","croat","cuban","czech","dominican","egyptian","british","estonian","ethiopian","finnish","french","gambian","georgian","german","greek","haitian","hungarian","indian","indonesian","iranian","iraqi","irish","israeli","italian","jamaican","japanese","jordanian","kenyan","korean","kuwaiti","latvian","lebanese","liberian","libyan","lithuanian","macedonian","malaysian","mexican","mongolian","moroccan","dutch","nicaraguan","nigerian","norwegian","omani","pakistani","palestinian","filipino","polish","portuguese","qatari","romanian","russian","rwandan","samoan","saudi","scottish","senegalese","serbian","singaporean","slovak","somali","sudanese","swedish","swiss","syrian","taiwanese","thai","tunisian","ugandan","ukrainian","american","hindi","spanish","venezuelan","vietnamese","welsh","african","european","asian","californian"]},{}],19:[function(e,t,i){var n,r,o,s,a,h=[],l={will:"iam,ie,ard,is,iams",fred:",erick,die,rick,dy",marc:"us,,o,os,el",darr:"ell,yl,en,el,in",fran:"k,cis,cisco,klin,kie",terr:"y,ance,ence,ell",rand:"y,all,olph,al",brad:"ley,,ford,y",jeff:"rey,,ery,ry",john:",ny,nie,athan",greg:"ory,,g,orio",mar:"k,tin,vin,io,shall,ty,lon,lin",car:"l,los,lton,roll,y,ey",ken:"neth,,t,ny,dall,drick",har:"old,ry,vey,ley,lan,rison",ste:"ven,phen,ve,wart,phan,rling",jer:"ry,emy,ome,emiah,maine,ald",mic:"hael,heal,ah,key,hel",dar:"yl,in,nell,win,ius",dan:"iel,ny,,e",wil:"bur,son,bert,fred,fredo",ric:"hard,ky,ardo,k,key",cli:"fford,nton,fton,nt,ff",cla:"rence,ude,yton,rk,y",ben:"jamin,,nie,ny,ito",rod:"ney,erick,olfo,ger,",rob:"ert,erto,bie,",gar:"y,ry,rett,land",sam:"uel,,my,mie",and:"rew,re,y,res",jos:"eph,e,hua,h",joe:",l,y,sph",leo:"nard,n,,nardo",tom:",my,as,mie",bry:"an,ant,ce,on",ant:"hony,onio,oine,on",jac:"k,ob,kson",cha:"rles,d,rlie,se",sha:"wn,ne,un",bre:"nt,tt,ndan,t",jes:"se,us,s",al:"bert,an,len,fred,exander,ex,vin,lan,fredo,berto,ejandro,fonso,ton,,onzo,i,varo",ro:"nald,ger,y,nnie,land,n,ss,osevelt,gelio,lando,man,cky,yce,scoe,ry",de:"nnis,rek,an,rrick,lbert,vin,wey,xter,wayne,metrius,nis,smond",ja:"mes,son,y,red,vier,ke,sper,mal,rrod",el:"mer,lis,bert,ias,ijah,don,i,ton,liot,liott,vin,wood",ma:"tthew,nuel,urice,thew,x,tt,lcolm,ck,son","do":"nald,uglas,n,nnie,ug,minic,yle,mingo,minick",er:"ic,nest,ik,nesto,ick,vin,nie,win",ra:"ymond,lph,y,mon,fael,ul,miro,phael",ed:"ward,win,die,gar,uardo,,mund,mond",co:"rey,ry,dy,lin,nrad,rnelius",le:"roy,wis,ster,land,vi",lo:"uis,nnie,renzo,ren,well,uie,u,gan",da:"vid,le,ve,mon,llas,mian,mien",jo:"nathan,n,rge,rdan,nathon,aquin",ru:"ssell,ben,dolph,dy,fus,ssel,sty",ke:"vin,ith,lvin,rmit",ar:"thur,nold,mando,turo,chie,mand",re:"ginald,x,ynaldo,uben,ggie",ge:"orge,rald,ne,rard,offrey,rardo",la:"rry,wrence,nce,urence,mar,mont",mo:"rris,ses,nte,ises,nty",ju:"an,stin,lio,lian,lius,nior",pe:"ter,dro,rry,te,rcy",tr:"avis,oy,evor,ent",he:"nry,rbert,rman,ctor,ath",no:"rman,el,ah,lan,rbert",em:"anuel,il,ilio,mett,manuel",wa:"lter,yne,rren,llace,de",mi:"ke,guel,lton,tchell,les",sa:"lvador,lvatore,ntiago,ul,ntos",ch:"ristopher,ris,ester,ristian,uck",pa:"ul,trick,blo,t",st:"anley,uart,an",hu:"gh,bert,go,mberto",br:"ian,uce,andon,ain",vi:"ctor,ncent,rgil,cente",ca:"lvin,meron,leb",gu:"y,illermo,stavo",lu:"is,ther,ke,cas",gr:"ant,ady,over,aham",ne:"il,lson,al,d",t:"homas,imothy,odd,ony,heodore,im,yler,ed,yrone,aylor,erence,immy,oby,eddy,yson",s:"cott,ean,idney,ergio,eth,pencer,herman,ylvester,imon,heldon,cotty,olomon",r:"yan",n:"icholas,athan,athaniel,ick,icolas",a:"dam,aron,drian,ustin,ngelo,braham,mos,bel,gustin,ugust,dolfo",b:"illy,obby,arry,ernard,ill,ob,yron,lake,ert,oyd,illie,laine,art,uddy,urton",e:"ugene,arl,verett,nrique,van,arnest,frain,than,steban",h:"oward,omer,orace,ans,al",p:"hillip,hilip,reston,hil,ierre",c:"raig,urtis,lyde,ecil,esar,edric,leveland,urt",j:"immy,im,immie",g:"lenn,ordon,len,ilbert,abriel,ilberto",m:"elvin,yron,erle,urray",k:"yle,arl,urt,irk,ristopher",o:"scar,tis,liver,rlando,mar,wen,rville,tto",l:"loyd,yle,ionel",f:"loyd,ernando,elix,elipe,orrest,abian,idel",w:"esley,endell,m,oodrow,inston",d:"ustin,uane,wayne,wight,rew,ylan",z:"achary",v:"ernon,an,ance",i:"an,van,saac,ra,rving,smael,gnacio,rvin",q:"uentin,uinton",x:"avier"},c={mari:"a,e,lyn,an,anne,na,ssa,bel,sa,sol,tza",kris:"ten,tin,tina,ti,tine,ty,ta,tie",jean:"ette,ne,nette,nie,ine,nine",chri:"stine,stina,sty,stie,sta,sti",marg:"aret,ie,arita,uerite,ret,o",ange:"la,lica,lina,lia,line",fran:"ces,cine,cisca",kath:"leen,erine,y,ryn,arine",sher:"ry,ri,yl,i,rie",caro:"l,lyn,line,le,lina",dian:"e,a,ne,na",jenn:"ifer,ie,y,a",luci:"lle,a,nda,le",kell:"y,i,ey,ie",rosa:",lie,lind",jani:"ce,e,s,ne",stac:"y,ey,ie,i",shel:"ly,ley,ia",laur:"a,en,ie,el",trac:"y,ey,i,ie",jane:"t,,lle,tte",bett:"y,ie,e,ye",rose:"mary,marie,tta",joan:",ne,n,na",mar:"y,tha,jorie,cia,lene,sha,yann,cella,ta,la,cy,tina",lor:"i,raine,etta,a,ena,ene,na,ie",sha:"ron,nnon,ri,wna,nna,na,una",dor:"othy,is,a,een,thy,othea",cla:"ra,udia,ire,rice,udette",eli:"zabeth,sa,sabeth,se,za",kar:"en,la,a,i,in",tam:"my,ara,i,mie,ika",ann:"a,,e,ie,ette",car:"men,rie,la,a,mela",mel:"issa,anie,inda",ali:"ce,cia,son,sha,sa",bri:"ttany,dget,ttney,dgette",lyn:"n,da,ne,ette",del:"ores,la,ia,oris",ter:"esa,ri,i",son:"ia,ya,ja,dra",deb:"orah,ra,bie,ora",jac:"queline,kie,quelyn,lyn",lat:"oya,asha,onya,isha",che:"ryl,lsea,ri,rie",vic:"toria,ki,kie,ky",sus:"an,ie,anne,ana",rob:"erta,yn",est:"her,elle,ella,er",lea:"h,,nne,nn",lil:"lian,lie,a,y",ma:"ureen,ttie,xine,bel,e,deline,ggie,mie,ble,ndy,ude,yra,nuela,vis,gdalena,tilda",jo:"yce,sephine,,di,dy,hanna,sefina,sie,celyn,lene,ni,die",be:"verly,rtha,atrice,rnice,th,ssie,cky,linda,ulah,rnadette,thany,tsy,atriz",ca:"therine,thy,ssandra,ndace,ndice,mille,itlin,ssie,thleen,llie",le:"slie,na,ona,ticia,igh,la,nora,ola,sley,ila",el:"aine,len,eanor,sie,la,ena,oise,vira,sa,va,ma",sa:"ndra,rah,ra,lly,mantha,brina,ndy,die,llie",mi:"chelle,ldred,chele,nnie,riam,sty,ndy,randa,llie",co:"nnie,lleen,nstance,urtney,ra,rinne,nsuelo,rnelia",ju:"lie,dith,dy,lia,anita,ana,stine",da:"wn,nielle,rlene,na,isy,rla,phne",re:"becca,nee,na,bekah,ba",al:"ma,lison,berta,exandra,yssa,ta",ra:"chel,mona,chael,quel,chelle",an:"drea,ita,a,gie,toinette,tonia",ge:"raldine,rtrude,orgia,nevieve,orgina",de:"nise,anna,siree,na,ana,e",ja:"smine,na,yne",lu:"cy,z,la,pe,ella,isa",je:"ssica,nifer,well,ri",ad:"a,rienne,die,ele,riana,eline",pa:"tricia,mela,ula,uline,tsy,m,tty,ulette,tti,trice,trica,ige",ke:"ndra,rri,isha,ri",mo:"nica,lly,nique,na,llie",lo:"uise,is,la",he:"len,ather,idi,nrietta,lene,lena",me:"gan,rcedes,redith,ghan,agan",wi:"lma,lla,nnie",ga:"il,yle,briela,brielle,le",er:"in,ica,ika,ma,nestine",ce:"cilia,lia,celia,leste,cile",ka:"tie,y,trina,yla,te",ol:"ga,ivia,lie,a",li:"nda,sa,ndsay,ndsey,zzie",na:"ncy,talie,omi,tasha,dine",la:"verne,na,donna,ra",vi:"rginia,vian,ola",ha:"rriet,nnah",pe:"ggy,arl,nny,tra",br:"enda,andi,ooke",ki:"mberly,m,mberley,rsten",au:"drey,tumn,dra",bo:"nnie,bbie,nita,bbi","do":"nna,lores,lly,minique",gl:"oria,adys,enda,enna",tr:"icia,ina,isha,udy",ta:"ra,nya,sha,bitha",ro:"sie,xanne,chelle,nda",am:"y,anda,ber,elia",fa:"ye,nnie,y",ni:"cole,na,chole,kki",ve:"ronica,ra,lma,rna",gr:"ace,etchen,aciela,acie",b:"arbara,lanca,arbra,ianca",r:"uth,ita,honda",s:"hirley,tephanie,ylvia,heila,uzanne,ue,tella,ophia,ilvia,ophie,tefanie,heena,ummer,elma,ocorro,ybil,imone",c:"ynthia,rystal,indy,harlene,ristina,leo",e:"velyn,mily,dna,dith,thel,mma,va,ileen,unice,ula,ssie,ffie,tta,ugenia",a:"shley,pril,gnes,rlene,imee,bigail,ida,bby,ileen",t:"heresa,ina,iffany,helma,onya,oni,herese,onia",i:"rene,da,rma,sabel,nez,ngrid,va,mogene,sabelle",w:"anda,endy,hitney",p:"hyllis,riscilla,olly",n:"orma,ellie,ora,ettie,ell",f:"lorence,elicia,lora,reda,ern,rieda",v:"alerie,anessa",j:"ill,illian",y:"vonne,olanda,vette",g:"ina,wendolyn,wen,oldie",l:"ydia",m:"yrtle,yra,uriel,yrna",h:"ilda",o:"pal,ra,felia",k:"rystal",d:"ixie,ina",u:"rsula"},u=["casey","jamie","lee","jaime","jessie","morgan","rene","robin","devon","kerry","alexis","guadalupe","blair","kasey","jean","marion","aubrey","shelby","jan","shea","jade","kenyatta","kelsey","shay","lashawn","trinity","regan","jammie","cassidy","cheyenne","reagan","shiloh","marlo","andra","devan","rosario","lee"];for(a=Object.keys(l),s=a.length,n=0;s>n;n++)for(r=l[a[n]].split(","),o=0;o<r.length;o++)h[a[n]+r[o]]="m";for(a=Object.keys(c),s=a.length,n=0;s>n;n++)for(r=c[a[n]].split(","),o=0;o<r.length;o++)h[a[n]+r[o]]="f";for(s=u.length,n=0;s>n;n+=1)h[u[n]]="a";t.exports=h},{}],20:[function(e,t,i){var n=["jr","mr","mrs","ms","dr","prof","sr","sen","corp","rep","gov","atty","supt","det","rev","col","gen","lt","cmdr","adm","capt","sgt","cpl","maj","miss","misses","mister","sir","esq","mstr","phd","adj","adv","asst","bldg","brig","comdr","hon","messrs","mlle","mme","op","ord","pvt","reps","res","sens","sfc","surg"];t.exports=n},{}],21:[function(e,t,i){var n=[["child","_ren"],["person","people"],["leaf","leaves"],["database","_s"],["quiz","_zes"],["child","_ren"],["stomach","_s"],["sex","_es"],["move","_s"],["shoe","_s"],["goose","geese"],["phenomenon","phenomena"],["barracks","_"],["deer","_"],["syllabus","syllabi"],["index","indices"],["appendix","appendices"],["criterion","criteria"],["man","men"],["sex","_es"],["rodeo","_s"],["epoch","_s"],["zero","_s"],["avocado","_s"],["halo","_s"],["tornado","_s"],["tuxedo","_s"],["sombrero","_s"],["addendum","addenda"],["alga","_e"],["alumna","_e"],["alumnus","alumni"],["bacillus","bacilli"],["cactus","cacti"],["beau","_x"],["chteau","_x"],["chateau","_x"],["tableau","_x"],["corpus","corpora"],["curriculum","curricula"],["echo","_es"],["embargo","_es"],["foot","feet"],["genus","genera"],["hippopotamus","hippopotami"],["larva","_e"],["libretto","libretti"],["loaf","loaves"],["matrix","matrices"],["memorandum","memoranda"],["mosquito","_es"],["opus","opera"],["ovum","ova"],["ox","_en"],["radius","radii"],["referendum","referenda"],["thief","thieves"],["tooth","teeth"]];n=n.map(function(e){return e[1]=e[1].replace("_",e[0]),e}),t.exports=n},{}],22:[function(e,t,i){t.exports={"of course":"RB","at least":"RB","no longer":"RB","sort of":"RB","at first":"RB","once again":"RB","once more":"RB","up to":"RB","by now":"RB","all but":"RB","just about":"RB","on board":"JJ","a lot":"RB","by far":"RB","at best":"RB","at large":"RB","for good":"RB","vice versa":"JJ","en route":"JJ","for sure":"RB","upside down":"JJ","at most":"RB","per se":"RB","at worst":"RB","upwards of":"RB","en masse":"RB","point blank":"RB","up front":"JJ","in situ":"JJ","in vitro":"JJ","ad hoc":"JJ","de facto":"JJ","ad infinitum":"JJ","ad nauseam":"RB","for keeps":"JJ","a priori":"FW","et cetera":"FW","off guard":"JJ","spot on":"JJ","ipso facto":"JJ","not withstanding":"RB","de jure":"RB","a la":"IN","ad hominem":"NN","par excellence":"RB","de trop":"RB","a posteriori":"RB","fed up":"JJ","brand new":"JJ","old fashioned":"JJ","bona fide":"JJ","well off":"JJ","far off":"JJ","straight forward":"JJ","hard up":"JJ","sui generis":"JJ","en suite":"JJ","avant garde":"JJ","sans serif":"JJ","gung ho":"JJ","super duper":"JJ","new york":"NN","new england":"NN","new hampshire":"NN","new delhi":"NN","new jersey":"NN","new mexico":"NN","united states":"NN","united kingdom":"NN","great britain":"NN","head start":"NN"}},{}],23:[function(e,t,i){var n=e("../../parents/verb/conjugate/conjugate"),r=["be onto","fall behind","fall through","fool with","get across","get along","get at","give way","hear from","hear of","lash into","make do","run across","set upon","take aback","keep from"],o={away:"back","in":"out",on:"off",over:"under",together:"apart",up:"down"},s={away:"blow,bounce,bring,call,come,cut,drop,fire,get,give,go,keep,pass,put,run,send,shoot,switch,take,tie,throw","in":"bang,barge,bash,beat,block,book,box,break,bring,burn,butt,carve,cash,check,come,cross,drop,fall,fence,fill,give,grow,hand,hang,head,jack,keep,leave,let,lock,log,move,opt,pack,peel,pull,put,rain,reach,ring,rub,send,set,settle,shut,sign,smash,snow,strike,take,try,turn,type,warm,wave,wean,wear,wheel",on:"add,call,carry,catch,count,feed,get,give,go,grind,head,hold,keep,lay,log,pass,pop,power,put,send,show,snap,switch,take,tell,try,turn,wait",over:"come,go,look,read,run,talk",together:"come,pull,put",up:"add,back,beat,bend,blow,boil,bottle,break,bring,buckle,bundle,call,carve,clean,cut,dress,fill,flag,fold,get,give,grind,grow,hang,hold,keep,let,load,lock,look,man,mark,melt,move,pack,pin,pipe,plump,pop,power,pull,put,rub,scale,scrape,send,set,settle,shake,show,sit,slow,smash,square,stand,strike,take,tear,tie,turn,use,wash,wind"};Object.keys(s).forEach(function(e){s[e].split(",").forEach(function(t){r.push(t+" "+e),r.push(t+" "+o[e])})});var a={about:"bring,fool,gad,go,root",after:"go,look,take",ahead:"get,go,press",along:"bring,move",apart:"fall,take",around:"ask,boss,bring,call,come,fool,get,horse,joke,lie,mess,play",away:"back,carry,file,frighten,hide,wash",back:"fall,fight,hit,hold,look,pay,stand,think",by:"drop,get,go,stop,swear,swing,tick,zip",down:"bog,calm,fall,hand,hunker,jot,knock,lie,narrow,note,pat,pour,run,tone,trickle,wear","for":"fend,file,gun,hanker,root,shoot",forth:"bring,come",forward:"come,look","in":"cave,chip,hone,jump,key,pencil,plug,rein,shade,sleep,stop,suck,tie,trade,tuck,usher,weigh,zero",into:"look,run",it:"go,have",off:"auction,be,beat,blast,block,brush,burn,buzz,cast,cool,drop,end,face,fall,fend,frighten,goof,jack,kick,knock,laugh,level,live,make,mouth,nod,pair,pay,peel,read,reel,ring,rip,round,sail,shave,shoot,sleep,slice,split,square,stave,stop,storm,strike,tear,tee,tick,tip,top,walk,work,write",on:"bank,bargain,egg,frown,hit,latch,pile,prattle,press,spring,spur,tack,urge,yammer",out:"act,ask,back,bail,bear,black,blank,bleed,blow,blurt,branch,buy,cancel,cut,eat,edge,farm,figure,find,fill,find,fish,fizzle,flake,flame,flare,flesh,flip,geek,get,help,hide,hold,iron,knock,lash,level,listen,lose,luck,make,max,miss,nerd,pan,pass,pick,pig,point,print,psych,rat,read,rent,root,rule,run,scout,see,sell,shout,single,sit,smoke,sort,spell,splash,stamp,start,storm,straighten,suss,time,tire,top,trip,trot,wash,watch,weird,whip,wimp,wipe,work,zone,zonk",
over:"bend,bubble,do,fall,get,gloss,hold,keel,mull,pore,sleep,spill,think,tide,tip",round:"get,go",through:"go,run",to:"keep,see",up:"act,beef,board,bone,boot,brighten,build,buy,catch,cheer,cook,end,eye,face,fatten,feel,fess,finish,fire,firm,flame,flare,free,freeze,freshen,fry,fuel,gang,gear,goof,hack,ham,heat,hit,hole,hush,jazz,juice,lap,light,lighten,line,link,listen,live,loosen,make,mash,measure,mess,mix,mock,mop,muddle,open,own,pair,patch,pick,prop,psych,read,rough,rustle,save,shack,sign,size,slice,slip,snap,sober,spark,split,spruce,stack,start,stay,stir,stitch,straighten,string,suck,suit,sum,team,tee,think,tidy,tighten,toss,trade,trip,type,vacuum,wait,wake,warm,weigh,whip,wire,wise,word,write,zip"};Object.keys(a).forEach(function(e){a[e].split(",").forEach(function(t){r.push(t+" "+e)})}),r=r.reduce(function(e,t){return e[t]="VBP",e},{});var h,l,c,u,p={present:"VB",past:"VBD",future:"VBF",gerund:"VBG",infinitive:"VBP"},d={};Object.keys(r).forEach(function(e){h=e.split(" "),l=h[0],c=h[1],void 0===d[l]&&(d[l]=n(l)),Object.keys(d[l]).forEach(function(e){u=d[l][e]+" "+c,r[u]=p[e]})}),t.exports=r},{"../../parents/verb/conjugate/conjugate":52}],24:[function(e,t,i){t.exports=["aircraft","bass","bison","fowl","halibut","moose","salmon","spacecraft","tuna","trout","advice","information","knowledge","trouble","enjoyment","fun","recreation","relaxation","meat","rice","bread","cake","coffee","ice","water","oil","grass","hair","fruit","wildlife","equipment","machinery","furniture","mail","luggage","jewelry","clothing","money","mathematics","economics","physics","civics","ethics","gymnastics","mumps","measles","news","tennis","baggage","currency","soap","toothpaste","food","sugar","butter","flour","research","leather","wool","wood","coal","weather","homework","cotton","silk","patience","impatience","vinegar","art","beef","blood","cash","chaos","cheese","chewing","conduct","confusion","education","electricity","entertainment","fiction","forgiveness","gold","gossip","ground","happiness","history","honey","hospitality","importance","justice","laughter","leisure","lightning","literature","luck","melancholy","milk","mist","music","noise","oxygen","paper","pay","peace","peanut","pepper","petrol","plastic","pork","power","pressure","rain","recognition","sadness","safety","salt","sand","scenery","shopping","silver","snow","softness","space","speed","steam","sunshine","tea","thunder","time","traffic","trousers","violence","warmth","wine","steel","soccer","hockey","golf","fish","gum","liquid","series","sheep","species","fahrenheit","celcius","kelvin","hertz"]},{}],25:[function(e,t,i){t.exports=["zero","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen","twenty","thirty","forty","fifty","sixty","seventy","eighty","ninety","hundred","thousand","million","billion","trillion","quadrillion","quintillion","sextillion","septillion","octillion","nonillion","decillion","january","february","april","june","july","august","september","october","november","december","jan","feb","mar","apr","jun","jul","aug","sep","oct","nov","dec","sept","sep","monday","tuesday","wednesday","thursday","friday","saturday","sunday"].reduce(function(e,t){return e[t]="CD",e},{})},{}],26:[function(e,t,i){t.exports=["collapse","stake","forsee","suck","answer","argue","tend","examine","depend","form","figure","mind","surround","suspect","reflect","wonder","hope","end","thank","file","regard","report","imagine","consider","ensure","cause","work","enter","stop","defeat","surge","launch","turn","like","control","relate","remember","join","listen","train","spring","enjoy","fail","recognize","obtain","learn","fill","announce","prevent","achieve","realize","involve","remove","aid","visit","test","prepare","ask","carry","suppose","determine","raise","love","use","pull","improve","contain","offer","talk","pick","care","express","remain","operate","close","add","mention","support","decide","walk","vary","demand","describe","agree","happen","allow","suffer","study","press","watch","seem","occur","contribute","claim","compare","apply","direct","discuss","indicate","require","change","fix","reach","prove","expect","exist","play","permit","kill","charge","increase","believe","create","continue","live","help","represent","edit","serve","appear","cover","maintain","start","stay","move","extend","design","supply","suggest","want","approach","call","include","try","receive","save","discover","marry","need","establish","keep","assume","attend","unite","explain","publish","accept","settle","reduce","do","look","interact","concern","labor","return","select","die","provide","seek","wish","finish","follow","disagree","produce","attack","attempt","brake","brush","burn","bang","bomb","budget","comfort","cook","copy","cough","crush","cry","check","claw","clip","combine","damage","desire","doubt","drain","dance","decrease","defect","deposit","drift","dip","dive","divorce","dream","exchange","envy","exert","exercise","export","fold","flood","focus","forecast","fracture","grip","guide","guard","guarantee","guess","hate","heat","handle","hire","host","hunt","hurry","import","judge","jump","jam","kick","kiss","knock","laugh","lift","lock","lecture","link","load","loan","lump","melt","message","murder","neglect","overlap","overtake","overuse","print","protest","pump","push","post","progress","promise","purchase","regret","request","reward","roll","rub","rent","repair","sail","scale","screw","shock","sleep","slip","smash","smell","smoke","sneeze","snow","surprise","scratch","search","share","shave","spit","splash","stain","stress","switch","taste","touch","trade","trick","twist","trap","travel","tune","undergo","undo","uplift","vote","wash","wave","whistle","wreck","yawn","betray","restrict","perform","worry","point","activate","fear","plan","note","face","predict","differ","deserve","torture","recall","count","admit","insist","lack","pass","belong","complain","constitute","rely","refuse","range","cite","flash","arrive","reveal","consist","observe","notice","trust","display","view","stare","acknowledge","owe","gaze","treat","account","gather","address","confirm","estimate","manage","participate","sneak","drop","mirror","experience","strive","arch","dislike","favor","earn","emphasize","match","question","emerge","encourage","matter","name","head","line","slam","list","warn","ignore","resemble","feature","place","reverse","accuse","spoil","retain","survive","praise","function","please","date","remind","deliver","echo","engage","deny","yield","center","gain","anticipate","reason","side","thrive","defy","dodge","enable","applaud","bear","persist","pose","reject","attract","await","inhibit","declare","process","risk","urge","value","block","confront","credit","cross","amuse","dare","resent","smile","gloss","threaten","collect","depict","dismiss","submit","benefit","step","deem","limit","sense","issue","embody","force","govern","replace","bother","cater","adopt","empower","outweigh","alter","enrich","influence","prohibit","pursue","warrant","convey","approve","reserve","rest","strain","wander","adjust","dress","market","mingle","disapprove","evaluate","flow","inhabit","pop","rule","depart","roam","assert","disappear","envision","pause","afford","challenge","grab","grumble","house","portray","revel","base","conduct","review","stem","crave","mark","store","target","unlock","weigh","resist","drag","pour","reckon","assign","cling","rank","attach","decline","destroy","interfere","paint","skip","sprinkle","wither","allege","retire","score","monitor","expand","honor","pack","assist","float","appeal","stretch","undermine","assemble","boast","bounce","grasp","install","borrow","crack","elect","shout","contrast","overcome","relax","relent","strengthen","conform","dump","pile","scare","relive","resort","rush","boost","cease","command","excel","plug","plunge","proclaim","discourage","endure","ruin","stumble","abandon","cheat","convince","merge","convert","harm","multiply","overwhelm","chew","invent","bury","wipe","added","took","define","goes","measure","enhance","distinguish","avoid","don't","won't","what's"]},{}],27:[function(e,t,i){t.exports={VB:{name:"verb, generic",parent:"verb",tag:"VB"},VBD:{name:"past-tense verb",parent:"verb",tense:"past",tag:"VBD"},VBN:{name:"past-participle verb",parent:"verb",tense:"past",tag:"VBN"},VBP:{name:"infinitive verb",parent:"verb",tense:"present",tag:"VBP"},VBF:{name:"future-tense verb",parent:"verb",tense:"future",tag:"VBF"},VBZ:{name:"present-tense verb",tense:"present",parent:"verb",tag:"VBZ"},CP:{name:"copula",parent:"verb",tag:"CP"},VBG:{name:"gerund verb",parent:"verb",tag:"VBG"},JJ:{name:"adjective, generic",parent:"adjective",tag:"JJ"},JJR:{name:"comparative adjective",parent:"adjective",tag:"JJR"},JJS:{name:"superlative adjective",parent:"adjective",tag:"JJS"},RB:{name:"adverb",parent:"adverb",tag:"RB"},RBR:{name:"comparative adverb",parent:"adverb",tag:"RBR"},RBS:{name:"superlative adverb",parent:"adverb",tag:"RBS"},NN:{name:"noun, generic",parent:"noun",tag:"NN"},NNP:{name:"singular proper noun",parent:"noun",tag:"NNP"},NNA:{name:"noun, active",parent:"noun",tag:"NNA"},NNPA:{name:"noun, acronym",parent:"noun",tag:"NNPA"},NNPS:{name:"plural proper noun",parent:"noun",tag:"NNPS"},NNAB:{name:"noun, abbreviation",parent:"noun",tag:"NNAB"},NNS:{name:"plural noun",parent:"noun",tag:"NNS"},NNO:{name:"possessive noun",parent:"noun",tag:"NNO"},NNG:{name:"gerund noun",parent:"noun",tag:"VBG"},PP:{name:"possessive pronoun",parent:"noun",tag:"PP"},FW:{name:"foreign word",parent:"glue",tag:"FW"},CD:{name:"cardinal value, generic",parent:"value",tag:"CD"},DA:{name:"date",parent:"value",tag:"DA"},NU:{name:"number",parent:"value",tag:"NU"},IN:{name:"preposition",parent:"glue",tag:"IN"},MD:{name:"modal verb",parent:"verb",tag:"MD"},CC:{name:"co-ordating conjunction",parent:"glue",tag:"CC"},PRP:{name:"personal pronoun",parent:"noun",tag:"PRP"},DT:{name:"determiner",parent:"glue",tag:"DT"},UH:{name:"interjection",parent:"glue",tag:"UH"},EX:{name:"existential there",parent:"glue",tag:"EX"}}},{}],28:[function(e,t,i){var n={NN:["ceae","inae","idae","leaf","rgan","eman","sman","star","boat","tube","rica","tica","nica","auce","tics","ency","ancy","poda","tude","xide","body","weed","tree","rrel","stem","cher","icer","erer","ader","ncer","izer","ayer","nner","ates","ales","ides","rmes","etes","llet","uage","ings","aphy","chid","tein","vein","hair","tris","unit","cake","nake","illa","ella","icle","ille","etle","scle","cell","bell","bill","palm","toma","game","lamp","bone","mann","ment","wood","book","nson","agon","odon","dron","iron","tion","itor","ator","root","cope","tera","hora","lora","bird","worm","fern","horn","wort","ourt","stry","etry","bush","ness","gist","rata","lata","tata","moth","lity","nity","sity","rity","city","dity","vity","drug","dium","llum","trum","inum","lium","tium","atum","rium","icum","anum","nium","orum","icus","opus","chus","ngus","thus","rius","rpus"],JJ:["liac","siac","clad","deaf","xial","hial","chal","rpal","asal","rial","teal","oeal","vial","phal","sial","heal","rbal","neal","geal","dial","eval","bial","ugal","kian","izan","rtan","odan","llan","zian","eian","eyan","ndan","eban","near","unar","lear","liar","-day","-way","tech","sick","tuck","inct","unct","wide","endo","uddy","eedy","uted","aled","rred","oned","rted","obed","oped","ched","dded","cted","tied","eked","ayed","rked","teed","mmed","tred","awed","rbed","bbed","axed","bred","pied","cked","rced","ened","fied","lved","mned","kled","hted","lied","eted","rded","lued","rved","azed","oked","ghed","sked","emed","aded","ived","mbed","pted","zled","ored","pled","wned","afed","nied","aked","gued","oded","oved","oled","ymed","lled","bled","cled","eded","toed","ited","oyed","eyed","ured","omed","ixed","pped","ined","lted","iced","exed","nded","amed","owed","dged","nted","eged","nned","used","ibed","nced","umed","dled","died","rged","aped","oted","uled","ided","nked","aved","rled","rned","aned","rmed","lmed","aged","ized","eved","ofed","thed","ered","ared","ated","eled","sted","ewed","nsed","nged","lded","gged","osed","fled","shed","aced","ffed","tted","uced","iled","uded","ired","yzed","-fed","mped","iked","fted","imed","hree","llel","aten","lden","nken","apen","ozen","ober","-set","nvex","osey","laid","paid","xvii","xxii","-air","tair","icit","knit","nlit","xxiv","-six","-old","held","cile","ible","able","gile","full","-ply","bbly","ggly","zzly","-one","mane","mune","rung","uing","mant","yant","uant","pant","urnt","awny","eeny","ainy","orny","siny","tood","shod","-toe","d-on","-top","-for","odox","wept","eepy","oopy","hird","dern","worn","mart","ltry","oury","ngry","arse","bose","cose","mose","iose","gish","kish","pish","wish","vish","yish","owsy","ensy","easy","ifth","edth","urth","ixth","00th","ghth","ilty","orty","ifty","inty","ghty","kety","afty","irty","roud","true","wful","dful","rful","mful","gful","lful","hful","kful","iful","yful","sful","tive","cave","sive","five","cive","xxvi","urvy","nown","hewn","lown","-two","lowy","ctyl"],VB:["wrap","hear","draw","rlay","away","elay","duce","esce","elch","ooch","pick","huck","back","hack","ruct","lict","nect","vict","eact","tect","vade","lude","vide","rude","cede","ceed","ivel","hten","rken","shen","open","quer","over","efer","eset","uiet","pret","ulge","lign","pugn","othe","rbid","raid","veil","vail","roil","join","dain","feit","mmit","erit","voke","make","weld","uild","idle","rgle","otle","rble","self","fill","till","eels","sult","pply","sume","dime","lame","lump","rump","vene","cook","look","from","elop","grow","adow","ploy","sorb","pare","uire","jure","lore","surf","narl","earn","ourn","hirr","tort","-fry","uise","lyse","sise","hise","tise","nise","lise","rise","anse","gise","owse","oosh","resh","cuss","uess","sess","vest","inst","gest","fest","xist","into","ccur","ieve","eive","olve","down","-dye","laze","lyze","raze","ooze"],RB:["that","oubt","much","diem","high","atim","sely","nely","ibly","lely","dely","ally","gely","imly","tely","ully","ably","owly","vely","cely","mely","mply","ngly","exly","ffly","rmly","rely","uely","time","iori","oors","wise","orst","east","ways"]};t.exports=Object.keys(n).reduce(function(e,t){return n[t].forEach(function(i){e[i]=t}),e},{})},{}],29:[function(e,t,i){t.exports=[[".[cts]hy$","JJ"],[".[st]ty$","JJ"],[".[lnr]ize$","VB"],[".[gk]y$","JJ"],[".fies$","VB"],[".some$","JJ"],[".[nrtumcd]al$","JJ"],[".que$","JJ"],[".[tnl]ary$","JJ"],[".[di]est$","JJS"],["^(un|de|re)\\-[a-z]..","VB"],[".lar$","JJ"],["[bszmp]{2}y","JJ"],[".zes$","VB"],[".[icldtgrv]ent$","JJ"],[".[rln]ates$","VBZ"],[".[oe]ry$","JJ"],["[rdntkdhs]ly$","RB"],[".[lsrnpb]ian$","JJ"],[".[^aeiou]ial$","JJ"],[".[^aeiou]eal$","JJ"],[".[vrl]id$","JJ"],[".[ilk]er$","JJR"],[".ike$","JJ"],[".ends$","VB"],[".wards$","RB"],[".rmy$","JJ"],[".rol$","NN"],[".tors$","NN"],[".azy$","JJ"],[".where$","RB"],[".ify$","VB"],[".bound$","JJ"],[".ens$","VB"],[".oid$","JJ"],[".vice$","NN"],[".rough$","JJ"],[".mum$","JJ"],[".teen(th)?$","CD"],[".oses$","VB"],[".ishes$","VB"],[".ects$","VB"],[".tieth$","CD"],[".ices$","NN"],[".bles$","VB"],[".pose$","VB"],[".ions$","NN"],[".ean$","JJ"],[".[ia]sed$","JJ"],[".tized$","VB"],[".llen$","JJ"],[".fore$","RB"],[".ances$","NN"],[".gate$","VB"],[".nes$","VB"],[".less$","RB"],[".ried$","JJ"],[".gone$","JJ"],[".made$","JJ"],[".[pdltrkvyns]ing$","JJ"],[".tions$","NN"],[".tures$","NN"],[".ous$","JJ"],[".ports$","NN"],[". so$","RB"],[".ints$","NN"],[".[gt]led$","JJ"],["[aeiou].*ist$","JJ"],[".lked$","VB"],[".fully$","RB"],[".*ould$","MD"],["^-?[0-9]+(.[0-9]+)?$","CD"],["[a-z]*\\-[a-z]*\\-","JJ"],["[a-z]'s$","NNO"],[".'n$","VB"],[".'re$","CP"],[".'ll$","MD"],[".'t$","VB"],[".tches$","VB"],["^https?:?//[a-z0-9]","CD"],["^www.[a-z0-9]","CD"],[".ize$","VB"],[".[^aeiou]ise$","VB"],[".[aeiou]te$","VB"],[".ea$","NN"],["[aeiou][pns]er$","NN"],[".ia$","NN"],[".sis$","NN"],[".[aeiou]na$","NN"],[".[^aeiou]ity$","NN"],[".[^aeiou]ium$","NN"],[".[^aeiou][ei]al$","JJ"],[".ffy$","JJ"],[".[^aeiou]ic$","JJ"],[".(gg|bb|zz)ly$","JJ"],[".[aeiou]my$","JJ"],[".[aeiou]ble$","JJ"],[".[^aeiou]ful$","JJ"],[".[^aeiou]ish$","JJ"],[".[^aeiou]ica$","NN"],["[aeiou][^aeiou]is$","NN"],["[^aeiou]ard$","NN"],["[^aeiou]ism$","NN"],[".[^aeiou]ity$","NN"],[".[^aeiou]ium$","NN"],[".[lstrn]us$","NN"],["..ic$","JJ"],["[aeiou][^aeiou]id$","JJ"],[".[^aeiou]ish$","JJ"],[".[^aeiou]ive$","JJ"],["[ea]{2}zy$","JJ"]].map(function(e){return{reg:new RegExp(e[0],"i"),pos:e[1]}})},{}],30:[function(e,t,i){t.exports=function(e){for(var t=[{reg:/([^aeiou][iy])s(e|ed|es|ing)?$/,repl:"$1z$2"},{reg:/(..)our(ly|y|ite)?$/,repl:"$1or$2"},{reg:/([^cdnv])re(s)?$/,repl:"$1er$2"},{reg:/([aeiou])xion([ed])?$/,repl:"$1tion$2"},{reg:/logue$/,repl:"log"},{reg:/([o|a])e/,repl:"e"},{reg:/e(ing|able)$/,repl:"$1"},{reg:/([aeiou]+[^aeiou]+[aeiou]+)ll(ful|ment|est|ing|or|er|ed)$/,repl:"$1l$2"}],i=0;i<t.length;i++)if(e.match(t[i].reg))return e.replace(t[i].reg,t[i].repl);return e}},{}],31:[function(e,t,i){t.exports=function(e){for(var t=[{reg:/([^aeiou][iy])z(e|ed|es|ing)?$/,repl:"$1s$2"},{reg:/([aeiou]+[^aeiou]+[aeiou]+)l(ful|ment|est|ing|or|er|ed)$/,repl:"$1ll$2",exceptions:[]}],i=0;i<t.length;i++)if(e.match(t[i].reg))return e.replace(t[i].reg,t[i].repl);return e}},{}],32:[function(e,t,i){t.exports=function(e){var t=[],i=function(e){if(e=e.map(function(e){return e=e.replace(/^ */,""),e=e.replace(/ *$/,"")}),e.length>2)return e;var t=[/^[^aeiou]?ion/,/^[^aeiou]?ised/,/^[^aeiou]?iled/],i=e.length;if(i>1)for(var n=e[i-2]+e[i-1],r=0;r<t.length;r++)n.match(t[r])&&(e[i-2]=e[i-2]+e[i-1],e.pop());return e},n=function(e){var i=/[aeiouy]$/;if(e){for(var r=e.split(""),o="",s="",a="",h=0;h<r.length;h++){o=r.slice(0,h).join(""),a=r[h],s=r.slice(h+1,r.length).join("");var l=o+r[h];if(o.match(i)&&!a.match(i))return s.match(/^e[sm]/)&&(l+="e",s=s.replace(/^e/,"")),t.push(l),n(s);if(l.match(/(eo|eu|ia|oa|ua|ui)$/i))return t.push(o),t.push(a),n(s)}e.match(/[aiouy]/)||e.match(/ee$/)?t.push(e):t[t.length-1]=(t[t.length-1]||"")+e}};return e.split(/\s\-/).forEach(function(e){n(e)}),t=i(t),0===t.length&&(t=[e]),t}},{}],33:[function(e,t,i){t.exports=function(e,t){t=t||{};var i,n,r,o,s,a=t.min_count||1,h=t.max_size||5,l=/[^a-zA-Z'\-]+/g,c=[null],u=[];for(h++,i=1;h>=i;i++)c.push({});for(e=e.replace(l," ").replace(/^\s+/,"").replace(/\s+$/,""),e=e.toLowerCase(),e=e.split(/\s+/),i=0,o=e.length;o>i;i++)for(s=e[i],c[1][s]=(c[1][s]||0)+1,n=2;h>=n&&o>=i+n;n++)s+=" "+e[i+n-1],c[n][s]=(c[n][s]||0)+1;for(i=void 0,r=1;h>r;r++){u[r]=[];var p=c[r];for(i in p)p.hasOwnProperty(i)&&p[i]>=a&&u[r].push({word:i,count:p[i],size:r})}return u=u.filter(function(e){return null!==e}),u=u.map(function(e){return e=e.sort(function(e,t){return t.count-e.count})})}},{}],34:[function(e,t,n){t.exports=function(t){var n=e("../../data/lexicon/abbreviations"),r=[],o=t.split(/(\S.+?[.\?!])(?=\s+|$|")/g);n=n.concat(["jan","feb","mar","apr","jun","jul","aug","sep","oct","nov","dec","sept","sep"]),n=n.concat(["ex","eg","ie","circa","ca","cca","vs","etc","esp","ft","bc","ad"]);var s=new RegExp("\\b("+n.join("|")+")[.!?] ?$","i"),a=new RegExp("[ |.][A-Z].?$","i"),h=new RegExp("\\.\\.\\.*$"),l=o.length;for(i=0;i<l;i++)o[i]&&(o[i]=o[i].replace(/^\s+|\s+$/g,""),o[i+1]&&o[i].match(s)||o[i].match(a)||o[i].match(h)?o[i+1]=((o[i]||"")+" "+(o[i+1]||"")).replace(/ +/g," "):o[i]&&o[i].length>0&&(r.push(o[i]),o[i]=""));return 0===r.length?[t]:r}},{"../../data/lexicon/abbreviations":16}],35:[function(e,t,i){var n=e("./sentence"),r=e("../../data/lexicon/multiples"),o=Object.keys(r).map(function(e){return e.split(" ")}),s=function(e){return e?(e=e.toLowerCase(),e=e.replace(/[,\.!:;\?\(\)]/,""),e=e.replace(//g,"'"),e=e.replace(/"/g,""),e=e.replace(/[\u2018\u2019\u201A\u201B\u2032\u2035]+/g,"'"),e=e.replace(/[\u201C\u201D\u201E\u201F\u2033\u2036]+/g,'"'),e.match(/[a-z0-9]/i)?e:""):""},a=function(e){return e.match(/\?$/)?"interrogative":e.match(/\!$/)?"exclamative":"declarative"},h=function(e){for(var t=[],i=e.map(function(e){return s(e)}),n=0;n<e.length;n++){for(var r=0;r<o.length;r++)if(e[n+1]&&i[n]===o[r][0]&&i[n+1]===o[r][1]){e[n]=e[n]+" "+e[n+1],e[n+1]=null;break}t.push(e[n])}return t.filter(function(e){return e})},l=function(e){var t=n(e);return t.map(function(e){var t=e.split(" ");t=h(t);var i=t.map(function(e,i){return{text:e,normalised:s(e),title_case:null!==e.match(/^[A-Z][a-z]/),noun_capital:i>0&&null!==e.match(/^[A-Z][a-z]/),punctuated:null!==e.match(/[,;:\(\)"]/)||void 0,end:i===t.length-1||void 0,start:0===i||void 0}});return{sentence:e,tokens:i,type:a(e)}})};t.exports=l},{"../../data/lexicon/multiples":22,"./sentence":34}],36:[function(e,t,i){var n={2:"",3:"",5:"",8:"","!":"","?":"",a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",I:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:""},r=[];Object.keys(n).forEach(function(e){n[e].split("").forEach(function(t){r.push([t,e])})});var o={},s={};r.forEach(function(e){o[e[0]]=e[1],s[e[1]]=e[0]});var a=function(e,t){t=t||{},t.percentage=t.percentage||50;var i=e.split("").map(function(e){var i=100*Math.random();return o[e]&&i<t.percentage?o[e]||e:e});return i.join("")},h=function(e,t){t=t||{},t.percentage=t.percentage||50;var i=e.split("").map(function(e){var i=100*Math.random();return s[e]&&i<t.percentage?s[e]||e:e});return i.join("")};t.exports={normalize:a,denormalize:h}},{}],37:[function(e,t,i){t.exports=["absurd","aggressive","alert","alive","awesome","beautiful","big","bitter","black","blue","bored","boring","brash","brave","brief","bright","broad","brown","calm","charming","cheap","clean","cold","cool","cruel","cute","damp","deep","dear","dead","dark","dirty","drunk","dull","eager","efficient","even","faint","fair","fanc","fast","fat","feeble","few","fierce","fine","flat","forgetful","frail","full","gentle","glib","great","green","gruesome","handsome","hard","harsh","high","hollow","hot","impolite","innocent","keen","kind","lame","lean","light","little","loose","long","loud","low","lush","macho","mean","meek","mellow","mundane","near","neat","new","nice","normal","odd","old","pale","pink","plain","poor","proud","purple","quick","rare","rapid","red","rich","ripe","rotten","round","rude","sad","safe","scarce","scared","shallow","sharp","short","shrill","simple","slim","slow","small","smart","smooth","soft","sore","sour","square","stale","steep","stiff","straight","strange","strong","sweet","swift","tall","tame","tart","tender","tense","thick","thin","tight","tough","vague","vast","vulgar","warm","weak","wet","white","wide","wild","wise","young","yellow","easy","narrow","late","early","soon","close","empty","dry","windy","noisy","thirsty","hungry","fresh","quiet","clear","heavy","happy","funny","lucky","pretty","important","interesting","attractive","dangerous","intellegent","pure","orange","large","firm","grand","formal","raw","weird","glad","mad","strict","tired","solid","extreme","mature","true","free","curly","angry"].reduce(function(e,t){return e[t]=!0,e},{})},{}],38:[function(e,t,i){var n=function(e){var t={idle:"idly","public":"publicly",vague:"vaguely",day:"daily",icy:"icily",single:"singly",female:"womanly",male:"manly",simple:"simply",whole:"wholly",special:"especially",straight:"straight",wrong:"wrong",fast:"fast",hard:"hard",late:"late",early:"early",well:"well",best:"best",latter:"latter",bad:"badly"},i={foreign:1,black:1,modern:1,next:1,difficult:1,degenerate:1,young:1,awake:1,back:1,blue:1,brown:1,orange:1,complex:1,cool:1,dirty:1,done:1,empty:1,fat:1,fertile:1,frozen:1,gold:1,grey:1,gray:1,green:1,medium:1,parallel:1,outdoor:1,unknown:1,undersized:1,used:1,welcome:1,yellow:1,white:1,fixed:1,mixed:1,"super":1,guilty:1,tiny:1,able:1,unable:1,same:1,adult:1},n=[{reg:/al$/i,repl:"ally"},{reg:/ly$/i,repl:"ly"},{reg:/(.{3})y$/i,repl:"$1ily"},{reg:/que$/i,repl:"quely"},{reg:/ue$/i,repl:"uly"},{reg:/ic$/i,repl:"ically"},{reg:/ble$/i,repl:"bly"},{reg:/l$/i,repl:"ly"}],r=[/airs$/,/ll$/,/ee.$/,/ile$/];if(i[e])return null;if(t[e])return t[e];if(e.length<=3)return null;var o;for(o=0;o<r.length;o++)if(e.match(r[o]))return null;for(o=0;o<n.length;o++)if(e.match(n[o].reg))return e.replace(n[o].reg,n[o].repl);return e+"ly"};t.exports=n},{}],39:[function(e,t,i){var n=e("./convertables"),r=function(e){var t={grey:"greyer",gray:"grayer",green:"greener",yellow:"yellower",red:"redder",good:"better",well:"better",bad:"worse",sad:"sadder"},i={overweight:1,main:1,nearby:1,asleep:1,weekly:1,secret:1,certain:1},r=[{reg:/y$/i,repl:"ier"},{reg:/([aeiou])t$/i,repl:"$1tter"},{reg:/([aeou])de$/i,repl:"$1der"},{reg:/nge$/i,repl:"nger"}],o=[/ght$/,/nge$/,/ough$/,/ain$/,/uel$/,/[au]ll$/,/ow$/,/old$/,/oud$/,/e[ae]p$/],s=[/ary$/,/ous$/];if(i.hasOwnProperty(e))return null;for(a=0;a<r.length;a++)if(e.match(r[a].reg))return e.replace(r[a].reg,r[a].repl);if(n.hasOwnProperty(e))return e.match(/e$/)?e+"r":e+"er";if(t.hasOwnProperty(e))return t[e];var a;for(a=0;a<s.length;a++)if(e.match(s[a]))return"more "+e;for(a=0;a<o.length;a++)if(e.match(o[a]))return e+"er";return"more "+e};t.exports=r},{"./convertables":37}],40:[function(e,t,i){t.exports=function(e){var t={clean:"cleanliness",naivety:"naivety"};if(!e)return"";if(t.hasOwnProperty(e))return t[e];if(e.match(" "))return e;if(e.match(/w$/))return e;for(var i=[{reg:/y$/,repl:"iness"},{reg:/le$/,repl:"ility"},{reg:/ial$/,repl:"y"},{reg:/al$/,repl:"ality"},{reg:/ting$/,repl:"ting"},{reg:/ring$/,repl:"ring"},{reg:/bing$/,repl:"bingness"},{reg:/sing$/,repl:"se"},{reg:/ing$/,repl:"ment"},{reg:/ess$/,repl:"essness"},{reg:/ous$/,repl:"ousness"}],n=0;n<i.length;n++)if(e.match(i[n].reg))return e.replace(i[n].reg,i[n].repl);return e.match(/s$/)?e:e+"ness"}},{}],41:[function(e,t,i){var n=e("./convertables");t.exports=function(e){var t={nice:"nicest",late:"latest",hard:"hardest",inner:"innermost",outer:"outermost",far:"furthest",worse:"worst",bad:"worst",good:"best"},i={overweight:1,ready:1},r=[{reg:/y$/i,repl:"iest"},{reg:/([aeiou])t$/i,repl:"$1ttest"},{reg:/([aeou])de$/i,repl:"$1dest"},{reg:/nge$/i,repl:"ngest"}],o=[/ght$/,/nge$/,/ough$/,/ain$/,/uel$/,/[au]ll$/,/ow$/,/oud$/,/...p$/],s=[/ary$/],a=function(e){return e.match(/e$/)?e+"st":e+"est"};for(h=0;h<r.length;h++)if(e.match(r[h].reg))return e.replace(r[h].reg,r[h].repl);if(n.hasOwnProperty(e))return a(e);if(i.hasOwnProperty(e))return"most "+e;if(t.hasOwnProperty(e))return t[e];var h;for(h=0;h<s.length;h++)if(e.match(s[h]))return"most "+e;for(h=0;h<o.length;h++)if(e.match(o[h]))return a(e);return"most "+e}},{"./convertables":37}],42:[function(e,t,i){var n=function(t,i,n){var r=this;r.word=t||"";var o=e("./conjugate/to_comparative"),s=e("./conjugate/to_superlative"),a=e("./conjugate/to_adverb"),h=e("./conjugate/to_noun"),l=e("../../data/parts_of_speech");return r.conjugate=function(){return{comparative:o(r.word),superlative:s(r.word),adverb:a(r.word),noun:h(r.word)}},r.which=function(){return r.word.match(/..est$/)?l.JJS:r.word.match(/..er$/)?l.JJR:l.JJ}(),r};t.exports=n},{"../../data/parts_of_speech":27,"./conjugate/to_adverb":38,"./conjugate/to_comparative":39,"./conjugate/to_noun":40,"./conjugate/to_superlative":41}],43:[function(e,t,i){t.exports=function(e){var t={idly:"idle",sporadically:"sporadic",basically:"basic",grammatically:"grammatical",alphabetically:"alphabetical",economically:"economical",conically:"conical",politically:"political",vertically:"vertical",practically:"practical",theoretically:"theoretical",critically:"critical",fantastically:"fantastic",mystically:"mystical",pornographically:"pornographic",fully:"full",jolly:"jolly",wholly:"whole"},i=[{reg:/bly$/i,repl:"ble"},{reg:/gically$/i,repl:"gical"},{reg:/([rsdh])ically$/i,repl:"$1ical"},{reg:/ically$/i,repl:"ic"},{reg:/uly$/i,repl:"ue"},{reg:/ily$/i,repl:"y"},{reg:/(.{3})ly$/i,repl:"$1"}];if(t.hasOwnProperty(e))return t[e];for(var n=0;n<i.length;n++)if(e.match(i[n].reg))return e.replace(i[n].reg,i[n].repl);return e}},{}],44:[function(e,t,i){var n=function(t,i,n){var r=this;r.word=t||"";var o=e("./conjugate/to_adjective"),s=e("../../data/parts_of_speech");return r.conjugate=function(){return{adjective:o(r.word)}},r.which=function(){return r.word.match(/..est$/)?s.RBS:r.word.match(/..er$/)?s.RBR:s.RB}(),r};t.exports=n},{"../../data/parts_of_speech":27,"./conjugate/to_adjective":43}],45:[function(e,t,i){var n,r=e("../../../data/lexicon/uncountables"),o=e("../../../data/lexicon/irregular_nouns"),s=r.reduce(function(e,t){return e[t]=!0,e},{}),a=function(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""},h=[["he","they"],["she","they"],["this","these"],["that","these"],["mine","ours"],["hers","theirs"],["his","theirs"],["i","we"],["move","_s"],["myself","ourselves"],["yourself","yourselves"],["himself","themselves"],["herself","themselves"],["themself","themselves"],["its","theirs"],["theirs","_"]];h=h.concat(o);var l=[[/(ax|test)is$/i,"$1es"],[/(octop|vir|radi|nucle|fung|cact|stimul)us$/i,"$1i"],[/(octop|vir)i$/i,"$1i"],[/([rl])f$/i,"$1ves"],[/(alias|status)$/i,"$1es"],[/(bu)s$/i,"$1ses"],[/(al|ad|at|er|et|ed|ad)o$/i,"$1oes"],[/([ti])um$/i,"$1a"],[/([ti])a$/i,"$1a"],[/sis$/i,"ses"],[/(?:([^f])fe|([lr])f)$/i,"$1ves"],[/(hive)$/i,"$1s"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/(x|ch|ss|sh|s|z)$/i,"$1es"],[/(matr|vert|ind|cort)(ix|ex)$/i,"$1ices"],[/([m|l])ouse$/i,"$1ice"],[/([m|l])ice$/i,"$1ice"],[/^(ox)$/i,"$1en"],[/^(oxen)$/i,"$1"],[/(quiz)$/i,"$1zes"],[/(antenn|formul|nebul|vertebr|vit)a$/i,"$1ae"],[/(sis)$/i,"ses"],[/^(?!talis|.*hu)(.*)man$/i,"$1men"],[/(.*)/i,"$1s"]].map(function(e){return{reg:e[0],repl:e[1]}}),c=function(e){var t=e.toLowerCase();if(s[t])return e;if(d(t)===!0)return e;var i=h.filter(function(e){return e[0]===t});if(i[0])return a(t)===e?a(i[0][1]):i[0][1];if(e.match(/([a-z]*) (of|in|by|for) [a-z]/)){var r=(e.match(/^([a-z]*) (of|in|by|for) [a-z]/)||[])[1];if(r){var o=c(r);return o+e.replace(r,"")}}for(n=0;n<l.length;n++)if(e.match(l[n].reg))return e.replace(l[n].reg,l[n].repl)},u=[[/([^v])ies$/i,"$1y"],[/ises$/i,"isis"],[/ives$/i,"ife"],[/(antenn|formul|nebul|vertebr|vit)ae$/i,"$1a"],[/(octop|vir|radi|nucle|fung|cact|stimul)(i)$/i,"$1us"],[/(buffal|tomat|tornad)(oes)$/i,"$1o"],[/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$/i,"$1sis"],[/(vert|ind|cort)(ices)$/i,"$1ex"],[/(matr|append)(ices)$/i,"$1ix"],[/(x|ch|ss|sh|s|z|o)es$/i,"$1"],[/men$/i,"man"],[/(n)ews$/i,"$1ews"],[/([ti])a$/i,"$1um"],[/([^f])ves$/i,"$1fe"],[/([lr])ves$/i,"$1f"],[/([^aeiouy]|qu)ies$/i,"$1y"],[/(s)eries$/i,"$1eries"],[/(m)ovies$/i,"$1ovie"],[/([m|l])ice$/i,"$1ouse"],[/(cris|ax|test)es$/i,"$1is"],[/(alias|status)es$/i,"$1"],[/(ss)$/i,"$1"],[/(ics)$/i,"$1"],[/s$/i,""]].map(function(e){return{reg:e[0],repl:e[1]}}),p=function(e){var t=e.toLowerCase();if(s[t])return e;if(d(t)===!1)return e;var i=h.filter(function(e){return e[1]===t});if(i[0])return a(t)===e?a(i[0][0]):i[0][0];if(e.match(/([a-z]*) (of|in|by|for) [a-z]/)){var r=e.match(/^([a-z]*) (of|in|by|for) [a-z]/);if(r&&r[1]){var o=p(r[1]);return o+e.replace(r[1],"")}}for(n=0;n<u.length;n++)if(e.match(u[n].reg))return e.replace(u[n].reg,u[n].repl);return e},d=function(e){e=(e||"").toLowerCase();var t=e.match(/([a-z]*) (of|in|by|for) [a-z]/);for(t&&t[1]&&(e=t[1]),n=0;n<h.length;n++){if(h[n][1]===e)return!0;if(h[n][0]===e)return!1}var i=[/(^v)ies$/i,/ises$/i,/ives$/i,/(antenn|formul|nebul|vertebr|vit)ae$/i,/(octop|vir|radi|nucle|fung|cact|stimul)i$/i,/(buffal|tomat|tornad)oes$/i,/(analy|ba|diagno|parenthe|progno|synop|the)ses$/i,/(vert|ind|cort)ices$/i,/(matr|append)ices$/i,/(x|ch|ss|sh|s|z|o)es$/i,/men$/i,/news$/i,/.tia$/i,/(^f)ves$/i,/(lr)ves$/i,/(^aeiouy|qu)ies$/i,/(m|l)ice$/i,/(cris|ax|test)es$/i,/(alias|status)es$/i,/ics$/i];
for(n=0;n<i.length;n++)if(e.match(i[n]))return!0;var r=[/(ax|test)is$/i,/(octop|vir|radi|nucle|fung|cact|stimul)us$/i,/(octop|vir)i$/i,/(rl)f$/i,/(alias|status)$/i,/(bu)s$/i,/(al|ad|at|er|et|ed|ad)o$/i,/(ti)um$/i,/(ti)a$/i,/sis$/i,/(?:(^f)fe|(lr)f)$/i,/hive$/i,/(^aeiouy|qu)y$/i,/(x|ch|ss|sh|z)$/i,/(matr|vert|ind|cort)(ix|ex)$/i,/(m|l)ouse$/i,/(m|l)ice$/i,/(antenn|formul|nebul|vertebr|vit)a$/i,/.sis$/i,/^(?!talis|.*hu)(.*)man$/i];for(n=0;n<r.length;n++)if(e.match(r[n]))return!1;return e.match(/s$/)&&!e.match(/ss$/)&&e.length>3?!0:!1},f=function(e){return s[e]?{plural:e,singular:e}:d(e)?{plural:e,singular:p(e)}:{singular:e,plural:c(e)}};t.exports={inflect:f,is_plural:d,singularize:p,pluralize:c}},{"../../../data/lexicon/irregular_nouns":21,"../../../data/lexicon/uncountables":24}],46:[function(e,t,i){t.exports=function(e){if(!e)return null;var t={hour:"an",heir:"an",heirloom:"an",honest:"an",honour:"an",honor:"an",uber:"an"},i=function(e){return e.length<=5&&e.match(/^[A-Z]*$/)?!0:e.length>=4&&e.match(/^([A-Z]\.)*$/)?!0:!1},n={A:!0,E:!0,F:!0,H:!0,I:!0,L:!0,M:!0,N:!0,O:!0,R:!0,S:!0,X:!0},r=[/^onc?e/i,/^u[bcfhjkqrstn][aeiou]/i,/^eul/i];if(t.hasOwnProperty(e))return t[e];if(i(e)&&n.hasOwnProperty(e.substr(0,1)))return"an";for(var o=0;o<r.length;o++)if(e.match(r[o]))return"a";return e.match(/^[aeiou]/i)?"an":"a"}},{}],47:[function(e,t,n){var r=function(t,n,r){var o,s,a=this;void 0!==n&&void 0!==r&&(o=n.tokens[r],s=n.tokens[r+i]),a.word=t||"";var h=e("../../data/parts_of_speech"),l=e("../../data/lexicon/firstnames"),c=e("../../data/lexicon/honourifics"),u=e("./conjugate/inflect"),p=e("./indefinite_article"),d={it:"PRP",they:"PRP",i:"PRP",them:"PRP",you:"PRP",she:"PRP",me:"PRP",he:"PRP",him:"PRP",her:"PRP",us:"PRP",we:"PRP",thou:"PRP"},f={itself:1,west:1,western:1,east:1,eastern:1,north:1,northern:1,south:1,southern:1,the:1,one:1,your:1,my:1,today:1,yesterday:1,tomorrow:1,era:1,century:1,it:1},m={his:"he",her:"she",hers:"she",their:"they",theirs:"they",them:"they",its:"it",mine:"i",yours:"you",our:"we",ours:"we"};return a.is_acronym=function(){var e=a.word;return e.length<=5&&e.match(/^[A-Z]*$/)?!0:e.length>=4&&e.match(/^([A-Z]\.)*$/)?!0:!1},a.is_entity=function(){if(!o)return!1;if(o.normalised.length<3||!o.normalised.match(/[a-z]/i))return!1;if(d[o.normalised])return!1;if(f[o.normalised])return!1;if(o.pos){if("NNA"==o.pos.tag)return!1;if("NNO"==o.pos.tag)return!1;if("NNG"==o.pos.tag)return!1;if("NNP"==o.pos.tag)return!0}return o.noun_capital?!0:o.normalised.match(/ /)?!0:o.normalised.match(/\./)?!0:o.normalised.length<5&&o.text.match(/^[A-Z]*$/)?!0:a.is_acronym()?!0:!1},a.conjugate=function(){return u.inflect(a.word)},a.is_plural=function(){return u.is_plural(a.word)},a.article=function(){return a.is_plural()?"the":p(a.word)},a.pluralize=function(){return u.pluralize(a.word)},a.singularize=function(){return u.singularize(a.word)},a.is_person=function(){var e,t,i=["center","centre","memorial","school","bridge","university","house","college","square","park","foundation","institute","club","museum","arena","stadium","ss","of","the","for","and","&","co","sons"];for(t=i.length,e=0;t>e;e++)if(a.word.match(new RegExp("\\b"+i[e]+"\\b","i")))return!1;for(t=c.length,e=0;t>e;e++)if(a.word.match(new RegExp("\\b"+c[e]+"\\.?\\b","i")))return!0;var n=a.word.split(" ").map(function(e){return e.toLowerCase()});return l[n[0]]?!0:n.length>2&&l[n[1]]?!0:a.word.match(/[a-z]{3,20} [a-z]\.? [a-z]{3,20}/i)?!0:!1},a.pronoun=function(){if(a.is_person()){var e=a.word.split(" ").map(function(e){return e.toLowerCase()});return"m"===l[e[0]]||"m"==l[e[1]]?"he":"f"===l[e[0]]||"f"==l[e[1]]?"she":a.word.match(/^(mrs|miss|ms|misses|mme|mlle)\.? /,"i")?"she":a.word.match(/\b(mr|mister|sr|jr)\b/,"i")?"he":"a"===l[e[0]]||"a"==l[e[1]]?"they":e[0].match(/[aeiy]$/)?"she":e[0].match(/[ou]$/)?"he":e[0].match(/(nn|ll|tt)/)?"she":"they"}return a.is_plural()?"they":"it"},a.referenced_by=function(){if(o&&"PRP"!==o.pos.tag&&"PP"!==o.pos.tag){var e=a.pronoun(),t=n.tokens.slice(r+1,n.tokens.length);n.next&&(t=t.concat(n.next.tokens));for(var i=[],s=0;s<t.length;s++)if("PRP"!==t[s].pos.tag||t[s].normalised!==e&&m[t[s].normalised]!==e){if("PP"===t[s].pos.tag&&m[t[s].normalised]===e)i.push(t[s]);else if("noun"===t[s].pos.parent&&t[s].analysis.pronoun()===e)break}else i.push(t[s]);return i}return[]},a.reference_to=function(){if(o&&("PRP"===o.pos.tag||"PP"===o.pos.tag)){var e=o.normalised;void 0!==m[e]&&(e=m[e]);var t=n.tokens.slice(0,r);n.last&&(t=n.last.tokens.concat(t)),t=t.reverse();for(var i=0;i<t.length;i++)if("noun"===t[i].pos.parent&&"PRP"!==t[i].pos.tag&&t[i].analysis.pronoun()===e)return t[i]}},a.which=function(){return a.word.match(/'s$/)?h.NNO:h.NN}(),a};t.exports=r},{"../../data/lexicon/firstnames":19,"../../data/lexicon/honourifics":20,"../../data/parts_of_speech":27,"./conjugate/inflect":45,"./indefinite_article":46}],48:[function(e,t,i){var n=e("./adjective/index"),r=e("./noun/index"),o=e("./adverb/index"),s=e("./verb/index"),a=e("./value/index"),h={adjective:function(e,t,i,r){return new n(e,t,i,r)},noun:function(e,t,i,n){return new r(e,t,i,n)},adverb:function(e,t,i,n){return new o(e,t,i,n)},verb:function(e,t,i,n){return new s(e,t,i,n)},value:function(e,t,i,n){return new a(e,t,i,n)},glue:function(e,t,i,n){return{}}};t.exports=h},{"./adjective/index":42,"./adverb/index":44,"./noun/index":47,"./value/index":50,"./verb/index":57}],49:[function(e,t,i){var n="(january|february|march|april|may|june|july|august|september|october|november|december|jan|feb|mar|apr|aug|sept|oct|nov|dec),?",r="([0-9]{1,2}),?",o="([12][0-9]{3})",s=function(e,t){return Object.keys(t).reduce(function(i,n){return i[n]=e[t[n]],i},{})},a=[{reg:String(n)+" "+String(r)+"-"+String(r)+" "+String(o),example:"March 7th-11th 1987",process:function(e){e||(e=[]);var t={month:1,day:2,to_day:3,year:4};return s(e,t)}},{reg:String(r)+" of "+String(n)+" to "+String(r)+" of "+String(n)+" "+String(o),example:"28th of September to 5th of October 2008",process:function(e){e||(e=[]);var t={day:1,month:2,to_day:3,to_month:4,to_year:5};return s(e,t)}},{reg:String(n)+" "+String(r)+" to "+String(n)+" "+String(r)+" "+String(o),example:"March 7th to june 11th 1987",process:function(e){e||(e=[]);var t={month:1,day:2,to_month:3,to_day:4,year:5,to_year:5};return s(e,t)}},{reg:"between "+String(r)+" "+String(n)+" and "+String(r)+" "+String(n)+" "+String(o),example:"between 13 February and 15 February 1945",process:function(e){e||(e=[]);var t={day:1,month:2,to_day:3,to_month:4,year:5,to_year:5};return s(e,t)}},{reg:"between "+String(n)+" "+String(r)+" and "+String(n)+" "+String(r)+" "+String(o),example:"between March 7th and june 11th 1987",process:function(e){e||(e=[]);var t={month:1,day:2,to_month:3,to_day:4,year:5,to_year:5};return s(e,t)}},{reg:String(n)+" "+String(r)+" "+String(o),example:"March 1st 1987",process:function(e){e||(e=[]);var t={month:1,day:2,year:3};return s(e,t)}},{reg:String(r)+" - "+String(r)+" of "+String(n)+" "+String(o),example:"3rd - 5th of March 1969",process:function(e){e||(e=[]);var t={day:1,to_day:2,month:3,year:4};return s(e,t)}},{reg:String(r)+" of "+String(n)+" "+String(o),example:"3rd of March 1969",process:function(e){e||(e=[]);var t={day:1,month:2,year:3};return s(e,t)}},{reg:String(n)+" "+o+",? to "+String(n)+" "+String(o),example:"September 1939 to April 1945",process:function(e){e||(e=[]);var t={month:1,year:2,to_month:3,to_year:4};return s(e,t)}},{reg:String(n)+" "+String(o),example:"March 1969",process:function(e){e||(e=[]);var t={month:1,year:2};return s(e,t)}},{reg:String(n)+" "+r,example:"March 18th",process:function(e){e||(e=[]);var t={month:1,day:2};return s(e,t)}},{reg:String(r)+" of "+n,example:"18th of March",process:function(e){e||(e=[]);var t={month:2,day:1};return s(e,t)}},{reg:o+" ?- ?"+String(o),example:"1997-1998",process:function(e){e||(e=[]);var t={year:1,to_year:2};return s(e,t)}},{reg:o,example:"1998",process:function(e){e||(e=[]);var t={year:1};return s(e,t)}}].map(function(e){return e.reg=new RegExp(e.reg,"g"),e}),h={january:0,february:1,march:2,april:3,may:4,june:5,july:6,august:7,september:8,october:9,november:10,december:11,jan:0,feb:1,mar:2,apr:3,aug:7,sept:8,oct:9,nov:10,dec:11},l=[31,29,31,30,31,30,31,31,30,31,30,31],c=function(e){return e=e.toLowerCase(),e=e.replace(/([0-9])(th|rd|st)/g,"$1")},u=function(e,t){var i;return i=new Date,t=t||{},e.year=parseInt(e.year,10)||void 0,e.day=parseInt(e.day,10)||void 0,e.to_day=parseInt(e.to_day,10)||void 0,e.to_year=parseInt(e.to_year,10)||void 0,e.month=h[e.month],e.to_month=h[e.to_month],void 0!==e.to_month&&void 0===e.month&&(e.month=e.to_month),void 0===e.to_month&&void 0!==e.month&&(e.to_month=e.month),e.to_year&&!e.year&&(e.year=e.to_year),!e.to_year&&e.year&&void 0!==e.to_month&&(e.to_year=e.year),t.assume_year&&!e.year&&(e.year=i.getFullYear()),void 0!==e.day&&(e.day>31||void 0!==e.month&&e.day>l[e.month])&&(e.day=void 0),void 0!==e.to_month&&e.to_month<e.month?{}:(e.to_year&&e.to_year<e.year&&(e.year=void 0,e.to_year=void 0),(e.year>2090||e.year<1200)&&(e.year=void 0,e.to_year=void 0),e={day:e.day,month:e.month,year:e.year,to:{day:e.to_day,month:e.to_month,year:e.to_year}},e.year&&e.day&&void 0!==e.month&&(e.date_object=new Date,e.date_object.setYear(e.year),e.date_object.setMonth(e.month),e.date_object.setDate(e.day)),e.to.year&&e.to.day&&void 0!==e.to.month&&(e.to.date_object=new Date,e.to.date_object.setYear(e.to.year),e.to.date_object.setMonth(e.to.month),e.to.date_object.setDate(e.to.day)),e.year||void 0!==e.month?e:{})};t.exports=function(e,t){t=t||{},e=c(e);for(var i,n,r,o,s=a.length,h=0;s>h;h+=1)if(o=a[h],e.match(o.reg))return r=new RegExp(o.reg.source,"i"),i=r.exec(e),n=o.process(i),u(n,t)}},{}],50:[function(e,t,i){var n=function(t,i,n){var r=this;r.word=t||"";var o=e("./to_number"),s=e("./date_extractor"),a=e("../../data/parts_of_speech");return r.date=function(e){return e=e||{},s(r.word,e)},r.is_date=function(){var e=/(january|february|march|april|may|june|july|august|september|october|november|december|jan|feb|mar|apr|aug|sept|oct|nov|dec)/i,t=/1?[0-9]:[0-9]{2}/,i=/\b(monday|tuesday|wednesday|thursday|friday|saturday|sunday|mon|tues|wed|thurs|fri|sat|sun)\b/i;return r.word.match(e)||r.word.match(t)||r.word.match(i)?!0:!1},r.number=function(){return r.is_date()?null:o(r.word)},r.which=function(){return r.date()?a.DA:r.number()?a.NU:a.CD}(),r};t.exports=n},{"../../data/parts_of_speech":27,"./date_extractor":49,"./to_number":51}],51:[function(e,t,i){"use strict";var n={a:1,zero:0,one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,first:1,second:2,third:3,fourth:4,fifth:5,sixth:6,seventh:7,eighth:8,ninth:9},r={ten:10,eleven:11,twelve:12,thirteen:13,fourteen:14,fifteen:15,sixteen:16,seventeen:17,eighteen:18,nineteen:19,eleventh:11,twelfth:12,thirteenth:13,fourteenth:14,fifteenth:15,sixteenth:16,seventeenth:17,eighteenth:18,nineteenth:19},o={twenty:20,thirty:30,forty:40,fifty:50,sixty:60,seventy:70,eighty:80,ninety:90,twentieth:20,thirtieth:30,fourtieth:40,fiftieth:50,sixtieth:60,seventieth:70,eightieth:80,ninetieth:90},s={hundred:100,grand:1e3,thousand:1e3,million:1e6,billion:1e9,trillion:1e12,quadrillion:1e15,quintillion:1e18,sextillion:1e21,septillion:1e24,octillion:1e27,nonillion:1e30,decillion:1e33},a=function(e){var t=!1,i=!1,a=!1,h={},l=0,c=1;if(e=e.replace(/, ?/g,""),e=e.replace(/[$]/,""),e.match(/[0-9]\.[0-9]/)&&parseFloat(e)==e)return parseFloat(e);if(parseInt(e,10)==e)return parseInt(e,10);if(e.match(/[0-9][\-:][0-9]/))return null;var u=[{reg:/^(minus|negative)[\s\-]/i,mult:-1},{reg:/^(a\s)?half[\s\-](of\s)?/i,mult:.5},{reg:/^(a\s)?quarter[\s\-]/i,mult:.25}];for(v=0;v<u.length;v++)if(e.match(u[v].reg)){c=u[v].mult,e=e.replace(u[v].reg,"");break}for(var p,d,f=e.toString().split(/[\s\-]+/),m=0,y=1,g=!1,v=0;v<f.length;v++)if(p=f[v],"and"!=p)if("point"!=p&&"decimal"!=p){if(g){if(d=null,void 0!==n[p]&&(d=n[p]),void 0!==r[p]&&(d=r[p]),parseInt(p,10)==p&&(d=parseInt(p,10)),!d)return null;if(10>d){l+=d*y,y=.1*y,m=0;continue}if(100>d){l+=d*(.1*y),y=.01*y,m=0;continue}}if(p.match(/^[0-9]\.[0-9]$/))m+=parseFloat(p);else if(parseInt(p,10)!=p)if(void 0===n[p])if(r[p]){if(t)return null;if(i)return null;if(a)return null;i=!0,m+=r[p]}else if(o[p]){if(t)return null;if(i)return null;if(a)return null;a=!0,m+=o[p]}else{if(!s[p])return null;if(h[p])return null;h[p]=!0,t=!1,i=!1,a=!1,0===m?(l=l||1,l*=s[p]):(m*=s[p],l+=m),m=0}else{if(t)return null;if(i)return null;t=!0,m+=n[p]}else m+=parseInt(p,10)}else{if(g)return null;g=!0,l+=m,m=0,t=!1,y=.1}return m&&(l+=(m||1)*y),l*=c};t.exports=a},{}],52:[function(e,t,n){var r=e("./to_doer"),o=e("./verb_irregulars"),s=e("./verb_rules"),a=e("./suffix_rules"),h=function(e){var t=function(e,t){return-1!==e.indexOf(t,e.length-t.length)},n=Object.keys(a);for(i=0;i<n.length;i++)if(t(e,n[i]))return a[n[i]];return"infinitive"},l=function(e){var t;t=e.length>4?e.replace(/ed$/,""):e.replace(/d$/,"");var i,n,o,s;return e.match(/[^aeiou]$/)?(o=e+"ing",n=e+"ed",i=e.match(/ss$/)?e+"es":e+"s",s=r(t)):(o=e.replace(/[aeiou]$/,"ing"),n=e.replace(/[aeiou]$/,"ed"),i=e.replace(/[aeiou]$/,"es"),s=r(t)),{infinitive:t,present:i,past:n,gerund:o,doer:s,future:"will "+t}},c=function(e,t){return e.infinitive?(e.gerund||(e.gerund=e.infinitive+"ing"),e.doer||(e.doer=r(e.infinitive)),e.present||(e.present=e.infinitive+"s"),e.past||(e.past=e.infinitive+"ed"),t&&Object.keys(e).forEach(function(i){e[i]=t+e[i]}),e.future||(e.future="will "+e.infinitive),e.perfect||(e.perfect="have "+e.past),e.pluperfect||(e.pluperfect="had "+e.past),e.future_perfect||(e.future_perfect="will have "+e.past),e):e},u=function(e){if(void 0===e)return{};var t=new RegExp("^(.*?) (in|out|on|off|behind|way|with|of|do|away|across|ahead|back|over|under|together|apart|up|upon|aback|down|about|before|after|around|to|forth|round|through|along|onto)$","i");if(e.match(" ")&&e.match(t)){var i=e.match(t,""),n=i[1],r=i[2],a=u(n);return delete a.doer,Object.keys(a).forEach(function(e){a[e]&&(a[e]+=" "+r)}),a}e.match(/^had [a-z]/i)&&(e=e.replace(/^had /i,"")),e.match(/^have [a-z]/i)&&(e=e.replace(/^have /i,"")),e.match(/^will have [a-z]/i)&&(e=e.replace(/^will have /i,"")),e=e.replace(/^will /i,"");var p,d,f=(e.match(/^(over|under|re|anti|full)\-?/i)||[])[0],m=e.replace(/^(over|under|re|anti|full)\-?/i,""),y={},g=o.length;for(d=0;g>d;d++)if(p=o[d],m===p.present||m===p.gerund||m===p.past||m===p.infinitive)return y=JSON.parse(JSON.stringify(o[d])),c(y,f);var v=h(e)||"infinitive";g=s[v].length;var b,_;for(d=0;g>d;d++)if(b=s[v][d],e.match(b.reg)){y[v]=e,_=Object.keys(b.repl);for(var x=0;x<_.length;x++)_[x]===v?y[_[x]]=e:y[_[x]]=e.replace(b.reg,b.repl[_[x]]);return c(y)}return l(e)};t.exports=u},{"./suffix_rules":53,"./to_doer":54,"./verb_irregulars":55,"./verb_rules":56}],53:[function(e,t,i){var n,r,o={gerund:["ing"],infinitive:["ate","ize","tion","rify","ress","ify","age","nce","ect","ise","ine","ish","ace","ash","ure","tch","end","ack","and","ute","ade","ock","ite","ase","ose","use","ive","int","nge","lay","est","ain","ant","eed","er","le"],past:["ed","lt","nt","pt","ew","ld"],present:["rks","cks","nks","ngs","mps","tes","zes","ers","les","acks","ends","ands","ocks","lays","eads","lls","els","ils","ows","nds","ays","ams","ars","ops","ffs","als","urs","lds","ews","ips","es","ts","ns","s"]},s={},a=Object.keys(o),h=a.length;for(r=0;h>r;r++){n=o[a[r]].length;for(var l=0;n>l;l++)s[o[a[r]][l]]=a[r]}t.exports=s},{}],54:[function(e,t,i){t.exports=function(e){e=e||"";var t={tie:"tier",dream:"dreamer",sail:"sailer",run:"runner",rub:"rubber",begin:"beginner",win:"winner",claim:"claimant",deal:"dealer",spin:"spinner"},i={aid:1,fail:1,appear:1,happen:1,seem:1,"try":1,say:1,marry:1,be:1,forbid:1,understand:1,bet:1},n=[{reg:/e$/i,repl:"er"},{reg:/([aeiou])([mlgp])$/i,repl:"$1$2$2er"},{reg:/([rlf])y$/i,repl:"$1ier"},{reg:/^(.?.[aeiou])t$/i,repl:"$1tter"}];if(i.hasOwnProperty(e))return null;if(t.hasOwnProperty(e))return t[e];for(var r=0;r<n.length;r++)if(e.match(n[r].reg))return e.replace(n[r].reg,n[r].repl);return e+"er"}},{}],55:[function(e,t,i){var n=["infinitive","gerund","past","present","doer","future"],r=[["arise","arising","arose","_s","_r"],["babysit","_ting","babysat","_s","_ter"],["be","_ing","was","is",""],["beat","_ing","_","_s","_er"],["become","becoming","became","_s","_r"],["bend","_ing","bent","_s","_er"],["begin","_ning","began","_s","_ner"],["bet","_ting","_","_s","_ter"],["bind","_ing","bound","_s","_er"],["bite","biting","bit","_s","_r"],["bleed","_ing","bled","_s","_er"],["blow","_ing","blew","_s","_er"],["break","_ing","broke","_s","_er"],["breed","_ing","bred","_s","_er"],["bring","_ing","brought","_s","_er"],["broadcast","_ing","_","_s","_er"],["build","_ing","built","_s","_er"],["buy","_ing","bought","_s","_er"],["catch","_ing","caught","_es","_er"],["choose","choosing","chose","_s","_r"],["come","coming","came","_s","_r"],["cost","_ing","_","_s","_er"],["cut","_ting","_","_s","_ter"],["deal","_ing","_t","_s","_er"],["dig","_ging","dug","_s","_ger"],["do","_ing","did","_es","_er"],["draw","_ing","drew","_s","_er"],["drink","_ing","drank","_s","_er"],["drive","driving","drove","_s","_r"],["eat","_ing","ate","_s","_er"],["fall","_ing","fell","_s","_er"],["feed","_ing","fed","_s","_er"],["feel","_ing","felt","_s","_er"],["fight","_ing","fought","_s","_er"],["find","_ing","found","_s","_er"],["fly","_ing","flew","_s","flier"],["forbid","_ing","forbade","_s"],["forget","_ing","forgot","_s","_er"],["forgive","forgiving","forgave","_s","_r"],["freeze","freezing","froze","_s","_r"],["get","_ting","got","_s","_ter"],["give","giving","gave","_s","_r"],["go","_ing","went","_es","_er"],["grow","_ing","grew","_s","_er"],["hang","_ing","hung","_s","_er"],["have","having","had","has"],["hear","_ing","_d","_s","_er"],["hide","hiding","hid","_s","_r"],["hit","_ting","_","_s","_ter"],["hold","_ing","held","_s","_er"],["hurt","_ing","_","_s","_er"],["know","_ing","knew","_s","_er"],["relay","_ing","_ed","_s","_er"],["lay","_ing","laid","_s","_er"],["lead","_ing","led","_s","_er"],["leave","leaving","left","_s","_r"],["lend","_ing","lent","_s","_er"],["let","_ting","_","_s","_ter"],["lie","lying","lay","_s","_r"],["light","_ing","lit","_s","_er"],["lose","losing","lost","_s","_r"],["make","making","made","_s","_r"],["mean","_ing","_t","_s","_er"],["meet","_ing","met","_s","_er"],["pay","_ing","paid","_s","_er"],["put","_ting","_","_s","_ter"],["quit","_ting","_","_s","_ter"],["read","_ing","_","_s","_er"],["ride","riding","rode","_s","_r"],["ring","_ing","rang","_s","_er"],["rise","rising","rose","_s","_r"],["run","_ning","ran","_s","_ner"],["say","_ing","said","_s"],["see","_ing","saw","_s","_r"],["sell","_ing","sold","_s","_er"],["send","_ing","sent","_s","_er"],["set","_ting","_","_s","_ter"],["shake","shaking","shook","_s","_r"],["shine","shining","shone","_s","_r"],["shoot","_ing","shot","_s","_er"],["show","_ing","_ed","_s","_er"],["shut","_ting","_","_s","_ter"],["sing","_ing","sang","_s","_er"],["sink","_ing","sank","_s","_er"],["sit","_ting","sat","_s","_ter"],["slide","sliding","slid","_s","_r"],["speak","_ing","spoke","_s","_er"],["spend","_ing","spent","_s","_er"],["spin","_ning","spun","_s","_ner"],["spread","_ing","_","_s","_er"],["stand","_ing","stood","_s","_er"],["steal","_ing","stole","_s","_er"],["stick","_ing","stuck","_s","_er"],["sting","_ing","stung","_s","_er"],["strike","striking","struck","_s","_r"],["swear","_ing","swore","_s","_er"],["swim","_ing","swam","_s","_mer"],["swing","_ing","swung","_s","_er"],["take","taking","took","_s","_r"],["teach","_ing","taught","_s","_er"],["tear","_ing","tore","_s","_er"],["tell","_ing","told","_s","_er"],["think","_ing","thought","_s","_er"],["throw","_ing","threw","_s","_er"],["understand","_ing","understood","_s"],["wake","waking","woke","_s","_r"],["wear","_ing","wore","_s","_er"],["win","_ning","won","_s","_ner"],["withdraw","_ing","withdrew","_s","_er"],["write","writing","wrote","_s","_r"],["tie","tying","_d","_s","_r"],["obey","_ing","_ed","_s","_er"],["ski","_ing","_ied","_s","_er"],["boil","_ing","_ed","_s","_er"],["miss","_ing","_ed","_","_er"],["act","_ing","_ed","_s","_or"],["compete","competing","_d","_s","competitor"],["being","are","were","are"],["imply","_ing","implied","implies","implier"],["ice","icing","_d","_s","_r"],["develop","_ing","_","_s","_er"],["wait","_ing","_ed","_s","_er"],["aim","_ing","_ed","_s","_er"],["spill","_ing","spilt","_s","_er"],["drop","_ping","_ped","_s","_per"],["head","_ing","_ed","_s","_er"],["log","_ging","_ged","_s","_ger"],["rub","_bing","_bed","_s","_ber"],["smash","_ing","_ed","_es","_er"],["add","_ing","_ed","_s","_er"],["word","_ing","_ed","_s","_er"],["suit","_ing","_ed","_s","_er"],["be","am","was","am",""],["load","_ing","_ed","_s","_er"]];t.exports=r.map(function(e){for(var t={},i=0;i<e.length;i++)t[n[i]]=e[i].replace(/_/,e[0]);return t})},{}],56:[function(e,t,i){var n={infinitive:[["(eed)$",{pr:"$1s",g:"$1ing",pa:"$1ed","do":"$1er"}],["(e)(ep)$",{pr:"$1$2s",g:"$1$2ing",pa:"$1pt","do":"$1$2er"}],["(a[tg]|i[zn]|ur|nc|gl|is)e$",{pr:"$1es",g:"$1ing",pa:"$1ed"}],["([i|f|rr])y$",{pr:"$1ies",g:"$1ying",pa:"$1ied"}],["([td]er)$",{pr:"$1s",g:"$1ing",pa:"$1ed"}],["([bd]l)e$",{pr:"$1es",g:"$1ing",pa:"$1ed"}],["(ish|tch|ess)$",{pr:"$1es",g:"$1ing",pa:"$1ed"}],["(ion|end|e[nc]t)$",{pr:"$1s",g:"$1ing",pa:"$1ed"}],["(om)e$",{pr:"$1es",g:"$1ing",pa:"ame"}],["([aeiu])([pt])$",{pr:"$1$2s",g:"$1$2$2ing",pa:"$1$2"}],["(er)$",{pr:"$1s",g:"$1ing",pa:"$1ed"}],["(en)$",{pr:"$1s",g:"$1ing",pa:"$1ed"}]],present:[["(ies)$",{"in":"y",g:"ying",pa:"ied"}],["(tch|sh)es$",{"in":"$1",g:"$1ing",pa:"$1ed"}],["(ss)es$",{"in":"$1",g:"$1ing",pa:"$1ed"}],["([tzlshicgrvdnkmu])es$",{"in":"$1e",g:"$1ing",pa:"$1ed"}],["(n[dtk]|c[kt]|[eo]n|i[nl]|er|a[ytrl])s$",{"in":"$1",g:"$1ing",pa:"$1ed"}],["(ow)s$",{"in":"$1",g:"$1ing",pa:"ew"}],["(op)s$",{"in":"$1",g:"$1ping",pa:"$1ped"}],["([eirs])ts$",{"in":"$1t",g:"$1tting",pa:"$1tted"}],["(ll)s$",{"in":"$1",g:"$1ing",pa:"$1ed"}],["(el)s$",{"in":"$1",g:"$1ling",pa:"$1led"}],["(ip)es$",{"in":"$1e",g:"$1ing",pa:"$1ed"}],["ss$",{"in":"ss",g:"ssing",pa:"ssed"}],["s$",{"in":"",g:"ing",pa:"ed"}]],gerund:[["pping$",{"in":"p",pr:"ps",pa:"pped"}],["lling$",{"in":"ll",pr:"lls",pa:"lled"}],["tting$",{"in":"t",pr:"ts",pa:"t"}],["ssing$",{"in":"ss",pr:"sses",pa:"ssed"}],["gging$",{"in":"g",pr:"gs",pa:"gged"}],["([^aeiou])ying$",{"in":"$1y",pr:"$1ies",pa:"$1ied","do":"$1ier"}],["(i.)ing$",{"in":"$1e",pr:"$1es",pa:"$1ed"}],["(u[rtcb]|[bdtpkg]l|n[cg]|a[gdkvtc]|[ua]s|[dr]g|yz|o[rlsp]|cre)ing$",{"in":"$1e",pr:"$1es",pa:"$1ed"}],["(ch|sh)ing$",{"in":"$1",pr:"$1es",pa:"$1ed"}],["(..)ing$",{"in":"$1",pr:"$1s",pa:"$1ed"}]],past:[["(ued)$",{pr:"ues",g:"uing",pa:"ued","do":"uer"}],["(e|i)lled$",{pr:"$1lls",g:"$1lling",pa:"$1lled","do":"$1ller"}],["(sh|ch)ed$",{"in":"$1",pr:"$1es",g:"$1ing","do":"$1er"}],["(tl|gl)ed$",{"in":"$1e",pr:"$1es",g:"$1ing","do":"$1er"}],["(ss)ed$",{"in":"$1",pr:"$1es",g:"$1ing","do":"$1er"}],["pped$",{"in":"p",pr:"ps",g:"pping","do":"pper"}],["tted$",{"in":"t",pr:"ts",g:"tting","do":"tter"}],["gged$",{"in":"g",pr:"gs",g:"gging","do":"gger"}],["(h|ion|n[dt]|ai.|[cs]t|pp|all|ss|tt|int|ail|ld|en|oo.|er|k|pp|w|ou.|rt|ght|rm)ed$",{"in":"$1",pr:"$1s",g:"$1ing","do":"$1er"}],["(..[^aeiou])ed$",{"in":"$1e",pr:"$1es",g:"$1ing","do":"$1er"}],["ied$",{"in":"y",pr:"ies",g:"ying","do":"ier"}],["(.o)ed$",{"in":"$1o",pr:"$1os",g:"$1oing","do":"$1oer"}],["(.i)ed$",{"in":"$1",pr:"$1s",g:"$1ing","do":"$1er"}],["([rl])ew$",{"in":"$1ow",pr:"$1ows",g:"$1owing"}],["([pl])t$",{"in":"$1t",pr:"$1ts",g:"$1ting"}]]};n=Object.keys(n).reduce(function(e,t){return e[t]=n[t].map(function(e){var t={reg:new RegExp(e[0],"i"),repl:{infinitive:e[1]["in"],present:e[1].pr,past:e[1].pa,gerund:e[1].g}};return e[1]["do"]&&(t.repl.doer=e[1]["do"]),t}),e},{}),t.exports=n},{}],57:[function(e,t,n){var r=function(t,n,r){var o,s,a=this;void 0!==n&&void 0!==r&&(o=n.tokens[r],s=n.tokens[r+i]),a.word=t||"";var h=e("./conjugate/conjugate"),l=e("../../data/parts_of_speech"),c={is:"CP","will be":"CP",will:"CP",are:"CP",was:"CP",were:"CP"},u={can:"MD",may:"MD",could:"MD",might:"MD",will:"MD","ought to":"MD",would:"MD",must:"MD",shall:"MD",should:"MD"},p={past:"VBD",participle:"VBN",infinitive:"VBP",present:"VBZ",gerund:"VBG"};return a.conjugate=function(){return h(a.word)},a.to_past=function(){return"gerund"===a.form?a.word:h(a.word).past},a.to_present=function(){return h(a.word).present},a.to_future=function(){return"will "+h(a.word).infinitive},a.form=function(){for(var e=["past","present","gerund","infinitive"],t=h(a.word),i=0;i<e.length;i++)if(t[e[i]]===a.word)return e[i]}(),a.tense=function(){return a.word.match(/\bwill\b/)?"future":"present"===a.form?"present":"past"===a.form?"past":"present"}(),a.which=function(){if(c[a.word])return l.CP;if(a.word.match(/([aeiou][^aeiouwyrlm])ing$/))return l.VBG;var e=a.form;return l[p[e]]}(),a.negative=function(){return a.word.match(/n't$/)?!0:(u[a.word]||c[a.word])&&s&&"not"===s.normalised?!0:!1},a};t.exports=r},{"../../data/parts_of_speech":27,"./conjugate/conjugate":52}],58:[function(e,t,i){var n=e("./data/lexicon"),r=e("./data/lexicon/values"),o=e("./methods/tokenization/tokenize"),s=e("./data/parts_of_speech"),a=e("./data/word_rules"),h=e("./data/unambiguous_suffixes"),l=e("./sentence"),c=e("./section"),u=e("./parents/parents"),p=["in","out","on","off","behind","way","with","of","do","away","across","ahead","back","over","under","together","apart","up","upon","aback","down","about","before","after","around","to","forth","round","through","along","onto"];p=p.reduce(function(e,t){return e[t]=!0,e},{});var d=function(e,t){return e.text+=" "+t.text,e.normalised+=" "+t.normalised,e.pos_reason+="|"+t.pos_reason,e.start=e.start||t.start,e.noun_capital=e.noun_capital&&t.noun_capital,e.punctuated=e.punctuated||t.punctuated,e.end=e.end||t.end,e},f=function(e){for(var t=e.tokens||[],i=0;i<=t.length;i++){var n=t[i+1];if(t[i]&&n){var r=t[i].pos.tag;r===n.pos.tag&&t[i].punctuated!==!0&&t[i].noun_capital==n.noun_capital?(t[i+1]=d(t[i],t[i+1]),t[i]=null):"NNP"===r&&"NN"===n.pos.tag||"NN"===r&&"NNP"===n.pos.tag?(t[i+1]=d(t[i],t[i+1]),t[i]=null,t[i+1].pos=s.NNP):"CD"===r&&"CD"===n.pos.tag?(t[i+1]=d(t[i],t[i+1]),t[i]=null):"NNAB"===r&&"noun"===n.pos.parent||"noun"===t[i].pos.parent&&"NNAB"===n.pos.tag?(t[i+1]=d(t[i],t[i+1]),t[i]=null):"will"===t[i].normalised&&"verb"===n.pos.parent?(t[i+1]=d(t[i],t[i+1]),t[i]=null):"CD"!==r||"and"!==n.normalised&&"the"!==n.normalised||!t[i+2]||"CD"!==t[i+2].pos.tag?"NN"==r&&t[i].noun_capital&&("of"==n.normalised||"and"==n.normalised)&&t[i+2]&&t[i+2].noun_capital?(t[i+1]=d(t[i],t[i+1]),t[i]=null,t[i+2]=d(t[i+1],t[i+2]),t[i+1]=null):t[i].noun_capital&&"of"==n.normalised&&t[i+2]&&"DT"==t[i+2].pos.tag&&t[i+3]&&t[i+3].noun_capital&&(t[i+1]=d(t[i],t[i+1]),t[i]=null,t[i+2]=d(t[i+1],t[i+2]),t[i+1]=null,t[i+3]=d(t[i+2],t[i+3]),t[i+2]=null):(t[i+1]=d(t[i],t[i+1]),t[i]=null)}}return e.tokens=t.filter(function(e){return e}),e},m=function(e){for(var t=e.tokens||[],i=1;i<t.length;i++)p[t[i].normalised]&&n[t[i-1].normalised+" "+t[i].normalised]&&(t[i]=d(t[i-1],t[i]),t[i-1]=null);return e.tokens=t.filter(function(e){return e}),e},y=function(e){if(n.hasOwnProperty(e))return s[n[e]];if(e.match(/^(over|under|out|-|un|re|en).{4}/)){var t=e.replace(/^(over|under|out|.*?-|un|re|en)/,"");return s[n[t]]}},g=function(e){for(var t=0;t<a.length;t++)if(e.length>4&&e.match(a[t].reg))return s[a[t].pos]},v=function(e,t,i){var n=i.tokens[t-1],r=i.tokens[t+1],o={the:1,a:1,an:1};return"march"!=e.normalised&&"april"!=e.normalised&&"may"!=e.normalised||!(r&&"CD"==r.pos.tag||n&&"CD"==n.pos.tag)||(e.pos=s.CD,e.pos_reason="may_is_date"),r&&"noun"!==e.pos.parent&&"glue"!==e.pos.parent&&"MD"===r.pos.tag&&(e.pos=s.NN,e.pos_reason="before_modal"),n&&"will"==n.normalised&&!n.punctuated&&"noun"==e.pos.parent&&"PRP"!==e.pos.tag&&"PP"!==e.pos.tag&&(e.pos=s.VB,e.pos_reason="after_will"),n&&"i"==n.normalised&&!n.punctuated&&"noun"==e.pos.parent&&(e.pos=s.VB,e.pos_reason="after_i"),n&&"noun"===e.pos.parent&&"PRP"!==e.pos.tag&&"PP"!==e.pos.tag&&"RB"===n.pos.tag&&!n.start&&(e.pos=s.VB,e.pos_reason="after_adverb"),r&&"adjective"===e.pos.parent&&"adjective"===r.pos.parent&&!e.punctuated&&(e.pos=s.RB,e.pos_reason="consecutive_adjectives"),n&&"verb"===e.pos.parent&&o[n.pos.normalised]&&"CP"!=e.pos.tag&&(e.pos=s.NN,e.pos_reason="determiner-verb"),n&&"CP"===n.pos.tag&&"DT"!==e.pos.tag&&"RB"!==e.pos.tag&&"PRP"!==e.pos.tag&&"adjective"!==e.pos.parent&&"value"!==e.pos.parent&&(e.pos=s.JJ,e.pos_reason="copula-adjective"),n&&r&&"CP"===n.pos.tag&&"RB"===e.pos.tag&&"verb"===r.pos.parent&&(i.tokens[t+1].pos=s.JJ,i.tokens[t+1].pos_reason="copula-adverb-adjective"),r&&"PRP"==r.pos.tag&&"PP"!==e.pos.tag&&"noun"==e.pos.parent&&!e.punctuated&&(e.pos=s.VB,e.pos_reason="before_[him|her|it]"),n&&r&&"DT"===n.pos.tag&&"noun"===r.pos.parent&&"verb"===e.pos.parent&&(e.pos=s.JJ,e.pos_reason="determiner-adjective-noun"),n&&"PRP"===n.pos.tag&&"JJ"===e.pos.tag&&(e.pos=s.VB,e.pos_reason="adjective-after-pronoun"),e},b=function(e){for(var t,i,n,r={"i'd":["i","would"],"she'd":["she","would"],"he'd":["he","would"],"they'd":["they","would"],"we'd":["we","would"],"i'll":["i","will"],"she'll":["she","will"],"he'll":["he","will"],"they'll":["they","will"],"we'll":["we","will"],"i've":["i","have"],"they've":["they","have"],"we've":["we","have"],"should've":["should","have"],"would've":["would","have"],"could've":["could","have"],"must've":["must","have"],"i'm":["i","am"],"we're":["we","are"],"they're":["they","are"],cannot:["can","not"]},o=0;o<e.length;o++)if(r.hasOwnProperty(e[o].normalised))return t=e.slice(0,o),i=e.slice(o+1,e.length),n=[{text:e[o].text,normalised:r[e[o].normalised][0],start:e[o].start},{text:"",normalised:r[e[o].normalised][1],start:void 0}],e=t.concat(n),e=e.concat(i),b(e);return e},_=function(e){for(var t,i,r,o={"he's":"he","she's":"she","it's":"it","who's":"who","what's":"what","where's":"where","when's":"when","why's":"why","how's":"how"},a=0;a<e.length;a++)if(o.hasOwnProperty(e[a].normalised)){t=e.slice(0,a),i=e.slice(a+1,e.length);for(var h="is",l=a+1;l<e.length;l++)if(e[l]&&e[l].pos&&"VBD"==e[l].pos.tag){h="has";break}return r=[{text:e[a].text,normalised:o[e[a].normalised],start:e[a].start,pos:s[n[o[e[a].normalised]]],pos_reason:"ambiguous_contraction"},{text:"",normalised:h,start:void 0,pos:s[n[h]],pos_reason:"silent_contraction"}],e=t.concat(r),e=e.concat(i),_(e)}return e},x=function(e,t){if(t=t||{},!e||!e.match(/[a-z0-9]/i))return new c([]);var i=o(e);return i.forEach(function(e){var t=e.tokens[0];t&&e.tokens[1]&&e.tokens[1].noun_capital&&!y(t.normalised)&&(e.tokens[0].noun_capital=!0),e.tokens=b(e.tokens),e.tokens=e.tokens.map(function(e){if(e.noun_capital&&!r[e.normalised])return e.pos=s.NN,e.pos_reason="noun_capitalised",e;var t=y(e.normalised);if(t)return e.pos=t,e.pos_reason="lexicon","NNAB"===e.pos.tag&&(e.punctuated=!1),e;if(!e.normalised)return e.pos=s.UH,e.pos_reason="wordless_string",e;var i=e.normalised.length;if(i>4){var n=e.normalised.substr(i-4,i-1);if(h.hasOwnProperty(n))return e.pos=s[h[n]],e.pos_reason="wordnet suffix",e}var o=g(e.normalised);return o?(e.pos=o,e.pos_reason="regex suffix",e):parseFloat(e.normalised)?(e.pos=s.CD,e.pos_reason="parsefloat",e):e}),e.tokens=e.tokens.map(function(e,t){return"lexicon"!==e.pos_reason&&e.normalised.match(/.ed$/)&&(e.pos=s.VB,e.pos_reason="ed"),e}),e.tokens=_(e.tokens);var i=null,n="";e.tokens=e.tokens.map(function(t,r){var o=e.tokens[r+1];if(t.pos){if("the"==t.normalised||"a"==t.normalised||"an"==t.normalised||"PP"===t.pos.tag)return i="noun",n=t.pos.name,t;if("PRP"===t.pos.tag&&"PP"!==t.pos.tag||"MD"===t.pos.tag)return i="verb",n=t.pos.name,t}return t.pos&&("verb"==i&&"noun"==t.pos.parent&&(!o||o.pos&&"noun"!=o.pos.parent)&&(o&&o.pos&&o.pos.parent==i||(t.pos=s.VB,t.pos_reason="signal from "+n,i=null)),"noun"==i&&"verb"==t.pos.parent&&(!o||o.pos&&"verb"!=o.pos.parent)&&(o&&o.pos&&o.pos.parent==i||(t.pos=s.NN,t.pos_reason="signal from "+n,i=null))),i&&!t.pos&&(o&&o.pos&&o.pos.parent==i||(t.pos=s[i],
t.pos_reason="signal from "+n,i=null)),"verb"===i&&t.pos&&"verb"===t.pos.parent&&(i=null),"noun"===i&&t.pos&&"noun"===t.pos.parent&&(i=null),t});var o={};e.tokens.forEach(function(e){e.pos&&(o[e.pos.parent]=!0)}),e.tokens=e.tokens.map(function(e,t){if(!e.pos){if(o.adjective&&o.noun&&!o.verb)return e.pos=s.VB,e.pos_reason="need one verb",o.verb=!0,e;e.pos=s.NN,e.pos_reason="noun fallback"}return e}),e.tokens=e.tokens.map(function(t,i){return v(t,i,e)}),e.tokens=e.tokens.map(function(t,i){return v(t,i,e)})}),t.dont_combine||(i=i.map(function(e){return f(e)}),i=i.map(function(e){return m(e)})),i=i.map(function(e){var t=new l(e.tokens);return t.type=e.type,t}),i=i.map(function(e){return e.tokens=e.tokens.map(function(t,i){return t.analysis=u[t.pos.parent](t.normalised,e,i),t}),e}),i=i.map(function(e,t){return e.last=i[t-1],e.next=i[t+1],e}),new c(i)};t.exports=x},{"./data/lexicon":15,"./data/lexicon/values":25,"./data/parts_of_speech":27,"./data/unambiguous_suffixes":28,"./data/word_rules":29,"./methods/tokenization/tokenize":35,"./parents/parents":48,"./section":59,"./sentence":60}],59:[function(e,t,i){var n=function(e){var t=this;t.sentences=e||[],t.text=function(){return t.sentences.map(function(e){return e.text()}).join(" ")},t.tense=function(){return t.sentences.map(function(e){return e.tense()})},t.nouns=function(){return t.sentences.map(function(e){return e.nouns()}).reduce(function(e,t){return e.concat(t)},[])},t.entities=function(e){return t.sentences.map(function(t){return t.entities(e)}).reduce(function(e,t){return e.concat(t)},[])},t.people=function(){return t.sentences.map(function(e){return e.people()}).reduce(function(e,t){return e.concat(t)},[])},t.adjectives=function(){return t.sentences.map(function(e){return e.adjectives()}).reduce(function(e,t){return e.concat(t)},[])},t.verbs=function(){return t.sentences.map(function(e){return e.verbs()}).reduce(function(e,t){return e.concat(t)},[])},t.adverbs=function(){return t.sentences.map(function(e){return e.adverbs()}).reduce(function(e,t){return e.concat(t)},[])},t.values=function(){return t.sentences.map(function(e){return e.values()}).reduce(function(e,t){return e.concat(t)},[])},t.tags=function(){return t.sentences.map(function(e){return e.tags()})},t.negate=function(){return t.sentences=t.sentences.map(function(e){return e.negate()}),t},t.to_past=function(){return t.sentences=t.sentences.map(function(e){return e.to_past()}),t},t.to_present=function(){return t.sentences=t.sentences.map(function(e){return e.to_present()}),t},t.to_future=function(){return t.sentences=t.sentences.map(function(e){return e.to_future()}),t}};t.exports=n},{}],60:[function(e,t,i){var n=function(e){var t=this;t.tokens=e||[];var i=function(e){return e.charAt(0).toUpperCase()+e.slice(1)};return t.tense=function(){var e=t.tokens.filter(function(e){return"verb"===e.pos.parent});return e.map(function(e){return e.analysis.tense})},t.to_past=function(){return t.tokens=t.tokens.map(function(e){return"verb"===e.pos.parent&&(e.text=e.analysis.to_past(),e.normalised=e.text),e}),t},t.to_present=function(){return t.tokens=t.tokens.map(function(e){return"verb"===e.pos.parent&&(e.text=e.analysis.to_present(),e.normalised=e.text),e}),t},t.to_future=function(){return t.tokens=t.tokens.map(function(e){return"verb"===e.pos.parent&&(e.text=e.analysis.to_future(),e.normalised=e.text),e}),t},t.insert=function(e,i){i&&e&&t.tokens.splice(i,0,e)},t.negate=function(){for(var e={everyone:"no one",everybody:"nobody",someone:"no one",somebody:"nobody",always:"never",is:"isn't",are:"aren't",was:"wasn't",will:"won't","didn't":"did","wouldn't":"would","couldn't":"could","shouldn't":"should","can't":"can","won't":"will","mustn't":"must","shan't":"shall",shant:"shall",did:"didn't",would:"wouldn't",could:"couldn't",should:"shouldn't",can:"can't",must:"mustn't"},n=0;n<t.tokens.length;n++){var r=t.tokens[n];if("ambiguous_contraction"===r.pos_reason&&(r.text=r.normalised),e[r.normalised]&&(!t.tokens[n+1]||"not"!=t.tokens[n+1].normalised))return r.text=e[r.normalised],r.normalised=e[r.normalised],r.capitalised&&(r.text=i(r.text)),t;if("verb"==r.pos.parent)return r.analysis.negative()?(t.tokens[n+1]&&"not"==t.tokens[n+1].normalised&&t.tokens.splice(n+1,1),t):r.normalised.match(/^will /i)?(r.text=r.text.replace(/^will /i,"won't "),r.normalised=r.text,r.capitalised&&(r.text=i(r.text)),t):"infinitive"==r.analysis.form&&"future"!=r.analysis.form?(r.text="don't "+(r.analysis.conjugate().infinitive||r.text),r.normalised=r.text.toLowerCase(),t):"gerund"==r.analysis.form?(r.text="not "+r.text,r.normalised=r.text.toLowerCase(),t):"past"==r.analysis.tense?(r.text="didn't "+(r.analysis.conjugate().infinitive||r.text),r.normalised=r.text.toLowerCase(),t):"present"==r.analysis.tense?(r.text="doesn't "+(r.analysis.conjugate().infinitive||r.text),r.normalised=r.text.toLowerCase(),t):"future"==r.analysis.tense?("will"==r.normalised?(r.normalised="won't",r.text="won't"):(r.text=r.text.replace(/^will /i,"won't "),r.normalised=r.normalised.replace(/^will /i,"won't ")),r.capitalised&&(r.text=i(r.text)),t):t}return t},t.entities=function(e){var i=[];return e=e||{},t.tokens.forEach(function(e){"noun"===e.pos.parent&&e.analysis.is_entity()&&i.push(e)}),e.ignore_gerund&&(i=i.filter(function(e){return"VBG"!==e.pos.tag})),i},t.people=function(){return t.entities({}).filter(function(e){return e.analysis.is_person()})},t.text=function(){return t.tokens.map(function(e){return e.text}).join(" ")},t.verbs=function(){return t.tokens.filter(function(e){return"verb"==e.pos.parent})},t.adverbs=function(){return t.tokens.filter(function(e){return"adverb"==e.pos.parent})},t.nouns=function(){return t.tokens.filter(function(e){return"noun"==e.pos.parent})},t.adjectives=function(){return t.tokens.filter(function(e){return"adjective"==e.pos.parent})},t.values=function(){return t.tokens.filter(function(e){return"value"==e.pos.parent})},t.tags=function(){return t.tokens.map(function(e){return e.pos.tag})},t.referables=function(){var e={he:void 0,she:void 0,they:void 0,it:void 0};return t.tokens.forEach(function(t){"noun"==t.pos.parent&&"PRP"!=t.pos.tag&&(e[t.analysis.pronoun()]=t)}),e},t};t.exports=n},{}],61:[function(e,t,i){var n=e("./pos"),r=function(e,t){t=t||{};var i=n(e,t).sentences,r=i.reduce(function(e,i){return e.concat(i.entities(t))},[]),o={};return r=r.filter(function(e){return e.analysis.is_person()&&e.normalised.split(" ").forEach(function(e){o[e]=!0}),o[e.normalised]?!1:!0})};t.exports=r},{"./pos":58}],62:[function(e,t,i){t.exports=e("./lib/")},{"./lib/":63}],63:[function(e,t,i){function n(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var i,n=r(e),o=n.source,l=n.id;return t.forceNew||t["force new connection"]||!1===t.multiplex?(a("ignoring socket cache for %s",o),i=s(o,t)):(h[l]||(a("new io instance for %s",o),h[l]=s(o,t)),i=h[l]),i.socket(n.path)}var r=e("./url"),o=e("socket.io-parser"),s=e("./manager"),a=e("debug")("socket.io-client");t.exports=i=n;var h=i.managers={};i.protocol=o.protocol,i.connect=n,i.Manager=e("./manager"),i.Socket=e("./socket")},{"./manager":64,"./socket":66,"./url":67,debug:71,"socket.io-parser":105}],64:[function(e,t,i){function n(e,t){return this instanceof n?(e&&"object"==typeof e&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new p({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connected=[],this.encoding=!1,this.packetBuffer=[],this.encoder=new a.Encoder,this.decoder=new a.Decoder,this.autoConnect=t.autoConnect!==!1,void(this.autoConnect&&this.open())):new n(e,t)}var r=(e("./url"),e("engine.io-client")),o=e("./socket"),s=e("component-emitter"),a=e("socket.io-parser"),h=e("./on"),l=e("component-bind"),c=(e("object-component"),e("debug")("socket.io-client:manager")),u=e("indexof"),p=e("backo2");t.exports=n,n.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps)this.nsps[e].emit.apply(this.nsps[e],arguments)},n.prototype.updateSocketIds=function(){for(var e in this.nsps)this.nsps[e].id=this.engine.id},s(n.prototype),n.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},n.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},n.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},n.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},n.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},n.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},n.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},n.prototype.open=n.prototype.connect=function(e){if(c("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;c("opening %s",this.uri),this.engine=r(this.uri,this.opts);var t=this.engine,i=this;this.readyState="opening",this.skipReconnect=!1;var n=h(t,"open",function(){i.onopen(),e&&e()}),o=h(t,"error",function(t){if(c("connect_error"),i.cleanup(),i.readyState="closed",i.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else i.maybeReconnectOnOpen()});if(!1!==this._timeout){var s=this._timeout;c("connect attempt will timeout after %d",s);var a=setTimeout(function(){c("connect attempt timed out after %d",s),n.destroy(),t.close(),t.emit("error","timeout"),i.emitAll("connect_timeout",s)},s);this.subs.push({destroy:function(){clearTimeout(a)}})}return this.subs.push(n),this.subs.push(o),this},n.prototype.onopen=function(){c("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(h(e,"data",l(this,"ondata"))),this.subs.push(h(this.decoder,"decoded",l(this,"ondecoded"))),this.subs.push(h(e,"error",l(this,"onerror"))),this.subs.push(h(e,"close",l(this,"onclose")))},n.prototype.ondata=function(e){this.decoder.add(e)},n.prototype.ondecoded=function(e){this.emit("packet",e)},n.prototype.onerror=function(e){c("error",e),this.emitAll("error",e)},n.prototype.socket=function(e){var t=this.nsps[e];if(!t){t=new o(this,e),this.nsps[e]=t;var i=this;t.on("connect",function(){t.id=i.engine.id,~u(i.connected,t)||i.connected.push(t)})}return t},n.prototype.destroy=function(e){var t=u(this.connected,e);~t&&this.connected.splice(t,1),this.connected.length||this.close()},n.prototype.packet=function(e){c("writing packet %j",e);var t=this;t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(e){for(var i=0;i<e.length;i++)t.engine.write(e[i]);t.encoding=!1,t.processPacketQueue()}))},n.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},n.prototype.cleanup=function(){for(var e;e=this.subs.shift();)e.destroy();this.packetBuffer=[],this.encoding=!1,this.decoder.destroy()},n.prototype.close=n.prototype.disconnect=function(){this.skipReconnect=!0,this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},n.prototype.onclose=function(e){c("close"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},n.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)c("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();c("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var i=setTimeout(function(){e.skipReconnect||(c("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(c("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(c("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(i)}})}},n.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},{"./on":65,"./socket":66,"./url":67,backo2:68,"component-bind":69,"component-emitter":70,debug:71,"engine.io-client":72,indexof:101,"object-component":102,"socket.io-parser":105}],65:[function(e,t,i){function n(e,t,i){return e.on(t,i),{destroy:function(){e.removeListener(t,i)}}}t.exports=n},{}],66:[function(e,t,i){function n(e,t){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.io.autoConnect&&this.open(),this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0}var r=e("socket.io-parser"),o=e("component-emitter"),s=e("to-array"),a=e("./on"),h=e("component-bind"),l=e("debug")("socket.io-client:socket"),c=e("has-binary");t.exports=i=n;var u={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},p=o.prototype.emit;o(n.prototype),n.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[a(e,"open",h(this,"onopen")),a(e,"packet",h(this,"onpacket")),a(e,"close",h(this,"onclose"))]}},n.prototype.open=n.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen(),this)},n.prototype.send=function(){var e=s(arguments);return e.unshift("message"),this.emit.apply(this,e),this},n.prototype.emit=function(e){if(u.hasOwnProperty(e))return p.apply(this,arguments),this;var t=s(arguments),i=r.EVENT;c(t)&&(i=r.BINARY_EVENT);var n={type:i,data:t};return"function"==typeof t[t.length-1]&&(l("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this},n.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},n.prototype.onopen=function(){l("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:r.CONNECT})},n.prototype.onclose=function(e){l("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},n.prototype.onpacket=function(e){if(e.nsp==this.nsp)switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:this.onevent(e);break;case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:this.onack(e);break;case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},n.prototype.onevent=function(e){var t=e.data||[];l("emitting event %j",t),null!=e.id&&(l("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?p.apply(this,t):this.receiveBuffer.push(t)},n.prototype.ack=function(e){var t=this,i=!1;return function(){if(!i){i=!0;var n=s(arguments);l("sending ack %j",n);var o=c(n)?r.BINARY_ACK:r.ACK;t.packet({type:o,id:e,data:n})}}},n.prototype.onack=function(e){l("calling ack %s with %j",e.id,e.data);var t=this.acks[e.id];t.apply(this,e.data),delete this.acks[e.id]},n.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},n.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)p.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},n.prototype.ondisconnect=function(){l("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},n.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},n.prototype.close=n.prototype.disconnect=function(){return this.connected&&(l("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{"./on":65,"component-bind":69,"component-emitter":70,debug:71,"has-binary":99,"socket.io-parser":105,"to-array":109}],67:[function(e,t,i){(function(i){function n(e,t){var n=e,t=t||i.location;return null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"==e.charAt(0)&&(e="/"==e.charAt(1)?t.protocol+e:t.hostname+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e="undefined"!=typeof t?t.protocol+"//"+e:"https://"+e),o("parse %s",e),n=r(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/",n.id=n.protocol+"://"+n.host+":"+n.port,n.href=n.protocol+"://"+n.host+(t&&t.port==n.port?"":":"+n.port),n}var r=e("parseuri"),o=e("debug")("socket.io-client:url");t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{debug:71,parseuri:103}],68:[function(e,t,i){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}t.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),i=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-i:e+i}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}},{}],69:[function(e,t,i){var n=[].slice;t.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var i=n.call(arguments,2);return function(){return t.apply(e,i.concat(n.call(arguments)))}}},{}],70:[function(e,t,i){function n(e){return e?r(e):void 0}function r(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}t.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},n.prototype.once=function(e,t){function i(){n.off(e,i),t.apply(this,arguments)}var n=this;return this._callbacks=this._callbacks||{},i.fn=t,this.on(e,i),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i=this._callbacks[e];if(!i)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var n,r=0;r<i.length;r++)if(n=i[r],n===t||n.fn===t){i.splice(r,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),i=this._callbacks[e];if(i){i=i.slice(0);for(var n=0,r=i.length;r>n;++n)i[n].apply(this,t)}return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],71:[function(e,t,i){function n(e){return n.enabled(e)?function(t){t=r(t);var i=new Date,o=i-(n[e]||i);n[e]=i,t=e+" "+t+" +"+n.humanize(o),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function r(e){return e instanceof Error?e.stack||e.message:e}t.exports=n,n.names=[],n.skips=[],n.enable=function(e){try{localStorage.debug=e}catch(t){}for(var i=(e||"").split(/[\s,]+/),r=i.length,o=0;r>o;o++)e=i[o].replace("*",".*?"),"-"===e[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$"))},n.disable=function(){n.enable("")},n.humanize=function(e){var t=1e3,i=6e4,n=60*i;return e>=n?(e/n).toFixed(1)+"h":e>=i?(e/i).toFixed(1)+"m":e>=t?(e/t|0)+"s":e+"ms"},n.enabled=function(e){for(var t=0,i=n.skips.length;i>t;t++)if(n.skips[t].test(e))return!1;for(var t=0,i=n.names.length;i>t;t++)if(n.names[t].test(e))return!0;return!1};try{window.localStorage&&n.enable(localStorage.debug)}catch(o){}},{}],72:[function(e,t,i){t.exports=e("./lib/")},{"./lib/":73}],73:[function(e,t,i){t.exports=e("./socket"),t.exports.parser=e("engine.io-parser")},{"./socket":74,"engine.io-parser":86}],74:[function(e,t,i){(function(i){function n(e,t){if(!(this instanceof n))return new n(e,t);if(t=t||{},e&&"object"==typeof e&&(t=e,e=null),e&&(e=c(e),t.host=e.host,t.secure="https"==e.protocol||"wss"==e.protocol,t.port=e.port,e.query&&(t.query=e.query)),this.secure=null!=t.secure?t.secure:i.location&&"https:"==location.protocol,t.host){var r=t.host.split(":");t.hostname=r.shift(),r.length?t.port=r.pop():t.port||(t.port=this.secure?"443":"80")}this.agent=t.agent||!1,this.hostname=t.hostname||(i.location?location.hostname:"localhost"),this.port=t.port||(i.location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=p.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.callbackBuffer=[],this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=t.rejectUnauthorized||null,this.open()}function r(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}var o=e("./transports"),s=e("component-emitter"),a=e("debug")("engine.io-client:socket"),h=e("indexof"),l=e("engine.io-parser"),c=e("parseuri"),u=e("parsejson"),p=e("parseqs");t.exports=n,n.priorWebsocketSuccess=!1,s(n.prototype),n.protocol=l.protocol,n.Socket=n,n.Transport=e("./transport"),n.transports=e("./transports"),n.parser=e("engine.io-parser"),n.prototype.createTransport=function(e){a('creating transport "%s"',e);var t=r(this.query);t.EIO=l.protocol,t.transport=e,this.id&&(t.sid=this.id);var i=new o[e]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized});return i},n.prototype.open=function(){var e;if(this.rememberUpgrade&&n.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))e="websocket";else{if(0==this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";var e;try{e=this.createTransport(e)}catch(i){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},n.prototype.setTransport=function(e){a("setting transport %s",e.name);var t=this;this.transport&&(a("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},n.prototype.probe=function(e){function t(){if(p.onlyBinaryUpgrades){var t=!this.supportsBinary&&p.transport.supportsBinary;u=u||t}u||(a('probe transport "%s" opened',e),c.send([{type:"ping",data:"probe"}]),c.once("packet",function(t){if(!u)if("pong"==t.type&&"probe"==t.data){if(a('probe transport "%s" pong',e),p.upgrading=!0,p.emit("upgrading",c),!c)return;n.priorWebsocketSuccess="websocket"==c.name,a('pausing current transport "%s"',p.transport.name),p.transport.pause(function(){u||"closed"!=p.readyState&&(a("changing transport and sending upgrade packet"),l(),p.setTransport(c),c.send([{type:"upgrade"}]),p.emit("upgrade",c),c=null,p.upgrading=!1,p.flush())})}else{a('probe transport "%s" failed',e);var i=new Error("probe error");i.transport=c.name,p.emit("upgradeError",i)}}))}function i(){u||(u=!0,l(),c.close(),c=null)}function r(t){var n=new Error("probe error: "+t);n.transport=c.name,i(),a('probe transport "%s" failed because of error: %s',e,t),p.emit("upgradeError",n)}function o(){r("transport closed")}function s(){r("socket closed")}function h(e){c&&e.name!=c.name&&(a('"%s" works - aborting "%s"',e.name,c.name),i())}function l(){c.removeListener("open",t),c.removeListener("error",r),c.removeListener("close",o),p.removeListener("close",s),p.removeListener("upgrading",h)}a('probing transport "%s"',e);var c=this.createTransport(e,{probe:1}),u=!1,p=this;n.priorWebsocketSuccess=!1,c.once("open",t),c.once("error",r),c.once("close",o),this.once("close",s),this.once("upgrading",h),c.open()},n.prototype.onOpen=function(){if(a("socket open"),this.readyState="open",n.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){a("starting upgrade probes");for(var e=0,t=this.upgrades.length;t>e;e++)this.probe(this.upgrades[e])}},n.prototype.onPacket=function(e){if("opening"==this.readyState||"open"==this.readyState)switch(a('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(u(e.data));break;case"pong":this.setPing();break;case"error":var t=new Error("server error");t.code=e.data,this.emit("error",t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else a('packet received with socket readyState "%s"',this.readyState)},n.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},n.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!=t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},n.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){a("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},n.prototype.ping=function(){this.sendPacket("ping")},n.prototype.onDrain=function(){for(var e=0;e<this.prevBufferLen;e++)this.callbackBuffer[e]&&this.callbackBuffer[e]();this.writeBuffer.splice(0,this.prevBufferLen),this.callbackBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0==this.writeBuffer.length?this.emit("drain"):this.flush()},n.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(a("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},n.prototype.write=n.prototype.send=function(e,t){return this.sendPacket("message",e,t),this},n.prototype.sendPacket=function(e,t,i){if("closing"!=this.readyState&&"closed"!=this.readyState){var n={type:e,data:t};this.emit("packetCreate",n),this.writeBuffer.push(n),this.callbackBuffer.push(i),this.flush()}},n.prototype.close=function(){function e(){n.onClose("forced close"),a("socket closing - telling transport to close"),n.transport.close()}function t(){n.removeListener("upgrade",t),n.removeListener("upgradeError",t),e()}function i(){n.once("upgrade",t),n.once("upgradeError",t)}if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var n=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?i():e()}):this.upgrading?i():e()}return this},n.prototype.onError=function(e){a("socket error %j",e),n.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},n.prototype.onClose=function(e,t){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){a('socket close with reason: "%s"',e);var i=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),setTimeout(function(){i.writeBuffer=[],i.callbackBuffer=[],i.prevBufferLen=0},0),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t)}},n.prototype.filterUpgrades=function(e){for(var t=[],i=0,n=e.length;n>i;i++)~h(this.transports,e[i])&&t.push(e[i]);return t}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./transport":75,"./transports":76,"component-emitter":70,debug:83,"engine.io-parser":86,indexof:101,parsejson:95,parseqs:96,parseuri:97}],75:[function(e,t,i){function n(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized}var r=e("engine.io-parser"),o=e("component-emitter");t.exports=n,o(n.prototype),n.timestamps=0,n.prototype.onError=function(e,t){var i=new Error(e);return i.type="TransportError",i.description=t,this.emit("error",i),this},n.prototype.open=function(){return("closed"==this.readyState||""==this.readyState)&&(this.readyState="opening",this.doOpen()),this},n.prototype.close=function(){return("opening"==this.readyState||"open"==this.readyState)&&(this.doClose(),this.onClose()),this},n.prototype.send=function(e){if("open"!=this.readyState)throw new Error("Transport not open");this.write(e)},n.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},n.prototype.onData=function(e){var t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)},n.prototype.onPacket=function(e){this.emit("packet",e)},n.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"component-emitter":70,"engine.io-parser":86}],76:[function(e,t,i){(function(t){function n(e){var i,n=!1,a=!1,h=!1!==e.jsonp;if(t.location){var l="https:"==location.protocol,c=location.port;c||(c=l?443:80),n=e.hostname!=location.hostname||c!=e.port,a=e.secure!=l}if(e.xdomain=n,e.xscheme=a,i=new r(e),"open"in i&&!e.forceJSONP)return new o(e);if(!h)throw new Error("JSONP disabled");return new s(e)}var r=e("xmlhttprequest"),o=e("./polling-xhr"),s=e("./polling-jsonp"),a=e("./websocket");i.polling=n,i.websocket=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling-jsonp":77,"./polling-xhr":78,"./websocket":80,xmlhttprequest:81}],77:[function(e,t,i){(function(i){function n(){}function r(e){o.call(this,e),this.query=this.query||{},a||(i.___eio||(i.___eio=[]),a=i.___eio),this.index=a.length;var t=this;a.push(function(e){t.onData(e)}),this.query.j=this.index,i.document&&i.addEventListener&&i.addEventListener("beforeunload",function(){t.script&&(t.script.onerror=n)},!1)}var o=e("./polling"),s=e("component-inherit");
t.exports=r;var a,h=/\n/g,l=/\\n/g;s(r,o),r.prototype.supportsBinary=!1,r.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),o.prototype.doClose.call(this)},r.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(t,i),this.script=t;var n="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);n&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},r.prototype.doWrite=function(e,t){function i(){n(),t()}function n(){if(r.iframe)try{r.form.removeChild(r.iframe)}catch(e){r.onError("jsonp polling iframe removal error",e)}try{var t='<iframe src="javascript:0" name="'+r.iframeId+'">';o=document.createElement(t)}catch(e){o=document.createElement("iframe"),o.name=r.iframeId,o.src="javascript:0"}o.id=r.iframeId,r.form.appendChild(o),r.iframe=o}var r=this;if(!this.form){var o,s=document.createElement("form"),a=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=c,s.method="POST",s.setAttribute("accept-charset","utf-8"),a.name="d",s.appendChild(a),document.body.appendChild(s),this.form=s,this.area=a}this.form.action=this.uri(),n(),e=e.replace(l,"\\\n"),this.area.value=e.replace(h,"\\n");try{this.form.submit()}catch(u){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==r.iframe.readyState&&i()}:this.iframe.onload=i}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":79,"component-inherit":82}],78:[function(e,t,i){(function(i){function n(){}function r(e){if(h.call(this,e),i.location){var t="https:"==location.protocol,n=location.port;n||(n=t?443:80),this.xd=e.hostname!=i.location.hostname||n!=e.port,this.xs=e.secure!=t}}function o(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!=e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.create()}function s(){for(var e in o.requests)o.requests.hasOwnProperty(e)&&o.requests[e].abort()}var a=e("xmlhttprequest"),h=e("./polling"),l=e("component-emitter"),c=e("component-inherit"),u=e("debug")("engine.io-client:polling-xhr");t.exports=r,t.exports.Request=o,c(r,h),r.prototype.supportsBinary=!0,r.prototype.request=function(e){return e=e||{},e.uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,new o(e)},r.prototype.doWrite=function(e,t){var i="string"!=typeof e&&void 0!==e,n=this.request({method:"POST",data:e,isBinary:i}),r=this;n.on("success",t),n.on("error",function(e){r.onError("xhr post error",e)}),this.sendXhr=n},r.prototype.doPoll=function(){u("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},l(o.prototype),o.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new a(e),n=this;try{if(u("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async),this.supportsBinary&&(t.responseType="arraybuffer"),"POST"==this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(r){}"withCredentials"in t&&(t.withCredentials=!0),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){4==t.readyState&&(200==t.status||1223==t.status?n.onLoad():setTimeout(function(){n.onError(t.status)},0))},u("xhr data %s",this.data),t.send(this.data)}catch(r){return void setTimeout(function(){n.onError(r)},0)}i.document&&(this.index=o.requestsCount++,o.requests[this.index]=this)},o.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},o.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},o.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},o.prototype.cleanup=function(e){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=n:this.xhr.onreadystatechange=n,e)try{this.xhr.abort()}catch(t){}i.document&&delete o.requests[this.index],this.xhr=null}},o.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(i){}e="application/octet-stream"===t?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(i){this.onError(i)}null!=e&&this.onData(e)},o.prototype.hasXDR=function(){return"undefined"!=typeof i.XDomainRequest&&!this.xs&&this.enablesXDR},o.prototype.abort=function(){this.cleanup()},i.document&&(o.requestsCount=0,o.requests={},i.attachEvent?i.attachEvent("onunload",s):i.addEventListener&&i.addEventListener("beforeunload",s,!1))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":79,"component-emitter":70,"component-inherit":82,debug:83,xmlhttprequest:81}],79:[function(e,t,i){function n(e){var t=e&&e.forceBase64;(!l||t)&&(this.supportsBinary=!1),r.call(this,e)}var r=e("../transport"),o=e("parseqs"),s=e("engine.io-parser"),a=e("component-inherit"),h=e("debug")("engine.io-client:polling");t.exports=n;var l=function(){var t=e("xmlhttprequest"),i=new t({xdomain:!1});return null!=i.responseType}();a(n,r),n.prototype.name="polling",n.prototype.doOpen=function(){this.poll()},n.prototype.pause=function(e){function t(){h("paused"),i.readyState="paused",e()}var i=this;if(this.readyState="pausing",this.polling||!this.writable){var n=0;this.polling&&(h("we are currently polling - waiting to pause"),n++,this.once("pollComplete",function(){h("pre-pause polling complete"),--n||t()})),this.writable||(h("we are currently writing - waiting to pause"),n++,this.once("drain",function(){h("pre-pause writing complete"),--n||t()}))}else t()},n.prototype.poll=function(){h("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},n.prototype.onData=function(e){var t=this;h("polling got data %s",e);var i=function(e,i,n){return"opening"==t.readyState&&t.onOpen(),"close"==e.type?(t.onClose(),!1):void t.onPacket(e)};s.decodePayload(e,this.socket.binaryType,i),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():h('ignoring poll - transport state "%s"',this.readyState))},n.prototype.doClose=function(){function e(){h("writing close packet"),t.write([{type:"close"}])}var t=this;"open"==this.readyState?(h("transport open - closing"),e()):(h("transport not open - deferring close"),this.once("open",e))},n.prototype.write=function(e){var t=this;this.writable=!1;var i=function(){t.writable=!0,t.emit("drain")},t=this;s.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,i)})},n.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",i="";return!1!==this.timestampRequests&&(e[this.timestampParam]=+new Date+"-"+r.timestamps++),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"==t&&443!=this.port||"http"==t&&80!=this.port)&&(i=":"+this.port),e.length&&(e="?"+e),t+"://"+this.hostname+i+this.path+e}},{"../transport":75,"component-inherit":82,debug:83,"engine.io-parser":86,parseqs:96,xmlhttprequest:81}],80:[function(e,t,i){function n(e){var t=e&&e.forceBase64;t&&(this.supportsBinary=!1),r.call(this,e)}var r=e("../transport"),o=e("engine.io-parser"),s=e("parseqs"),a=e("component-inherit"),h=e("debug")("engine.io-client:websocket"),l=e("ws");t.exports=n,a(n,r),n.prototype.name="websocket",n.prototype.supportsBinary=!0,n.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=void 0,i={agent:this.agent};i.pfx=this.pfx,i.key=this.key,i.passphrase=this.passphrase,i.cert=this.cert,i.ca=this.ca,i.ciphers=this.ciphers,i.rejectUnauthorized=this.rejectUnauthorized,this.ws=new l(e,t,i),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.binaryType="arraybuffer",this.addEventListeners()}},n.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(n.prototype.onData=function(e){var t=this;setTimeout(function(){r.prototype.onData.call(t,e)},0)}),n.prototype.write=function(e){function t(){i.writable=!0,i.emit("drain")}var i=this;this.writable=!1;for(var n=0,r=e.length;r>n;n++)o.encodePacket(e[n],this.supportsBinary,function(e){try{i.ws.send(e)}catch(t){h("websocket closed before onclose event")}});setTimeout(t,0)},n.prototype.onClose=function(){r.prototype.onClose.call(this)},n.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},n.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",i="";return this.port&&("wss"==t&&443!=this.port||"ws"==t&&80!=this.port)&&(i=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=+new Date),this.supportsBinary||(e.b64=1),e=s.encode(e),e.length&&(e="?"+e),t+"://"+this.hostname+i+this.path+e},n.prototype.check=function(){return!(!l||"__initialize"in l&&this.name===n.prototype.name)}},{"../transport":75,"component-inherit":82,debug:83,"engine.io-parser":86,parseqs:96,ws:98}],81:[function(e,t,i){var n=e("has-cors");t.exports=function(e){var t=e.xdomain,i=e.xscheme,r=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||n))return new XMLHttpRequest}catch(o){}try{if("undefined"!=typeof XDomainRequest&&!i&&r)return new XDomainRequest}catch(o){}if(!t)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(o){}}},{"has-cors":93}],82:[function(e,t,i){t.exports=function(e,t){var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}},{}],83:[function(e,t,i){function n(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function r(){var e=arguments,t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+i.humanize(this.diff),!t)return e;var n="color: "+this.color;e=[e[0],n,"color: inherit"].concat(Array.prototype.slice.call(e,1));var r=0,o=0;return e[0].replace(/%[a-z%]/g,function(e){"%"!==e&&(r++,"%c"===e&&(o=r))}),e.splice(o,0,n),e}function o(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(e){try{null==e?localStorage.removeItem("debug"):localStorage.debug=e}catch(t){}}function a(){var e;try{e=localStorage.debug}catch(t){}return e}i=t.exports=e("./debug"),i.log=o,i.formatArgs=r,i.save=s,i.load=a,i.useColors=n,i.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],i.formatters.j=function(e){return JSON.stringify(e)},i.enable(a())},{"./debug":84}],84:[function(e,t,i){function n(){return i.colors[c++%i.colors.length]}function r(e){function t(){}function r(){var e=r,t=+new Date,o=t-(l||t);e.diff=o,e.prev=l,e.curr=t,l=t,null==e.useColors&&(e.useColors=i.useColors()),null==e.color&&e.useColors&&(e.color=n());var s=Array.prototype.slice.call(arguments);s[0]=i.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var a=0;s[0]=s[0].replace(/%([a-z%])/g,function(t,n){if("%"===t)return t;a++;var r=i.formatters[n];if("function"==typeof r){var o=s[a];t=r.call(e,o),s.splice(a,1),a--}return t}),"function"==typeof i.formatArgs&&(s=i.formatArgs.apply(e,s));var h=r.log||i.log||console.log.bind(console);h.apply(e,s)}t.enabled=!1,r.enabled=!0;var o=i.enabled(e)?r:t;return o.namespace=e,o}function o(e){i.save(e);for(var t=(e||"").split(/[\s,]+/),n=t.length,r=0;n>r;r++)t[r]&&(e=t[r].replace(/\*/g,".*?"),"-"===e[0]?i.skips.push(new RegExp("^"+e.substr(1)+"$")):i.names.push(new RegExp("^"+e+"$")))}function s(){i.enable("")}function a(e){var t,n;for(t=0,n=i.skips.length;n>t;t++)if(i.skips[t].test(e))return!1;for(t=0,n=i.names.length;n>t;t++)if(i.names[t].test(e))return!0;return!1}function h(e){return e instanceof Error?e.stack||e.message:e}i=t.exports=r,i.coerce=h,i.disable=s,i.enable=o,i.enabled=a,i.humanize=e("ms"),i.names=[],i.skips=[],i.formatters={};var l,c=0},{ms:85}],85:[function(e,t,i){function n(e){var t=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(e);if(t){var i=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"y":return i*u;case"days":case"day":case"d":return i*c;case"hours":case"hour":case"h":return i*l;case"minutes":case"minute":case"m":return i*h;case"seconds":case"second":case"s":return i*a;case"ms":return i}}}function r(e){return e>=c?Math.round(e/c)+"d":e>=l?Math.round(e/l)+"h":e>=h?Math.round(e/h)+"m":e>=a?Math.round(e/a)+"s":e+"ms"}function o(e){return s(e,c,"day")||s(e,l,"hour")||s(e,h,"minute")||s(e,a,"second")||e+" ms"}function s(e,t,i){return t>e?void 0:1.5*t>e?Math.floor(e/t)+" "+i:Math.ceil(e/t)+" "+i+"s"}var a=1e3,h=60*a,l=60*h,c=24*l,u=365.25*c;t.exports=function(e,t){return t=t||{},"string"==typeof e?n(e):t["long"]?o(e):r(e)}},{}],86:[function(e,t,i){(function(t){function n(e,t){var n="b"+i.packets[e.type]+e.data.data;return t(n)}function r(e,t,n){if(!t)return i.encodeBase64Packet(e,n);var r=e.data,o=new Uint8Array(r),s=new Uint8Array(1+r.byteLength);s[0]=g[e.type];for(var a=0;a<o.length;a++)s[a+1]=o[a];return n(s.buffer)}function o(e,t,n){if(!t)return i.encodeBase64Packet(e,n);var r=new FileReader;return r.onload=function(){e.data=r.result,i.encodePacket(e,t,!0,n)},r.readAsArrayBuffer(e.data)}function s(e,t,n){if(!t)return i.encodeBase64Packet(e,n);if(y)return o(e,t,n);var r=new Uint8Array(1);r[0]=g[e.type];var s=new _([r.buffer,e.data]);return n(s)}function a(e,t,i){for(var n=new Array(e.length),r=p(e.length,i),o=function(e,i,r){t(i,function(t,i){n[e]=i,r(t,n)})},s=0;s<e.length;s++)o(s,e[s],r)}var h=e("./keys"),l=e("has-binary"),c=e("arraybuffer.slice"),u=e("base64-arraybuffer"),p=e("after"),d=e("utf8"),f=navigator.userAgent.match(/Android/i),m=/PhantomJS/i.test(navigator.userAgent),y=f||m;i.protocol=3;var g=i.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},v=h(g),b={type:"error",data:"parser error"},_=e("blob");i.encodePacket=function(e,i,o,a){"function"==typeof i&&(a=i,i=!1),"function"==typeof o&&(a=o,o=null);var h=void 0===e.data?void 0:e.data.buffer||e.data;if(t.ArrayBuffer&&h instanceof ArrayBuffer)return r(e,i,a);if(_&&h instanceof t.Blob)return s(e,i,a);if(h&&h.base64)return n(e,a);var l=g[e.type];return void 0!==e.data&&(l+=o?d.encode(String(e.data)):String(e.data)),a(""+l)},i.encodeBase64Packet=function(e,n){var r="b"+i.packets[e.type];if(_&&e.data instanceof _){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];n(r+e)},o.readAsDataURL(e.data)}var s;try{s=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(a){for(var h=new Uint8Array(e.data),l=new Array(h.length),c=0;c<h.length;c++)l[c]=h[c];s=String.fromCharCode.apply(null,l)}return r+=t.btoa(s),n(r)},i.decodePacket=function(e,t,n){if("string"==typeof e||void 0===e){if("b"==e.charAt(0))return i.decodeBase64Packet(e.substr(1),t);if(n)try{e=d.decode(e)}catch(r){return b}var o=e.charAt(0);return Number(o)==o&&v[o]?e.length>1?{type:v[o],data:e.substring(1)}:{type:v[o]}:b}var s=new Uint8Array(e),o=s[0],a=c(e,1);return _&&"blob"===t&&(a=new _([a])),{type:v[o],data:a}},i.decodeBase64Packet=function(e,i){var n=v[e.charAt(0)];if(!t.ArrayBuffer)return{type:n,data:{base64:!0,data:e.substr(1)}};var r=u.decode(e.substr(1));return"blob"===i&&_&&(r=new _([r])),{type:n,data:r}},i.encodePayload=function(e,t,n){function r(e){return e.length+":"+e}function o(e,n){i.encodePacket(e,s?t:!1,!0,function(e){n(null,r(e))})}"function"==typeof t&&(n=t,t=null);var s=l(e);return t&&s?_&&!y?i.encodePayloadAsBlob(e,n):i.encodePayloadAsArrayBuffer(e,n):e.length?void a(e,o,function(e,t){return n(t.join(""))}):n("0:")},i.decodePayload=function(e,t,n){if("string"!=typeof e)return i.decodePayloadAsBinary(e,t,n);"function"==typeof t&&(n=t,t=null);var r;if(""==e)return n(b,0,1);for(var o,s,a="",h=0,l=e.length;l>h;h++){var c=e.charAt(h);if(":"!=c)a+=c;else{if(""==a||a!=(o=Number(a)))return n(b,0,1);if(s=e.substr(h+1,o),a!=s.length)return n(b,0,1);if(s.length){if(r=i.decodePacket(s,t,!0),b.type==r.type&&b.data==r.data)return n(b,0,1);var u=n(r,h+o,l);if(!1===u)return}h+=o,a=""}}return""!=a?n(b,0,1):void 0},i.encodePayloadAsArrayBuffer=function(e,t){function n(e,t){i.encodePacket(e,!0,!0,function(e){return t(null,e)})}return e.length?void a(e,n,function(e,i){var n=i.reduce(function(e,t){var i;return i="string"==typeof t?t.length:t.byteLength,e+i.toString().length+i+2},0),r=new Uint8Array(n),o=0;return i.forEach(function(e){var t="string"==typeof e,i=e;if(t){for(var n=new Uint8Array(e.length),s=0;s<e.length;s++)n[s]=e.charCodeAt(s);i=n.buffer}t?r[o++]=0:r[o++]=1;for(var a=i.byteLength.toString(),s=0;s<a.length;s++)r[o++]=parseInt(a[s]);r[o++]=255;for(var n=new Uint8Array(i),s=0;s<n.length;s++)r[o++]=n[s]}),t(r.buffer)}):t(new ArrayBuffer(0))},i.encodePayloadAsBlob=function(e,t){function n(e,t){i.encodePacket(e,!0,!0,function(e){var i=new Uint8Array(1);if(i[0]=1,"string"==typeof e){for(var n=new Uint8Array(e.length),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);e=n.buffer,i[0]=0}for(var o=e instanceof ArrayBuffer?e.byteLength:e.size,s=o.toString(),a=new Uint8Array(s.length+1),r=0;r<s.length;r++)a[r]=parseInt(s[r]);if(a[s.length]=255,_){var h=new _([i.buffer,a.buffer,e]);t(null,h)}})}a(e,n,function(e,i){return t(new _(i))})},i.decodePayloadAsBinary=function(e,t,n){"function"==typeof t&&(n=t,t=null);for(var r=e,o=[],s=!1;r.byteLength>0;){for(var a=new Uint8Array(r),h=0===a[0],l="",u=1;255!=a[u];u++){if(l.length>310){s=!0;break}l+=a[u]}if(s)return n(b,0,1);r=c(r,2+l.length),l=parseInt(l);var p=c(r,0,l);if(h)try{p=String.fromCharCode.apply(null,new Uint8Array(p))}catch(d){var f=new Uint8Array(p);p="";for(var u=0;u<f.length;u++)p+=String.fromCharCode(f[u])}o.push(p),r=c(r,l)}var m=o.length;o.forEach(function(e,r){n(i.decodePacket(e,t,!0),r,m)})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./keys":87,after:88,"arraybuffer.slice":89,"base64-arraybuffer":90,blob:91,"has-binary":99,utf8:92}],87:[function(e,t,i){t.exports=Object.keys||function(e){var t=[],i=Object.prototype.hasOwnProperty;for(var n in e)i.call(e,n)&&t.push(n);return t}},{}],88:[function(e,t,i){function n(e,t,i){function n(e,r){if(n.count<=0)throw new Error("after called too many times");--n.count,e?(o=!0,t(e),t=i):0!==n.count||o||t(null,r)}var o=!1;return i=i||r,n.count=e,0===e?t():n}function r(){}t.exports=n},{}],89:[function(e,t,i){t.exports=function(e,t,i){var n=e.byteLength;if(t=t||0,i=i||n,e.slice)return e.slice(t,i);if(0>t&&(t+=n),0>i&&(i+=n),i>n&&(i=n),t>=n||t>=i||0===n)return new ArrayBuffer(0);for(var r=new Uint8Array(e),o=new Uint8Array(i-t),s=t,a=0;i>s;s++,a++)o[a]=r[s];return o.buffer}},{}],90:[function(e,t,i){!function(e){"use strict";i.encode=function(t){var i,n=new Uint8Array(t),r=n.length,o="";for(i=0;r>i;i+=3)o+=e[n[i]>>2],o+=e[(3&n[i])<<4|n[i+1]>>4],o+=e[(15&n[i+1])<<2|n[i+2]>>6],o+=e[63&n[i+2]];return r%3===2?o=o.substring(0,o.length-1)+"=":r%3===1&&(o=o.substring(0,o.length-2)+"=="),o},i.decode=function(t){var i,n,r,o,s,a=.75*t.length,h=t.length,l=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var c=new ArrayBuffer(a),u=new Uint8Array(c);for(i=0;h>i;i+=4)n=e.indexOf(t[i]),r=e.indexOf(t[i+1]),o=e.indexOf(t[i+2]),s=e.indexOf(t[i+3]),u[l++]=n<<2|r>>4,u[l++]=(15&r)<<4|o>>2,u[l++]=(3&o)<<6|63&s;return c}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],91:[function(e,t,i){(function(e){function i(e){for(var t=0;t<e.length;t++){var i=e[t];if(i.buffer instanceof ArrayBuffer){var n=i.buffer;if(i.byteLength!==n.byteLength){var r=new Uint8Array(i.byteLength);r.set(new Uint8Array(n,i.byteOffset,i.byteLength)),n=r.buffer}e[t]=n}}}function n(e,t){t=t||{};var n=new o;i(e);for(var r=0;r<e.length;r++)n.append(e[r]);return t.type?n.getBlob(t.type):n.getBlob()}function r(e,t){return i(e),new Blob(e,t||{})}var o=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder,s=function(){try{var e=new Blob(["hi"]);return 2===e.size}catch(t){return!1}}(),a=s&&function(){try{var e=new Blob([new Uint8Array([1,2])]);return 2===e.size}catch(t){return!1}}(),h=o&&o.prototype.append&&o.prototype.getBlob;t.exports=function(){return s?a?e.Blob:r:h?n:void 0}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],92:[function(e,t,i){(function(e){!function(n){function r(e){for(var t,i,n=[],r=0,o=e.length;o>r;)t=e.charCodeAt(r++),t>=55296&&56319>=t&&o>r?(i=e.charCodeAt(r++),56320==(64512&i)?n.push(((1023&t)<<10)+(1023&i)+65536):(n.push(t),r--)):n.push(t);return n}function o(e){for(var t,i=e.length,n=-1,r="";++n<i;)t=e[n],t>65535&&(t-=65536,r+=b(t>>>10&1023|55296),t=56320|1023&t),r+=b(t);return r}function s(e){if(e>=55296&&57343>=e)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}function a(e,t){return b(e>>t&63|128)}function h(e){if(0==(4294967168&e))return b(e);var t="";return 0==(4294965248&e)?t=b(e>>6&31|192):0==(4294901760&e)?(s(e),t=b(e>>12&15|224),t+=a(e,6)):0==(4292870144&e)&&(t=b(e>>18&7|240),t+=a(e,12),t+=a(e,6)),t+=b(63&e|128)}function l(e){for(var t,i=r(e),n=i.length,o=-1,s="";++o<n;)t=i[o],s+=h(t);return s}function c(){if(v>=g)throw Error("Invalid byte index");var e=255&y[v];if(v++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function u(){var e,t,i,n,r;if(v>g)throw Error("Invalid byte index");if(v==g)return!1;if(e=255&y[v],v++,0==(128&e))return e;if(192==(224&e)){var t=c();if(r=(31&e)<<6|t,r>=128)return r;throw Error("Invalid continuation byte")}if(224==(240&e)){if(t=c(),i=c(),r=(15&e)<<12|t<<6|i,r>=2048)return s(r),r;throw Error("Invalid continuation byte")}if(240==(248&e)&&(t=c(),i=c(),n=c(),r=(15&e)<<18|t<<12|i<<6|n,r>=65536&&1114111>=r))return r;throw Error("Invalid UTF-8 detected")}function p(e){y=r(e),g=y.length,v=0;for(var t,i=[];(t=u())!==!1;)i.push(t);return o(i)}var d="object"==typeof i&&i,f="object"==typeof t&&t&&t.exports==d&&t,m="object"==typeof e&&e;(m.global===m||m.window===m)&&(n=m);var y,g,v,b=String.fromCharCode,_={version:"2.0.0",encode:l,decode:p};if("function"==typeof define&&"object"==typeof define.amd&&define.amd)define(function(){return _});else if(d&&!d.nodeType)if(f)f.exports=_;else{var x={},w=x.hasOwnProperty;for(var S in _)w.call(_,S)&&(d[S]=_[S])}else n.utf8=_}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],93:[function(e,t,i){var n=e("global");try{t.exports="XMLHttpRequest"in n&&"withCredentials"in new n.XMLHttpRequest}catch(r){t.exports=!1}},{global:94}],94:[function(e,t,i){t.exports=function(){return this}()},{}],95:[function(e,t,i){(function(e){var i=/^[\],:{}\s]*$/,n=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,r=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,o=/(?:^|:|,)(?:\s*\[)+/g,s=/^\s+/,a=/\s+$/;t.exports=function(t){return"string"==typeof t&&t?(t=t.replace(s,"").replace(a,""),e.JSON&&JSON.parse?JSON.parse(t):i.test(t.replace(n,"@").replace(r,"]").replace(o,""))?new Function("return "+t)():void 0):null}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],96:[function(e,t,i){i.encode=function(e){var t="";for(var i in e)e.hasOwnProperty(i)&&(t.length&&(t+="&"),t+=encodeURIComponent(i)+"="+encodeURIComponent(e[i]));return t},i.decode=function(e){for(var t={},i=e.split("&"),n=0,r=i.length;r>n;n++){var o=i[n].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},{}],97:[function(e,t,i){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(e){var t=e,i=e.indexOf("["),o=e.indexOf("]");-1!=i&&-1!=o&&(e=e.substring(0,i)+e.substring(i,o).replace(/:/g,";")+e.substring(o,e.length));for(var s=n.exec(e||""),a={},h=14;h--;)a[r[h]]=s[h]||"";return-1!=i&&-1!=o&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},{}],98:[function(e,t,i){function n(e,t,i){var n;return n=t?new o(e,t):new o(e)}var r=function(){return this}(),o=r.WebSocket||r.MozWebSocket;t.exports=o?n:null,o&&(n.prototype=o.prototype)},{}],99:[function(e,t,i){(function(i){function n(e){function t(e){if(!e)return!1;if(i.Buffer&&i.Buffer.isBuffer(e)||i.ArrayBuffer&&e instanceof ArrayBuffer||i.Blob&&e instanceof Blob||i.File&&e instanceof File)return!0;if(r(e)){for(var n=0;n<e.length;n++)if(t(e[n]))return!0}else if(e&&"object"==typeof e){e.toJSON&&(e=e.toJSON());for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&t(e[o]))return!0}return!1}return t(e)}var r=e("isarray");t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:100}],100:[function(e,t,i){t.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},{}],101:[function(e,t,i){var n=[].indexOf;t.exports=function(e,t){if(n)return e.indexOf(t);for(var i=0;i<e.length;++i)if(e[i]===t)return i;return-1}},{}],102:[function(e,t,i){var n=Object.prototype.hasOwnProperty;i.keys=Object.keys||function(e){var t=[];for(var i in e)n.call(e,i)&&t.push(i);return t},i.values=function(e){var t=[];for(var i in e)n.call(e,i)&&t.push(e[i]);return t},i.merge=function(e,t){for(var i in t)n.call(t,i)&&(e[i]=t[i]);return e},i.length=function(e){return i.keys(e).length},i.isEmpty=function(e){return 0==i.length(e)}},{}],103:[function(e,t,i){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(e){for(var t=n.exec(e||""),i={},o=14;o--;)i[r[o]]=t[o]||"";return i}},{}],104:[function(e,t,i){(function(t){var n=e("isarray"),r=e("./is-buffer");i.deconstructPacket=function(e){function t(e){if(!e)return e;if(r(e)){var o={_placeholder:!0,num:i.length};return i.push(e),o}if(n(e)){for(var s=new Array(e.length),a=0;a<e.length;a++)s[a]=t(e[a]);return s}if("object"==typeof e&&!(e instanceof Date)){var s={};for(var h in e)s[h]=t(e[h]);return s}return e}var i=[],o=e.data,s=e;return s.data=t(o),s.attachments=i.length,{packet:s,buffers:i}},i.reconstructPacket=function(e,t){function i(e){if(e&&e._placeholder){var r=t[e.num];return r}if(n(e)){for(var o=0;o<e.length;o++)e[o]=i(e[o]);return e}if(e&&"object"==typeof e){for(var s in e)e[s]=i(e[s]);return e}return e}return e.data=i(e.data),e.attachments=void 0,e},i.removeBlobs=function(e,i){function o(e,h,l){if(!e)return e;if(t.Blob&&e instanceof Blob||t.File&&e instanceof File){s++;var c=new FileReader;c.onload=function(){l?l[h]=this.result:a=this.result,--s||i(a)},c.readAsArrayBuffer(e)}else if(n(e))for(var u=0;u<e.length;u++)o(e[u],u,e);else if(e&&"object"==typeof e&&!r(e))for(var p in e)o(e[p],p,e)}var s=0,a=e;o(a),s||i(a)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-buffer":106,isarray:107}],105:[function(e,t,i){function n(){}function r(e){var t="",n=!1;return t+=e.type,(i.BINARY_EVENT==e.type||i.BINARY_ACK==e.type)&&(t+=e.attachments,t+="-"),e.nsp&&"/"!=e.nsp&&(n=!0,t+=e.nsp),null!=e.id&&(n&&(t+=",",n=!1),t+=e.id),null!=e.data&&(n&&(t+=","),t+=u.stringify(e.data)),c("encoded %j as %s",e,t),t}function o(e,t){function i(e){var i=d.deconstructPacket(e),n=r(i.packet),o=i.buffers;o.unshift(n),t(o)}d.removeBlobs(e,i)}function s(){this.reconstructor=null}function a(e){var t={},n=0;if(t.type=Number(e.charAt(0)),null==i.types[t.type])return l();if(i.BINARY_EVENT==t.type||i.BINARY_ACK==t.type){for(var r="";"-"!=e.charAt(++n)&&(r+=e.charAt(n),n!=e.length););if(r!=Number(r)||"-"!=e.charAt(n))throw new Error("Illegal attachments");t.attachments=Number(r)}if("/"==e.charAt(n+1))for(t.nsp="";++n;){var o=e.charAt(n);if(","==o)break;if(t.nsp+=o,n==e.length)break}else t.nsp="/";var s=e.charAt(n+1);if(""!==s&&Number(s)==s){for(t.id="";++n;){var o=e.charAt(n);if(null==o||Number(o)!=o){--n;break}if(t.id+=e.charAt(n),n==e.length)break}t.id=Number(t.id)}if(e.charAt(++n))try{t.data=u.parse(e.substr(n))}catch(a){return l()}return c("decoded %s as %j",e,t),t}function h(e){this.reconPack=e,this.buffers=[]}function l(e){return{type:i.ERROR,data:"parser error"}}var c=e("debug")("socket.io-parser"),u=e("json3"),p=(e("isarray"),e("component-emitter")),d=e("./binary"),f=e("./is-buffer");i.protocol=4,i.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],i.CONNECT=0,i.DISCONNECT=1,i.EVENT=2,i.ACK=3,i.ERROR=4,i.BINARY_EVENT=5,i.BINARY_ACK=6,i.Encoder=n,i.Decoder=s,n.prototype.encode=function(e,t){if(c("encoding packet %j",e),i.BINARY_EVENT==e.type||i.BINARY_ACK==e.type)o(e,t);else{var n=r(e);t([n])}},p(s.prototype),s.prototype.add=function(e){var t;if("string"==typeof e)t=a(e),i.BINARY_EVENT==t.type||i.BINARY_ACK==t.type?(this.reconstructor=new h(t),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",t)):this.emit("decoded",t);else{if(!f(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,this.emit("decoded",t))}},s.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},h.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length==this.reconPack.attachments){var t=d.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},h.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{"./binary":104,"./is-buffer":106,"component-emitter":70,debug:71,isarray:107,json3:108}],106:[function(e,t,i){(function(e){function i(t){return e.Buffer&&e.Buffer.isBuffer(t)||e.ArrayBuffer&&t instanceof ArrayBuffer}t.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],107:[function(e,t,i){arguments[4][100][0].apply(i,arguments)},{dup:100}],108:[function(e,t,i){!function(e){function t(e){if(t[e]!==o)return t[e];var i;
if("bug-string-char-index"==e)i="a"!="a"[0];else if("json"==e)i=t("json-stringify")&&t("json-parse");else{var n,r='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var a=l.stringify,h="function"==typeof a&&c;if(h){(n=function(){return 1}).toJSON=n;try{h="0"===a(0)&&"0"===a(new Number)&&'""'==a(new String)&&a(s)===o&&a(o)===o&&a()===o&&"1"===a(n)&&"[1]"==a([n])&&"[null]"==a([o])&&"null"==a(null)&&"[null,null,null]"==a([o,s,null])&&a({a:[n,!0,!1,null,"\x00\b\n\f\r	"]})==r&&"1"===a(null,n)&&"[\n 1,\n 2\n]"==a([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==a(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==a(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==a(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==a(new Date(-1))}catch(u){h=!1}}i=h}if("json-parse"==e){var p=l.parse;if("function"==typeof p)try{if(0===p("0")&&!p(!1)){n=p(r);var d=5==n.a.length&&1===n.a[0];if(d){try{d=!p('"	"')}catch(u){}if(d)try{d=1!==p("01")}catch(u){}if(d)try{d=1!==p("1.")}catch(u){}}}}catch(u){d=!1}i=d}}return t[e]=!!i}var n,r,o,s={}.toString,a="function"==typeof define&&define.amd,h="object"==typeof JSON&&JSON,l="object"==typeof i&&i&&!i.nodeType&&i;l&&h?(l.stringify=h.stringify,l.parse=h.parse):l=e.JSON=h||{};var c=new Date(-0xc782b5b800cec);try{c=-109252==c.getUTCFullYear()&&0===c.getUTCMonth()&&1===c.getUTCDate()&&10==c.getUTCHours()&&37==c.getUTCMinutes()&&6==c.getUTCSeconds()&&708==c.getUTCMilliseconds()}catch(u){}if(!t("json")){var p="[object Function]",d="[object Date]",f="[object Number]",m="[object String]",y="[object Array]",g="[object Boolean]",v=t("bug-string-char-index");if(!c)var b=Math.floor,_=[0,31,59,90,120,151,181,212,243,273,304,334],x=function(e,t){return _[t]+365*(e-1970)+b((e-1969+(t=+(t>1)))/4)-b((e-1901+t)/100)+b((e-1601+t)/400)};(n={}.hasOwnProperty)||(n=function(e){var t,i={};return(i.__proto__=null,i.__proto__={toString:1},i).toString!=s?n=function(e){var t=this.__proto__,i=e in(this.__proto__=null,this);return this.__proto__=t,i}:(t=i.constructor,n=function(e){var i=(this.constructor||t).prototype;return e in this&&!(e in i&&this[e]===i[e])}),i=null,n.call(this,e)});var w={"boolean":1,number:1,string:1,undefined:1},S=function(e,t){var i=typeof e[t];return"object"==i?!!e[t]:!w[i]};if(r=function(e,t){var i,o,a,h=0;(i=function(){this.valueOf=0}).prototype.valueOf=0,o=new i;for(a in o)n.call(o,a)&&h++;return i=o=null,h?r=2==h?function(e,t){var i,r={},o=s.call(e)==p;for(i in e)o&&"prototype"==i||n.call(r,i)||!(r[i]=1)||!n.call(e,i)||t(i)}:function(e,t){var i,r,o=s.call(e)==p;for(i in e)o&&"prototype"==i||!n.call(e,i)||(r="constructor"===i)||t(i);(r||n.call(e,i="constructor"))&&t(i)}:(o=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],r=function(e,t){var i,r,a=s.call(e)==p,h=!a&&"function"!=typeof e.constructor&&S(e,"hasOwnProperty")?e.hasOwnProperty:n;for(i in e)a&&"prototype"==i||!h.call(e,i)||t(i);for(r=o.length;i=o[--r];h.call(e,i)&&t(i));}),r(e,t)},!t("json-stringify")){var M={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},T="000000",E=function(e,t){return(T+(t||0)).slice(-e)},k="\\u00",A=function(e){var t,i='"',n=0,r=e.length,o=r>10&&v;for(o&&(t=e.split(""));r>n;n++){var s=e.charCodeAt(n);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:i+=M[s];break;default:if(32>s){i+=k+E(2,s.toString(16));break}i+=o?t[n]:v?e.charAt(n):e[n]}}return i+'"'},C=function(e,t,i,a,h,l,c){var u,p,v,_,w,S,M,T,k,P,L,R,O,F,D,B;try{u=t[e]}catch(N){}if("object"==typeof u&&u)if(p=s.call(u),p!=d||n.call(u,"toJSON"))"function"==typeof u.toJSON&&(p!=f&&p!=m&&p!=y||n.call(u,"toJSON"))&&(u=u.toJSON(e));else if(u>-1/0&&1/0>u){if(x){for(w=b(u/864e5),v=b(w/365.2425)+1970-1;x(v+1,0)<=w;v++);for(_=b((w-x(v,0))/30.42);x(v,_+1)<=w;_++);w=1+w-x(v,_),S=(u%864e5+864e5)%864e5,M=b(S/36e5)%24,T=b(S/6e4)%60,k=b(S/1e3)%60,P=S%1e3}else v=u.getUTCFullYear(),_=u.getUTCMonth(),w=u.getUTCDate(),M=u.getUTCHours(),T=u.getUTCMinutes(),k=u.getUTCSeconds(),P=u.getUTCMilliseconds();u=(0>=v||v>=1e4?(0>v?"-":"+")+E(6,0>v?-v:v):E(4,v))+"-"+E(2,_+1)+"-"+E(2,w)+"T"+E(2,M)+":"+E(2,T)+":"+E(2,k)+"."+E(3,P)+"Z"}else u=null;if(i&&(u=i.call(t,e,u)),null===u)return"null";if(p=s.call(u),p==g)return""+u;if(p==f)return u>-1/0&&1/0>u?""+u:"null";if(p==m)return A(""+u);if("object"==typeof u){for(F=c.length;F--;)if(c[F]===u)throw TypeError();if(c.push(u),L=[],D=l,l+=h,p==y){for(O=0,F=u.length;F>O;O++)R=C(O,u,i,a,h,l,c),L.push(R===o?"null":R);B=L.length?h?"[\n"+l+L.join(",\n"+l)+"\n"+D+"]":"["+L.join(",")+"]":"[]"}else r(a||u,function(e){var t=C(e,u,i,a,h,l,c);t!==o&&L.push(A(e)+":"+(h?" ":"")+t)}),B=L.length?h?"{\n"+l+L.join(",\n"+l)+"\n"+D+"}":"{"+L.join(",")+"}":"{}";return c.pop(),B}};l.stringify=function(e,t,i){var n,r,o,a;if("function"==typeof t||"object"==typeof t&&t)if((a=s.call(t))==p)r=t;else if(a==y){o={};for(var h,l=0,c=t.length;c>l;h=t[l++],a=s.call(h),(a==m||a==f)&&(o[h]=1));}if(i)if((a=s.call(i))==f){if((i-=i%1)>0)for(n="",i>10&&(i=10);n.length<i;n+=" ");}else a==m&&(n=i.length<=10?i:i.slice(0,10));return C("",(h={},h[""]=e,h),r,o,n,"",[])}}if(!t("json-parse")){var P,L,R=String.fromCharCode,O={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},F=function(){throw P=L=null,SyntaxError()},D=function(){for(var e,t,i,n,r,o=L,s=o.length;s>P;)switch(r=o.charCodeAt(P)){case 9:case 10:case 13:case 32:P++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=v?o.charAt(P):o[P],P++,e;case 34:for(e="@",P++;s>P;)if(r=o.charCodeAt(P),32>r)F();else if(92==r)switch(r=o.charCodeAt(++P)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=O[r],P++;break;case 117:for(t=++P,i=P+4;i>P;P++)r=o.charCodeAt(P),r>=48&&57>=r||r>=97&&102>=r||r>=65&&70>=r||F();e+=R("0x"+o.slice(t,P));break;default:F()}else{if(34==r)break;for(r=o.charCodeAt(P),t=P;r>=32&&92!=r&&34!=r;)r=o.charCodeAt(++P);e+=o.slice(t,P)}if(34==o.charCodeAt(P))return P++,e;F();default:if(t=P,45==r&&(n=!0,r=o.charCodeAt(++P)),r>=48&&57>=r){for(48==r&&(r=o.charCodeAt(P+1),r>=48&&57>=r)&&F(),n=!1;s>P&&(r=o.charCodeAt(P),r>=48&&57>=r);P++);if(46==o.charCodeAt(P)){for(i=++P;s>i&&(r=o.charCodeAt(i),r>=48&&57>=r);i++);i==P&&F(),P=i}if(r=o.charCodeAt(P),101==r||69==r){for(r=o.charCodeAt(++P),(43==r||45==r)&&P++,i=P;s>i&&(r=o.charCodeAt(i),r>=48&&57>=r);i++);i==P&&F(),P=i}return+o.slice(t,P)}if(n&&F(),"true"==o.slice(P,P+4))return P+=4,!0;if("false"==o.slice(P,P+5))return P+=5,!1;if("null"==o.slice(P,P+4))return P+=4,null;F()}return"$"},B=function(e){var t,i;if("$"==e&&F(),"string"==typeof e){if("@"==(v?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];e=D(),"]"!=e;i||(i=!0))i&&(","==e?(e=D(),"]"==e&&F()):F()),","==e&&F(),t.push(B(e));return t}if("{"==e){for(t={};e=D(),"}"!=e;i||(i=!0))i&&(","==e?(e=D(),"}"==e&&F()):F()),(","==e||"string"!=typeof e||"@"!=(v?e.charAt(0):e[0])||":"!=D())&&F(),t[e.slice(1)]=B(D());return t}F()}return e},N=function(e,t,i){var n=j(e,t,i);n===o?delete e[t]:e[t]=n},j=function(e,t,i){var n,o=e[t];if("object"==typeof o&&o)if(s.call(o)==y)for(n=o.length;n--;)N(o,n,i);else r(o,function(e){N(o,e,i)});return i.call(e,t,o)};l.parse=function(e,t){var i,n;return P=0,L=""+e,i=B(D()),"$"!=D()&&F(),P=L=null,t&&s.call(t)==p?j((n={},n[""]=i,n),"",t):i}}}a&&define(function(){return l})}(this)},{}],109:[function(e,t,i){function n(e,t){var i=[];t=t||0;for(var n=t||0;n<e.length;n++)i[n-t]=e[n];return i}t.exports=n},{}],110:[function(e,t,i){var n=n||{},r={REVISION:"72"};"function"==typeof define&&define.amd?define("three",r):"undefined"!=typeof i&&"undefined"!=typeof t&&(t.exports=r),(void 0===n.requestAnimationFrame||void 0===n.cancelAnimationFrame)&&!function(){for(var e=0,t=["ms","moz","webkit","o"],i=0;i<t.length&&!n.requestAnimationFrame;++i)n.requestAnimationFrame=n[t[i]+"RequestAnimationFrame"],n.cancelAnimationFrame=n[t[i]+"CancelAnimationFrame"]||n[t[i]+"CancelRequestAnimationFrame"];void 0===n.requestAnimationFrame&&void 0!==n.setTimeout&&(n.requestAnimationFrame=function(t){var i=Date.now(),r=Math.max(0,16-(i-e)),o=n.setTimeout(function(){t(i+r)},r);return e=i+r,o}),void 0===n.cancelAnimationFrame&&void 0!==n.clearTimeout&&(n.cancelAnimationFrame=function(e){n.clearTimeout(e)})}(),void 0===Math.sign&&(Math.sign=function(e){return 0>e?-1:e>0?1:+e}),void 0===Function.prototype.name&&void 0!==Object.defineProperty&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]}}),r.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},r.CullFaceNone=0,r.CullFaceBack=1,r.CullFaceFront=2,r.CullFaceFrontBack=3,r.FrontFaceDirectionCW=0,r.FrontFaceDirectionCCW=1,r.BasicShadowMap=0,r.PCFShadowMap=1,r.PCFSoftShadowMap=2,r.FrontSide=0,r.BackSide=1,r.DoubleSide=2,r.FlatShading=1,r.SmoothShading=2,r.NoColors=0,r.FaceColors=1,r.VertexColors=2,r.NoBlending=0,r.NormalBlending=1,r.AdditiveBlending=2,r.SubtractiveBlending=3,r.MultiplyBlending=4,r.CustomBlending=5,r.AddEquation=100,r.SubtractEquation=101,r.ReverseSubtractEquation=102,r.MinEquation=103,r.MaxEquation=104,r.ZeroFactor=200,r.OneFactor=201,r.SrcColorFactor=202,r.OneMinusSrcColorFactor=203,r.SrcAlphaFactor=204,r.OneMinusSrcAlphaFactor=205,r.DstAlphaFactor=206,r.OneMinusDstAlphaFactor=207,r.DstColorFactor=208,r.OneMinusDstColorFactor=209,r.SrcAlphaSaturateFactor=210,r.NeverDepth=0,r.AlwaysDepth=1,r.LessDepth=2,r.LessEqualDepth=3,r.EqualDepth=4,r.GreaterEqualDepth=5,r.GreaterDepth=6,r.NotEqualDepth=7,r.MultiplyOperation=0,r.MixOperation=1,r.AddOperation=2,r.UVMapping=300,r.CubeReflectionMapping=301,r.CubeRefractionMapping=302,r.EquirectangularReflectionMapping=303,r.EquirectangularRefractionMapping=304,r.SphericalReflectionMapping=305,r.RepeatWrapping=1e3,r.ClampToEdgeWrapping=1001,r.MirroredRepeatWrapping=1002,r.NearestFilter=1003,r.NearestMipMapNearestFilter=1004,r.NearestMipMapLinearFilter=1005,r.LinearFilter=1006,r.LinearMipMapNearestFilter=1007,r.LinearMipMapLinearFilter=1008,r.UnsignedByteType=1009,r.ByteType=1010,r.ShortType=1011,r.UnsignedShortType=1012,r.IntType=1013,r.UnsignedIntType=1014,r.FloatType=1015,r.HalfFloatType=1025,r.UnsignedShort4444Type=1016,r.UnsignedShort5551Type=1017,r.UnsignedShort565Type=1018,r.AlphaFormat=1019,r.RGBFormat=1020,r.RGBAFormat=1021,r.LuminanceFormat=1022,r.LuminanceAlphaFormat=1023,r.RGBEFormat=r.RGBAFormat,r.RGB_S3TC_DXT1_Format=2001,r.RGBA_S3TC_DXT1_Format=2002,r.RGBA_S3TC_DXT3_Format=2003,r.RGBA_S3TC_DXT5_Format=2004,r.RGB_PVRTC_4BPPV1_Format=2100,r.RGB_PVRTC_2BPPV1_Format=2101,r.RGBA_PVRTC_4BPPV1_Format=2102,r.RGBA_PVRTC_2BPPV1_Format=2103,r.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(e,t){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},r.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElement("canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},r.Color=function(e){return 3===arguments.length?this.setRGB(arguments[0],arguments[1],arguments[2]):this.set(e)},r.Color.prototype={constructor:r.Color,r:1,g:1,b:1,set:function(e){return e instanceof r.Color?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,i){return this.r=e,this.g=t,this.b=i,this},setHSL:function(){function e(e,t,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?e+6*(t-e)*i:.5>i?t:2/3>i?e+6*(t-e)*(2/3-i):e}return function(t,i,n){if(t=r.Math.euclideanModulo(t,1),i=r.Math.clamp(i,0,1),n=r.Math.clamp(n,0,1),0===i)this.r=this.g=this.b=n;else{var o=.5>=n?n*(1+i):n+i-n*i,s=2*n-o;this.r=e(s,o,t+1/3),this.g=e(s,o,t),this.b=e(s,o,t-1/3)}return this}}(),setStyle:function(e){var t,i=function(t){var i=parseFloat(t);return 1>i&&console.warn("THREE.Color: Alpha component of color "+e+" will be ignored."),i};if(t=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var n,o=t[1],s=t[2];switch(o){case"rgb":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*$/.exec(s))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*$/.exec(s))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,this;break;case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([0-9]*\.?[0-9]+)\s*$/.exec(s))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,i(n[4]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*([0-9]*\.?[0-9]+)\s*$/.exec(s))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,i(n[4]),this;break;case"hsl":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*$/.exec(s)){var a=parseFloat(n[1]),h=parseInt(n[2],10)/100,l=parseInt(n[3],10)/100;return this.setHSL(a,h,l)}break;case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*([0-9]*\.?[0-9]+)\s*$/.exec(s)){var a=parseFloat(n[1]),h=parseInt(n[2],10)/100,l=parseInt(n[3],10)/100;return i(n[4]),this.setHSL(a,h,l)}}}else if(t=/^\#([A-Fa-f0-9]+)$/.exec(e)){var c=t[1],u=c.length;if(3===u)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===u)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}if(e&&e.length>0){var c=r.ColorKeywords[e];void 0!==c?this.setHex(c):console.warn("THREE.Color: Unknown color "+e)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var i=t>0?1/t:1;return this.r=Math.pow(e.r,i),this.g=Math.pow(e.g,i),this.b=Math.pow(e.b,i),this},convertGammaToLinear:function(){var e=this.r,t=this.g,i=this.b;return this.r=e*e,this.g=t*t,this.b=i*i,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){var t,i,n=e||{h:0,s:0,l:0},r=this.r,o=this.g,s=this.b,a=Math.max(r,o,s),h=Math.min(r,o,s),l=(h+a)/2;if(h===a)t=0,i=0;else{var c=a-h;switch(i=.5>=l?c/(a+h):c/(2-a-h),a){case r:t=(o-s)/c+(s>o?6:0);break;case o:t=(s-r)/c+2;break;case s:t=(r-o)/c+4}t/=6}return n.h=t,n.s=i,n.l=l,n},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,i){var n=this.getHSL();return n.h+=e,n.s+=t,n.l+=i,this.setHSL(n.h,n.s,n.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e){return this.r=e[0],this.g=e[1],this.b=e[2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}},r.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},r.Quaternion=function(e,t,i,n){this._x=e||0,this._y=t||0,this._z=i||0,this._w=void 0!==n?n:1},r.Quaternion.prototype={constructor:r.Quaternion,get x(){return this._x},set x(e){this._x=e,this.onChangeCallback()},get y(){return this._y},set y(e){this._y=e,this.onChangeCallback()},get z(){return this._z},set z(e){this._z=e,this.onChangeCallback()},get w(){return this._w},set w(e){this._w=e,this.onChangeCallback()},set:function(e,t,i,n){return this._x=e,this._y=t,this._z=i,this._w=n,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(e instanceof r.Euler==!1)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var i=Math.cos(e._x/2),n=Math.cos(e._y/2),o=Math.cos(e._z/2),s=Math.sin(e._x/2),a=Math.sin(e._y/2),h=Math.sin(e._z/2),l=e.order;return"XYZ"===l?(this._x=s*n*o+i*a*h,this._y=i*a*o-s*n*h,this._z=i*n*h+s*a*o,this._w=i*n*o-s*a*h):"YXZ"===l?(this._x=s*n*o+i*a*h,this._y=i*a*o-s*n*h,this._z=i*n*h-s*a*o,this._w=i*n*o+s*a*h):"ZXY"===l?(this._x=s*n*o-i*a*h,this._y=i*a*o+s*n*h,this._z=i*n*h+s*a*o,this._w=i*n*o-s*a*h):"ZYX"===l?(this._x=s*n*o-i*a*h,this._y=i*a*o+s*n*h,this._z=i*n*h-s*a*o,this._w=i*n*o+s*a*h):"YZX"===l?(this._x=s*n*o+i*a*h,this._y=i*a*o+s*n*h,this._z=i*n*h-s*a*o,this._w=i*n*o-s*a*h):"XZY"===l&&(this._x=s*n*o-i*a*h,this._y=i*a*o-s*n*h,this._z=i*n*h+s*a*o,this._w=i*n*o+s*a*h),t!==!1&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var i=t/2,n=Math.sin(i);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(i),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,i=e.elements,n=i[0],r=i[4],o=i[8],s=i[1],a=i[5],h=i[9],l=i[2],c=i[6],u=i[10],p=n+a+u;return p>0?(t=.5/Math.sqrt(p+1),this._w=.25/t,this._x=(c-h)*t,this._y=(o-l)*t,this._z=(s-r)*t):n>a&&n>u?(t=2*Math.sqrt(1+n-a-u),this._w=(c-h)/t,this._x=.25*t,this._y=(r+s)/t,this._z=(o+l)/t):a>u?(t=2*Math.sqrt(1+a-n-u),this._w=(o-l)/t,this._x=(r+s)/t,this._y=.25*t,this._z=(h+c)/t):(t=2*Math.sqrt(1+u-n-a),this._w=(s-r)/t,this._x=(o+l)/t,this._y=(h+c)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:function(){var e,t,i=1e-6;return function(n,o){return void 0===e&&(e=new r.Vector3),t=n.dot(o)+1,i>t?(t=0,Math.abs(n.x)>Math.abs(n.z)?e.set(-n.y,n.x,0):e.set(0,-n.z,n.y)):e.crossVectors(n,o),this._x=e.x,this._y=e.y,this._z=e.z,this._w=t,this.normalize(),this}}(),inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,t){var i=e._x,n=e._y,r=e._z,o=e._w,s=t._x,a=t._y,h=t._z,l=t._w;return this._x=i*l+o*s+n*h-r*a,this._y=n*l+o*a+r*s-i*h,this._z=r*l+o*h+i*a-n*s,this._w=o*l-i*s-n*a-r*h,this.onChangeCallback(),this},multiplyVector3:function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var i=this._x,n=this._y,r=this._z,o=this._w,s=o*e._w+i*e._x+n*e._y+r*e._z;if(0>s?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=o,this._x=i,this._y=n,this._z=r,this;var a=Math.acos(s),h=Math.sqrt(1-s*s);if(Math.abs(h)<.001)return this._w=.5*(o+this._w),this._x=.5*(i+this._x),this._y=.5*(n+this._y),this._z=.5*(r+this._z),this;var l=Math.sin((1-t)*a)/h,c=Math.sin(t*a)/h;return this._w=o*l+this._w*c,this._x=i*l+this._x*c,this._y=n*l+this._y*c,this._z=r*l+this._z*c,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}},r.Quaternion.slerp=function(e,t,i,n){return i.copy(e).slerp(t,n)},r.Vector2=function(e,t){this.x=e||0,this.y=t||0},r.Vector2.prototype={constructor:r.Vector2,set:function(e,t){return this.x=e,this.y=t,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t}else this.x=0,this.y=0;return this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this},clampScalar:function(){var e,t;return function(i,n){return void 0===e&&(e=new r.Vector2,t=new r.Vector2),e.set(i,i),t.set(n,n),this.clamp(e,t)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y;return t*t+i*i},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e),this},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromAttribute:function(e,t,i){return void 0===i&&(i=0),t=t*e.itemSize+i,this.x=e.array[t],this.y=e.array[t+1],this}},r.Vector3=function(e,t,i){this.x=e||0,this.y=t||0,this.z=i||0},r.Vector3.prototype={constructor:r.Vector3,set:function(e,t,i){return this.x=e,this.y=t,this.z=i,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(){var e;return function(t){return t instanceof r.Euler==!1&&console.error("THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order."),void 0===e&&(e=new r.Quaternion),this.applyQuaternion(e.setFromEuler(t)),this}}(),applyAxisAngle:function(){var e;return function(t,i){return void 0===e&&(e=new r.Quaternion),this.applyQuaternion(e.setFromAxisAngle(t,i)),this}}(),applyMatrix3:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6]*n,this.y=r[1]*t+r[4]*i+r[7]*n,this.z=r[2]*t+r[5]*i+r[8]*n,this},applyMatrix4:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[4]*i+r[8]*n+r[12],this.y=r[1]*t+r[5]*i+r[9]*n+r[13],this.z=r[2]*t+r[6]*i+r[10]*n+r[14],this},applyProjection:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements,o=1/(r[3]*t+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*t+r[4]*i+r[8]*n+r[12])*o,this.y=(r[1]*t+r[5]*i+r[9]*n+r[13])*o,this.z=(r[2]*t+r[6]*i+r[10]*n+r[14])*o,this},applyQuaternion:function(e){var t=this.x,i=this.y,n=this.z,r=e.x,o=e.y,s=e.z,a=e.w,h=a*t+o*n-s*i,l=a*i+s*t-r*n,c=a*n+r*i-o*t,u=-r*t-o*i-s*n;return this.x=h*a+u*-r+l*-s-c*-o,this.y=l*a+u*-o+c*-r-h*-s,this.z=c*a+u*-s+h*-o-l*-r,this},project:function(){var e;return function(t){return void 0===e&&(e=new r.Matrix4),e.multiplyMatrices(t.projectionMatrix,e.getInverse(t.matrixWorld)),this.applyProjection(e)}}(),unproject:function(){var e;return function(t){return void 0===e&&(e=new r.Matrix4),e.multiplyMatrices(t.matrixWorld,e.getInverse(t.projectionMatrix)),this.applyProjection(e)}}(),transformDirection:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[4]*i+r[8]*n,this.y=r[1]*t+r[5]*i+r[9]*n,this.z=r[2]*t+r[6]*i+r[10]*n,this.normalize(),this},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t}else this.x=0,this.y=0,this.z=0;return this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this},clampScalar:function(){var e,t;return function(i,n){return void 0===e&&(e=new r.Vector3,t=new r.Vector3),e.set(i,i,i),t.set(n,n,n),this.clamp(e,t)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){
return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e),this},cross:function(e,t){if(void 0!==t)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var i=this.x,n=this.y,r=this.z;return this.x=n*e.z-r*e.y,this.y=r*e.x-i*e.z,this.z=i*e.y-n*e.x,this},crossVectors:function(e,t){var i=e.x,n=e.y,r=e.z,o=t.x,s=t.y,a=t.z;return this.x=n*a-r*s,this.y=r*o-i*a,this.z=i*s-n*o,this},projectOnVector:function(){var e,t;return function(i){return void 0===e&&(e=new r.Vector3),e.copy(i).normalize(),t=this.dot(e),this.copy(e).multiplyScalar(t)}}(),projectOnPlane:function(){var e;return function(t){return void 0===e&&(e=new r.Vector3),e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e;return function(t){return void 0===e&&(e=new r.Vector3),this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/(this.length()*e.length());return Math.acos(r.Math.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y,n=this.z-e.z;return t*t+i*i+n*n},setEulerFromRotationMatrix:function(e,t){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(e,t){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},setFromMatrixPosition:function(e){return this.x=e.elements[12],this.y=e.elements[13],this.z=e.elements[14],this},setFromMatrixScale:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),i=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),n=this.set(e.elements[8],e.elements[9],e.elements[10]).length();return this.x=t,this.y=i,this.z=n,this},setFromMatrixColumn:function(e,t){var i=4*e,n=t.elements;return this.x=n[i],this.y=n[i+1],this.z=n[i+2],this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromAttribute:function(e,t,i){return void 0===i&&(i=0),t=t*e.itemSize+i,this.x=e.array[t],this.y=e.array[t+1],this.z=e.array[t+2],this}},r.Vector4=function(e,t,i,n){this.x=e||0,this.y=t||0,this.z=i||0,this.w=void 0!==n?n:1},r.Vector4.prototype={constructor:r.Vector4,set:function(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,i=this.y,n=this.z,r=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*n+o[12]*r,this.y=o[1]*t+o[5]*i+o[9]*n+o[13]*r,this.z=o[2]*t+o[6]*i+o[10]*n+o[14]*r,this.w=o[3]*t+o[7]*i+o[11]*n+o[15]*r,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t,this.w*=t}else this.x=0,this.y=0,this.z=0,this.w=1;return this},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return 1e-4>t?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,i,n,r,o=.01,s=.1,a=e.elements,h=a[0],l=a[4],c=a[8],u=a[1],p=a[5],d=a[9],f=a[2],m=a[6],y=a[10];if(Math.abs(l-u)<o&&Math.abs(c-f)<o&&Math.abs(d-m)<o){if(Math.abs(l+u)<s&&Math.abs(c+f)<s&&Math.abs(d+m)<s&&Math.abs(h+p+y-3)<s)return this.set(1,0,0,0),this;t=Math.PI;var g=(h+1)/2,v=(p+1)/2,b=(y+1)/2,_=(l+u)/4,x=(c+f)/4,w=(d+m)/4;return g>v&&g>b?o>g?(i=0,n=.707106781,r=.707106781):(i=Math.sqrt(g),n=_/i,r=x/i):v>b?o>v?(i=.707106781,n=0,r=.707106781):(n=Math.sqrt(v),i=_/n,r=w/n):o>b?(i=.707106781,n=.707106781,r=0):(r=Math.sqrt(b),i=x/r,n=w/r),this.set(i,n,r,t),this}var S=Math.sqrt((m-d)*(m-d)+(c-f)*(c-f)+(u-l)*(u-l));return Math.abs(S)<.001&&(S=1),this.x=(m-d)/S,this.y=(c-f)/S,this.z=(u-l)/S,this.w=Math.acos((h+p+y-1)/2),this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this.w>e.w&&(this.w=e.w),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this.w<e.w&&(this.w=e.w),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this.w<e.w?this.w=e.w:this.w>t.w&&(this.w=t.w),this},clampScalar:function(){var e,t;return function(i,n){return void 0===e&&(e=new r.Vector4,t=new r.Vector4),e.set(i,i,i,i),t.set(n,n,n,n),this.clamp(e,t)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e),this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromAttribute:function(e,t,i){return void 0===i&&(i=0),t=t*e.itemSize+i,this.x=e.array[t],this.y=e.array[t+1],this.z=e.array[t+2],this.w=e.array[t+3],this}},r.Euler=function(e,t,i,n){this._x=e||0,this._y=t||0,this._z=i||0,this._order=n||r.Euler.DefaultOrder},r.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],r.Euler.DefaultOrder="XYZ",r.Euler.prototype={constructor:r.Euler,get x(){return this._x},set x(e){this._x=e,this.onChangeCallback()},get y(){return this._y},set y(e){this._y=e,this.onChangeCallback()},get z(){return this._z},set z(e){this._z=e,this.onChangeCallback()},get order(){return this._order},set order(e){this._order=e,this.onChangeCallback()},set:function(e,t,i,n){return this._x=e,this._y=t,this._z=i,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,i){var n=r.Math.clamp,o=e.elements,s=o[0],a=o[4],h=o[8],l=o[1],c=o[5],u=o[9],p=o[2],d=o[6],f=o[10];return t=t||this._order,"XYZ"===t?(this._y=Math.asin(n(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(-u,f),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(d,c),this._z=0)):"YXZ"===t?(this._x=Math.asin(-n(u,-1,1)),Math.abs(u)<.99999?(this._y=Math.atan2(h,f),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-p,s),this._z=0)):"ZXY"===t?(this._x=Math.asin(n(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(-p,f),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(l,s))):"ZYX"===t?(this._y=Math.asin(-n(p,-1,1)),Math.abs(p)<.99999?(this._x=Math.atan2(d,f),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-a,c))):"YZX"===t?(this._z=Math.asin(n(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-p,s)):(this._x=0,this._y=Math.atan2(h,f))):"XZY"===t?(this._z=Math.asin(-n(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(d,c),this._y=Math.atan2(h,s)):(this._x=Math.atan2(-u,f),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,i!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var e;return function(t,i,n){return void 0===e&&(e=new r.Matrix4),e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,i,n),this}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(){var e=new r.Quaternion;return function(t){e.setFromEuler(this),this.setFromQuaternion(e,t)}}(),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new r.Vector3(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}},r.Line3=function(e,t){this.start=void 0!==e?e:new r.Vector3,this.end=void 0!==t?t:new r.Vector3},r.Line3.prototype={constructor:r.Line3,set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},center:function(e){var t=e||new r.Vector3;return t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){var t=e||new r.Vector3;return t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){var i=t||new r.Vector3;return this.delta(i).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var e=new r.Vector3,t=new r.Vector3;return function(i,n){e.subVectors(i,this.start),t.subVectors(this.end,this.start);var o=t.dot(t),s=t.dot(e),a=s/o;return n&&(a=r.Math.clamp(a,0,1)),a}}(),closestPointToPoint:function(e,t,i){var n=this.closestPointToPointParameter(e,t),o=i||new r.Vector3;return this.delta(o).multiplyScalar(n).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}},r.Box2=function(e,t){this.min=void 0!==e?e:new r.Vector2(1/0,1/0),this.max=void 0!==t?t:new r.Vector2(-(1/0),-(1/0))},r.Box2.prototype={constructor:r.Box2,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,i=e.length;i>t;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new r.Vector2;return function(t,i){var n=e.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-(1/0),this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(e){var t=e||new r.Vector2;return t.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){var t=e||new r.Vector2;return t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y?!1:!0},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y?!0:!1},getParameter:function(e,t){var i=t||new r.Vector2;return i.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y?!1:!0},clampPoint:function(e,t){var i=t||new r.Vector2;return i.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new r.Vector2;return function(t){var i=e.copy(t).clamp(this.min,this.max);return i.sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},r.Box3=function(e,t){this.min=void 0!==e?e:new r.Vector3(1/0,1/0,1/0),this.max=void 0!==t?t:new r.Vector3(-(1/0),-(1/0),-(1/0))},r.Box3.prototype={constructor:r.Box3,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,i=e.length;i>t;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new r.Vector3;return function(t,i){var n=e.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),setFromObject:function(){var e=new r.Vector3;return function(t){var i=this;return t.updateMatrixWorld(!0),this.makeEmpty(),t.traverse(function(t){var n=t.geometry;if(void 0!==n)if(n instanceof r.Geometry)for(var o=n.vertices,s=0,a=o.length;a>s;s++)e.copy(o[s]),e.applyMatrix4(t.matrixWorld),i.expandByPoint(e);else if(n instanceof r.BufferGeometry&&void 0!==n.attributes.position)for(var h=n.attributes.position.array,s=0,a=h.length;a>s;s+=3)e.set(h[s],h[s+1],h[s+2]),e.applyMatrix4(t.matrixWorld),i.expandByPoint(e)}),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-(1/0),this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(e){var t=e||new r.Vector3;return t.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){var t=e||new r.Vector3;return t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z?!1:!0},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z?!0:!1},getParameter:function(e,t){var i=t||new r.Vector3;return i.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z?!1:!0},clampPoint:function(e,t){var i=t||new r.Vector3;return i.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new r.Vector3;return function(t){var i=e.copy(t).clamp(this.min,this.max);return i.sub(t).length()}}(),getBoundingSphere:function(){var e=new r.Vector3;return function(t){var i=t||new r.Sphere;return i.center=this.center(),i.radius=.5*this.size(e).length(),i}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(){var e=[new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3];return function(t){return e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.makeEmpty(),this.setFromPoints(e),this}}(),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},r.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")},r.Matrix3.prototype={constructor:r.Matrix3,set:function(e,t,i,n,r,o,s,a,h){var l=this.elements;return l[0]=e,l[3]=t,l[6]=i,l[1]=n,l[4]=r,l[7]=o,l[2]=s,l[5]=a,l[8]=h,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=e.elements;return this.set(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]),this},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(e){return console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(e)},applyToVector3Array:function(){var e;return function(t,i,n){void 0===e&&(e=new r.Vector3),void 0===i&&(i=0),void 0===n&&(n=t.length);for(var o=0,s=i;n>o;o+=3,s+=3)e.fromArray(t,s),e.applyMatrix3(this),e.toArray(t,s);return t}}(),applyToBuffer:function(){var e;return function(t,i,n){void 0===e&&(e=new r.Vector3),void 0===i&&(i=0),void 0===n&&(n=t.length/t.itemSize);for(var o=0,s=i;n>o;o++,s++)e.x=t.getX(s),e.y=t.getY(s),e.z=t.getZ(s),e.applyMatrix3(this),t.setXYZ(e.x,e.y,e.z);return t}}(),multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],o=e[4],s=e[5],a=e[6],h=e[7],l=e[8];return t*o*l-t*s*h-i*r*l+i*s*a+n*r*h-n*o*a},getInverse:function(e,t){var i=e.elements,n=this.elements;n[0]=i[10]*i[5]-i[6]*i[9],n[1]=-i[10]*i[1]+i[2]*i[9],n[2]=i[6]*i[1]-i[2]*i[5],n[3]=-i[10]*i[4]+i[6]*i[8],n[4]=i[10]*i[0]-i[2]*i[8],n[5]=-i[6]*i[0]+i[2]*i[4],n[6]=i[9]*i[4]-i[5]*i[8],n[7]=-i[9]*i[0]+i[1]*i[8],n[8]=i[5]*i[0]-i[1]*i[4];var r=i[0]*n[0]+i[1]*n[3]+i[2]*n[6];if(0===r){var o="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(o);return console.warn(o),this.identity(),this}return this.multiplyScalar(1/r),this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},flattenToArrayOffset:function(e,t){var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e},getNormalMatrix:function(e){return this.getInverse(e).transpose(),this},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},fromArray:function(e){return this.elements.set(e),this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]}},r.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")},r.Matrix4.prototype={constructor:r.Matrix4,set:function(e,t,i,n,r,o,s,a,h,l,c,u,p,d,f,m){var y=this.elements;return y[0]=e,y[4]=t,y[8]=i,y[12]=n,y[1]=r,y[5]=o,y[9]=s,y[13]=a,y[2]=h,y[6]=l,y[10]=c,y[14]=u,y[3]=p,y[7]=d,y[11]=f,y[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new r.Matrix4).fromArray(this.elements)},copy:function(e){return this.elements.set(e.elements),this},extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},copyPosition:function(e){var t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this},extractBasis:function(e,t,i){var n=this.elements;return e.set(n[0],n[1],n[2]),t.set(n[4],n[5],n[6]),i.set(n[8],n[9],n[10]),this},makeBasis:function(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this},extractRotation:function(){var e;return function(t){void 0===e&&(e=new r.Vector3);var i=this.elements,n=t.elements,o=1/e.set(n[0],n[1],n[2]).length(),s=1/e.set(n[4],n[5],n[6]).length(),a=1/e.set(n[8],n[9],n[10]).length();return i[0]=n[0]*o,i[1]=n[1]*o,i[2]=n[2]*o,i[4]=n[4]*s,i[5]=n[5]*s,i[6]=n[6]*s,i[8]=n[8]*a,i[9]=n[9]*a,i[10]=n[10]*a,this}}(),makeRotationFromEuler:function(e){e instanceof r.Euler==!1&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,i=e.x,n=e.y,o=e.z,s=Math.cos(i),a=Math.sin(i),h=Math.cos(n),l=Math.sin(n),c=Math.cos(o),u=Math.sin(o);if("XYZ"===e.order){var p=s*c,d=s*u,f=a*c,m=a*u;t[0]=h*c,t[4]=-h*u,t[8]=l,t[1]=d+f*l,t[5]=p-m*l,t[9]=-a*h,t[2]=m-p*l,t[6]=f+d*l,t[10]=s*h}else if("YXZ"===e.order){var y=h*c,g=h*u,v=l*c,b=l*u;t[0]=y+b*a,t[4]=v*a-g,t[8]=s*l,t[1]=s*u,t[5]=s*c,t[9]=-a,t[2]=g*a-v,t[6]=b+y*a,t[10]=s*h}else if("ZXY"===e.order){var y=h*c,g=h*u,v=l*c,b=l*u;t[0]=y-b*a,t[4]=-s*u,t[8]=v+g*a,t[1]=g+v*a,t[5]=s*c,t[9]=b-y*a,t[2]=-s*l,t[6]=a,t[10]=s*h}else if("ZYX"===e.order){var p=s*c,d=s*u,f=a*c,m=a*u;t[0]=h*c,t[4]=f*l-d,t[8]=p*l+m,t[1]=h*u,t[5]=m*l+p,t[9]=d*l-f,t[2]=-l,t[6]=a*h,t[10]=s*h}else if("YZX"===e.order){var _=s*h,x=s*l,w=a*h,S=a*l;t[0]=h*c,t[4]=S-_*u,t[8]=w*u+x,t[1]=u,t[5]=s*c,t[9]=-a*c,t[2]=-l*c,t[6]=x*u+w,t[10]=_-S*u}else if("XZY"===e.order){var _=s*h,x=s*l,w=a*h,S=a*l;t[0]=h*c,t[4]=-u,t[8]=l*c,t[1]=_*u+S,t[5]=s*c,t[9]=x*u-w,t[2]=w*u-x,t[6]=a*c,t[10]=S*u+_}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},makeRotationFromQuaternion:function(e){var t=this.elements,i=e.x,n=e.y,r=e.z,o=e.w,s=i+i,a=n+n,h=r+r,l=i*s,c=i*a,u=i*h,p=n*a,d=n*h,f=r*h,m=o*s,y=o*a,g=o*h;return t[0]=1-(p+f),t[4]=c-g,t[8]=u+y,t[1]=c+g,t[5]=1-(l+f),t[9]=d-m,t[2]=u-y,t[6]=d+m,t[10]=1-(l+p),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},lookAt:function(){var e,t,i;return function(n,o,s){void 0===e&&(e=new r.Vector3),void 0===t&&(t=new r.Vector3),void 0===i&&(i=new r.Vector3);var a=this.elements;return i.subVectors(n,o).normalize(),0===i.length()&&(i.z=1),e.crossVectors(s,i).normalize(),0===e.length()&&(i.x+=1e-4,e.crossVectors(s,i).normalize()),t.crossVectors(i,e),a[0]=e.x,a[4]=t.x,a[8]=i.x,a[1]=e.y,a[5]=t.y,a[9]=i.y,a[2]=e.z,a[6]=t.z,a[10]=i.z,this}}(),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},multiplyMatrices:function(e,t){var i=e.elements,n=t.elements,r=this.elements,o=i[0],s=i[4],a=i[8],h=i[12],l=i[1],c=i[5],u=i[9],p=i[13],d=i[2],f=i[6],m=i[10],y=i[14],g=i[3],v=i[7],b=i[11],_=i[15],x=n[0],w=n[4],S=n[8],M=n[12],T=n[1],E=n[5],k=n[9],A=n[13],C=n[2],P=n[6],L=n[10],R=n[14],O=n[3],F=n[7],D=n[11],B=n[15];return r[0]=o*x+s*T+a*C+h*O,r[4]=o*w+s*E+a*P+h*F,r[8]=o*S+s*k+a*L+h*D,r[12]=o*M+s*A+a*R+h*B,r[1]=l*x+c*T+u*C+p*O,r[5]=l*w+c*E+u*P+p*F,r[9]=l*S+c*k+u*L+p*D,r[13]=l*M+c*A+u*R+p*B,r[2]=d*x+f*T+m*C+y*O,r[6]=d*w+f*E+m*P+y*F,r[10]=d*S+f*k+m*L+y*D,r[14]=d*M+f*A+m*R+y*B,r[3]=g*x+v*T+b*C+_*O,r[7]=g*w+v*E+b*P+_*F,r[11]=g*S+v*k+b*L+_*D,r[15]=g*M+v*A+b*R+_*B,this},multiplyToArray:function(e,t,i){var n=this.elements;return this.multiplyMatrices(e,t),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),e.applyProjection(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(e){return console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(e)},applyToVector3Array:function(){var e;return function(t,i,n){void 0===e&&(e=new r.Vector3),void 0===i&&(i=0),void 0===n&&(n=t.length);for(var o=0,s=i;n>o;o+=3,s+=3)e.fromArray(t,s),e.applyMatrix4(this),e.toArray(t,s);return t}}(),applyToBuffer:function(){var e;return function(t,i,n){void 0===e&&(e=new r.Vector3),void 0===i&&(i=0),void 0===n&&(n=t.length/t.itemSize);for(var o=0,s=i;n>o;o++,s++)e.x=t.getX(s),e.y=t.getY(s),e.z=t.getZ(s),e.applyMatrix4(this),t.setXYZ(e.x,e.y,e.z);return t}}(),rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},determinant:function(){var e=this.elements,t=e[0],i=e[4],n=e[8],r=e[12],o=e[1],s=e[5],a=e[9],h=e[13],l=e[2],c=e[6],u=e[10],p=e[14],d=e[3],f=e[7],m=e[11],y=e[15];return d*(+r*a*c-n*h*c-r*s*u+i*h*u+n*s*p-i*a*p)+f*(+t*a*p-t*h*u+r*o*u-n*o*p+n*h*l-r*a*l)+m*(+t*h*c-t*s*p-r*o*c+i*o*p+r*s*l-i*h*l)+y*(-n*s*l-t*a*c+t*s*u+n*o*c-i*o*u+i*a*l)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},flattenToArrayOffset:function(e,t){var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e},getPosition:function(){var e;return function(){void 0===e&&(e=new r.Vector3),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var t=this.elements;return e.set(t[12],t[13],t[14])}}(),setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var i=this.elements,n=e.elements,r=n[0],o=n[4],s=n[8],a=n[12],h=n[1],l=n[5],c=n[9],u=n[13],p=n[2],d=n[6],f=n[10],m=n[14],y=n[3],g=n[7],v=n[11],b=n[15];i[0]=c*m*g-u*f*g+u*d*v-l*m*v-c*d*b+l*f*b,i[4]=a*f*g-s*m*g-a*d*v+o*m*v+s*d*b-o*f*b,i[8]=s*u*g-a*c*g+a*l*v-o*u*v-s*l*b+o*c*b,i[12]=a*c*d-s*u*d-a*l*f+o*u*f+s*l*m-o*c*m,i[1]=u*f*y-c*m*y-u*p*v+h*m*v+c*p*b-h*f*b,i[5]=s*m*y-a*f*y+a*p*v-r*m*v-s*p*b+r*f*b,i[9]=a*c*y-s*u*y-a*h*v+r*u*v+s*h*b-r*c*b,i[13]=s*u*p-a*c*p+a*h*f-r*u*f-s*h*m+r*c*m,i[2]=l*m*y-u*d*y+u*p*g-h*m*g-l*p*b+h*d*b,i[6]=a*d*y-o*m*y-a*p*g+r*m*g+o*p*b-r*d*b,i[10]=o*u*y-a*l*y+a*h*g-r*u*g-o*h*b+r*l*b,i[14]=a*l*p-o*u*p-a*h*d+r*u*d+o*h*m-r*l*m,i[3]=c*d*y-l*f*y-c*p*g+h*f*g+l*p*v-h*d*v,i[7]=o*f*y-s*d*y+s*p*g-r*f*g-o*p*v+r*d*v,i[11]=s*l*y-o*c*y-s*h*g+r*c*g+o*h*v-r*l*v,i[15]=o*c*p-s*l*p+s*h*d-r*c*d-o*h*f+r*l*f;var _=r*i[0]+h*i[4]+p*i[8]+y*i[12];if(0===_){var x="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(x);return console.warn(x),this.identity(),this}return this.multiplyScalar(1/_),this},translate:function(e){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(e){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(e){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(e){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(e,t){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},scale:function(e){var t=this.elements,i=e.x,n=e.y,r=e.z;return t[0]*=i,t[4]*=n,t[8]*=r,t[1]*=i,t[5]*=n,t[9]*=r,t[2]*=i,t[6]*=n,t[10]*=r,t[3]*=i,t[7]*=n,t[11]*=r,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,Math.max(i,n)))},makeTranslation:function(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this},makeRotationX:function(e){
var t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var i=Math.cos(t),n=Math.sin(t),r=1-i,o=e.x,s=e.y,a=e.z,h=r*o,l=r*s;return this.set(h*o+i,h*s-n*a,h*a+n*s,0,h*s+n*a,l*s+i,l*a-n*o,0,h*a-n*s,l*a+n*o,r*a*a+i,0,0,0,0,1),this},makeScale:function(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this},compose:function(e,t,i){return this.makeRotationFromQuaternion(t),this.scale(i),this.setPosition(e),this},decompose:function(){var e,t;return function(i,n,o){void 0===e&&(e=new r.Vector3),void 0===t&&(t=new r.Matrix4);var s=this.elements,a=e.set(s[0],s[1],s[2]).length(),h=e.set(s[4],s[5],s[6]).length(),l=e.set(s[8],s[9],s[10]).length(),c=this.determinant();0>c&&(a=-a),i.x=s[12],i.y=s[13],i.z=s[14],t.elements.set(this.elements);var u=1/a,p=1/h,d=1/l;return t.elements[0]*=u,t.elements[1]*=u,t.elements[2]*=u,t.elements[4]*=p,t.elements[5]*=p,t.elements[6]*=p,t.elements[8]*=d,t.elements[9]*=d,t.elements[10]*=d,n.setFromRotationMatrix(t),o.x=a,o.y=h,o.z=l,this}}(),makeFrustum:function(e,t,i,n,r,o){var s=this.elements,a=2*r/(t-e),h=2*r/(n-i),l=(t+e)/(t-e),c=(n+i)/(n-i),u=-(o+r)/(o-r),p=-2*o*r/(o-r);return s[0]=a,s[4]=0,s[8]=l,s[12]=0,s[1]=0,s[5]=h,s[9]=c,s[13]=0,s[2]=0,s[6]=0,s[10]=u,s[14]=p,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this},makePerspective:function(e,t,i,n){var o=i*Math.tan(r.Math.degToRad(.5*e)),s=-o,a=s*t,h=o*t;return this.makeFrustum(a,h,s,o,i,n)},makeOrthographic:function(e,t,i,n,r,o){var s=this.elements,a=t-e,h=i-n,l=o-r,c=(t+e)/a,u=(i+n)/h,p=(o+r)/l;return s[0]=2/a,s[4]=0,s[8]=0,s[12]=-c,s[1]=0,s[5]=2/h,s[9]=0,s[13]=-u,s[2]=0,s[6]=0,s[10]=-2/l,s[14]=-p,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this},equals:function(e){for(var t=this.elements,i=e.elements,n=0;16>n;n++)if(t[n]!==i[n])return!1;return!0},fromArray:function(e){return this.elements.set(e),this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]}},r.Ray=function(e,t){this.origin=void 0!==e?e:new r.Vector3,this.direction=void 0!==t?t:new r.Vector3},r.Ray.prototype={constructor:r.Ray,set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){var i=t||new r.Vector3;return i.copy(this.direction).multiplyScalar(e).add(this.origin)},recast:function(){var e=new r.Vector3;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){var i=t||new r.Vector3;i.subVectors(e,this.origin);var n=i.dot(this.direction);return 0>n?i.copy(this.origin):i.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new r.Vector3;return function(t){var i=e.subVectors(t,this.origin).dot(this.direction);return 0>i?this.origin.distanceToSquared(t):(e.copy(this.direction).multiplyScalar(i).add(this.origin),e.distanceToSquared(t))}}(),distanceSqToSegment:function(){var e=new r.Vector3,t=new r.Vector3,i=new r.Vector3;return function(n,r,o,s){e.copy(n).add(r).multiplyScalar(.5),t.copy(r).sub(n).normalize(),i.copy(this.origin).sub(e);var a,h,l,c,u=.5*n.distanceTo(r),p=-this.direction.dot(t),d=i.dot(this.direction),f=-i.dot(t),m=i.lengthSq(),y=Math.abs(1-p*p);if(y>0)if(a=p*f-d,h=p*d-f,c=u*y,a>=0)if(h>=-c)if(c>=h){var g=1/y;a*=g,h*=g,l=a*(a+p*h+2*d)+h*(p*a+h+2*f)+m}else h=u,a=Math.max(0,-(p*h+d)),l=-a*a+h*(h+2*f)+m;else h=-u,a=Math.max(0,-(p*h+d)),l=-a*a+h*(h+2*f)+m;else-c>=h?(a=Math.max(0,-(-p*u+d)),h=a>0?-u:Math.min(Math.max(-u,-f),u),l=-a*a+h*(h+2*f)+m):c>=h?(a=0,h=Math.min(Math.max(-u,-f),u),l=h*(h+2*f)+m):(a=Math.max(0,-(p*u+d)),h=a>0?u:Math.min(Math.max(-u,-f),u),l=-a*a+h*(h+2*f)+m);else h=p>0?-u:u,a=Math.max(0,-(p*h+d)),l=-a*a+h*(h+2*f)+m;return o&&o.copy(this.direction).multiplyScalar(a).add(this.origin),s&&s.copy(t).multiplyScalar(h).add(e),l}}(),isIntersectionSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},intersectSphere:function(){var e=new r.Vector3;return function(t,i){e.subVectors(t.center,this.origin);var n=e.dot(this.direction),r=e.dot(e)-n*n,o=t.radius*t.radius;if(r>o)return null;var s=Math.sqrt(o-r),a=n-s,h=n+s;return 0>a&&0>h?null:0>a?this.at(h,i):this.at(a,i)}}(),isIntersectionPlane:function(e){var t=e.distanceToPoint(this.origin);if(0===t)return!0;var i=e.normal.dot(this.direction);return 0>i*t?!0:!1},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null},intersectPlane:function(e,t){var i=this.distanceToPlane(e);return null===i?null:this.at(i,t)},isIntersectionBox:function(){var e=new r.Vector3;return function(t){return null!==this.intersectBox(t,e)}}(),intersectBox:function(e,t){var i,n,r,o,s,a,h=1/this.direction.x,l=1/this.direction.y,c=1/this.direction.z,u=this.origin;return h>=0?(i=(e.min.x-u.x)*h,n=(e.max.x-u.x)*h):(i=(e.max.x-u.x)*h,n=(e.min.x-u.x)*h),l>=0?(r=(e.min.y-u.y)*l,o=(e.max.y-u.y)*l):(r=(e.max.y-u.y)*l,o=(e.min.y-u.y)*l),i>o||r>n?null:((r>i||i!==i)&&(i=r),(n>o||n!==n)&&(n=o),c>=0?(s=(e.min.z-u.z)*c,a=(e.max.z-u.z)*c):(s=(e.max.z-u.z)*c,a=(e.min.z-u.z)*c),i>a||s>n?null:((s>i||i!==i)&&(i=s),(n>a||n!==n)&&(n=a),0>n?null:this.at(i>=0?i:n,t)))},intersectTriangle:function(){var e=new r.Vector3,t=new r.Vector3,i=new r.Vector3,n=new r.Vector3;return function(r,o,s,a,h){t.subVectors(o,r),i.subVectors(s,r),n.crossVectors(t,i);var l,c=this.direction.dot(n);if(c>0){if(a)return null;l=1}else{if(!(0>c))return null;l=-1,c=-c}e.subVectors(this.origin,r);var u=l*this.direction.dot(i.crossVectors(e,i));if(0>u)return null;var p=l*this.direction.dot(t.cross(e));if(0>p)return null;if(u+p>c)return null;var d=-l*e.dot(n);return 0>d?null:this.at(d/c,h)}}(),applyMatrix4:function(e){return this.direction.add(this.origin).applyMatrix4(e),this.origin.applyMatrix4(e),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}},r.Sphere=function(e,t){this.center=void 0!==e?e:new r.Vector3,this.radius=void 0!==t?t:0},r.Sphere.prototype={constructor:r.Sphere,set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(){var e=new r.Box3;return function(t,i){var n=this.center;void 0!==i?n.copy(i):e.setFromPoints(t).center(n);for(var r=0,o=0,s=t.length;s>o;o++)r=Math.max(r,n.distanceToSquared(t[o]));return this.radius=Math.sqrt(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},clampPoint:function(e,t){var i=this.center.distanceToSquared(e),n=t||new r.Vector3;return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},getBoundingBox:function(e){var t=e||new r.Box3;return t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}},r.Frustum=function(e,t,i,n,o,s){this.planes=[void 0!==e?e:new r.Plane,void 0!==t?t:new r.Plane,void 0!==i?i:new r.Plane,void 0!==n?n:new r.Plane,void 0!==o?o:new r.Plane,void 0!==s?s:new r.Plane]},r.Frustum.prototype={constructor:r.Frustum,set:function(e,t,i,n,r,o){var s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(i),s[3].copy(n),s[4].copy(r),s[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,i=0;6>i;i++)t[i].copy(e.planes[i]);return this},setFromMatrix:function(e){var t=this.planes,i=e.elements,n=i[0],r=i[1],o=i[2],s=i[3],a=i[4],h=i[5],l=i[6],c=i[7],u=i[8],p=i[9],d=i[10],f=i[11],m=i[12],y=i[13],g=i[14],v=i[15];return t[0].setComponents(s-n,c-a,f-u,v-m).normalize(),t[1].setComponents(s+n,c+a,f+u,v+m).normalize(),t[2].setComponents(s+r,c+h,f+p,v+y).normalize(),t[3].setComponents(s-r,c-h,f-p,v-y).normalize(),t[4].setComponents(s-o,c-l,f-d,v-g).normalize(),t[5].setComponents(s+o,c+l,f+d,v+g).normalize(),this},intersectsObject:function(){var e=new r.Sphere;return function(t){var i=t.geometry;return null===i.boundingSphere&&i.computeBoundingSphere(),e.copy(i.boundingSphere),e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){for(var t=this.planes,i=e.center,n=-e.radius,r=0;6>r;r++){var o=t[r].distanceToPoint(i);if(n>o)return!1}return!0},intersectsBox:function(){var e=new r.Vector3,t=new r.Vector3;return function(i){for(var n=this.planes,r=0;6>r;r++){var o=n[r];e.x=o.normal.x>0?i.min.x:i.max.x,t.x=o.normal.x>0?i.max.x:i.min.x,e.y=o.normal.y>0?i.min.y:i.max.y,t.y=o.normal.y>0?i.max.y:i.min.y,e.z=o.normal.z>0?i.min.z:i.max.z,t.z=o.normal.z>0?i.max.z:i.min.z;var s=o.distanceToPoint(e),a=o.distanceToPoint(t);if(0>s&&0>a)return!1}return!0}}(),containsPoint:function(e){for(var t=this.planes,i=0;6>i;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}},r.Plane=function(e,t){this.normal=void 0!==e?e:new r.Vector3(1,0,0),this.constant=void 0!==t?t:0},r.Plane.prototype={constructor:r.Plane,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,i,n){return this.normal.set(e,t,i),this.constant=n,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new r.Vector3,t=new r.Vector3;return function(i,n,r){var o=e.subVectors(r,n).cross(t.subVectors(i,n)).normalize();return this.setFromNormalAndCoplanarPoint(o,i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return this.orthoPoint(e,t).sub(e).negate()},orthoPoint:function(e,t){var i=this.distanceToPoint(e),n=t||new r.Vector3;return n.copy(this.normal).multiplyScalar(i)},isIntersectionLine:function(e){var t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return 0>t&&i>0||0>i&&t>0},intersectLine:function(){var e=new r.Vector3;return function(t,i){var n=i||new r.Vector3,o=t.delta(e),s=this.normal.dot(o);if(0===s)return 0===this.distanceToPoint(t.start)?n.copy(t.start):void 0;var a=-(t.start.dot(this.normal)+this.constant)/s;return 0>a||a>1?void 0:n.copy(o).multiplyScalar(a).add(t.start)}}(),coplanarPoint:function(e){var t=e||new r.Vector3;return t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new r.Vector3,t=new r.Vector3,i=new r.Matrix3;return function(n,r){var o=r||i.getNormalMatrix(n),s=e.copy(this.normal).applyMatrix3(o),a=this.coplanarPoint(t);return a.applyMatrix4(n),this.setFromNormalAndCoplanarPoint(s,a),this}}(),translate:function(e){return this.constant=this.constant-e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}},r.Math={generateUUID:function(){var e,t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=new Array(36),n=0;return function(){for(var r=0;36>r;r++)8===r||13===r||18===r||23===r?i[r]="-":14===r?i[r]="4":(2>=n&&(n=33554432+16777216*Math.random()|0),e=15&n,n>>=4,i[r]=t[19===r?3&e|8:e]);return i.join("")}}(),clamp:function(e,t,i){return t>e?t:e>i?i:e},clampBottom:function(e,t){return t>e?t:e},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,i,n,r){return n+(e-t)*(r-n)/(i-t)},smoothstep:function(e,t,i){return t>=e?0:e>=i?1:(e=(e-t)/(i-t),e*e*(3-2*e))},smootherstep:function(e,t,i){return t>=e?0:e>=i?1:(e=(e-t)/(i-t),e*e*e*(e*(6*e-15)+10))},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(){var e=Math.PI/180;return function(t){return t*e}}(),radToDeg:function(){var e=180/Math.PI;return function(t){return t*e}}(),isPowerOfTwo:function(e){return 0===(e&e-1)&&0!==e},nextPowerOfTwo:function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e++,e}},r.Spline=function(e){function t(e,t,i,n,r,o,s){var a=.5*(i-e),h=.5*(n-t);return(2*(t-i)+a+h)*s+(-3*(t-i)-2*a-h)*o+a*r+t}this.points=e;var i,n,o,s,a,h,l,c,u,p=[],d={x:0,y:0,z:0};this.initFromArray=function(e){this.points=[];for(var t=0;t<e.length;t++)this.points[t]={x:e[t][0],y:e[t][1],z:e[t][2]}},this.getPoint=function(e){return i=(this.points.length-1)*e,n=Math.floor(i),o=i-n,p[0]=0===n?n:n-1,p[1]=n,p[2]=n>this.points.length-2?this.points.length-1:n+1,p[3]=n>this.points.length-3?this.points.length-1:n+2,h=this.points[p[0]],l=this.points[p[1]],c=this.points[p[2]],u=this.points[p[3]],s=o*o,a=o*s,d.x=t(h.x,l.x,c.x,u.x,o,s,a),d.y=t(h.y,l.y,c.y,u.y,o,s,a),d.z=t(h.z,l.z,c.z,u.z,o,s,a),d},this.getControlPointsArray=function(){var e,t,i=this.points.length,n=[];for(e=0;i>e;e++)t=this.points[e],n[e]=[t.x,t.y,t.z];return n},this.getLength=function(e){var t,i,n,o,s=0,a=0,h=0,l=new r.Vector3,c=new r.Vector3,u=[],p=0;for(u[0]=0,e||(e=100),n=this.points.length*e,l.copy(this.points[0]),t=1;n>t;t++)i=t/n,o=this.getPoint(i),c.copy(o),p+=c.distanceTo(l),l.copy(o),s=(this.points.length-1)*i,a=Math.floor(s),a!==h&&(u[a]=p,h=a);return u[u.length]=p,{chunks:u,total:p}},this.reparametrizeByArcLength=function(e){var t,i,n,o,s,a,h,l,c=[],u=new r.Vector3,p=this.getLength();for(c.push(u.copy(this.points[0]).clone()),t=1;t<this.points.length;t++){for(a=p.chunks[t]-p.chunks[t-1],h=Math.ceil(e*a/p.total),o=(t-1)/(this.points.length-1),s=t/(this.points.length-1),i=1;h-1>i;i++)n=o+i*(1/h)*(s-o),l=this.getPoint(n),c.push(u.copy(l).clone());c.push(u.copy(this.points[t]).clone())}this.points=c}},r.Triangle=function(e,t,i){this.a=void 0!==e?e:new r.Vector3,this.b=void 0!==t?t:new r.Vector3,this.c=void 0!==i?i:new r.Vector3},r.Triangle.normal=function(){var e=new r.Vector3;return function(t,i,n,o){var s=o||new r.Vector3;s.subVectors(n,i),e.subVectors(t,i),s.cross(e);var a=s.lengthSq();return a>0?s.multiplyScalar(1/Math.sqrt(a)):s.set(0,0,0)}}(),r.Triangle.barycoordFromPoint=function(){var e=new r.Vector3,t=new r.Vector3,i=new r.Vector3;return function(n,o,s,a,h){e.subVectors(a,o),t.subVectors(s,o),i.subVectors(n,o);var l=e.dot(e),c=e.dot(t),u=e.dot(i),p=t.dot(t),d=t.dot(i),f=l*p-c*c,m=h||new r.Vector3;if(0===f)return m.set(-2,-1,-1);var y=1/f,g=(p*u-c*d)*y,v=(l*d-c*u)*y;return m.set(1-g-v,v,g)}}(),r.Triangle.containsPoint=function(){var e=new r.Vector3;return function(t,i,n,o){var s=r.Triangle.barycoordFromPoint(t,i,n,o,e);return s.x>=0&&s.y>=0&&s.x+s.y<=1}}(),r.Triangle.prototype={constructor:r.Triangle,set:function(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this},setFromPointsAndIndices:function(e,t,i,n){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},area:function(){var e=new r.Vector3,t=new r.Vector3;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),midpoint:function(e){var t=e||new r.Vector3;return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return r.Triangle.normal(this.a,this.b,this.c,e)},plane:function(e){var t=e||new r.Plane;return t.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return r.Triangle.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return r.Triangle.containsPoint(e,this.a,this.b,this.c)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},r.Clock=function(e){this.autoStart=void 0!==e?e:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1},r.Clock.prototype={constructor:r.Clock,start:function(){this.startTime=void 0!==n.performance&&void 0!==n.performance.now?n.performance.now():Date.now(),this.oldTime=this.startTime,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running&&this.start(),this.running){var t=void 0!==n.performance&&void 0!==n.performance.now?n.performance.now():Date.now();e=.001*(t-this.oldTime),this.oldTime=t,this.elapsedTime+=e}return e}},r.EventDispatcher=function(){},r.EventDispatcher.prototype={constructor:r.EventDispatcher,apply:function(e){e.addEventListener=r.EventDispatcher.prototype.addEventListener,e.hasEventListener=r.EventDispatcher.prototype.hasEventListener,e.removeEventListener=r.EventDispatcher.prototype.removeEventListener,e.dispatchEvent=r.EventDispatcher.prototype.dispatchEvent},addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)?!0:!1},removeEventListener:function(e,t){if(void 0!==this._listeners){var i=this._listeners,n=i[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners,i=t[e.type];if(void 0!==i){e.target=this;for(var n=[],r=i.length,o=0;r>o;o++)n[o]=i[o];for(var o=0;r>o;o++)n[o].call(this,e)}}}},function(e){function t(e,t){return e.distance-t.distance}e.Raycaster=function(t,i,n,r){this.ray=new e.Ray(t,i),this.near=n||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})};var i=function(e,t,n,r){if(e.visible!==!1&&(e.raycast(t,n),r===!0))for(var o=e.children,s=0,a=o.length;a>s;s++)i(o[s],t,n,!0)};e.Raycaster.prototype={constructor:e.Raycaster,linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(t,i){i instanceof e.PerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(i).sub(this.ray.origin).normalize()):i instanceof e.OrthographicCamera?(this.ray.origin.set(t.x,t.y,-1).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,n){var r=[];return i(e,this,r,n),r.sort(t),r},intersectObjects:function(e,n){var r=[];if(Array.isArray(e)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var o=0,s=e.length;s>o;o++)i(e[o],this,r,n);return r.sort(t),r}}}(r),r.Object3D=function(){Object.defineProperty(this,"id",{value:r.Object3DIdCount++}),this.uuid=r.Math.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=r.Object3D.DefaultUp.clone();var e=new r.Vector3,t=new r.Euler,i=new r.Quaternion,n=new r.Vector3(1,1,1),o=function(){i.setFromEuler(t,!1)},s=function(){t.setFromQuaternion(i,void 0,!1)};t.onChange(o),i.onChange(s),Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:t},quaternion:{enumerable:!0,value:i},scale:{enumerable:!0,value:n},modelViewMatrix:{value:new r.Matrix4},normalMatrix:{value:new r.Matrix3}}),this.rotationAutoUpdate=!0,this.matrix=new r.Matrix4,this.matrixWorld=new r.Matrix4,this.matrixAutoUpdate=r.Object3D.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}},r.Object3D.DefaultUp=new r.Vector3(0,1,0),r.Object3D.DefaultMatrixAutoUpdate=!0,r.Object3D.prototype={constructor:r.Object3D,get eulerOrder(){return console.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."),this.rotation.order},set eulerOrder(e){console.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."),this.rotation.order=e},get useQuaternion(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(e){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set renderDepth(e){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new r.Quaternion;return function(t,i){return e.setFromAxisAngle(t,i),this.quaternion.multiply(e),this}}(),rotateX:function(){var e=new r.Vector3(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new r.Vector3(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new r.Vector3(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new r.Vector3;return function(t,i){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(i)),this}}(),translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},translateX:function(){var e=new r.Vector3(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new r.Vector3(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new r.Vector3(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new r.Matrix4;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new r.Matrix4;return function(t){e.lookAt(t,this.position,this.up),this.quaternion.setFromRotationMatrix(e)}}(),add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e instanceof r.Object3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1)for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);var i=this.children.indexOf(e);-1!==i&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(i,1))},getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var i=0,n=this.children.length;n>i;i++){var r=this.children[i],o=r.getObjectByProperty(e,t);if(void 0!==o)return o}return void 0},getWorldPosition:function(e){var t=e||new r.Vector3;return this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var e=new r.Vector3,t=new r.Vector3;return function(i){var n=i||new r.Quaternion;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,n,t),n}}(),getWorldRotation:function(){var e=new r.Quaternion;return function(t){var i=t||new r.Euler;return this.getWorldQuaternion(e),i.setFromQuaternion(e,this.rotation.order,!1)}}(),getWorldScale:function(){var e=new r.Vector3,t=new r.Quaternion;return function(i){var n=i||new r.Vector3;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,n),n}}(),getWorldDirection:function(){var e=new r.Quaternion;return function(t){var i=t||new r.Vector3;return this.getWorldQuaternion(e),i.set(0,0,1).applyQuaternion(e)}}(),raycast:function(){},traverse:function(e){e(this);for(var t=this.children,i=0,n=t.length;n>i;i++)t[i].traverse(e)},traverseVisible:function(e){if(this.visible!==!1){e(this);for(var t=this.children,i=0,n=t.length;n>i;i++)t[i].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate===!0&&this.updateMatrix(),(this.matrixWorldNeedsUpdate===!0||e===!0)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=0,i=this.children.length;i>t;t++)this.children[t].updateMatrixWorld(e)},toJSON:function(e){function t(e){var t=[];for(var i in e){var n=e[i];delete n.metadata,t.push(n)}return t}var i=void 0===e,n={};if(i&&(e={geometries:{},materials:{},textures:{},images:{}},n.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"}),n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),this.visible!==!0&&(n.visible=this.visible),n.matrix=this.matrix.toArray(),this.children.length>0){n.children=[];for(var r=0;r<this.children.length;r++)n.children.push(this.children[r].toJSON(e).object)}var o={};if(i){var s=t(e.geometries),a=t(e.materials),h=t(e.textures),l=t(e.images);s.length>0&&(o.geometries=s),a.length>0&&(o.materials=a),h.length>0&&(o.textures=h),l.length>0&&(o.images=l)}return o.object=n,o},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.rotationAutoUpdate=e.rotationAutoUpdate,this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(var i=0;i<e.children.length;i++){var n=e.children[i];this.add(n.clone())}return this}},r.EventDispatcher.prototype.apply(r.Object3D.prototype),r.Object3DIdCount=0,r.Face3=function(e,t,i,n,o,s){this.a=e,this.b=t,this.c=i,this.normal=n instanceof r.Vector3?n:new r.Vector3,this.vertexNormals=Array.isArray(n)?n:[],this.color=o instanceof r.Color?o:new r.Color,this.vertexColors=Array.isArray(o)?o:[],this.materialIndex=void 0!==s?s:0},r.Face3.prototype={constructor:r.Face3,clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,i=e.vertexNormals.length;i>t;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(var t=0,i=e.vertexColors.length;i>t;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}},r.Face4=function(e,t,i,n,o,s,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new r.Face3(e,t,i,o,s,a)},r.BufferAttribute=function(e,t){this.uuid=r.Math.generateUUID(),this.array=e,this.itemSize=t,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0},r.BufferAttribute.prototype={constructor:r.BufferAttribute,get length(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length},get count(){return this.array.length/this.itemSize},set needsUpdate(e){e===!0&&this.version++},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.dynamic=e.dynamic,this},copyAt:function(e,t,i){e*=this.itemSize,i*=t.itemSize;for(var n=0,r=this.itemSize;r>n;n++)this.array[e+n]=t.array[i+n];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,i=0,n=0,o=e.length;o>n;n++){var s=e[n];void 0===s&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),s=new r.Color),t[i++]=s.r,t[i++]=s.g,t[i++]=s.b}return this},copyIndicesArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;r>n;n++){var o=e[n];t[i++]=o.a,t[i++]=o.b,t[i++]=o.c}return this},copyVector2sArray:function(e){for(var t=this.array,i=0,n=0,o=e.length;o>n;n++){var s=e[n];void 0===s&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),s=new r.Vector2),t[i++]=s.x,t[i++]=s.y}return this},copyVector3sArray:function(e){for(var t=this.array,i=0,n=0,o=e.length;o>n;n++){var s=e[n];void 0===s&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),s=new r.Vector3),t[i++]=s.x,t[i++]=s.y,t[i++]=s.z}return this},copyVector4sArray:function(e){for(var t=this.array,i=0,n=0,o=e.length;o>n;n++){var s=e[n];void 0===s&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),s=new r.Vector4),t[i++]=s.x,t[i++]=s.y,t[i++]=s.z,t[i++]=s.w}return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this},setXYZ:function(e,t,i,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this},setXYZW:function(e,t,i,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this.array[e+3]=r,this},clone:function(){return(new this.constructor).copy(this)}},r.Int8Attribute=function(e,t){return new r.BufferAttribute(new Int8Array(e),t)},r.Uint8Attribute=function(e,t){return new r.BufferAttribute(new Uint8Array(e),t)},r.Uint8ClampedAttribute=function(e,t){return new r.BufferAttribute(new Uint8ClampedArray(e),t)},r.Int16Attribute=function(e,t){return new r.BufferAttribute(new Int16Array(e),t)},r.Uint16Attribute=function(e,t){return new r.BufferAttribute(new Uint16Array(e),t)},r.Int32Attribute=function(e,t){return new r.BufferAttribute(new Int32Array(e),t)},r.Uint32Attribute=function(e,t){return new r.BufferAttribute(new Uint32Array(e),t)},r.Float32Attribute=function(e,t){
return new r.BufferAttribute(new Float32Array(e),t)},r.Float64Attribute=function(e,t){return new r.BufferAttribute(new Float64Array(e),t)},r.DynamicBufferAttribute=function(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new r.BufferAttribute(e,t).setDynamic(!0)},r.InstancedBufferAttribute=function(e,t,i){r.BufferAttribute.call(this,e,t),this.meshPerAttribute=i||1},r.InstancedBufferAttribute.prototype=Object.create(r.BufferAttribute.prototype),r.InstancedBufferAttribute.prototype.constructor=r.InstancedBufferAttribute,r.InstancedBufferAttribute.prototype.copy=function(e){return r.BufferAttribute.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},r.InterleavedBuffer=function(e,t){this.uuid=r.Math.generateUUID(),this.array=e,this.stride=t,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0},r.InterleavedBuffer.prototype={constructor:r.InterleavedBuffer,get length(){return this.array.length},get count(){return this.array.length/this.stride},set needsUpdate(e){e===!0&&this.version++},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){this.array=new e.array.constructor(e.array),this.stride=e.stride,this.dynamic=e.dynamic},copyAt:function(e,t,i){e*=this.stride,i*=t.stride;for(var n=0,r=this.stride;r>n;n++)this.array[e+n]=t.array[i+n];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)}},r.InstancedInterleavedBuffer=function(e,t,i){r.InterleavedBuffer.call(this,e,t),this.meshPerAttribute=i||1},r.InstancedInterleavedBuffer.prototype=Object.create(r.InterleavedBuffer.prototype),r.InstancedInterleavedBuffer.prototype.constructor=r.InstancedInterleavedBuffer,r.InstancedInterleavedBuffer.prototype.copy=function(e){return r.InterleavedBuffer.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},r.InterleavedBufferAttribute=function(e,t,i){this.uuid=r.Math.generateUUID(),this.data=e,this.itemSize=t,this.offset=i},r.InterleavedBufferAttribute.prototype={constructor:r.InterleavedBufferAttribute,get length(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length},get count(){return this.data.array.length/this.data.stride},setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this},setXYZ:function(e,t,i,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this},setXYZW:function(e,t,i,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this.data.array[e+3]=r,this}},r.Geometry=function(){Object.defineProperty(this,"id",{value:r.GeometryIdCount++}),this.uuid=r.Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphColors=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1},r.Geometry.prototype={constructor:r.Geometry,applyMatrix:function(e){for(var t=(new r.Matrix3).getNormalMatrix(e),i=0,n=this.vertices.length;n>i;i++){var o=this.vertices[i];o.applyMatrix4(e)}for(var i=0,n=this.faces.length;n>i;i++){var s=this.faces[i];s.normal.applyMatrix3(t).normalize();for(var a=0,h=s.vertexNormals.length;h>a;a++)s.vertexNormals[a].applyMatrix3(t).normalize()}null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0},rotateX:function(){var e;return function(t){return void 0===e&&(e=new r.Matrix4),e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e;return function(t){return void 0===e&&(e=new r.Matrix4),e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e;return function(t){return void 0===e&&(e=new r.Matrix4),e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e;return function(t,i,n){return void 0===e&&(e=new r.Matrix4),e.makeTranslation(t,i,n),this.applyMatrix(e),this}}(),scale:function(){var e;return function(t,i,n){return void 0===e&&(e=new r.Matrix4),e.makeScale(t,i,n),this.applyMatrix(e),this}}(),lookAt:function(){var e;return function(t){void 0===e&&(e=new r.Object3D),e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),fromBufferGeometry:function(e){var t=this,i=null!==e.index?e.index.array:void 0,n=e.attributes,o=n.position.array,s=void 0!==n.normal?n.normal.array:void 0,a=void 0!==n.color?n.color.array:void 0,h=void 0!==n.uv?n.uv.array:void 0,l=void 0!==n.uv2?n.uv2.array:void 0;void 0!==l&&(this.faceVertexUvs[1]=[]);for(var c=[],u=[],p=[],d=0,f=0,m=0;d<o.length;d+=3,f+=2,m+=4)t.vertices.push(new r.Vector3(o[d],o[d+1],o[d+2])),void 0!==s&&c.push(new r.Vector3(s[d],s[d+1],s[d+2])),void 0!==a&&t.colors.push(new r.Color(a[d],a[d+1],a[d+2])),void 0!==h&&u.push(new r.Vector2(h[f],h[f+1])),void 0!==l&&p.push(new r.Vector2(l[f],l[f+1]));var y=function(e,i,n){var o=void 0!==s?[c[e].clone(),c[i].clone(),c[n].clone()]:[],d=void 0!==a?[t.colors[e].clone(),t.colors[i].clone(),t.colors[n].clone()]:[],f=new r.Face3(e,i,n,o,d);t.faces.push(f),void 0!==h&&t.faceVertexUvs[0].push([u[e].clone(),u[i].clone(),u[n].clone()]),void 0!==l&&t.faceVertexUvs[1].push([p[e].clone(),p[i].clone(),p[n].clone()])};if(void 0!==i){var g=e.groups;if(g.length>0)for(var d=0;d<g.length;d++)for(var v=g[d],b=v.start,_=v.count,f=b,x=b+_;x>f;f+=3)y(i[f],i[f+1],i[f+2]);else for(var d=0;d<i.length;d+=3)y(i[d],i[d+1],i[d+2])}else for(var d=0;d<o.length/3;d+=3)y(d,d+1,d+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var e=this.boundingBox.center().negate();return this.translate(e.x,e.y,e.z),e},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,i=0===t?1:1/t,n=new r.Matrix4;return n.set(i,0,0,-i*e.x,0,i,0,-i*e.y,0,0,i,-i*e.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var e=new r.Vector3,t=new r.Vector3,i=0,n=this.faces.length;n>i;i++){var o=this.faces[i],s=this.vertices[o.a],a=this.vertices[o.b],h=this.vertices[o.c];e.subVectors(h,a),t.subVectors(s,a),e.cross(t),e.normalize(),o.normal.copy(e)}},computeVertexNormals:function(e){var t,i,n,o,s,a;for(a=new Array(this.vertices.length),t=0,i=this.vertices.length;i>t;t++)a[t]=new r.Vector3;if(e){var h,l,c,u=new r.Vector3,p=new r.Vector3;for(n=0,o=this.faces.length;o>n;n++)s=this.faces[n],h=this.vertices[s.a],l=this.vertices[s.b],c=this.vertices[s.c],u.subVectors(c,l),p.subVectors(h,l),u.cross(p),a[s.a].add(u),a[s.b].add(u),a[s.c].add(u)}else for(n=0,o=this.faces.length;o>n;n++)s=this.faces[n],a[s.a].add(s.normal),a[s.b].add(s.normal),a[s.c].add(s.normal);for(t=0,i=this.vertices.length;i>t;t++)a[t].normalize();for(n=0,o=this.faces.length;o>n;n++){s=this.faces[n];var d=s.vertexNormals;3===d.length?(d[0].copy(a[s.a]),d[1].copy(a[s.b]),d[2].copy(a[s.c])):(d[0]=a[s.a].clone(),d[1]=a[s.b].clone(),d[2]=a[s.c].clone())}},computeMorphNormals:function(){var e,t,i,n,o;for(i=0,n=this.faces.length;n>i;i++)for(o=this.faces[i],o.__originalFaceNormal?o.__originalFaceNormal.copy(o.normal):o.__originalFaceNormal=o.normal.clone(),o.__originalVertexNormals||(o.__originalVertexNormals=[]),e=0,t=o.vertexNormals.length;t>e;e++)o.__originalVertexNormals[e]?o.__originalVertexNormals[e].copy(o.vertexNormals[e]):o.__originalVertexNormals[e]=o.vertexNormals[e].clone();var s=new r.Geometry;for(s.faces=this.faces,e=0,t=this.morphTargets.length;t>e;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var a,h,l=this.morphNormals[e].faceNormals,c=this.morphNormals[e].vertexNormals;for(i=0,n=this.faces.length;n>i;i++)a=new r.Vector3,h={a:new r.Vector3,b:new r.Vector3,c:new r.Vector3},l.push(a),c.push(h)}var u=this.morphNormals[e];s.vertices=this.morphTargets[e].vertices,s.computeFaceNormals(),s.computeVertexNormals();var a,h;for(i=0,n=this.faces.length;n>i;i++)o=this.faces[i],a=u.faceNormals[i],h=u.vertexNormals[i],a.copy(o.normal),h.a.copy(o.vertexNormals[0]),h.b.copy(o.vertexNormals[1]),h.c.copy(o.vertexNormals[2])}for(i=0,n=this.faces.length;n>i;i++)o=this.faces[i],o.normal=o.__originalFaceNormal,o.vertexNormals=o.__originalVertexNormals},computeTangents:function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){for(var e=0,t=this.vertices,i=0,n=t.length;n>i;i++)i>0&&(e+=t[i].distanceTo(t[i-1])),this.lineDistances[i]=e},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new r.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new r.Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,i){if(e instanceof r.Geometry==!1)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);var n,o=this.vertices.length,s=this.vertices,a=e.vertices,h=this.faces,l=e.faces,c=this.faceVertexUvs[0],u=e.faceVertexUvs[0];void 0===i&&(i=0),void 0!==t&&(n=(new r.Matrix3).getNormalMatrix(t));for(var p=0,d=a.length;d>p;p++){var f=a[p],m=f.clone();void 0!==t&&m.applyMatrix4(t),s.push(m)}for(p=0,d=l.length;d>p;p++){var y,g,v,b=l[p],_=b.vertexNormals,x=b.vertexColors;y=new r.Face3(b.a+o,b.b+o,b.c+o),y.normal.copy(b.normal),void 0!==n&&y.normal.applyMatrix3(n).normalize();for(var w=0,S=_.length;S>w;w++)g=_[w].clone(),void 0!==n&&g.applyMatrix3(n).normalize(),y.vertexNormals.push(g);y.color.copy(b.color);for(var w=0,S=x.length;S>w;w++)v=x[w],y.vertexColors.push(v.clone());y.materialIndex=b.materialIndex+i,h.push(y)}for(p=0,d=u.length;d>p;p++){var M=u[p],T=[];if(void 0!==M){for(var w=0,S=M.length;S>w;w++)T.push(M[w].clone());c.push(T)}}},mergeMesh:function(e){return e instanceof r.Mesh==!1?void console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e):(e.matrixAutoUpdate&&e.updateMatrix(),void this.merge(e.geometry,e.matrix))},mergeVertices:function(){var e,t,i,n,r,o,s,a,h={},l=[],c=[],u=4,p=Math.pow(10,u);for(i=0,n=this.vertices.length;n>i;i++)e=this.vertices[i],t=Math.round(e.x*p)+"_"+Math.round(e.y*p)+"_"+Math.round(e.z*p),void 0===h[t]?(h[t]=i,l.push(this.vertices[i]),c[i]=l.length-1):c[i]=c[h[t]];var d=[];for(i=0,n=this.faces.length;n>i;i++){r=this.faces[i],r.a=c[r.a],r.b=c[r.b],r.c=c[r.c],o=[r.a,r.b,r.c];for(var f=-1,m=0;3>m;m++)if(o[m]===o[(m+1)%3]){f=m,d.push(i);break}}for(i=d.length-1;i>=0;i--){var y=d[i];for(this.faces.splice(y,1),s=0,a=this.faceVertexUvs.length;a>s;s++)this.faceVertexUvs[s].splice(y,1)}var g=this.vertices.length-l.length;return this.vertices=l,g},toJSON:function(){function e(e,t,i){return i?e|1<<t:e&~(1<<t)}function t(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==p[t]?p[t]:(p[t]=u.length/3,u.push(e.x,e.y,e.z),p[t])}function i(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==f[t]?f[t]:(f[t]=d.length,d.push(e.getHex()),f[t])}function n(e){var t=e.x.toString()+e.y.toString();return void 0!==y[t]?y[t]:(y[t]=m.length/2,m.push(e.x,e.y),y[t])}var r={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),void 0!==this.parameters){var o=this.parameters;for(var s in o)void 0!==o[s]&&(r[s]=o[s]);return r}for(var a=[],h=0;h<this.vertices.length;h++){var l=this.vertices[h];a.push(l.x,l.y,l.z)}for(var c=[],u=[],p={},d=[],f={},m=[],y={},h=0;h<this.faces.length;h++){var g=this.faces[h],v=!1,b=!1,_=void 0!==this.faceVertexUvs[0][h],x=g.normal.length()>0,w=g.vertexNormals.length>0,S=1!==g.color.r||1!==g.color.g||1!==g.color.b,M=g.vertexColors.length>0,T=0;if(T=e(T,0,0),T=e(T,1,v),T=e(T,2,b),T=e(T,3,_),T=e(T,4,x),T=e(T,5,w),T=e(T,6,S),T=e(T,7,M),c.push(T),c.push(g.a,g.b,g.c),_){var E=this.faceVertexUvs[0][h];c.push(n(E[0]),n(E[1]),n(E[2]))}if(x&&c.push(t(g.normal)),w){var k=g.vertexNormals;c.push(t(k[0]),t(k[1]),t(k[2]))}if(S&&c.push(i(g.color)),M){var A=g.vertexColors;c.push(i(A[0]),i(A[1]),i(A[2]))}}return r.data={},r.data.vertices=a,r.data.normals=u,d.length>0&&(r.data.colors=d),m.length>0&&(r.data.uvs=[m]),r.data.faces=c,r},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]];for(var t=e.vertices,i=0,n=t.length;n>i;i++)this.vertices.push(t[i].clone());for(var r=e.faces,i=0,n=r.length;n>i;i++)this.faces.push(r[i].clone());for(var i=0,n=e.faceVertexUvs.length;n>i;i++){var o=e.faceVertexUvs[i];void 0===this.faceVertexUvs[i]&&(this.faceVertexUvs[i]=[]);for(var s=0,a=o.length;a>s;s++){for(var h=o[s],l=[],c=0,u=h.length;u>c;c++){var p=h[c];l.push(p.clone())}this.faceVertexUvs[i].push(l)}}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}},r.EventDispatcher.prototype.apply(r.Geometry.prototype),r.GeometryIdCount=0,r.DirectGeometry=function(){Object.defineProperty(this,"id",{value:r.GeometryIdCount++}),this.uuid=r.Math.generateUUID(),this.name="",this.type="DirectGeometry",this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1},r.DirectGeometry.prototype={constructor:r.DirectGeometry,computeBoundingBox:r.Geometry.prototype.computeBoundingBox,computeBoundingSphere:r.Geometry.prototype.computeBoundingSphere,computeFaceNormals:function(){console.warn("THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.")},computeVertexNormals:function(){console.warn("THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.")},computeGroups:function(e){for(var t,i,n=[],r=e.faces,o=0;o<r.length;o++){var s=r[o];s.materialIndex!==i&&(i=s.materialIndex,void 0!==t&&(t.count=3*o-t.start,n.push(t)),t={start:3*o,materialIndex:i})}void 0!==t&&(t.count=3*o-t.start,n.push(t)),this.groups=n},fromGeometry:function(e){var t=e.faces,i=e.vertices,n=e.faceVertexUvs,o=n[0]&&n[0].length>0,s=n[1]&&n[1].length>0,a=e.morphTargets,h=a.length;if(h>0){for(var l=[],c=0;h>c;c++)l[c]=[];this.morphTargets.position=l}var u=e.morphNormals,p=u.length;if(p>0){for(var d=[],c=0;p>c;c++)d[c]=[];this.morphTargets.normal=d}for(var f=e.skinIndices,m=e.skinWeights,y=f.length===i.length,g=m.length===i.length,c=0;c<t.length;c++){var v=t[c];this.vertices.push(i[v.a],i[v.b],i[v.c]);var b=v.vertexNormals;if(3===b.length)this.normals.push(b[0],b[1],b[2]);else{var _=v.normal;this.normals.push(_,_,_)}var x=v.vertexColors;if(3===x.length)this.colors.push(x[0],x[1],x[2]);else{var w=v.color;this.colors.push(w,w,w)}if(o===!0){var S=n[0][c];void 0!==S?this.uvs.push(S[0],S[1],S[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",c),this.uvs.push(new r.Vector2,new r.Vector2,new r.Vector2))}if(s===!0){var S=n[1][c];void 0!==S?this.uvs2.push(S[0],S[1],S[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",c),this.uvs2.push(new r.Vector2,new r.Vector2,new r.Vector2))}for(var M=0;h>M;M++){var T=a[M].vertices;l[M].push(T[v.a],T[v.b],T[v.c])}for(var M=0;p>M;M++){var E=u[M].vertexNormals[c];d[M].push(E.a,E.b,E.c)}y&&this.skinIndices.push(f[v.a],f[v.b],f[v.c]),g&&this.skinWeights.push(m[v.a],m[v.b],m[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}},r.EventDispatcher.prototype.apply(r.DirectGeometry.prototype),r.BufferGeometry=function(){Object.defineProperty(this,"id",{value:r.GeometryIdCount++}),this.uuid=r.Math.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}},r.BufferGeometry.prototype={constructor:r.BufferGeometry,addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},getIndex:function(){return this.index},setIndex:function(e){this.index=e},addAttribute:function(e,t){return t instanceof r.BufferAttribute==!1&&t instanceof r.InterleavedBufferAttribute==!1?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(e,new r.BufferAttribute(arguments[1],arguments[2]))):("index"===e&&(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t)),void(this.attributes[e]=t))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){delete this.attributes[e]},get drawcalls(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups},get offsets(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups},addDrawCall:function(e,t,i){void 0!==i&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},addGroup:function(e,t,i){this.groups.push({start:e,count:t,materialIndex:void 0!==i?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToVector3Array(t.array),t.needsUpdate=!0);var i=this.attributes.normal;if(void 0!==i){var n=(new r.Matrix3).getNormalMatrix(e);n.applyToVector3Array(i.array),i.needsUpdate=!0}null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere()},rotateX:function(){var e;return function(t){return void 0===e&&(e=new r.Matrix4),e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e;return function(t){return void 0===e&&(e=new r.Matrix4),e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e;return function(t){return void 0===e&&(e=new r.Matrix4),e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e;return function(t,i,n){return void 0===e&&(e=new r.Matrix4),e.makeTranslation(t,i,n),this.applyMatrix(e),this}}(),scale:function(){var e;return function(t,i,n){return void 0===e&&(e=new r.Matrix4),e.makeScale(t,i,n),this.applyMatrix(e),this}}(),lookAt:function(){var e;return function(t){void 0===e&&(e=new r.Object3D),e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),center:function(){this.computeBoundingBox();var e=this.boundingBox.center().negate();return this.translate(e.x,e.y,e.z),e},setFromObject:function(e){var t=e.geometry;if(e instanceof r.Points||e instanceof r.Line){var i=new r.Float32Attribute(3*t.vertices.length,3),n=new r.Float32Attribute(3*t.colors.length,3);if(this.addAttribute("position",i.copyVector3sArray(t.vertices)),this.addAttribute("color",n.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var o=new r.Float32Attribute(t.lineDistances.length,1);this.addAttribute("lineDistance",o.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e instanceof r.Mesh&&t instanceof r.Geometry&&this.fromGeometry(t);return this},updateFromObject:function(e){var t=e.geometry;if(e instanceof r.Mesh){var i=t.__directGeometry;if(void 0===i)return this.fromGeometry(t);i.verticesNeedUpdate=t.verticesNeedUpdate,i.normalsNeedUpdate=t.normalsNeedUpdate,i.colorsNeedUpdate=t.colorsNeedUpdate,i.uvsNeedUpdate=t.uvsNeedUpdate,i.groupsNeedUpdate=t.groupsNeedUpdate,t.verticesNeedUpdate=!1,t.normalsNeedUpdate=!1,t.colorsNeedUpdate=!1,t.uvsNeedUpdate=!1,t.groupsNeedUpdate=!1,t=i}if(t.verticesNeedUpdate===!0){var n=this.attributes.position;void 0!==n&&(n.copyVector3sArray(t.vertices),n.needsUpdate=!0),t.verticesNeedUpdate=!1}if(t.normalsNeedUpdate===!0){var n=this.attributes.normal;void 0!==n&&(n.copyVector3sArray(t.normals),n.needsUpdate=!0),t.normalsNeedUpdate=!1}if(t.colorsNeedUpdate===!0){var n=this.attributes.color;void 0!==n&&(n.copyColorsArray(t.colors),n.needsUpdate=!0),t.colorsNeedUpdate=!1}if(t.lineDistancesNeedUpdate){var n=this.attributes.lineDistance;void 0!==n&&(n.copyArray(t.lineDistances),n.needsUpdate=!0),t.lineDistancesNeedUpdate=!1}return t.groupsNeedUpdate&&(t.computeGroups(e.geometry),this.groups=t.groups,t.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new r.DirectGeometry).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new r.BufferAttribute(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var i=new Float32Array(3*e.normals.length);this.addAttribute("normal",new r.BufferAttribute(i,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var n=new Float32Array(3*e.colors.length);this.addAttribute("color",new r.BufferAttribute(n,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var o=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new r.BufferAttribute(o,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var s=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new r.BufferAttribute(s,2).copyVector2sArray(e.uvs2))}if(e.indices.length>0){var a=e.vertices.length>65535?Uint32Array:Uint16Array,h=new a(3*e.indices.length);this.setIndex(new r.BufferAttribute(h,1).copyIndicesArray(e.indices))}this.groups=e.groups;for(var l in e.morphTargets){for(var c=[],u=e.morphTargets[l],p=0,d=u.length;d>p;p++){var f=u[p],m=new r.Float32Attribute(3*f.length,3);c.push(m.copyVector3sArray(f))}this.morphAttributes[l]=c}if(e.skinIndices.length>0){var y=new r.Float32Attribute(4*e.skinIndices.length,4);this.addAttribute("skinIndex",y.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var g=new r.Float32Attribute(4*e.skinWeights.length,4);this.addAttribute("skinWeight",g.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){var e=new r.Vector3;return function(){null===this.boundingBox&&(this.boundingBox=new r.Box3);var t=this.attributes.position.array;if(t){var i=this.boundingBox;i.makeEmpty();for(var n=0,o=t.length;o>n;n+=3)e.fromArray(t,n),i.expandByPoint(e)}(void 0===t||0===t.length)&&(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}}(),computeBoundingSphere:function(){var e=new r.Box3,t=new r.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new r.Sphere);var i=this.attributes.position.array;if(i){e.makeEmpty();for(var n=this.boundingSphere.center,o=0,s=i.length;s>o;o+=3)t.fromArray(i,o),e.expandByPoint(t);e.center(n);for(var a=0,o=0,s=i.length;s>o;o+=3)t.fromArray(i,o),a=Math.max(a,n.distanceToSquared(t));this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes,i=this.groups;if(t.position){var n=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new r.BufferAttribute(new Float32Array(n.length),3));else for(var o=t.normal.array,s=0,a=o.length;a>s;s++)o[s]=0;var h,l,c,o=t.normal.array,u=new r.Vector3,p=new r.Vector3,d=new r.Vector3,f=new r.Vector3,m=new r.Vector3;if(e){var y=e.array;0===i.length&&this.addGroup(0,y.length);for(var g=0,v=i.length;v>g;++g)for(var b=i[g],_=b.start,x=b.count,s=_,a=_+x;a>s;s+=3)h=3*y[s+0],l=3*y[s+1],c=3*y[s+2],u.fromArray(n,h),p.fromArray(n,l),d.fromArray(n,c),f.subVectors(d,p),m.subVectors(u,p),f.cross(m),o[h]+=f.x,o[h+1]+=f.y,o[h+2]+=f.z,o[l]+=f.x,o[l+1]+=f.y,o[l+2]+=f.z,o[c]+=f.x,o[c+1]+=f.y,o[c+2]+=f.z}else for(var s=0,a=n.length;a>s;s+=9)u.fromArray(n,s),p.fromArray(n,s+3),d.fromArray(n,s+6),f.subVectors(d,p),m.subVectors(u,p),f.cross(m),o[s]=f.x,o[s+1]=f.y,o[s+2]=f.z,o[s+3]=f.x,o[s+4]=f.y,o[s+5]=f.z,o[s+6]=f.x,o[s+7]=f.y,o[s+8]=f.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(e){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},merge:function(e,t){if(e instanceof r.BufferGeometry==!1)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0);var i=this.attributes;for(var n in i)if(void 0!==e.attributes[n])for(var o=i[n],s=o.array,a=e.attributes[n],h=a.array,l=a.itemSize,c=0,u=l*t;c<h.length;c++,u++)s[u]=h[c];return this},normalizeNormals:function(){for(var e,t,i,n,r=this.attributes.normal.array,o=0,s=r.length;s>o;o+=3)e=r[o],t=r[o+1],i=r[o+2],n=1/Math.sqrt(e*e+t*t+i*i),r[o]*=n,r[o+1]*=n,r[o+2]*=n},toJSON:function(){var e={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var i in t)void 0!==t[i]&&(e[i]=t[i]);return e}e.data={attributes:{}};var n=this.index;if(null!==n){var r=Array.prototype.slice.call(n.array);e.data.index={type:n.array.constructor.name,array:r}}var o=this.attributes;for(var i in o){var s=o[i],r=Array.prototype.slice.call(s.array);e.data.attributes[i]={itemSize:s.itemSize,type:s.array.constructor.name,array:r}}var a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));var h=this.boundingSphere;return null!==h&&(e.data.boundingSphere={center:h.center.toArray(),radius:h.radius}),e},clone:function(){return(new this.constructor).copy(this)},copy:function(e){var t=e.index;null!==t&&this.setIndex(t.clone());var i=e.attributes;for(var n in i){var r=i[n];this.addAttribute(n,r.clone())}for(var o=e.groups,s=0,a=o.length;a>s;s++){var h=o[s];this.addGroup(h.start,h.count)}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}},r.EventDispatcher.prototype.apply(r.BufferGeometry.prototype),r.BufferGeometry.MaxIndex=65535,r.InstancedBufferGeometry=function(){r.BufferGeometry.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0},r.InstancedBufferGeometry.prototype=Object.create(r.BufferGeometry.prototype),r.InstancedBufferGeometry.prototype.constructor=r.InstancedBufferGeometry,r.InstancedBufferGeometry.prototype.addGroup=function(e,t,i){this.groups.push({start:e,count:t,instances:i})},r.InstancedBufferGeometry.prototype.copy=function(e){var t=e.index;null!==t&&this.setIndex(t.clone());var i=e.attributes;for(var n in i){var r=i[n];this.addAttribute(n,r.clone())}for(var o=e.groups,s=0,a=o.length;a>s;s++){var h=o[s];this.addGroup(h.start,h.count,h.instances)}return this},r.EventDispatcher.prototype.apply(r.InstancedBufferGeometry.prototype),r.Camera=function(){r.Object3D.call(this),this.type="Camera",this.matrixWorldInverse=new r.Matrix4,this.projectionMatrix=new r.Matrix4},r.Camera.prototype=Object.create(r.Object3D.prototype),r.Camera.prototype.constructor=r.Camera,r.Camera.prototype.getWorldDirection=function(){var e=new r.Quaternion;return function(t){var i=t||new r.Vector3;return this.getWorldQuaternion(e),i.set(0,0,-1).applyQuaternion(e)}}(),r.Camera.prototype.lookAt=function(){var e=new r.Matrix4;return function(t){e.lookAt(this.position,t,this.up),this.quaternion.setFromRotationMatrix(e)}}(),r.Camera.prototype.clone=function(){return(new this.constructor).copy(this)},r.Camera.prototype.copy=function(e){return r.Object3D.prototype.copy.call(this,e),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this},r.CubeCamera=function(e,t,i){r.Object3D.call(this),this.type="CubeCamera";var n=90,o=1,s=new r.PerspectiveCamera(n,o,e,t);s.up.set(0,-1,0),s.lookAt(new r.Vector3(1,0,0)),this.add(s);var a=new r.PerspectiveCamera(n,o,e,t);a.up.set(0,-1,0),a.lookAt(new r.Vector3(-1,0,0)),this.add(a);var h=new r.PerspectiveCamera(n,o,e,t);h.up.set(0,0,1),h.lookAt(new r.Vector3(0,1,0)),this.add(h);var l=new r.PerspectiveCamera(n,o,e,t);l.up.set(0,0,-1),l.lookAt(new r.Vector3(0,-1,0)),this.add(l);var c=new r.PerspectiveCamera(n,o,e,t);c.up.set(0,-1,0),c.lookAt(new r.Vector3(0,0,1)),this.add(c);var u=new r.PerspectiveCamera(n,o,e,t);u.up.set(0,-1,0),u.lookAt(new r.Vector3(0,0,-1)),this.add(u),this.renderTarget=new r.WebGLRenderTargetCube(i,i,{format:r.RGBFormat,magFilter:r.LinearFilter,minFilter:r.LinearFilter}),this.updateCubeMap=function(e,t){null===this.parent&&this.updateMatrixWorld();var i=this.renderTarget,n=i.generateMipmaps;i.generateMipmaps=!1,i.activeCubeFace=0,e.render(t,s,i),i.activeCubeFace=1,e.render(t,a,i),i.activeCubeFace=2,e.render(t,h,i),i.activeCubeFace=3,e.render(t,l,i),i.activeCubeFace=4,e.render(t,c,i),i.generateMipmaps=n,i.activeCubeFace=5,e.render(t,u,i),e.setRenderTarget(null)}},r.CubeCamera.prototype=Object.create(r.Object3D.prototype),r.CubeCamera.prototype.constructor=r.CubeCamera,r.OrthographicCamera=function(e,t,i,n,o,s){r.Camera.call(this),this.type="OrthographicCamera",this.zoom=1,this.left=e,this.right=t,this.top=i,this.bottom=n,this.near=void 0!==o?o:.1,this.far=void 0!==s?s:2e3,this.updateProjectionMatrix()},r.OrthographicCamera.prototype=Object.create(r.Camera.prototype),r.OrthographicCamera.prototype.constructor=r.OrthographicCamera,r.OrthographicCamera.prototype.updateProjectionMatrix=function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(i-e,i+e,n+t,n-t,this.near,this.far)},r.OrthographicCamera.prototype.copy=function(e){return r.Camera.prototype.copy.call(this,e),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this},r.OrthographicCamera.prototype.toJSON=function(e){var t=r.Object3D.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,t},r.PerspectiveCamera=function(e,t,i,n){r.Camera.call(this),
this.type="PerspectiveCamera",this.zoom=1,this.fov=void 0!==e?e:50,this.aspect=void 0!==t?t:1,this.near=void 0!==i?i:.1,this.far=void 0!==n?n:2e3,this.updateProjectionMatrix()},r.PerspectiveCamera.prototype=Object.create(r.Camera.prototype),r.PerspectiveCamera.prototype.constructor=r.PerspectiveCamera,r.PerspectiveCamera.prototype.setLens=function(e,t){void 0===t&&(t=24),this.fov=2*r.Math.radToDeg(Math.atan(t/(2*e))),this.updateProjectionMatrix()},r.PerspectiveCamera.prototype.setViewOffset=function(e,t,i,n,r,o){this.fullWidth=e,this.fullHeight=t,this.x=i,this.y=n,this.width=r,this.height=o,this.updateProjectionMatrix()},r.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var e=r.Math.radToDeg(2*Math.atan(Math.tan(.5*r.Math.degToRad(this.fov))/this.zoom));if(this.fullWidth){var t=this.fullWidth/this.fullHeight,i=Math.tan(r.Math.degToRad(.5*e))*this.near,n=-i,o=t*n,s=t*i,a=Math.abs(s-o),h=Math.abs(i-n);this.projectionMatrix.makeFrustum(o+this.x*a/this.fullWidth,o+(this.x+this.width)*a/this.fullWidth,i-(this.y+this.height)*h/this.fullHeight,i-this.y*h/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(e,this.aspect,this.near,this.far)},r.PerspectiveCamera.prototype.copy=function(e){return r.Camera.prototype.copy.call(this,e),this.fov=e.fov,this.aspect=e.aspect,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this},r.PerspectiveCamera.prototype.toJSON=function(e){var t=r.Object3D.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.fov=this.fov,t.object.aspect=this.aspect,t.object.near=this.near,t.object.far=this.far,t},r.Light=function(e){r.Object3D.call(this),this.type="Light",this.color=new r.Color(e)},r.Light.prototype=Object.create(r.Object3D.prototype),r.Light.prototype.constructor=r.Light,r.Light.prototype.copy=function(e){return r.Object3D.prototype.copy.call(this,e),this.color.copy(e.color),this},r.AmbientLight=function(e){r.Light.call(this,e),this.type="AmbientLight"},r.AmbientLight.prototype=Object.create(r.Light.prototype),r.AmbientLight.prototype.constructor=r.AmbientLight,r.AmbientLight.prototype.toJSON=function(e){var t=r.Object3D.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t},r.DirectionalLight=function(e,t){r.Light.call(this,e),this.type="DirectionalLight",this.position.set(0,1,0),this.updateMatrix(),this.target=new r.Object3D,this.intensity=void 0!==t?t:1,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraLeft=-500,this.shadowCameraRight=500,this.shadowCameraTop=500,this.shadowCameraBottom=-500,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},r.DirectionalLight.prototype=Object.create(r.Light.prototype),r.DirectionalLight.prototype.constructor=r.DirectionalLight,r.DirectionalLight.prototype.copy=function(e){return r.Light.prototype.copy.call(this,e),this.intensity=e.intensity,this.target=e.target.clone(),this.castShadow=e.castShadow,this.onlyShadow=e.onlyShadow,this.shadowCameraNear=e.shadowCameraNear,this.shadowCameraFar=e.shadowCameraFar,this.shadowCameraLeft=e.shadowCameraLeft,this.shadowCameraRight=e.shadowCameraRight,this.shadowCameraTop=e.shadowCameraTop,this.shadowCameraBottom=e.shadowCameraBottom,this.shadowCameraVisible=e.shadowCameraVisible,this.shadowBias=e.shadowBias,this.shadowDarkness=e.shadowDarkness,this.shadowMapWidth=e.shadowMapWidth,this.shadowMapHeight=e.shadowMapHeight,this},r.DirectionalLight.prototype.toJSON=function(e){var t=r.Object3D.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t},r.HemisphereLight=function(e,t,i){r.Light.call(this,e),this.type="HemisphereLight",this.position.set(0,1,0),this.updateMatrix(),this.groundColor=new r.Color(t),this.intensity=void 0!==i?i:1},r.HemisphereLight.prototype=Object.create(r.Light.prototype),r.HemisphereLight.prototype.constructor=r.HemisphereLight,r.HemisphereLight.prototype.copy=function(e){return r.Light.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this.intensity=e.intensity,this},r.HemisphereLight.prototype.toJSON=function(e){var t=r.Object3D.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.groundColor=this.groundColor.getHex(),t.object.intensity=this.intensity,t},r.PointLight=function(e,t,i,n){r.Light.call(this,e),this.type="PointLight",this.intensity=void 0!==t?t:1,this.distance=void 0!==i?i:0,this.decay=void 0!==n?n:1},r.PointLight.prototype=Object.create(r.Light.prototype),r.PointLight.prototype.constructor=r.PointLight,r.PointLight.prototype.copy=function(e){return r.Light.prototype.copy.call(this,e),this.intensity=e.intensity,this.distance=e.distance,this.decay=e.decay,this},r.PointLight.prototype.toJSON=function(e){var t=r.Object3D.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t.object.distance=this.distance,t.object.decay=this.decay,t},r.SpotLight=function(e,t,i,n,o,s){r.Light.call(this,e),this.type="SpotLight",this.position.set(0,1,0),this.updateMatrix(),this.target=new r.Object3D,this.intensity=void 0!==t?t:1,this.distance=void 0!==i?i:0,this.angle=void 0!==n?n:Math.PI/3,this.exponent=void 0!==o?o:10,this.decay=void 0!==s?s:1,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraFov=50,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},r.SpotLight.prototype=Object.create(r.Light.prototype),r.SpotLight.prototype.constructor=r.SpotLight,r.SpotLight.prototype.copy=function(e){return r.Light.prototype.copy.call(this,e),this.intensity=e.intensity,this.distance=e.distance,this.angle=e.angle,this.exponent=e.exponent,this.decay=e.decay,this.target=e.target.clone(),this.castShadow=e.castShadow,this.onlyShadow=e.onlyShadow,this.shadowCameraNear=e.shadowCameraNear,this.shadowCameraFar=e.shadowCameraFar,this.shadowCameraFov=e.shadowCameraFov,this.shadowCameraVisible=e.shadowCameraVisible,this.shadowBias=e.shadowBias,this.shadowDarkness=e.shadowDarkness,this.shadowMapWidth=e.shadowMapWidth,this.shadowMapHeight=e.shadowMapHeight,this},r.SpotLight.prototype.toJSON=function(e){var t=r.Object3D.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t.object.distance=this.distance,t.object.angle=this.angle,t.object.exponent=this.exponent,t.object.decay=this.decay,t},r.Cache={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&(this.files[e]=t)},get:function(e){return this.enabled!==!1?this.files[e]:void 0},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},r.Loader=function(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},r.Loader.prototype={constructor:r.Loader,crossOrigin:void 0,extractUrlBase:function(e){var t=e.split("/");return 1===t.length?"./":(t.pop(),t.join("/")+"/")},initMaterials:function(e,t,i){for(var n=[],r=0;r<e.length;++r)n[r]=this.createMaterial(e[r],t,i);return n},createMaterial:function(){var e;return function(t,i,n){function o(e){var t=Math.log(e)/Math.LN2;return Math.pow(2,Math.round(t))}function s(t,s,a,h,l,c,u){var p,d=i+a,f=r.Loader.Handlers.get(d);if(null!==f?p=f.load(d):(p=new r.Texture,f=e,f.setCrossOrigin(n),f.load(d,function(e){if(r.Math.isPowerOfTwo(e.width)===!1||r.Math.isPowerOfTwo(e.height)===!1){var t=o(e.width),i=o(e.height),n=document.createElement("canvas");n.width=t,n.height=i;var s=n.getContext("2d");s.drawImage(e,0,0,t,i),p.image=n}else p.image=e;p.needsUpdate=!0})),p.sourceFile=a,h&&(p.repeat.set(h[0],h[1]),1!==h[0]&&(p.wrapS=r.RepeatWrapping),1!==h[1]&&(p.wrapT=r.RepeatWrapping)),l&&p.offset.set(l[0],l[1]),c){var m={repeat:r.RepeatWrapping,mirror:r.MirroredRepeatWrapping};void 0!==m[c[0]]&&(p.wrapS=m[c[0]]),void 0!==m[c[1]]&&(p.wrapT=m[c[1]])}u&&(p.anisotropy=u),t[s]=p}function a(e){return(255*e[0]<<16)+(255*e[1]<<8)+255*e[2]}var h=this;void 0===n&&void 0!==h.crossOrigin&&(n=h.crossOrigin),void 0===e&&(e=new r.ImageLoader);var l="MeshLambertMaterial",c={};if(t.shading){var u=t.shading.toLowerCase();"phong"===u?l="MeshPhongMaterial":"basic"===u&&(l="MeshBasicMaterial")}void 0!==t.blending&&void 0!==r[t.blending]&&(c.blending=r[t.blending]),void 0!==t.transparent&&(c.transparent=t.transparent),void 0!==t.opacity&&t.opacity<1&&(c.transparent=!0),void 0!==t.depthTest&&(c.depthTest=t.depthTest),void 0!==t.depthWrite&&(c.depthWrite=t.depthWrite),void 0!==t.visible&&(c.visible=t.visible),void 0!==t.flipSided&&(c.side=r.BackSide),void 0!==t.doubleSided&&(c.side=r.DoubleSide),void 0!==t.wireframe&&(c.wireframe=t.wireframe),void 0!==t.vertexColors&&("face"===t.vertexColors?c.vertexColors=r.FaceColors:t.vertexColors&&(c.vertexColors=r.VertexColors)),t.colorDiffuse?c.color=a(t.colorDiffuse):t.DbgColor&&(c.color=t.DbgColor),t.colorEmissive&&(c.emissive=a(t.colorEmissive)),"MeshPhongMaterial"===l&&(t.colorSpecular&&(c.specular=a(t.colorSpecular)),t.specularCoef&&(c.shininess=t.specularCoef)),void 0!==t.transparency&&(console.warn("THREE.Loader: transparency has been renamed to opacity"),t.opacity=t.transparency),void 0!==t.opacity&&(c.opacity=t.opacity),i&&(t.mapDiffuse&&s(c,"map",t.mapDiffuse,t.mapDiffuseRepeat,t.mapDiffuseOffset,t.mapDiffuseWrap,t.mapDiffuseAnisotropy),t.mapLight&&s(c,"lightMap",t.mapLight,t.mapLightRepeat,t.mapLightOffset,t.mapLightWrap,t.mapLightAnisotropy),t.mapAO&&s(c,"aoMap",t.mapAO,t.mapAORepeat,t.mapAOOffset,t.mapAOWrap,t.mapAOAnisotropy),t.mapBump&&s(c,"bumpMap",t.mapBump,t.mapBumpRepeat,t.mapBumpOffset,t.mapBumpWrap,t.mapBumpAnisotropy),t.mapNormal&&s(c,"normalMap",t.mapNormal,t.mapNormalRepeat,t.mapNormalOffset,t.mapNormalWrap,t.mapNormalAnisotropy),t.mapSpecular&&s(c,"specularMap",t.mapSpecular,t.mapSpecularRepeat,t.mapSpecularOffset,t.mapSpecularWrap,t.mapSpecularAnisotropy),t.mapAlpha&&s(c,"alphaMap",t.mapAlpha,t.mapAlphaRepeat,t.mapAlphaOffset,t.mapAlphaWrap,t.mapAlphaAnisotropy)),t.mapBumpScale&&(c.bumpScale=t.mapBumpScale),t.mapNormalFactor&&(c.normalScale=new r.Vector2(t.mapNormalFactor,t.mapNormalFactor));var p=new r[l](c);return void 0!==t.DbgName&&(p.name=t.DbgName),p}}()},r.Loader.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=0,i=this.handlers.length;i>t;t+=2){var n=this.handlers[t],r=this.handlers[t+1];if(n.test(e))return r}return null}},r.XHRLoader=function(e){this.manager=void 0!==e?e:r.DefaultLoadingManager},r.XHRLoader.prototype={constructor:r.XHRLoader,load:function(e,t,i,n){var o=this,s=r.Cache.get(e);if(void 0!==s)return t&&setTimeout(function(){t(s)},0),s;var a=new XMLHttpRequest;return a.open("GET",e,!0),a.addEventListener("load",function(i){r.Cache.add(e,this.response),t&&t(this.response),o.manager.itemEnd(e)},!1),void 0!==i&&a.addEventListener("progress",function(e){i(e)},!1),a.addEventListener("error",function(t){n&&n(t),o.manager.itemError(e)},!1),void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),void 0!==this.responseType&&(a.responseType=this.responseType),void 0!==this.withCredentials&&(a.withCredentials=this.withCredentials),a.send(null),o.manager.itemStart(e),a},setResponseType:function(e){this.responseType=e},setCrossOrigin:function(e){this.crossOrigin=e},setWithCredentials:function(e){this.withCredentials=e}},r.ImageLoader=function(e){this.manager=void 0!==e?e:r.DefaultLoadingManager},r.ImageLoader.prototype={constructor:r.ImageLoader,load:function(e,t,i,n){var o=this,s=r.Cache.get(e);if(void 0!==s)return t&&setTimeout(function(){t(s)},0),s;var a=document.createElement("img");return a.addEventListener("load",function(i){r.Cache.add(e,this),t&&t(this),o.manager.itemEnd(e)},!1),void 0!==i&&a.addEventListener("progress",function(e){i(e)},!1),a.addEventListener("error",function(t){n&&n(t),o.manager.itemError(e)},!1),void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),o.manager.itemStart(e),a.src=e,a},setCrossOrigin:function(e){this.crossOrigin=e}},r.JSONLoader=function(e){"boolean"==typeof e&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:r.DefaultLoadingManager,this.withCredentials=!1},r.JSONLoader.prototype={constructor:r.JSONLoader,get statusDomElement(){return void 0===this._statusDomElement&&(this._statusDomElement=document.createElement("div")),console.warn("THREE.JSONLoader: .statusDomElement has been removed."),this._statusDomElement},load:function(e,t,i,n){var o=this,s=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:r.Loader.prototype.extractUrlBase(e),a=new r.XHRLoader(this.manager);a.setCrossOrigin(this.crossOrigin),a.setWithCredentials(this.withCredentials),a.load(e,function(i){var n=JSON.parse(i),r=n.metadata;if(void 0!==r){if("object"===r.type)return void console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.ObjectLoader instead.");if("scene"===r.type)return void console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.SceneLoader instead.")}var a=o.parse(n,s);t(a.geometry,a.materials)})},setCrossOrigin:function(e){this.crossOrigin=e},setTexturePath:function(e){this.texturePath=e},parse:function(e,t){function i(t){function i(e,t){return e&1<<t}var n,o,a,h,l,c,u,p,d,f,m,y,g,v,b,_,x,w,S,M,T,E,k,A,C,P,L,R=e.faces,O=e.vertices,F=e.normals,D=e.colors,B=0;if(void 0!==e.uvs){for(n=0;n<e.uvs.length;n++)e.uvs[n].length&&B++;for(n=0;B>n;n++)s.faceVertexUvs[n]=[]}for(h=0,l=O.length;l>h;)w=new r.Vector3,w.x=O[h++]*t,w.y=O[h++]*t,w.z=O[h++]*t,s.vertices.push(w);for(h=0,l=R.length;l>h;)if(f=R[h++],m=i(f,0),y=i(f,1),g=i(f,3),v=i(f,4),b=i(f,5),_=i(f,6),x=i(f,7),m){if(M=new r.Face3,M.a=R[h],M.b=R[h+1],M.c=R[h+3],T=new r.Face3,T.a=R[h+1],T.b=R[h+2],T.c=R[h+3],h+=4,y&&(d=R[h++],M.materialIndex=d,T.materialIndex=d),a=s.faces.length,g)for(n=0;B>n;n++)for(A=e.uvs[n],s.faceVertexUvs[n][a]=[],s.faceVertexUvs[n][a+1]=[],o=0;4>o;o++)p=R[h++],P=A[2*p],L=A[2*p+1],C=new r.Vector2(P,L),2!==o&&s.faceVertexUvs[n][a].push(C),0!==o&&s.faceVertexUvs[n][a+1].push(C);if(v&&(u=3*R[h++],M.normal.set(F[u++],F[u++],F[u]),T.normal.copy(M.normal)),b)for(n=0;4>n;n++)u=3*R[h++],k=new r.Vector3(F[u++],F[u++],F[u]),2!==n&&M.vertexNormals.push(k),0!==n&&T.vertexNormals.push(k);if(_&&(c=R[h++],E=D[c],M.color.setHex(E),T.color.setHex(E)),x)for(n=0;4>n;n++)c=R[h++],E=D[c],2!==n&&M.vertexColors.push(new r.Color(E)),0!==n&&T.vertexColors.push(new r.Color(E));s.faces.push(M),s.faces.push(T)}else{if(S=new r.Face3,S.a=R[h++],S.b=R[h++],S.c=R[h++],y&&(d=R[h++],S.materialIndex=d),a=s.faces.length,g)for(n=0;B>n;n++)for(A=e.uvs[n],s.faceVertexUvs[n][a]=[],o=0;3>o;o++)p=R[h++],P=A[2*p],L=A[2*p+1],C=new r.Vector2(P,L),s.faceVertexUvs[n][a].push(C);if(v&&(u=3*R[h++],S.normal.set(F[u++],F[u++],F[u])),b)for(n=0;3>n;n++)u=3*R[h++],k=new r.Vector3(F[u++],F[u++],F[u]),S.vertexNormals.push(k);if(_&&(c=R[h++],S.color.setHex(D[c])),x)for(n=0;3>n;n++)c=R[h++],S.vertexColors.push(new r.Color(D[c]));s.faces.push(S)}}function n(){var t=void 0!==e.influencesPerVertex?e.influencesPerVertex:2;if(e.skinWeights)for(var i=0,n=e.skinWeights.length;n>i;i+=t){var o=e.skinWeights[i],a=t>1?e.skinWeights[i+1]:0,h=t>2?e.skinWeights[i+2]:0,l=t>3?e.skinWeights[i+3]:0;s.skinWeights.push(new r.Vector4(o,a,h,l))}if(e.skinIndices)for(var i=0,n=e.skinIndices.length;n>i;i+=t){var c=e.skinIndices[i],u=t>1?e.skinIndices[i+1]:0,p=t>2?e.skinIndices[i+2]:0,d=t>3?e.skinIndices[i+3]:0;s.skinIndices.push(new r.Vector4(c,u,p,d))}s.bones=e.bones,s.bones&&s.bones.length>0&&(s.skinWeights.length!==s.skinIndices.length||s.skinIndices.length!==s.vertices.length)&&console.warn("When skinning, number of vertices ("+s.vertices.length+"), skinIndices ("+s.skinIndices.length+"), and skinWeights ("+s.skinWeights.length+") should match."),s.animation=e.animation,s.animations=e.animations}function o(t){if(void 0!==e.morphTargets){var i,n,o,a,h,l;for(i=0,n=e.morphTargets.length;n>i;i++)for(s.morphTargets[i]={},s.morphTargets[i].name=e.morphTargets[i].name,s.morphTargets[i].vertices=[],h=s.morphTargets[i].vertices,l=e.morphTargets[i].vertices,o=0,a=l.length;a>o;o+=3){var c=new r.Vector3;c.x=l[o]*t,c.y=l[o+1]*t,c.z=l[o+2]*t,h.push(c)}}if(void 0!==e.morphColors){var i,n,u,p,d,f,m;for(i=0,n=e.morphColors.length;n>i;i++)for(s.morphColors[i]={},s.morphColors[i].name=e.morphColors[i].name,s.morphColors[i].colors=[],d=s.morphColors[i].colors,f=e.morphColors[i].colors,u=0,p=f.length;p>u;u+=3)m=new r.Color(16755200),m.setRGB(f[u],f[u+1],f[u+2]),d.push(m)}}var s=new r.Geometry,a=void 0!==e.scale?1/e.scale:1;if(i(a),n(),o(a),s.computeFaceNormals(),s.computeBoundingSphere(),void 0===e.materials||0===e.materials.length)return{geometry:s};var h=r.Loader.prototype.initMaterials(e.materials,t,this.crossOrigin);return{geometry:s,materials:h}}},r.LoadingManager=function(e,t,i){var n=this,r=!1,o=0,s=0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(e){s++,r===!1&&void 0!==n.onStart&&n.onStart(e,o,s),r=!0},this.itemEnd=function(e){o++,void 0!==n.onProgress&&n.onProgress(e,o,s),o===s&&(r=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(e){void 0!==n.onError&&n.onError(e)}},r.DefaultLoadingManager=new r.LoadingManager,r.BufferGeometryLoader=function(e){this.manager=void 0!==e?e:r.DefaultLoadingManager},r.BufferGeometryLoader.prototype={constructor:r.BufferGeometryLoader,load:function(e,t,i,n){var o=this,s=new r.XHRLoader(o.manager);s.setCrossOrigin(this.crossOrigin),s.load(e,function(e){t(o.parse(JSON.parse(e)))},i,n)},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var t=new r.BufferGeometry,i=e.data.index;if(void 0!==i){var o=new n[i.type](i.array);t.setIndex(new r.BufferAttribute(o,1))}var s=e.data.attributes;for(var a in s){var h=s[a],o=new n[h.type](h.array);t.addAttribute(a,new r.BufferAttribute(o,h.itemSize))}var l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(var c=0,u=l.length;c!==u;++c){var p=l[c];t.addGroup(p.start,p.count)}var d=e.data.boundingSphere;if(void 0!==d){var f=new r.Vector3;void 0!==d.center&&f.fromArray(d.center),t.boundingSphere=new r.Sphere(f,d.radius)}return t}},r.MaterialLoader=function(e){this.manager=void 0!==e?e:r.DefaultLoadingManager,this.textures={}},r.MaterialLoader.prototype={constructor:r.MaterialLoader,load:function(e,t,i,n){var o=this,s=new r.XHRLoader(o.manager);s.setCrossOrigin(this.crossOrigin),s.load(e,function(e){t(o.parse(JSON.parse(e)))},i,n)},setCrossOrigin:function(e){this.crossOrigin=e},setTextures:function(e){this.textures=e},getTexture:function(e){var t=this.textures;return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]},parse:function(e){var t=new r[e.type];if(t.uuid=e.uuid,void 0!==e.name&&(t.name=e.name),void 0!==e.color&&t.color.setHex(e.color),void 0!==e.emissive&&t.emissive.setHex(e.emissive),void 0!==e.specular&&t.specular.setHex(e.specular),void 0!==e.shininess&&(t.shininess=e.shininess),void 0!==e.uniforms&&(t.uniforms=e.uniforms),void 0!==e.vertexShader&&(t.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(t.fragmentShader=e.fragmentShader),void 0!==e.vertexColors&&(t.vertexColors=e.vertexColors),void 0!==e.shading&&(t.shading=e.shading),void 0!==e.blending&&(t.blending=e.blending),void 0!==e.side&&(t.side=e.side),void 0!==e.opacity&&(t.opacity=e.opacity),void 0!==e.transparent&&(t.transparent=e.transparent),void 0!==e.alphaTest&&(t.alphaTest=e.alphaTest),void 0!==e.depthTest&&(t.depthTest=e.depthTest),void 0!==e.depthWrite&&(t.depthWrite=e.depthWrite),void 0!==e.wireframe&&(t.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(t.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.size&&(t.size=e.size),void 0!==e.sizeAttenuation&&(t.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(t.map=this.getTexture(e.map)),void 0!==e.alphaMap&&(t.alphaMap=this.getTexture(e.alphaMap),t.transparent=!0),void 0!==e.bumpMap&&(t.bumpMap=this.getTexture(e.bumpMap)),void 0!==e.bumpScale&&(t.bumpScale=e.bumpScale),void 0!==e.normalMap&&(t.normalMap=this.getTexture(e.normalMap)),e.normalScale&&(t.normalScale=new r.Vector2(e.normalScale,e.normalScale)),void 0!==e.displacementMap&&(t.displacementMap=this.getTexture(e.displacementMap)),void 0!==e.displacementScale&&(t.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(t.displacementBias=e.displacementBias),void 0!==e.specularMap&&(t.specularMap=this.getTexture(e.specularMap)),void 0!==e.envMap&&(t.envMap=this.getTexture(e.envMap),t.combine=r.MultiplyOperation),e.reflectivity&&(t.reflectivity=e.reflectivity),void 0!==e.lightMap&&(t.lightMap=this.getTexture(e.lightMap)),void 0!==e.lightMapIntensity&&(t.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(t.aoMap=this.getTexture(e.aoMap)),void 0!==e.aoMapIntensity&&(t.aoMapIntensity=e.aoMapIntensity),void 0!==e.materials)for(var i=0,n=e.materials.length;n>i;i++)t.materials.push(this.parse(e.materials[i]));return t}},r.ObjectLoader=function(e){this.manager=void 0!==e?e:r.DefaultLoadingManager,this.texturePath=""},r.ObjectLoader.prototype={constructor:r.ObjectLoader,load:function(e,t,i,n){""===this.texturePath&&(this.texturePath=e.substring(0,e.lastIndexOf("/")+1));var o=this,s=new r.XHRLoader(o.manager);s.setCrossOrigin(this.crossOrigin),s.load(e,function(e){o.parse(JSON.parse(e),t)},i,n)},setTexturePath:function(e){this.texturePath=e},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,t){var i=this.parseGeometries(e.geometries),n=this.parseImages(e.images,function(){void 0!==t&&t(s)}),r=this.parseTextures(e.textures,n),o=this.parseMaterials(e.materials,r),s=this.parseObject(e.object,i,o);return(void 0===e.images||0===e.images.length)&&void 0!==t&&t(s),s},parseGeometries:function(e){var t={};if(void 0!==e)for(var i=new r.JSONLoader,n=new r.BufferGeometryLoader,o=0,s=e.length;s>o;o++){var a,h=e[o];switch(h.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new r[h.type](h.width,h.height,h.widthSegments,h.heightSegments);break;case"BoxGeometry":case"CubeGeometry":a=new r.BoxGeometry(h.width,h.height,h.depth,h.widthSegments,h.heightSegments,h.depthSegments);break;case"CircleBufferGeometry":a=new r.CircleBufferGeometry(h.radius,h.segments,h.thetaStart,h.thetaLength);break;case"CircleGeometry":a=new r.CircleGeometry(h.radius,h.segments,h.thetaStart,h.thetaLength);break;case"CylinderGeometry":a=new r.CylinderGeometry(h.radiusTop,h.radiusBottom,h.height,h.radialSegments,h.heightSegments,h.openEnded,h.thetaStart,h.thetaLength);break;case"SphereGeometry":a=new r.SphereGeometry(h.radius,h.widthSegments,h.heightSegments,h.phiStart,h.phiLength,h.thetaStart,h.thetaLength);break;case"SphereBufferGeometry":a=new r.SphereBufferGeometry(h.radius,h.widthSegments,h.heightSegments,h.phiStart,h.phiLength,h.thetaStart,h.thetaLength);break;case"DodecahedronGeometry":a=new r.DodecahedronGeometry(h.radius,h.detail);break;case"IcosahedronGeometry":a=new r.IcosahedronGeometry(h.radius,h.detail);break;case"OctahedronGeometry":a=new r.OctahedronGeometry(h.radius,h.detail);break;case"TetrahedronGeometry":a=new r.TetrahedronGeometry(h.radius,h.detail);break;case"RingGeometry":a=new r.RingGeometry(h.innerRadius,h.outerRadius,h.thetaSegments,h.phiSegments,h.thetaStart,h.thetaLength);break;case"TorusGeometry":a=new r.TorusGeometry(h.radius,h.tube,h.radialSegments,h.tubularSegments,h.arc);break;case"TorusKnotGeometry":a=new r.TorusKnotGeometry(h.radius,h.tube,h.radialSegments,h.tubularSegments,h.p,h.q,h.heightScale);break;case"TextGeometry":a=new r.TextGeometry(h.text,h.data);break;case"BufferGeometry":a=n.parse(h);break;case"Geometry":a=i.parse(h.data,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+h.type+'"');continue}a.uuid=h.uuid,void 0!==h.name&&(a.name=h.name),t[h.uuid]=a}return t},parseMaterials:function(e,t){var i={};if(void 0!==e){var n=new r.MaterialLoader;n.setTextures(t);for(var o=0,s=e.length;s>o;o++){var a=n.parse(e[o]);i[a.uuid]=a}}return i},parseImages:function(e,t){function i(e){return n.manager.itemStart(e),a.load(e,function(){n.manager.itemEnd(e)})}var n=this,o={};if(void 0!==e&&e.length>0){var s=new r.LoadingManager(t),a=new r.ImageLoader(s);a.setCrossOrigin(this.crossOrigin);for(var h=0,l=e.length;l>h;h++){var c=e[h],u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:n.texturePath+c.url;o[c.uuid]=i(u)}}return o},parseTextures:function(e,t){function i(e){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),r[e])}var n={};if(void 0!==e)for(var o=0,s=e.length;s>o;o++){var a=e[o];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===t[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);var h=new r.Texture(t[a.image]);h.needsUpdate=!0,h.uuid=a.uuid,void 0!==a.name&&(h.name=a.name),void 0!==a.mapping&&(h.mapping=i(a.mapping)),void 0!==a.offset&&(h.offset=new r.Vector2(a.offset[0],a.offset[1])),void 0!==a.repeat&&(h.repeat=new r.Vector2(a.repeat[0],a.repeat[1])),void 0!==a.minFilter&&(h.minFilter=i(a.minFilter)),void 0!==a.magFilter&&(h.magFilter=i(a.magFilter)),void 0!==a.anisotropy&&(h.anisotropy=a.anisotropy),Array.isArray(a.wrap)&&(h.wrapS=i(a.wrap[0]),h.wrapT=i(a.wrap[1])),n[a.uuid]=h}return n},parseObject:function(){var e=new r.Matrix4;return function(t,i,n){var o,s=function(e){return void 0===i[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),i[e]},a=function(e){return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]};switch(t.type){case"Scene":o=new r.Scene;break;case"PerspectiveCamera":o=new r.PerspectiveCamera(t.fov,t.aspect,t.near,t.far);break;case"OrthographicCamera":o=new r.OrthographicCamera(t.left,t.right,t.top,t.bottom,t.near,t.far);break;case"AmbientLight":o=new r.AmbientLight(t.color);break;case"DirectionalLight":o=new r.DirectionalLight(t.color,t.intensity);break;case"PointLight":o=new r.PointLight(t.color,t.intensity,t.distance,t.decay);break;case"SpotLight":o=new r.SpotLight(t.color,t.intensity,t.distance,t.angle,t.exponent,t.decay);break;case"HemisphereLight":o=new r.HemisphereLight(t.color,t.groundColor,t.intensity);break;case"Mesh":o=new r.Mesh(s(t.geometry),a(t.material));break;case"LOD":o=new r.LOD;break;case"Line":o=new r.Line(s(t.geometry),a(t.material),t.mode);break;case"PointCloud":case"Points":o=new r.Points(s(t.geometry),a(t.material));break;case"Sprite":o=new r.Sprite(a(t.material));break;case"Group":o=new r.Group;break;default:o=new r.Object3D}if(o.uuid=t.uuid,void 0!==t.name&&(o.name=t.name),void 0!==t.matrix?(e.fromArray(t.matrix),e.decompose(o.position,o.quaternion,o.scale)):(void 0!==t.position&&o.position.fromArray(t.position),void 0!==t.rotation&&o.rotation.fromArray(t.rotation),void 0!==t.scale&&o.scale.fromArray(t.scale)),void 0!==t.castShadow&&(o.castShadow=t.castShadow),void 0!==t.receiveShadow&&(o.receiveShadow=t.receiveShadow),void 0!==t.visible&&(o.visible=t.visible),void 0!==t.userData&&(o.userData=t.userData),void 0!==t.children)for(var h in t.children)o.add(this.parseObject(t.children[h],i,n));if("LOD"===t.type)for(var l=t.levels,c=0;c<l.length;c++){var u=l[c],h=o.getObjectByProperty("uuid",u.object);void 0!==h&&o.addLevel(h,u.distance)}return o}}()},r.TextureLoader=function(e){this.manager=void 0!==e?e:r.DefaultLoadingManager},r.TextureLoader.prototype={constructor:r.TextureLoader,load:function(e,t,i,n){var o=this,s=new r.ImageLoader(o.manager);s.setCrossOrigin(this.crossOrigin),s.load(e,function(e){var i=new r.Texture(e);i.needsUpdate=!0,void 0!==t&&t(i)},i,n)},setCrossOrigin:function(e){this.crossOrigin=e}},r.DataTextureLoader=r.BinaryTextureLoader=function(e){this.manager=void 0!==e?e:r.DefaultLoadingManager,this._parser=null},r.BinaryTextureLoader.prototype={constructor:r.BinaryTextureLoader,load:function(e,t,i,n){var o=this,s=new r.DataTexture,a=new r.XHRLoader(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setResponseType("arraybuffer"),a.load(e,function(e){var i=o._parser(e);i&&(void 0!==i.image?s.image=i.image:void 0!==i.data&&(s.image.width=i.width,s.image.height=i.height,s.image.data=i.data),s.wrapS=void 0!==i.wrapS?i.wrapS:r.ClampToEdgeWrapping,s.wrapT=void 0!==i.wrapT?i.wrapT:r.ClampToEdgeWrapping,s.magFilter=void 0!==i.magFilter?i.magFilter:r.LinearFilter,s.minFilter=void 0!==i.minFilter?i.minFilter:r.LinearMipMapLinearFilter,s.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,void 0!==i.format&&(s.format=i.format),void 0!==i.type&&(s.type=i.type),void 0!==i.mipmaps&&(s.mipmaps=i.mipmaps),1===i.mipmapCount&&(s.minFilter=r.LinearFilter),s.needsUpdate=!0,t&&t(s,i))},i,n),s},setCrossOrigin:function(e){this.crossOrigin=e}},r.CompressedTextureLoader=function(e){this.manager=void 0!==e?e:r.DefaultLoadingManager,this._parser=null},r.CompressedTextureLoader.prototype={constructor:r.CompressedTextureLoader,load:function(e,t,i,n){var o=this,s=[],a=new r.CompressedTexture;a.image=s;var h=new r.XHRLoader(this.manager);if(h.setCrossOrigin(this.crossOrigin),h.setResponseType("arraybuffer"),Array.isArray(e))for(var l=0,c=function(c){h.load(e[c],function(e){var i=o._parser(e,!0);s[c]={width:i.width,height:i.height,format:i.format,mipmaps:i.mipmaps},l+=1,6===l&&(1===i.mipmapCount&&(a.minFilter=r.LinearFilter),a.format=i.format,a.needsUpdate=!0,t&&t(a))},i,n)},u=0,p=e.length;p>u;++u)c(u);else h.load(e,function(e){var i=o._parser(e,!0);if(i.isCubemap)for(var n=i.mipmaps.length/i.mipmapCount,h=0;n>h;h++){s[h]={mipmaps:[]};for(var l=0;l<i.mipmapCount;l++)s[h].mipmaps.push(i.mipmaps[h*i.mipmapCount+l]),s[h].format=i.format,s[h].width=i.width,s[h].height=i.height}else a.image.width=i.width,a.image.height=i.height,a.mipmaps=i.mipmaps;1===i.mipmapCount&&(a.minFilter=r.LinearFilter),a.format=i.format,a.needsUpdate=!0,t&&t(a)},i,n);return a},setCrossOrigin:function(e){this.crossOrigin=e}},r.Material=function(){Object.defineProperty(this,"id",{value:r.MaterialIdCount++}),this.uuid=r.Math.generateUUID(),this.name="",this.type="Material",this.side=r.FrontSide,this.opacity=1,this.transparent=!1,this.blending=r.NormalBlending,this.blendSrc=r.SrcAlphaFactor,this.blendDst=r.OneMinusSrcAlphaFactor,this.blendEquation=r.AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=r.LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.overdraw=0,this.visible=!0,this._needsUpdate=!0},r.Material.prototype={constructor:r.Material,get needsUpdate(){return this._needsUpdate},set needsUpdate(e){e===!0&&this.update(),this._needsUpdate=e},setValues:function(e){if(void 0!==e)for(var t in e){var i=e[t];if(void 0!==i){var n=this[t];void 0!==n?n instanceof r.Color?n.set(i):n instanceof r.Vector3&&i instanceof r.Vector3?n.copy(i):"overdraw"===t?this[t]=Number(i):this[t]=i:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};return t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),this.color instanceof r.Color&&(t.color=this.color.getHex()),this.emissive instanceof r.Color&&(t.emissive=this.emissive.getHex()),this.specular instanceof r.Color&&(t.specular=this.specular.getHex()),void 0!==this.shininess&&(t.shininess=this.shininess),this.map instanceof r.Texture&&(t.map=this.map.toJSON(e).uuid),this.alphaMap instanceof r.Texture&&(t.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap instanceof r.Texture&&(t.lightMap=this.lightMap.toJSON(e).uuid),this.bumpMap instanceof r.Texture&&(t.bumpMap=this.bumpMap.toJSON(e).uuid,t.bumpScale=this.bumpScale),this.normalMap instanceof r.Texture&&(t.normalMap=this.normalMap.toJSON(e).uuid,
t.normalScale=this.normalScale),this.displacementMap instanceof r.Texture&&(t.displacementMap=this.displacementMap.toJSON(e).uuid,t.displacementScale=this.displacementScale,t.displacementBias=this.displacementBias),this.specularMap instanceof r.Texture&&(t.specularMap=this.specularMap.toJSON(e).uuid),this.envMap instanceof r.Texture&&(t.envMap=this.envMap.toJSON(e).uuid,t.reflectivity=this.reflectivity),void 0!==this.size&&(t.size=this.size),void 0!==this.sizeAttenuation&&(t.sizeAttenuation=this.sizeAttenuation),void 0!==this.vertexColors&&this.vertexColors!==r.NoColors&&(t.vertexColors=this.vertexColors),void 0!==this.shading&&this.shading!==r.SmoothShading&&(t.shading=this.shading),void 0!==this.blending&&this.blending!==r.NormalBlending&&(t.blending=this.blending),void 0!==this.side&&this.side!==r.FrontSide&&(t.side=this.side),this.opacity<1&&(t.opacity=this.opacity),this.transparent===!0&&(t.transparent=this.transparent),this.alphaTest>0&&(t.alphaTest=this.alphaTest),this.wireframe===!0&&(t.wireframe=this.wireframe),this.wireframeLinewidth>1&&(t.wireframeLinewidth=this.wireframeLinewidth),t},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.side=e.side,this.opacity=e.opacity,this.transparent=e.transparent,this.blending=e.blending,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.alphaTest=e.alphaTest,this.overdraw=e.overdraw,this.visible=e.visible,this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})},get wrapAround(){console.warn("THREE."+this.type+": .wrapAround has been removed.")},set wrapAround(e){console.warn("THREE."+this.type+": .wrapAround has been removed.")},get wrapRGB(){return console.warn("THREE."+this.type+": .wrapRGB has been removed."),new r.Color}},r.EventDispatcher.prototype.apply(r.Material.prototype),r.MaterialIdCount=0,r.LineBasicMaterial=function(e){r.Material.call(this),this.type="LineBasicMaterial",this.color=new r.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=r.NoColors,this.fog=!0,this.setValues(e)},r.LineBasicMaterial.prototype=Object.create(r.Material.prototype),r.LineBasicMaterial.prototype.constructor=r.LineBasicMaterial,r.LineBasicMaterial.prototype.copy=function(e){return r.Material.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.vertexColors=e.vertexColors,this.fog=e.fog,this},r.LineDashedMaterial=function(e){r.Material.call(this),this.type="LineDashedMaterial",this.color=new r.Color(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.vertexColors=!1,this.fog=!0,this.setValues(e)},r.LineDashedMaterial.prototype=Object.create(r.Material.prototype),r.LineDashedMaterial.prototype.constructor=r.LineDashedMaterial,r.LineDashedMaterial.prototype.copy=function(e){return r.Material.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this.vertexColors=e.vertexColors,this.fog=e.fog,this},r.MeshBasicMaterial=function(e){r.Material.call(this),this.type="MeshBasicMaterial",this.color=new r.Color(16777215),this.map=null,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=r.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=r.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=r.NoColors,this.skinning=!1,this.morphTargets=!1,this.setValues(e)},r.MeshBasicMaterial.prototype=Object.create(r.Material.prototype),r.MeshBasicMaterial.prototype.constructor=r.MeshBasicMaterial,r.MeshBasicMaterial.prototype.copy=function(e){return r.Material.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.fog=e.fog,this.shading=e.shading,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.vertexColors=e.vertexColors,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},r.MeshLambertMaterial=function(e){r.Material.call(this),this.type="MeshLambertMaterial",this.color=new r.Color(16777215),this.emissive=new r.Color(0),this.map=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=r.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=r.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)},r.MeshLambertMaterial.prototype=Object.create(r.Material.prototype),r.MeshLambertMaterial.prototype.constructor=r.MeshLambertMaterial,r.MeshLambertMaterial.prototype.copy=function(e){return r.Material.prototype.copy.call(this,e),this.color.copy(e.color),this.emissive.copy(e.emissive),this.map=e.map,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.fog=e.fog,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.vertexColors=e.vertexColors,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},r.MeshPhongMaterial=function(e){r.Material.call(this),this.type="MeshPhongMaterial",this.color=new r.Color(16777215),this.emissive=new r.Color(0),this.specular=new r.Color(1118481),this.shininess=30,this.metal=!1,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new r.Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=r.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=r.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=r.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)},r.MeshPhongMaterial.prototype=Object.create(r.Material.prototype),r.MeshPhongMaterial.prototype.constructor=r.MeshPhongMaterial,r.MeshPhongMaterial.prototype.copy=function(e){return r.Material.prototype.copy.call(this,e),this.color.copy(e.color),this.emissive.copy(e.emissive),this.specular.copy(e.specular),this.shininess=e.shininess,this.metal=e.metal,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissiveMap=e.emissiveMap,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.fog=e.fog,this.shading=e.shading,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.vertexColors=e.vertexColors,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},r.MeshDepthMaterial=function(e){r.Material.call(this),this.type="MeshDepthMaterial",this.morphTargets=!1,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)},r.MeshDepthMaterial.prototype=Object.create(r.Material.prototype),r.MeshDepthMaterial.prototype.constructor=r.MeshDepthMaterial,r.MeshDepthMaterial.prototype.copy=function(e){return r.Material.prototype.copy.call(this,e),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},r.MeshNormalMaterial=function(e){r.Material.call(this,e),this.type="MeshNormalMaterial",this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(e)},r.MeshNormalMaterial.prototype=Object.create(r.Material.prototype),r.MeshNormalMaterial.prototype.constructor=r.MeshNormalMaterial,r.MeshNormalMaterial.prototype.copy=function(e){return r.Material.prototype.copy.call(this,e),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},r.MultiMaterial=function(e){this.uuid=r.Math.generateUUID(),this.type="MultiMaterial",this.materials=e instanceof Array?e:[],this.visible=!0},r.MultiMaterial.prototype={constructor:r.MultiMaterial,toJSON:function(){for(var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},t=0,i=this.materials.length;i>t;t++)e.materials.push(this.materials[t].toJSON());return e.visible=this.visible,e},clone:function(){for(var e=new this.constructor,t=0;t<this.materials.length;t++)e.materials.push(this.materials[t].clone());return e.visible=this.visible,e}},r.MeshFaceMaterial=r.MultiMaterial,r.PointsMaterial=function(e){r.Material.call(this),this.type="PointsMaterial",this.color=new r.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.vertexColors=r.NoColors,this.fog=!0,this.setValues(e)},r.PointsMaterial.prototype=Object.create(r.Material.prototype),r.PointsMaterial.prototype.constructor=r.PointsMaterial,r.PointsMaterial.prototype.copy=function(e){return r.Material.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.vertexColors=e.vertexColors,this.fog=e.fog,this},r.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new r.PointsMaterial(e)},r.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new r.PointsMaterial(e)},r.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new r.PointsMaterial(e)},r.ShaderMaterial=function(e){r.Material.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.shading=r.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.vertexColors=r.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.derivatives=!1,this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))},r.ShaderMaterial.prototype=Object.create(r.Material.prototype),r.ShaderMaterial.prototype.constructor=r.ShaderMaterial,r.ShaderMaterial.prototype.copy=function(e){return r.Material.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=r.UniformsUtils.clone(e.uniforms),this.attributes=e.attributes,this.defines=e.defines,this.shading=e.shading,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.vertexColors=e.vertexColors,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.derivatives=e.derivatives,this},r.ShaderMaterial.prototype.toJSON=function(e){var t=r.Material.prototype.toJSON.call(this,e);return t.uniforms=this.uniforms,t.attributes=this.attributes,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t},r.RawShaderMaterial=function(e){r.ShaderMaterial.call(this,e),this.type="RawShaderMaterial"},r.RawShaderMaterial.prototype=Object.create(r.ShaderMaterial.prototype),r.RawShaderMaterial.prototype.constructor=r.RawShaderMaterial,r.SpriteMaterial=function(e){r.Material.call(this),this.type="SpriteMaterial",this.color=new r.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.setValues(e)},r.SpriteMaterial.prototype=Object.create(r.Material.prototype),r.SpriteMaterial.prototype.constructor=r.SpriteMaterial,r.SpriteMaterial.prototype.copy=function(e){return r.Material.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this.fog=e.fog,this},r.Texture=function(e,t,i,n,o,s,a,h,l){Object.defineProperty(this,"id",{value:r.TextureIdCount++}),this.uuid=r.Math.generateUUID(),this.name="",this.sourceFile="",this.image=void 0!==e?e:r.Texture.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:r.Texture.DEFAULT_MAPPING,this.wrapS=void 0!==i?i:r.ClampToEdgeWrapping,this.wrapT=void 0!==n?n:r.ClampToEdgeWrapping,this.magFilter=void 0!==o?o:r.LinearFilter,this.minFilter=void 0!==s?s:r.LinearMipMapLinearFilter,this.anisotropy=void 0!==l?l:1,this.format=void 0!==a?a:r.RGBAFormat,this.type=void 0!==h?h:r.UnsignedByteType,this.offset=new r.Vector2(0,0),this.repeat=new r.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.version=0,this.onUpdate=null},r.Texture.DEFAULT_IMAGE=void 0,r.Texture.DEFAULT_MAPPING=r.UVMapping,r.Texture.prototype={constructor:r.Texture,set needsUpdate(e){e===!0&&this.version++},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this},toJSON:function(e){function t(e){var t;return void 0!==e.toDataURL?t=e:(t=document.createElement("canvas"),t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0,e.width,e.height)),t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}if(void 0!==e.textures[this.uuid])return e.textures[this.uuid];var i={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy};if(void 0!==this.image){var n=this.image;void 0===n.uuid&&(n.uuid=r.Math.generateUUID()),void 0===e.images[n.uuid]&&(e.images[n.uuid]={uuid:n.uuid,url:t(n)}),i.image=n.uuid}return e.textures[this.uuid]=i,i},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping===r.UVMapping){if(e.multiply(this.repeat),e.add(this.offset),e.x<0||e.x>1)switch(this.wrapS){case r.RepeatWrapping:e.x=e.x-Math.floor(e.x);break;case r.ClampToEdgeWrapping:e.x=e.x<0?0:1;break;case r.MirroredRepeatWrapping:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case r.RepeatWrapping:e.y=e.y-Math.floor(e.y);break;case r.ClampToEdgeWrapping:e.y=e.y<0?0:1;break;case r.MirroredRepeatWrapping:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}this.flipY&&(e.y=1-e.y)}}},r.EventDispatcher.prototype.apply(r.Texture.prototype),r.TextureIdCount=0,r.CanvasTexture=function(e,t,i,n,o,s,a,h,l){r.Texture.call(this,e,t,i,n,o,s,a,h,l),this.needsUpdate=!0},r.CanvasTexture.prototype=Object.create(r.Texture.prototype),r.CanvasTexture.prototype.constructor=r.CanvasTexture,r.CubeTexture=function(e,t,i,n,o,s,a,h,l){t=void 0!==t?t:r.CubeReflectionMapping,r.Texture.call(this,e,t,i,n,o,s,a,h,l),this.images=e,this.flipY=!1},r.CubeTexture.prototype=Object.create(r.Texture.prototype),r.CubeTexture.prototype.constructor=r.CubeTexture,r.CubeTexture.prototype.copy=function(e){return r.Texture.prototype.copy.call(this,e),this.images=e.images,this},r.CompressedTexture=function(e,t,i,n,o,s,a,h,l,c,u){r.Texture.call(this,null,s,a,h,l,c,n,o,u),this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1},r.CompressedTexture.prototype=Object.create(r.Texture.prototype),r.CompressedTexture.prototype.constructor=r.CompressedTexture,r.DataTexture=function(e,t,i,n,o,s,a,h,l,c,u){r.Texture.call(this,null,s,a,h,l,c,n,o,u),this.image={data:e,width:t,height:i},this.magFilter=void 0!==l?l:r.NearestFilter,this.minFilter=void 0!==c?c:r.NearestFilter,this.flipY=!1,this.generateMipmaps=!1},r.DataTexture.prototype=Object.create(r.Texture.prototype),r.DataTexture.prototype.constructor=r.DataTexture,r.VideoTexture=function(e,t,i,n,o,s,a,h,l){r.Texture.call(this,e,t,i,n,o,s,a,h,l),this.generateMipmaps=!1;var c=this,u=function(){requestAnimationFrame(u),e.readyState===e.HAVE_ENOUGH_DATA&&(c.needsUpdate=!0)};u()},r.VideoTexture.prototype=Object.create(r.Texture.prototype),r.VideoTexture.prototype.constructor=r.VideoTexture,r.Group=function(){r.Object3D.call(this),this.type="Group"},r.Group.prototype=Object.create(r.Object3D.prototype),r.Group.prototype.constructor=r.Group,r.Points=function(e,t){r.Object3D.call(this),this.type="Points",this.geometry=void 0!==e?e:new r.Geometry,this.material=void 0!==t?t:new r.PointsMaterial({color:16777215*Math.random()})},r.Points.prototype=Object.create(r.Object3D.prototype),r.Points.prototype.constructor=r.Points,r.Points.prototype.raycast=function(){var e=new r.Matrix4,t=new r.Ray;return function(i,n){function o(e,r){var o=t.distanceSqToPoint(e);if(c>o){var a=t.closestPointToPoint(e);a.applyMatrix4(s.matrixWorld);var h=i.ray.origin.distanceTo(a);if(h<i.near||h>i.far)return;n.push({distance:h,distanceToRay:Math.sqrt(o),point:a.clone(),index:r,face:null,object:s})}}var s=this,a=s.geometry,h=i.params.Points.threshold;if(e.getInverse(this.matrixWorld),t.copy(i.ray).applyMatrix4(e),null===a.boundingBox||t.isIntersectionBox(a.boundingBox)!==!1){var l=h/((this.scale.x+this.scale.y+this.scale.z)/3),c=l*l,u=new r.Vector3;if(a instanceof r.BufferGeometry){var p=a.index,d=a.attributes,f=d.position.array;if(null!==p)for(var m=p.array,y=0,g=m.length;g>y;y++){var v=m[y];u.fromArray(f,3*v),o(u,v)}else for(var y=0,b=f.length/3;b>y;y++)u.fromArray(f,3*y),o(u,y)}else for(var _=a.vertices,y=0,b=_.length;b>y;y++)o(_[y],y)}}}(),r.Points.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},r.Points.prototype.toJSON=function(e){var t=r.Object3D.prototype.toJSON.call(this,e);return void 0===e.geometries[this.geometry.uuid]&&(e.geometries[this.geometry.uuid]=this.geometry.toJSON()),void 0===e.materials[this.material.uuid]&&(e.materials[this.material.uuid]=this.material.toJSON()),t.object.geometry=this.geometry.uuid,t.object.material=this.material.uuid,t},r.PointCloud=function(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new r.Points(e,t)},r.ParticleSystem=function(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new r.Points(e,t)},r.Line=function(e,t,i){return 1===i?(console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new r.LineSegments(e,t)):(r.Object3D.call(this),this.type="Line",this.geometry=void 0!==e?e:new r.Geometry,void(this.material=void 0!==t?t:new r.LineBasicMaterial({color:16777215*Math.random()})))},r.Line.prototype=Object.create(r.Object3D.prototype),r.Line.prototype.constructor=r.Line,r.Line.prototype.raycast=function(){var e=new r.Matrix4,t=new r.Ray,i=new r.Sphere;return function(n,o){var s=n.linePrecision,a=s*s,h=this.geometry;if(null===h.boundingSphere&&h.computeBoundingSphere(),i.copy(h.boundingSphere),i.applyMatrix4(this.matrixWorld),n.ray.isIntersectionSphere(i)!==!1){e.getInverse(this.matrixWorld),t.copy(n.ray).applyMatrix4(e);var l=new r.Vector3,c=new r.Vector3,u=new r.Vector3,p=new r.Vector3,d=this instanceof r.LineSegments?2:1;if(h instanceof r.BufferGeometry){var f=h.index,m=h.attributes;if(null!==f)for(var y=f.array,g=m.position.array,v=0,b=y.length-1;b>v;v+=d){var _=y[v],x=y[v+1];l.fromArray(g,3*_),c.fromArray(g,3*x);var w=t.distanceSqToSegment(l,c,p,u);if(!(w>a)){p.applyMatrix4(this.matrixWorld);var S=n.ray.origin.distanceTo(p);S<n.near||S>n.far||o.push({distance:S,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else for(var g=m.position.array,v=0,b=g.length/3-1;b>v;v+=d){l.fromArray(g,3*v),c.fromArray(g,3*v+3);var w=t.distanceSqToSegment(l,c,p,u);if(!(w>a)){p.applyMatrix4(this.matrixWorld);var S=n.ray.origin.distanceTo(p);S<n.near||S>n.far||o.push({distance:S,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}else if(h instanceof r.Geometry)for(var M=h.vertices,T=M.length,v=0;T-1>v;v+=d){var w=t.distanceSqToSegment(M[v],M[v+1],p,u);if(!(w>a)){p.applyMatrix4(this.matrixWorld);var S=n.ray.origin.distanceTo(p);S<n.near||S>n.far||o.push({distance:S,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}}}(),r.Line.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},r.Line.prototype.toJSON=function(e){var t=r.Object3D.prototype.toJSON.call(this,e);return void 0===e.geometries[this.geometry.uuid]&&(e.geometries[this.geometry.uuid]=this.geometry.toJSON()),void 0===e.materials[this.material.uuid]&&(e.materials[this.material.uuid]=this.material.toJSON()),t.object.geometry=this.geometry.uuid,t.object.material=this.material.uuid,t},r.LineStrip=0,r.LinePieces=1,r.LineSegments=function(e,t){r.Line.call(this,e,t),this.type="LineSegments"},r.LineSegments.prototype=Object.create(r.Line.prototype),r.LineSegments.prototype.constructor=r.LineSegments,r.Mesh=function(e,t){r.Object3D.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new r.Geometry,this.material=void 0!==t?t:new r.MeshBasicMaterial({color:16777215*Math.random()}),this.updateMorphTargets()},r.Mesh.prototype=Object.create(r.Object3D.prototype),r.Mesh.prototype.constructor=r.Mesh,r.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&this.geometry.morphTargets.length>0){this.morphTargetBase=-1,this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var e=0,t=this.geometry.morphTargets.length;t>e;e++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[e].name]=e}},r.Mesh.prototype.getMorphTargetIndexByName=function(e){return void 0!==this.morphTargetDictionary[e]?this.morphTargetDictionary[e]:(console.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+e+" does not exist. Returning 0."),0)},r.Mesh.prototype.raycast=function(){function e(e,t,i,n,o,s,a){return r.Triangle.barycoordFromPoint(e,t,i,n,f),o.multiplyScalar(f.x),s.multiplyScalar(f.y),a.multiplyScalar(f.z),o.add(s).add(a),o.clone()}var t=new r.Matrix4,i=new r.Ray,n=new r.Sphere,o=new r.Vector3,s=new r.Vector3,a=new r.Vector3,h=new r.Vector3,l=new r.Vector3,c=new r.Vector3,u=new r.Vector2,p=new r.Vector2,d=new r.Vector2,f=new r.Vector3,m=new r.Vector3,y=new r.Vector3;return function(f,g){var v=this.geometry,b=this.material;if(void 0!==b&&(null===v.boundingSphere&&v.computeBoundingSphere(),n.copy(v.boundingSphere),n.applyMatrix4(this.matrixWorld),f.ray.isIntersectionSphere(n)!==!1&&(t.getInverse(this.matrixWorld),i.copy(f.ray).applyMatrix4(t),null===v.boundingBox||i.isIntersectionBox(v.boundingBox)!==!1))){var _,x,w;if(v instanceof r.BufferGeometry){var S=v.index,M=v.attributes;if(null!==S)for(var T=S.array,E=M.position.array,k=0,A=T.length;A>k;k+=3){if(_=T[k],x=T[k+1],w=T[k+2],o.fromArray(E,3*_),s.fromArray(E,3*x),a.fromArray(E,3*w),b.side===r.BackSide){if(null===i.intersectTriangle(a,s,o,!0,m))continue}else if(null===i.intersectTriangle(o,s,a,b.side!==r.DoubleSide,m))continue;y.copy(m),y.applyMatrix4(this.matrixWorld);var C=f.ray.origin.distanceTo(y);if(!(C<f.near||C>f.far)){var P;if(void 0!==M.uv){var L=M.uv.array;u.fromArray(L,2*_),p.fromArray(L,2*x),d.fromArray(L,2*w),P=e(m,o,s,a,u,p,d)}g.push({distance:C,point:y.clone(),uv:P,face:new r.Face3(_,x,w,r.Triangle.normal(o,s,a)),faceIndex:Math.floor(k/3),object:this})}}else for(var E=M.position.array,k=0,A=E.length;A>k;k+=9){if(o.fromArray(E,k),s.fromArray(E,k+3),a.fromArray(E,k+6),b.side===r.BackSide){if(null===i.intersectTriangle(a,s,o,!0,m))continue}else if(null===i.intersectTriangle(o,s,a,b.side!==r.DoubleSide,m))continue;y.copy(m),y.applyMatrix4(this.matrixWorld);var C=f.ray.origin.distanceTo(y);if(!(C<f.near||C>f.far)){var P;if(void 0!==M.uv){var L=M.uv.array;u.fromArray(L,k),p.fromArray(L,k+2),d.fromArray(L,k+4),P=e(m,o,s,a,u,p,d)}_=k/3,x=_+1,w=_+2,g.push({distance:C,point:y.clone(),uv:P,face:new r.Face3(_,x,w,r.Triangle.normal(o,s,a)),index:_,object:this})}}}else if(v instanceof r.Geometry)for(var R=b instanceof r.MeshFaceMaterial,O=R===!0?b.materials:null,F=v.vertices,D=v.faces,B=0,N=D.length;N>B;B++){var j=D[B],V=R===!0?O[j.materialIndex]:b;if(void 0!==V){if(_=F[j.a],x=F[j.b],w=F[j.c],V.morphTargets===!0){var z=v.morphTargets,U=this.morphTargetInfluences;o.set(0,0,0),s.set(0,0,0),a.set(0,0,0);for(var I=0,G=z.length;G>I;I++){var q=U[I];if(0!==q){var H=z[I].vertices;o.addScaledVector(h.subVectors(H[j.a],_),q),s.addScaledVector(l.subVectors(H[j.b],x),q),a.addScaledVector(c.subVectors(H[j.c],w),q)}}o.add(_),s.add(x),a.add(w),_=o,x=s,w=a}if(V.side===r.BackSide){if(null===i.intersectTriangle(w,x,_,!0,m))continue}else if(null===i.intersectTriangle(_,x,w,V.side!==r.DoubleSide,m))continue;y.copy(m),y.applyMatrix4(this.matrixWorld);var C=f.ray.origin.distanceTo(y);if(!(C<f.near||C>f.far)){var P;if(v.faceVertexUvs[0].length>0){var L=v.faceVertexUvs[0][B];u.copy(L[0]),p.copy(L[1]),d.copy(L[2]),P=e(m,_,x,w,u,p,d)}g.push({distance:C,point:y.clone(),uv:P,face:j,faceIndex:B,object:this})}}}}}}(),r.Mesh.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},r.Mesh.prototype.toJSON=function(e){var t=r.Object3D.prototype.toJSON.call(this,e);return void 0===e.geometries[this.geometry.uuid]&&(e.geometries[this.geometry.uuid]=this.geometry.toJSON(e)),void 0===e.materials[this.material.uuid]&&(e.materials[this.material.uuid]=this.material.toJSON(e)),t.object.geometry=this.geometry.uuid,t.object.material=this.material.uuid,t},r.Bone=function(e){r.Object3D.call(this),this.type="Bone",this.skin=e},r.Bone.prototype=Object.create(r.Object3D.prototype),r.Bone.prototype.constructor=r.Bone,r.Bone.prototype.copy=function(e){return r.Object3D.prototype.copy.call(this,e),this.skin=e.skin,this},r.Skeleton=function(e,t,i){if(this.useVertexTexture=void 0!==i?i:!0,this.identityMatrix=new r.Matrix4,e=e||[],this.bones=e.slice(0),this.useVertexTexture){var n=Math.sqrt(4*this.bones.length);n=r.Math.nextPowerOfTwo(Math.ceil(n)),n=Math.max(n,4),this.boneTextureWidth=n,this.boneTextureHeight=n,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new r.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,r.RGBAFormat,r.FloatType)}else this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[];for(var o=0,s=this.bones.length;s>o;o++)this.boneInverses.push(new r.Matrix4)}},r.Skeleton.prototype.calculateInverses=function(){this.boneInverses=[];for(var e=0,t=this.bones.length;t>e;e++){var i=new r.Matrix4;this.bones[e]&&i.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(i)}},r.Skeleton.prototype.pose=function(){for(var e,t=0,i=this.bones.length;i>t;t++)e=this.bones[t],e&&e.matrixWorld.getInverse(this.boneInverses[t]);for(var t=0,i=this.bones.length;i>t;t++)e=this.bones[t],e&&(e.parent?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},r.Skeleton.prototype.update=function(){var e=new r.Matrix4;return function(){for(var t=0,i=this.bones.length;i>t;t++){var n=this.bones[t]?this.bones[t].matrixWorld:this.identityMatrix;e.multiplyMatrices(n,this.boneInverses[t]),e.flattenToArrayOffset(this.boneMatrices,16*t)}this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),r.Skeleton.prototype.clone=function(){return new r.Skeleton(this.bones,this.boneInverses,this.useVertexTexture)},r.SkinnedMesh=function(e,t,i){r.Mesh.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new r.Matrix4,this.bindMatrixInverse=new r.Matrix4;var n=[];if(this.geometry&&void 0!==this.geometry.bones){for(var o,s,a=0,h=this.geometry.bones.length;h>a;++a)s=this.geometry.bones[a],o=new r.Bone(this),n.push(o),o.name=s.name,o.position.fromArray(s.pos),o.quaternion.fromArray(s.rotq),void 0!==s.scl&&o.scale.fromArray(s.scl);for(var a=0,h=this.geometry.bones.length;h>a;++a)s=this.geometry.bones[a],-1!==s.parent?n[s.parent].add(n[a]):this.add(n[a])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new r.Skeleton(n,void 0,i),this.matrixWorld)},r.SkinnedMesh.prototype=Object.create(r.Mesh.prototype),r.SkinnedMesh.prototype.constructor=r.SkinnedMesh,r.SkinnedMesh.prototype.bind=function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},r.SkinnedMesh.prototype.pose=function(){this.skeleton.pose()},r.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof r.Geometry)for(var e=0;e<this.geometry.skinIndices.length;e++){var t=this.geometry.skinWeights[e],i=1/t.lengthManhattan();i!==1/0?t.multiplyScalar(i):t.set(1)}},r.SkinnedMesh.prototype.updateMatrixWorld=function(e){r.Mesh.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unrecognized bindMode: "+this.bindMode)},r.SkinnedMesh.prototype.clone=function(){return new this.constructor(this.geometry,this.material,this.useVertexTexture).copy(this)},r.MorphAnimMesh=function(e,t){r.Mesh.call(this,e,t),this.type="MorphAnimMesh",this.duration=1e3,this.mirroredLoop=!1,this.time=0,this.lastKeyframe=0,this.currentKeyframe=0,this.direction=1,this.directionBackwards=!1,this.setFrameRange(0,e.morphTargets.length-1)},r.MorphAnimMesh.prototype=Object.create(r.Mesh.prototype),r.MorphAnimMesh.prototype.constructor=r.MorphAnimMesh,r.MorphAnimMesh.prototype.setFrameRange=function(e,t){this.startKeyframe=e,this.endKeyframe=t,this.length=this.endKeyframe-this.startKeyframe+1},r.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1,this.directionBackwards=!1},r.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1,this.directionBackwards=!0},r.MorphAnimMesh.prototype.parseAnimations=function(){var e=this.geometry;e.animations||(e.animations={});for(var t,i=e.animations,n=/([a-z]+)_?(\d+)/,r=0,o=e.morphTargets.length;o>r;r++){
var s=e.morphTargets[r],a=s.name.match(n);if(a&&a.length>1){var h=a[1];i[h]||(i[h]={start:1/0,end:-(1/0)});var l=i[h];r<l.start&&(l.start=r),r>l.end&&(l.end=r),t||(t=h)}}e.firstAnimation=t},r.MorphAnimMesh.prototype.setAnimationLabel=function(e,t,i){this.geometry.animations||(this.geometry.animations={}),this.geometry.animations[e]={start:t,end:i}},r.MorphAnimMesh.prototype.playAnimation=function(e,t){var i=this.geometry.animations[e];i?(this.setFrameRange(i.start,i.end),this.duration=1e3*((i.end-i.start)/t),this.time=0):console.warn("THREE.MorphAnimMesh: animation["+e+"] undefined in .playAnimation()")},r.MorphAnimMesh.prototype.updateAnimation=function(e){var t=this.duration/this.length;this.time+=this.direction*e,this.mirroredLoop?(this.time>this.duration||this.time<0)&&(this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),this.time<0&&(this.time=0,this.directionBackwards=!1)):(this.time=this.time%this.duration,this.time<0&&(this.time+=this.duration));var i=this.startKeyframe+r.Math.clamp(Math.floor(this.time/t),0,this.length-1),n=this.morphTargetInfluences;i!==this.currentKeyframe&&(n[this.lastKeyframe]=0,n[this.currentKeyframe]=1,n[i]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=i);var o=this.time%t/t;this.directionBackwards&&(o=1-o),n[this.currentKeyframe]=o,n[this.lastKeyframe]=1-o},r.MorphAnimMesh.prototype.interpolateTargets=function(e,t,i){for(var n=this.morphTargetInfluences,r=0,o=n.length;o>r;r++)n[r]=0;e>-1&&(n[e]=1-i),t>-1&&(n[t]=i)},r.MorphAnimMesh.prototype.copy=function(e){return r.Mesh.prototype.copy.call(this,e),this.duration=e.duration,this.mirroredLoop=e.mirroredLoop,this.time=e.time,this.lastKeyframe=e.lastKeyframe,this.currentKeyframe=e.currentKeyframe,this.direction=e.direction,this.directionBackwards=e.directionBackwards,this},r.LOD=function(){r.Object3D.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}})},r.LOD.prototype=Object.create(r.Object3D.prototype),r.LOD.prototype.constructor=r.LOD,r.LOD.prototype.addLevel=function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var i=this.levels,n=0;n<i.length&&!(t<i[n].distance);n++);i.splice(n,0,{distance:t,object:e}),this.add(e)},r.LOD.prototype.getObjectForDistance=function(e){for(var t=this.levels,i=1,n=t.length;n>i&&!(e<t[i].distance);i++);return t[i-1].object},r.LOD.prototype.raycast=function(){var e=new r.Vector3;return function(t,i){e.setFromMatrixPosition(this.matrixWorld);var n=t.ray.origin.distanceTo(e);this.getObjectForDistance(n).raycast(t,i)}}(),r.LOD.prototype.update=function(){var e=new r.Vector3,t=new r.Vector3;return function(i){var n=this.levels;if(n.length>1){e.setFromMatrixPosition(i.matrixWorld),t.setFromMatrixPosition(this.matrixWorld);var r=e.distanceTo(t);n[0].object.visible=!0;for(var o=1,s=n.length;s>o&&r>=n[o].distance;o++)n[o-1].object.visible=!1,n[o].object.visible=!0;for(;s>o;o++)n[o].object.visible=!1}}}(),r.LOD.prototype.copy=function(e){r.Object3D.prototype.copy.call(this,e,!1);for(var t=e.levels,i=0,n=t.length;n>i;i++){var o=t[i];this.addLevel(o.object.clone(),o.distance)}return this},r.LOD.prototype.toJSON=function(e){var t=r.Object3D.prototype.toJSON.call(this,e);t.object.levels=[];for(var i=this.levels,n=0,o=i.length;o>n;n++){var s=i[n];t.object.levels.push({object:s.object.uuid,distance:s.distance})}return t},r.Sprite=function(){var e=new Uint16Array([0,1,2,0,2,3]),t=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),i=new Float32Array([0,0,1,0,1,1,0,1]),n=new r.BufferGeometry;return n.setIndex(new r.BufferAttribute(e,1)),n.addAttribute("position",new r.BufferAttribute(t,3)),n.addAttribute("uv",new r.BufferAttribute(i,2)),function(e){r.Object3D.call(this),this.type="Sprite",this.geometry=n,this.material=void 0!==e?e:new r.SpriteMaterial}}(),r.Sprite.prototype=Object.create(r.Object3D.prototype),r.Sprite.prototype.constructor=r.Sprite,r.Sprite.prototype.raycast=function(){var e=new r.Vector3;return function(t,i){e.setFromMatrixPosition(this.matrixWorld);var n=t.ray.distanceSqToPoint(e),r=this.scale.x*this.scale.y;n>r||i.push({distance:Math.sqrt(n),point:this.position,face:null,object:this})}}(),r.Sprite.prototype.clone=function(){return new this.constructor(this.material).copy(this)},r.Sprite.prototype.toJSON=function(e){var t=r.Object3D.prototype.toJSON.call(this,e);return void 0===e.materials[this.material.uuid]&&(e.materials[this.material.uuid]=this.material.toJSON()),t.object.material=this.material.uuid,t},r.Particle=r.Sprite,r.LensFlare=function(e,t,i,n,o){r.Object3D.call(this),this.lensFlares=[],this.positionScreen=new r.Vector3,this.customUpdateCallback=void 0,void 0!==e&&this.add(e,t,i,n,o)},r.LensFlare.prototype=Object.create(r.Object3D.prototype),r.LensFlare.prototype.constructor=r.LensFlare,r.LensFlare.prototype.add=function(e,t,i,n,o,s){void 0===t&&(t=-1),void 0===i&&(i=0),void 0===s&&(s=1),void 0===o&&(o=new r.Color(16777215)),void 0===n&&(n=r.NormalBlending),i=Math.min(i,Math.max(0,i)),this.lensFlares.push({texture:e,size:t,distance:i,x:0,y:0,z:0,scale:1,rotation:0,opacity:s,color:o,blending:n})},r.LensFlare.prototype.updateLensFlares=function(){var e,t,i=this.lensFlares.length,n=2*-this.positionScreen.x,r=2*-this.positionScreen.y;for(e=0;i>e;e++)t=this.lensFlares[e],t.x=this.positionScreen.x+n*t.distance,t.y=this.positionScreen.y+r*t.distance,t.wantedRotation=t.x*Math.PI*.25,t.rotation+=.25*(t.wantedRotation-t.rotation)},r.LensFlare.prototype.copy=function(e){r.Object3D.prototype.copy.call(this,e),this.positionScreen.copy(e.positionScreen),this.customUpdateCallback=e.customUpdateCallback;for(var t=0,i=e.lensFlares.length;i>t;t++)this.lensFlares.push(e.lensFlares[t]);return this},r.Scene=function(){r.Object3D.call(this),this.type="Scene",this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0},r.Scene.prototype=Object.create(r.Object3D.prototype),r.Scene.prototype.constructor=r.Scene,r.Scene.prototype.copy=function(e){return r.Object3D.prototype.copy.call(this,e),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},r.Fog=function(e,t,i){this.name="",this.color=new r.Color(e),this.near=void 0!==t?t:1,this.far=void 0!==i?i:1e3},r.Fog.prototype.clone=function(){return new r.Fog(this.color.getHex(),this.near,this.far)},r.FogExp2=function(e,t){this.name="",this.color=new r.Color(e),this.density=void 0!==t?t:25e-5},r.FogExp2.prototype.clone=function(){return new r.FogExp2(this.color.getHex(),this.density)},r.ShaderChunk={},r.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\n\n	diffuseColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n",r.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\n	uniform sampler2D alphaMap;\n\n#endif\n",r.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\n\n	if ( diffuseColor.a < ALPHATEST ) discard;\n\n#endif\n",r.ShaderChunk.aomap_fragment="#ifdef USE_AOMAP\n\n	totalAmbientLight *= ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\n#endif\n",r.ShaderChunk.aomap_pars_fragment="#ifdef USE_AOMAP\n\n	uniform sampler2D aoMap;\n	uniform float aoMapIntensity;\n\n#endif",r.ShaderChunk.begin_vertex="\nvec3 transformed = vec3( position );\n",r.ShaderChunk.beginnormal_vertex="\nvec3 objectNormal = vec3( normal );\n",r.ShaderChunk.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n\n	uniform sampler2D bumpMap;\n	uniform float bumpScale;\n\n	// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\n	// http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\n\n	// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n	vec2 dHdxy_fwd() {\n\n		vec2 dSTdx = dFdx( vUv );\n		vec2 dSTdy = dFdy( vUv );\n\n		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n		return vec2( dBx, dBy );\n\n	}\n\n	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n		vec3 vSigmaX = dFdx( surf_pos );\n		vec3 vSigmaY = dFdy( surf_pos );\n		vec3 vN = surf_norm;		// normalized\n\n		vec3 R1 = cross( vSigmaY, vN );\n		vec3 R2 = cross( vN, vSigmaX );\n\n		float fDet = dot( vSigmaX, R1 );\n\n		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n		return normalize( abs( fDet ) * surf_norm - vGrad );\n\n	}\n\n#endif\n",r.ShaderChunk.color_fragment="#ifdef USE_COLOR\n\n	diffuseColor.rgb *= vColor;\n\n#endif",r.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\n\n	varying vec3 vColor;\n\n#endif\n",r.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\n\n	varying vec3 vColor;\n\n#endif",r.ShaderChunk.color_vertex="#ifdef USE_COLOR\n\n	vColor.xyz = color.xyz;\n\n#endif",r.ShaderChunk.common="#define PI 3.14159\n#define PI2 6.28318\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\n\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\n\n	return normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\n\n}\n\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\n\n	return normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\n\n}\n\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n	float distance = dot( planeNormal, point - pointOnPlane );\n\n	return - distance * planeNormal + point;\n\n}\n\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n	return sign( dot( point - pointOnPlane, planeNormal ) );\n\n}\n\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n\n}\n\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\n\n	if ( decayExponent > 0.0 ) {\n\n	  return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\n	}\n\n	return 1.0;\n\n}\n\nvec3 F_Schlick( in vec3 specularColor, in float dotLH ) {\n\n	// Original approximation by Christophe Schlick '94\n	//;float fresnel = pow( 1.0 - dotLH, 5.0 );\n\n	// Optimized variant (presented by Epic at SIGGRAPH '13)\n	float fresnel = exp2( ( -5.55437 * dotLH - 6.98316 ) * dotLH );\n\n	return ( 1.0 - specularColor ) * fresnel + specularColor;\n\n}\n\nfloat G_BlinnPhong_Implicit( /* in float dotNL, in float dotNV */ ) {\n\n	// geometry term is (nl)(nv) / 4(nl)(nv)\n\n	return 0.25;\n\n}\n\nfloat D_BlinnPhong( in float shininess, in float dotNH ) {\n\n	// factor of 1/PI in distribution term omitted\n\n	return ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n\n}\n\nvec3 BRDF_BlinnPhong( in vec3 specularColor, in float shininess, in vec3 normal, in vec3 lightDir, in vec3 viewDir ) {\n\n	vec3 halfDir = normalize( lightDir + viewDir );\n\n	//float dotNL = saturate( dot( normal, lightDir ) );\n	//float dotNV = saturate( dot( normal, viewDir ) );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float dotLH = saturate( dot( lightDir, halfDir ) );\n\n	vec3 F = F_Schlick( specularColor, dotLH );\n\n	float G = G_BlinnPhong_Implicit( /* dotNL, dotNV */ );\n\n	float D = D_BlinnPhong( shininess, dotNH );\n\n	return F * G * D;\n\n}\n\nvec3 inputToLinear( in vec3 a ) {\n\n	#ifdef GAMMA_INPUT\n\n		return pow( a, vec3( float( GAMMA_FACTOR ) ) );\n\n	#else\n\n		return a;\n\n	#endif\n\n}\n\nvec3 linearToOutput( in vec3 a ) {\n\n	#ifdef GAMMA_OUTPUT\n\n		return pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\n\n	#else\n\n		return a;\n\n	#endif\n\n}\n",r.ShaderChunk.defaultnormal_vertex="#ifdef FLIP_SIDED\n\n	objectNormal = -objectNormal;\n\n#endif\n\nvec3 transformedNormal = normalMatrix * objectNormal;\n",r.ShaderChunk.displacementmap_vertex="#ifdef USE_DISPLACEMENTMAP\n\n	transformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n\n#endif\n",r.ShaderChunk.displacementmap_pars_vertex="#ifdef USE_DISPLACEMENTMAP\n\n	uniform sampler2D displacementMap;\n	uniform float displacementScale;\n	uniform float displacementBias;\n\n#endif\n",r.ShaderChunk.emissivemap_fragment="#ifdef USE_EMISSIVEMAP\n\n	vec4 emissiveColor = texture2D( emissiveMap, vUv );\n\n	emissiveColor.rgb = inputToLinear( emissiveColor.rgb );\n\n	totalEmissiveLight *= emissiveColor.rgb;\n\n#endif\n",r.ShaderChunk.emissivemap_pars_fragment="#ifdef USE_EMISSIVEMAP\n\n	uniform sampler2D emissiveMap;\n\n#endif\n",r.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\n\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n		vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\n		// Transforming Normal Vectors with the Inverse Transformation\n		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n		#ifdef ENVMAP_MODE_REFLECTION\n\n			vec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\n		#else\n\n			vec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\n		#endif\n\n	#else\n\n		vec3 reflectVec = vReflect;\n\n	#endif\n\n	#ifdef DOUBLE_SIDED\n		float flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n	#else\n		float flipNormal = 1.0;\n	#endif\n\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n	#elif defined( ENVMAP_TYPE_EQUIREC )\n		vec2 sampleUV;\n		sampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n		sampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n		vec4 envColor = texture2D( envMap, sampleUV );\n\n	#elif defined( ENVMAP_TYPE_SPHERE )\n		vec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n	#endif\n\n	envColor.xyz = inputToLinear( envColor.xyz );\n\n	#ifdef ENVMAP_BLENDING_MULTIPLY\n\n		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\n	#elif defined( ENVMAP_BLENDING_MIX )\n\n		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\n	#elif defined( ENVMAP_BLENDING_ADD )\n\n		outgoingLight += envColor.xyz * specularStrength * reflectivity;\n\n	#endif\n\n#endif\n",r.ShaderChunk.envmap_pars_fragment="#ifdef USE_ENVMAP\n\n	uniform float reflectivity;\n	#ifdef ENVMAP_TYPE_CUBE\n		uniform samplerCube envMap;\n	#else\n		uniform sampler2D envMap;\n	#endif\n	uniform float flipEnvMap;\n\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n		uniform float refractionRatio;\n\n	#else\n\n		varying vec3 vReflect;\n\n	#endif\n\n#endif\n",r.ShaderChunk.envmap_pars_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n	varying vec3 vReflect;\n\n	uniform float refractionRatio;\n\n#endif\n",r.ShaderChunk.envmap_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n	vec3 worldNormal = transformDirection( objectNormal, modelMatrix );\n\n	vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n	#ifdef ENVMAP_MODE_REFLECTION\n\n		vReflect = reflect( cameraToVertex, worldNormal );\n\n	#else\n\n		vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n	#endif\n\n#endif\n",r.ShaderChunk.fog_fragment="#ifdef USE_FOG\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		float depth = gl_FragDepthEXT / gl_FragCoord.w;\n\n	#else\n\n		float depth = gl_FragCoord.z / gl_FragCoord.w;\n\n	#endif\n\n	#ifdef FOG_EXP2\n\n		float fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n\n	#else\n\n		float fogFactor = smoothstep( fogNear, fogFar, depth );\n\n	#endif\n	\n	outgoingLight = mix( outgoingLight, fogColor, fogFactor );\n\n#endif",r.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\n\n	uniform vec3 fogColor;\n\n	#ifdef FOG_EXP2\n\n		uniform float fogDensity;\n\n	#else\n\n		uniform float fogNear;\n		uniform float fogFar;\n	#endif\n\n#endif",r.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\n\n	totalAmbientLight += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\n#endif\n",r.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\n	uniform sampler2D lightMap;\n	uniform float lightMapIntensity;\n\n#endif",r.ShaderChunk.lights_lambert_pars_vertex="uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n	uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n	uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n	uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n",r.ShaderChunk.lights_lambert_vertex="vLightFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\n	vLightBack = vec3( 0.0 );\n\n#endif\n\nvec3 normal = normalize( transformedNormal );\n\n#if MAX_POINT_LIGHTS > 0\n\n	for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n		vec3 lightColor = pointLightColor[ i ];\n\n		vec3 lVector = pointLightPosition[ i ] - mvPosition.xyz;\n		vec3 lightDir = normalize( lVector );\n\n		// attenuation\n\n		float attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n		// diffuse\n\n		float dotProduct = dot( normal, lightDir );\n\n		vLightFront += lightColor * attenuation * saturate( dotProduct );\n\n		#ifdef DOUBLE_SIDED\n\n			vLightBack += lightColor * attenuation * saturate( - dotProduct );\n\n		#endif\n\n	}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n		vec3 lightColor = spotLightColor[ i ];\n\n		vec3 lightPosition = spotLightPosition[ i ];\n		vec3 lVector = lightPosition - mvPosition.xyz;\n		vec3 lightDir = normalize( lVector );\n\n		float spotEffect = dot( spotLightDirection[ i ], lightDir );\n\n		if ( spotEffect > spotLightAngleCos[ i ] ) {\n\n			spotEffect = saturate( pow( saturate( spotEffect ), spotLightExponent[ i ] ) );\n\n			// attenuation\n\n			float attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n			attenuation *= spotEffect;\n\n			// diffuse\n\n			float dotProduct = dot( normal, lightDir );\n\n			vLightFront += lightColor * attenuation * saturate( dotProduct );\n\n			#ifdef DOUBLE_SIDED\n\n				vLightBack += lightColor * attenuation * saturate( - dotProduct );\n\n			#endif\n\n		}\n\n	}\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n	for ( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n		vec3 lightColor = directionalLightColor[ i ];\n\n		vec3 lightDir = directionalLightDirection[ i ];\n\n		// diffuse\n\n		float dotProduct = dot( normal, lightDir );\n\n		vLightFront += lightColor * saturate( dotProduct );\n\n		#ifdef DOUBLE_SIDED\n\n			vLightBack += lightColor * saturate( - dotProduct );\n\n		#endif\n\n	}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	for ( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n		vec3 lightDir = hemisphereLightDirection[ i ];\n\n		// diffuse\n\n		float dotProduct = dot( normal, lightDir );\n\n		float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n		vLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n		#ifdef DOUBLE_SIDED\n\n			float hemiDiffuseWeightBack = - 0.5 * dotProduct + 0.5;\n\n			vLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n\n		#endif\n\n	}\n\n#endif\n\nvLightFront += ambientLightColor;\n\n#ifdef DOUBLE_SIDED\n\n	vLightBack += ambientLightColor;\n\n#endif\n",r.ShaderChunk.lights_phong_fragment="#ifndef FLAT_SHADED\n\n	vec3 normal = normalize( vNormal );\n\n	#ifdef DOUBLE_SIDED\n\n		normal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\n	#endif\n\n#else\n\n	vec3 fdx = dFdx( vViewPosition );\n	vec3 fdy = dFdy( vViewPosition );\n	vec3 normal = normalize( cross( fdx, fdy ) );\n\n#endif\n\n#ifdef USE_NORMALMAP\n\n	normal = perturbNormal2Arb( -vViewPosition, normal );\n\n#elif defined( USE_BUMPMAP )\n\n	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n\nvec3 viewDir = normalize( vViewPosition );\n\nvec3 totalDiffuseLight = vec3( 0.0 );\nvec3 totalSpecularLight = vec3( 0.0 );\n\n#if MAX_POINT_LIGHTS > 0\n\n	for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n		vec3 lightColor = pointLightColor[ i ];\n\n		vec3 lightPosition = pointLightPosition[ i ];\n		vec3 lVector = lightPosition + vViewPosition.xyz;\n		vec3 lightDir = normalize( lVector );\n\n		// attenuation\n\n		float attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n		// diffuse\n\n		float cosineTerm = saturate( dot( normal, lightDir ) );\n\n		totalDiffuseLight += lightColor * attenuation * cosineTerm;\n\n		// specular\n\n		vec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\n\n		totalSpecularLight += brdf * specularStrength * lightColor * attenuation * cosineTerm;\n\n\n	}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n		vec3 lightColor = spotLightColor[ i ];\n\n		vec3 lightPosition = spotLightPosition[ i ];\n		vec3 lVector = lightPosition + vViewPosition.xyz;\n		vec3 lightDir = normalize( lVector );\n\n		float spotEffect = dot( spotLightDirection[ i ], lightDir );\n\n		if ( spotEffect > spotLightAngleCos[ i ] ) {\n\n			spotEffect = saturate( pow( saturate( spotEffect ), spotLightExponent[ i ] ) );\n\n			// attenuation\n\n			float attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n			attenuation *= spotEffect;\n\n			// diffuse\n\n			float cosineTerm = saturate( dot( normal, lightDir ) );\n\n			totalDiffuseLight += lightColor * attenuation * cosineTerm;\n\n			// specular\n\n			vec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\n\n			totalSpecularLight += brdf * specularStrength * lightColor * attenuation * cosineTerm;\n\n		}\n\n	}\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n	for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n		vec3 lightColor = directionalLightColor[ i ];\n\n		vec3 lightDir = directionalLightDirection[ i ];\n\n		// diffuse\n\n		float cosineTerm = saturate( dot( normal, lightDir ) );\n\n		totalDiffuseLight += lightColor * cosineTerm;\n\n		// specular\n\n		vec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\n\n		totalSpecularLight += brdf * specularStrength * lightColor * cosineTerm;\n\n	}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n		vec3 lightDir = hemisphereLightDirection[ i ];\n\n		// diffuse\n\n		float dotProduct = dot( normal, lightDir );\n\n		float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n		vec3 lightColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n		totalDiffuseLight += lightColor;\n\n		// specular (sky term only)\n\n		vec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\n\n		totalSpecularLight += brdf * specularStrength * lightColor * max( dotProduct, 0.0 );\n\n	}\n\n#endif\n\n#ifdef METAL\n\n	outgoingLight += diffuseColor.rgb * ( totalDiffuseLight + totalAmbientLight ) * specular + totalSpecularLight + totalEmissiveLight;\n\n#else\n\n	outgoingLight += diffuseColor.rgb * ( totalDiffuseLight + totalAmbientLight ) + totalSpecularLight + totalEmissiveLight;\n\n#endif\n",r.ShaderChunk.lights_phong_pars_fragment="uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n	uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n	uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\n	uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\n\n	varying vec3 vWorldPosition;\n\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n	varying vec3 vNormal;\n\n#endif\n",r.ShaderChunk.lights_phong_pars_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\n\n	varying vec3 vWorldPosition;\n\n#endif\n",r.ShaderChunk.lights_phong_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\n\n	vWorldPosition = worldPosition.xyz;\n\n#endif\n",r.ShaderChunk.linear_to_gamma_fragment="\n	outgoingLight = linearToOutput( outgoingLight );\n",r.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\n	gl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n\n#endif",r.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n\n	uniform float logDepthBufFC;\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		varying float vFragDepth;\n\n	#endif\n\n#endif\n",r.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		varying float vFragDepth;\n\n	#endif\n\n	uniform float logDepthBufFC;\n\n#endif",r.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\n	gl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		vFragDepth = 1.0 + gl_Position.w;\n\n#else\n\n		gl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\n	#endif\n\n#endif",r.ShaderChunk.map_fragment="#ifdef USE_MAP\n\n	vec4 texelColor = texture2D( map, vUv );\n\n	texelColor.xyz = inputToLinear( texelColor.xyz );\n\n	diffuseColor *= texelColor;\n\n#endif\n",r.ShaderChunk.map_pars_fragment="#ifdef USE_MAP\n\n	uniform sampler2D map;\n\n#endif",r.ShaderChunk.map_particle_fragment="#ifdef USE_MAP\n\n	diffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\n#endif\n",r.ShaderChunk.map_particle_pars_fragment="#ifdef USE_MAP\n\n	uniform vec4 offsetRepeat;\n	uniform sampler2D map;\n\n#endif\n",r.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\n	objectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n	objectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n	objectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n	objectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n\n#endif\n",r.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\n	#ifndef USE_MORPHNORMALS\n\n	uniform float morphTargetInfluences[ 8 ];\n\n	#else\n\n	uniform float morphTargetInfluences[ 4 ];\n\n	#endif\n\n#endif",r.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\n	transformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n	transformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n	transformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n	transformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\n	#ifndef USE_MORPHNORMALS\n\n	transformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n	transformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n	transformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n	transformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\n	#endif\n\n#endif\n",r.ShaderChunk.normalmap_pars_fragment="#ifdef USE_NORMALMAP\n\n	uniform sampler2D normalMap;\n	uniform vec2 normalScale;\n\n	// Per-Pixel Tangent Space Normal Mapping\n	// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\n	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\n		vec3 q0 = dFdx( eye_pos.xyz );\n		vec3 q1 = dFdy( eye_pos.xyz );\n		vec2 st0 = dFdx( vUv.st );\n		vec2 st1 = dFdy( vUv.st );\n\n		vec3 S = normalize( q0 * st1.t - q1 * st0.t );\n		vec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n		vec3 N = normalize( surf_norm );\n\n		vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n		mapN.xy = normalScale * mapN.xy;\n		mat3 tsn = mat3( S, T, N );\n		return normalize( tsn * mapN );\n\n	}\n\n#endif\n",r.ShaderChunk.project_vertex="#ifdef USE_SKINNING\n\n	vec4 mvPosition = modelViewMatrix * skinned;\n\n#else\n\n	vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n\n#endif\n\ngl_Position = projectionMatrix * mvPosition;\n",r.ShaderChunk.shadowmap_fragment="#ifdef USE_SHADOWMAP\n\n	#ifdef SHADOWMAP_DEBUG\n\n		vec3 frustumColors[3];\n		frustumColors[0] = vec3( 1.0, 0.5, 0.0 );\n		frustumColors[1] = vec3( 0.0, 1.0, 0.8 );\n		frustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n\n	#endif\n\n	float fDepth;\n	vec3 shadowColor = vec3( 1.0 );\n\n	for( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n		vec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\n\n				// if ( something && something ) breaks ATI OpenGL shader compiler\n				// if ( all( something, something ) ) using this instead\n\n		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n		bool inFrustum = all( inFrustumVec );\n\n		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n		bool frustumTest = all( frustumTestVec );\n\n		if ( frustumTest ) {\n\n			shadowCoord.z += shadowBias[ i ];\n\n			#if defined( SHADOWMAP_TYPE_PCF )\n\n						// Percentage-close filtering\n						// (9 pixel kernel)\n						// http://fabiensanglard.net/shadowmappingPCF/\n\n				float shadow = 0.0;\n\n		/*\n						// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\n						// must enroll loop manually\n\n				for ( float y = -1.25; y <= 1.25; y += 1.25 )\n					for ( float x = -1.25; x <= 1.25; x += 1.25 ) {\n\n						vec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\n\n								// doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\n								//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\n\n						float fDepth = unpackDepth( rgbaDepth );\n\n						if ( fDepth < shadowCoord.z )\n							shadow += 1.0;\n\n				}\n\n				shadow /= 9.0;\n\n		*/\n\n				const float shadowDelta = 1.0 / 9.0;\n\n				float xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n				float yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n				float dx0 = -1.25 * xPixelOffset;\n				float dy0 = -1.25 * yPixelOffset;\n				float dx1 = 1.25 * xPixelOffset;\n				float dy1 = 1.25 * yPixelOffset;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n			#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n						// Percentage-close filtering\n						// (9 pixel kernel)\n						// http://fabiensanglard.net/shadowmappingPCF/\n\n				float shadow = 0.0;\n\n				float xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n				float yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n				float dx0 = -1.0 * xPixelOffset;\n				float dy0 = -1.0 * yPixelOffset;\n				float dx1 = 1.0 * xPixelOffset;\n				float dy1 = 1.0 * yPixelOffset;\n\n				mat3 shadowKernel;\n				mat3 depthKernel;\n\n				depthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n				depthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n				depthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n				depthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n				depthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n				depthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n				depthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n				depthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n				depthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\n				vec3 shadowZ = vec3( shadowCoord.z );\n				shadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\n				shadowKernel[0] *= vec3(0.25);\n\n				shadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\n				shadowKernel[1] *= vec3(0.25);\n\n				shadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\n				shadowKernel[2] *= vec3(0.25);\n\n				vec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\n\n				shadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\n				shadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\n\n				vec4 shadowValues;\n				shadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\n				shadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\n				shadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\n				shadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\n\n				shadow = dot( shadowValues, vec4( 1.0 ) );\n\n				shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n			#else\n\n				vec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\n				float fDepth = unpackDepth( rgbaDepth );\n\n				if ( fDepth < shadowCoord.z )\n\n		// spot with multiple shadows is darker\n\n					shadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n\n		// spot with multiple shadows has the same color as single shadow spot\n\n		// 					shadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\n\n			#endif\n\n		}\n\n\n		#ifdef SHADOWMAP_DEBUG\n\n			if ( inFrustum ) outgoingLight *= frustumColors[ i ];\n\n		#endif\n\n	}\n\n	outgoingLight = outgoingLight * shadowColor;\n\n#endif\n",
r.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\n	uniform sampler2D shadowMap[ MAX_SHADOWS ];\n	uniform vec2 shadowMapSize[ MAX_SHADOWS ];\n\n	uniform float shadowDarkness[ MAX_SHADOWS ];\n	uniform float shadowBias[ MAX_SHADOWS ];\n\n	varying vec4 vShadowCoord[ MAX_SHADOWS ];\n\n	float unpackDepth( const in vec4 rgba_depth ) {\n\n		const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n		float depth = dot( rgba_depth, bit_shift );\n		return depth;\n\n	}\n\n#endif",r.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\n	varying vec4 vShadowCoord[ MAX_SHADOWS ];\n	uniform mat4 shadowMatrix[ MAX_SHADOWS ];\n\n#endif",r.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\n\n	for( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n		vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n\n	}\n\n#endif",r.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\n\n	mat4 boneMatX = getBoneMatrix( skinIndex.x );\n	mat4 boneMatY = getBoneMatrix( skinIndex.y );\n	mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n	mat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif",r.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\n\n	uniform mat4 bindMatrix;\n	uniform mat4 bindMatrixInverse;\n\n	#ifdef BONE_TEXTURE\n\n		uniform sampler2D boneTexture;\n		uniform int boneTextureWidth;\n		uniform int boneTextureHeight;\n\n		mat4 getBoneMatrix( const in float i ) {\n\n			float j = i * 4.0;\n			float x = mod( j, float( boneTextureWidth ) );\n			float y = floor( j / float( boneTextureWidth ) );\n\n			float dx = 1.0 / float( boneTextureWidth );\n			float dy = 1.0 / float( boneTextureHeight );\n\n			y = dy * ( y + 0.5 );\n\n			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n			mat4 bone = mat4( v1, v2, v3, v4 );\n\n			return bone;\n\n		}\n\n	#else\n\n		uniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\n		mat4 getBoneMatrix( const in float i ) {\n\n			mat4 bone = boneGlobalMatrices[ int(i) ];\n			return bone;\n\n		}\n\n	#endif\n\n#endif\n",r.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\n\n	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\n	vec4 skinned = vec4( 0.0 );\n	skinned += boneMatX * skinVertex * skinWeight.x;\n	skinned += boneMatY * skinVertex * skinWeight.y;\n	skinned += boneMatZ * skinVertex * skinWeight.z;\n	skinned += boneMatW * skinVertex * skinWeight.w;\n	skinned  = bindMatrixInverse * skinned;\n\n#endif\n",r.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\n\n	mat4 skinMatrix = mat4( 0.0 );\n	skinMatrix += skinWeight.x * boneMatX;\n	skinMatrix += skinWeight.y * boneMatY;\n	skinMatrix += skinWeight.z * boneMatZ;\n	skinMatrix += skinWeight.w * boneMatW;\n	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\n#endif\n",r.ShaderChunk.specularmap_fragment="float specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n	vec4 texelSpecular = texture2D( specularMap, vUv );\n	specularStrength = texelSpecular.r;\n\n#else\n\n	specularStrength = 1.0;\n\n#endif",r.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\n	uniform sampler2D specularMap;\n\n#endif",r.ShaderChunk.uv2_pars_fragment="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n	varying vec2 vUv2;\n\n#endif",r.ShaderChunk.uv2_pars_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n	attribute vec2 uv2;\n	varying vec2 vUv2;\n\n#endif",r.ShaderChunk.uv2_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n	vUv2 = uv2;\n\n#endif",r.ShaderChunk.uv_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\n\n	varying vec2 vUv;\n\n#endif",r.ShaderChunk.uv_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\n\n	varying vec2 vUv;\n	uniform vec4 offsetRepeat;\n\n#endif\n",r.ShaderChunk.uv_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\n\n	vUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n\n#endif",r.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\n	#ifdef USE_SKINNING\n\n		vec4 worldPosition = modelMatrix * skinned;\n\n	#else\n\n		vec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\n	#endif\n\n#endif\n",r.UniformsUtils={merge:function(e){for(var t={},i=0;i<e.length;i++){var n=this.clone(e[i]);for(var r in n)t[r]=n[r]}return t},clone:function(e){var t={};for(var i in e){t[i]={};for(var n in e[i]){var o=e[i][n];o instanceof r.Color||o instanceof r.Vector2||o instanceof r.Vector3||o instanceof r.Vector4||o instanceof r.Matrix3||o instanceof r.Matrix4||o instanceof r.Texture?t[i][n]=o.clone():Array.isArray(o)?t[i][n]=o.slice():t[i][n]=o}}return t}},r.UniformsLib={common:{diffuse:{type:"c",value:new r.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new r.Vector4(0,0,1,1)},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98}},aomap:{aoMap:{type:"t",value:null},aoMapIntensity:{type:"f",value:1}},lightmap:{lightMap:{type:"t",value:null},lightMapIntensity:{type:"f",value:1}},emissivemap:{emissiveMap:{type:"t",value:null}},bumpmap:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new r.Vector2(1,1)}},displacementmap:{displacementMap:{type:"t",value:null},displacementScale:{type:"f",value:1},displacementBias:{type:"f",value:0}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new r.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},pointLightDecay:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]},spotLightDecay:{type:"fv1",value:[]}},points:{psColor:{type:"c",value:new r.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new r.Vector4(0,0,1,1)},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new r.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}},r.ShaderLib={basic:{uniforms:r.UniformsUtils.merge([r.UniformsLib.common,r.UniformsLib.aomap,r.UniformsLib.fog,r.UniformsLib.shadowmap]),vertexShader:[r.ShaderChunk.common,r.ShaderChunk.uv_pars_vertex,r.ShaderChunk.uv2_pars_vertex,r.ShaderChunk.envmap_pars_vertex,r.ShaderChunk.color_pars_vertex,r.ShaderChunk.morphtarget_pars_vertex,r.ShaderChunk.skinning_pars_vertex,r.ShaderChunk.shadowmap_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",r.ShaderChunk.uv_vertex,r.ShaderChunk.uv2_vertex,r.ShaderChunk.color_vertex,r.ShaderChunk.skinbase_vertex,"	#ifdef USE_ENVMAP",r.ShaderChunk.beginnormal_vertex,r.ShaderChunk.morphnormal_vertex,r.ShaderChunk.skinnormal_vertex,r.ShaderChunk.defaultnormal_vertex,"	#endif",r.ShaderChunk.begin_vertex,r.ShaderChunk.morphtarget_vertex,r.ShaderChunk.skinning_vertex,r.ShaderChunk.project_vertex,r.ShaderChunk.logdepthbuf_vertex,r.ShaderChunk.worldpos_vertex,r.ShaderChunk.envmap_vertex,r.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;",r.ShaderChunk.common,r.ShaderChunk.color_pars_fragment,r.ShaderChunk.uv_pars_fragment,r.ShaderChunk.uv2_pars_fragment,r.ShaderChunk.map_pars_fragment,r.ShaderChunk.alphamap_pars_fragment,r.ShaderChunk.aomap_pars_fragment,r.ShaderChunk.envmap_pars_fragment,r.ShaderChunk.fog_pars_fragment,r.ShaderChunk.shadowmap_pars_fragment,r.ShaderChunk.specularmap_pars_fragment,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	vec3 outgoingLight = vec3( 0.0 );","	vec4 diffuseColor = vec4( diffuse, opacity );","	vec3 totalAmbientLight = vec3( 1.0 );",r.ShaderChunk.logdepthbuf_fragment,r.ShaderChunk.map_fragment,r.ShaderChunk.color_fragment,r.ShaderChunk.alphamap_fragment,r.ShaderChunk.alphatest_fragment,r.ShaderChunk.specularmap_fragment,r.ShaderChunk.aomap_fragment,"	outgoingLight = diffuseColor.rgb * totalAmbientLight;",r.ShaderChunk.envmap_fragment,r.ShaderChunk.shadowmap_fragment,r.ShaderChunk.linear_to_gamma_fragment,r.ShaderChunk.fog_fragment,"	gl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},lambert:{uniforms:r.UniformsUtils.merge([r.UniformsLib.common,r.UniformsLib.fog,r.UniformsLib.lights,r.UniformsLib.shadowmap,{emissive:{type:"c",value:new r.Color(0)}}]),vertexShader:["#define LAMBERT","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","#endif",r.ShaderChunk.common,r.ShaderChunk.uv_pars_vertex,r.ShaderChunk.uv2_pars_vertex,r.ShaderChunk.envmap_pars_vertex,r.ShaderChunk.lights_lambert_pars_vertex,r.ShaderChunk.color_pars_vertex,r.ShaderChunk.morphtarget_pars_vertex,r.ShaderChunk.skinning_pars_vertex,r.ShaderChunk.shadowmap_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",r.ShaderChunk.uv_vertex,r.ShaderChunk.uv2_vertex,r.ShaderChunk.color_vertex,r.ShaderChunk.beginnormal_vertex,r.ShaderChunk.morphnormal_vertex,r.ShaderChunk.skinbase_vertex,r.ShaderChunk.skinnormal_vertex,r.ShaderChunk.defaultnormal_vertex,r.ShaderChunk.begin_vertex,r.ShaderChunk.morphtarget_vertex,r.ShaderChunk.skinning_vertex,r.ShaderChunk.project_vertex,r.ShaderChunk.logdepthbuf_vertex,r.ShaderChunk.worldpos_vertex,r.ShaderChunk.envmap_vertex,r.ShaderChunk.lights_lambert_vertex,r.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform vec3 emissive;","uniform float opacity;","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","#endif",r.ShaderChunk.common,r.ShaderChunk.color_pars_fragment,r.ShaderChunk.uv_pars_fragment,r.ShaderChunk.uv2_pars_fragment,r.ShaderChunk.map_pars_fragment,r.ShaderChunk.alphamap_pars_fragment,r.ShaderChunk.envmap_pars_fragment,r.ShaderChunk.fog_pars_fragment,r.ShaderChunk.shadowmap_pars_fragment,r.ShaderChunk.specularmap_pars_fragment,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	vec3 outgoingLight = vec3( 0.0 );","	vec4 diffuseColor = vec4( diffuse, opacity );",r.ShaderChunk.logdepthbuf_fragment,r.ShaderChunk.map_fragment,r.ShaderChunk.color_fragment,r.ShaderChunk.alphamap_fragment,r.ShaderChunk.alphatest_fragment,r.ShaderChunk.specularmap_fragment,"	#ifdef DOUBLE_SIDED","		if ( gl_FrontFacing )","			outgoingLight += diffuseColor.rgb * vLightFront + emissive;","		else","			outgoingLight += diffuseColor.rgb * vLightBack + emissive;","	#else","		outgoingLight += diffuseColor.rgb * vLightFront + emissive;","	#endif",r.ShaderChunk.envmap_fragment,r.ShaderChunk.shadowmap_fragment,r.ShaderChunk.linear_to_gamma_fragment,r.ShaderChunk.fog_fragment,"	gl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},phong:{uniforms:r.UniformsUtils.merge([r.UniformsLib.common,r.UniformsLib.aomap,r.UniformsLib.lightmap,r.UniformsLib.emissivemap,r.UniformsLib.bumpmap,r.UniformsLib.normalmap,r.UniformsLib.displacementmap,r.UniformsLib.fog,r.UniformsLib.lights,r.UniformsLib.shadowmap,{emissive:{type:"c",value:new r.Color(0)},specular:{type:"c",value:new r.Color(1118481)},shininess:{type:"f",value:30}}]),vertexShader:["#define PHONG","varying vec3 vViewPosition;","#ifndef FLAT_SHADED","	varying vec3 vNormal;","#endif",r.ShaderChunk.common,r.ShaderChunk.uv_pars_vertex,r.ShaderChunk.uv2_pars_vertex,r.ShaderChunk.displacementmap_pars_vertex,r.ShaderChunk.envmap_pars_vertex,r.ShaderChunk.lights_phong_pars_vertex,r.ShaderChunk.color_pars_vertex,r.ShaderChunk.morphtarget_pars_vertex,r.ShaderChunk.skinning_pars_vertex,r.ShaderChunk.shadowmap_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",r.ShaderChunk.uv_vertex,r.ShaderChunk.uv2_vertex,r.ShaderChunk.color_vertex,r.ShaderChunk.beginnormal_vertex,r.ShaderChunk.morphnormal_vertex,r.ShaderChunk.skinbase_vertex,r.ShaderChunk.skinnormal_vertex,r.ShaderChunk.defaultnormal_vertex,"#ifndef FLAT_SHADED","	vNormal = normalize( transformedNormal );","#endif",r.ShaderChunk.begin_vertex,r.ShaderChunk.displacementmap_vertex,r.ShaderChunk.morphtarget_vertex,r.ShaderChunk.skinning_vertex,r.ShaderChunk.project_vertex,r.ShaderChunk.logdepthbuf_vertex,"	vViewPosition = - mvPosition.xyz;",r.ShaderChunk.worldpos_vertex,r.ShaderChunk.envmap_vertex,r.ShaderChunk.lights_phong_vertex,r.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["#define PHONG","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;","uniform float opacity;",r.ShaderChunk.common,r.ShaderChunk.color_pars_fragment,r.ShaderChunk.uv_pars_fragment,r.ShaderChunk.uv2_pars_fragment,r.ShaderChunk.map_pars_fragment,r.ShaderChunk.alphamap_pars_fragment,r.ShaderChunk.aomap_pars_fragment,r.ShaderChunk.lightmap_pars_fragment,r.ShaderChunk.emissivemap_pars_fragment,r.ShaderChunk.envmap_pars_fragment,r.ShaderChunk.fog_pars_fragment,r.ShaderChunk.lights_phong_pars_fragment,r.ShaderChunk.shadowmap_pars_fragment,r.ShaderChunk.bumpmap_pars_fragment,r.ShaderChunk.normalmap_pars_fragment,r.ShaderChunk.specularmap_pars_fragment,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	vec3 outgoingLight = vec3( 0.0 );","	vec4 diffuseColor = vec4( diffuse, opacity );","	vec3 totalAmbientLight = ambientLightColor;","	vec3 totalEmissiveLight = emissive;",r.ShaderChunk.logdepthbuf_fragment,r.ShaderChunk.map_fragment,r.ShaderChunk.color_fragment,r.ShaderChunk.alphamap_fragment,r.ShaderChunk.alphatest_fragment,r.ShaderChunk.specularmap_fragment,r.ShaderChunk.lightmap_fragment,r.ShaderChunk.aomap_fragment,r.ShaderChunk.emissivemap_fragment,r.ShaderChunk.lights_phong_fragment,r.ShaderChunk.envmap_fragment,r.ShaderChunk.shadowmap_fragment,r.ShaderChunk.linear_to_gamma_fragment,r.ShaderChunk.fog_fragment,"	gl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},points:{uniforms:r.UniformsUtils.merge([r.UniformsLib.points,r.UniformsLib.shadowmap]),vertexShader:["uniform float size;","uniform float scale;",r.ShaderChunk.common,r.ShaderChunk.color_pars_vertex,r.ShaderChunk.shadowmap_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",r.ShaderChunk.color_vertex,"	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","	#ifdef USE_SIZEATTENUATION","		gl_PointSize = size * ( scale / length( mvPosition.xyz ) );","	#else","		gl_PointSize = size;","	#endif","	gl_Position = projectionMatrix * mvPosition;",r.ShaderChunk.logdepthbuf_vertex,r.ShaderChunk.worldpos_vertex,r.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;","uniform float opacity;",r.ShaderChunk.common,r.ShaderChunk.color_pars_fragment,r.ShaderChunk.map_particle_pars_fragment,r.ShaderChunk.fog_pars_fragment,r.ShaderChunk.shadowmap_pars_fragment,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	vec3 outgoingLight = vec3( 0.0 );","	vec4 diffuseColor = vec4( psColor, opacity );",r.ShaderChunk.logdepthbuf_fragment,r.ShaderChunk.map_particle_fragment,r.ShaderChunk.color_fragment,r.ShaderChunk.alphatest_fragment,"	outgoingLight = diffuseColor.rgb;",r.ShaderChunk.shadowmap_fragment,r.ShaderChunk.fog_fragment,"	gl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},dashed:{uniforms:r.UniformsUtils.merge([r.UniformsLib.common,r.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;","attribute float lineDistance;","varying float vLineDistance;",r.ShaderChunk.common,r.ShaderChunk.color_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",r.ShaderChunk.color_vertex,"	vLineDistance = scale * lineDistance;","	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","	gl_Position = projectionMatrix * mvPosition;",r.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform float dashSize;","uniform float totalSize;","varying float vLineDistance;",r.ShaderChunk.common,r.ShaderChunk.color_pars_fragment,r.ShaderChunk.fog_pars_fragment,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	if ( mod( vLineDistance, totalSize ) > dashSize ) {","		discard;","	}","	vec3 outgoingLight = vec3( 0.0 );","	vec4 diffuseColor = vec4( diffuse, opacity );",r.ShaderChunk.logdepthbuf_fragment,r.ShaderChunk.color_fragment,"	outgoingLight = diffuseColor.rgb;",r.ShaderChunk.fog_fragment,"	gl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:[r.ShaderChunk.common,r.ShaderChunk.morphtarget_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",r.ShaderChunk.begin_vertex,r.ShaderChunk.morphtarget_vertex,r.ShaderChunk.project_vertex,r.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float mNear;","uniform float mFar;","uniform float opacity;",r.ShaderChunk.common,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {",r.ShaderChunk.logdepthbuf_fragment,"	#ifdef USE_LOGDEPTHBUF_EXT","		float depth = gl_FragDepthEXT / gl_FragCoord.w;","	#else","		float depth = gl_FragCoord.z / gl_FragCoord.w;","	#endif","	float color = 1.0 - smoothstep( mNear, mFar, depth );","	gl_FragColor = vec4( vec3( color ), opacity );","}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",r.ShaderChunk.common,r.ShaderChunk.morphtarget_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","	vNormal = normalize( normalMatrix * normal );",r.ShaderChunk.begin_vertex,r.ShaderChunk.morphtarget_vertex,r.ShaderChunk.project_vertex,r.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vNormal;",r.ShaderChunk.common,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	gl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );",r.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",r.ShaderChunk.common,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","	vWorldPosition = transformDirection( position, modelMatrix );","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",r.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform samplerCube tCube;","uniform float tFlip;","varying vec3 vWorldPosition;",r.ShaderChunk.common,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );",r.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},equirect:{uniforms:{tEquirect:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",r.ShaderChunk.common,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","	vWorldPosition = transformDirection( position, modelMatrix );","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",r.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","uniform float tFlip;","varying vec3 vWorldPosition;",r.ShaderChunk.common,r.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","vec3 direction = normalize( vWorldPosition );","vec2 sampleUV;","sampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );","sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","gl_FragColor = texture2D( tEquirect, sampleUV );",r.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[r.ShaderChunk.common,r.ShaderChunk.morphtarget_pars_vertex,r.ShaderChunk.skinning_pars_vertex,r.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",r.ShaderChunk.skinbase_vertex,r.ShaderChunk.begin_vertex,r.ShaderChunk.morphtarget_vertex,r.ShaderChunk.skinning_vertex,r.ShaderChunk.project_vertex,r.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:[r.ShaderChunk.common,r.ShaderChunk.logdepthbuf_pars_fragment,"vec4 pack_depth( const in float depth ) {","	const vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );","	const vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );","	vec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );","	res -= res.xxyz * bit_mask;","	return res;","}","void main() {",r.ShaderChunk.logdepthbuf_fragment,"	#ifdef USE_LOGDEPTHBUF_EXT","		gl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );","	#else","		gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );","	#endif","}"].join("\n")}},r.WebGLRenderer=function(e){function t(e,t,i,n){oe===!0&&(e*=n,t*=n,i*=n),Ie.clearColor(e,t,i,n)}function i(){$e.init(),Ie.viewport(Ae,Ce,Pe,Le),t(ae.r,ae.g,ae.b,he)}function n(){we=null,Ee=null,Te="",Me=-1,je=!0,$e.reset()}function o(e){e.preventDefault(),n(),i(),Xe.clear()}function s(e){var t=e.target;t.removeEventListener("dispose",s),l(t),ze.textures--}function a(e){var t=e.target;t.removeEventListener("dispose",a),c(t),ze.textures--}function h(e){var t=e.target;t.removeEventListener("dispose",h),u(t)}function l(e){var t=Xe.get(e);if(e.image&&t.__image__webglTextureCube)Ie.deleteTexture(t.__image__webglTextureCube);else{if(void 0===t.__webglInit)return;Ie.deleteTexture(t.__webglTexture)}Xe["delete"](e)}function c(e){var t=Xe.get(e);if(e&&void 0!==t.__webglTexture){if(Ie.deleteTexture(t.__webglTexture),e instanceof r.WebGLRenderTargetCube)for(var i=0;6>i;i++)Ie.deleteFramebuffer(t.__webglFramebuffer[i]),Ie.deleteRenderbuffer(t.__webglRenderbuffer[i]);else Ie.deleteFramebuffer(t.__webglFramebuffer),Ie.deleteRenderbuffer(t.__webglRenderbuffer);Xe["delete"](e)}}function u(e){p(e),Xe["delete"](e)}function p(e){var t=Xe.get(e).program;e.program=void 0,void 0!==t&&Ye.releaseProgram(t)}function d(e,t,i,n){var o;if(i instanceof r.InstancedBufferGeometry&&(o=He.get("ANGLE_instanced_arrays"),null===o))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");void 0===n&&(n=0),$e.initAttributes();var s=i.attributes,a=t.getAttributes(),h=e.defaultAttributeValues;for(var l in a){var c=a[l];if(c>=0){var u=s[l];if(void 0!==u){$e.enableAttribute(c);var p=u.itemSize,d=Je.getAttributeBuffer(u);if(u instanceof r.InterleavedBufferAttribute){var f=u.data,m=f.stride,y=u.offset;if(Ie.bindBuffer(Ie.ARRAY_BUFFER,d),Ie.vertexAttribPointer(c,p,Ie.FLOAT,!1,m*f.array.BYTES_PER_ELEMENT,(n*m+y)*f.array.BYTES_PER_ELEMENT),f instanceof r.InstancedInterleavedBuffer){if(null===o)return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferAttribute but hardware does not support extension ANGLE_instanced_arrays.");o.vertexAttribDivisorANGLE(c,f.meshPerAttribute),void 0===i.maxInstancedCount&&(i.maxInstancedCount=f.meshPerAttribute*f.count)}}else if(Ie.bindBuffer(Ie.ARRAY_BUFFER,d),Ie.vertexAttribPointer(c,p,Ie.FLOAT,!1,0,n*p*4),u instanceof r.InstancedBufferAttribute){if(null===o)return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferAttribute but hardware does not support extension ANGLE_instanced_arrays.");o.vertexAttribDivisorANGLE(c,u.meshPerAttribute),void 0===i.maxInstancedCount&&(i.maxInstancedCount=u.meshPerAttribute*u.count)}}else if(void 0!==h){var g=h[l];if(void 0!==g)switch(g.length){case 2:Ie.vertexAttrib2fv(c,g);break;case 3:Ie.vertexAttrib3fv(c,g);break;case 4:Ie.vertexAttrib4fv(c,g);break;default:Ie.vertexAttrib1fv(c,g)}}}}$e.disableUnusedAttributes()}function f(e,t){return t[0]-e[0]}function m(e,t){return e.object.renderOrder!==t.object.renderOrder?e.object.renderOrder-t.object.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function y(e,t){return e.object.renderOrder!==t.object.renderOrder?e.object.renderOrder-t.object.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function g(e){var t,i;e.material.transparent?(t=ye,i=++ge):(t=fe,i=++me),i<t.length?t[i]=e:t.push(e)}function v(e,t,i,n,r){var o,s;i.transparent?(o=pe,s=++de):(o=ce,s=++ue);var a=o[s];void 0!==a?(a.id=e.id,a.object=e,a.geometry=t,a.material=i,a.z=Be.z,a.group=r):(a={id:e.id,object:e,geometry:t,material:i,z:Be.z,group:r},o.push(a))}function b(e){if(e.visible!==!1){if(e instanceof r.Light)le.push(e);else if(e instanceof r.Sprite)be.push(e);else if(e instanceof r.LensFlare)_e.push(e);else if(e instanceof r.ImmediateRenderObject)g(e);else if((e instanceof r.Mesh||e instanceof r.Line||e instanceof r.Points)&&(e instanceof r.SkinnedMesh&&e.skeleton.update(),e.frustumCulled===!1||Fe.intersectsObject(e)===!0)){var t=e.material;if(t.visible===!0){xe.sortObjects===!0&&(Be.setFromMatrixPosition(e.matrixWorld),Be.applyProjection(De));var i=Je.update(e);if(t instanceof r.MeshFaceMaterial)for(var n=i.groups,o=t.materials,s=0,a=n.length;a>s;s++){var h=n[s],l=o[h.materialIndex];l.visible===!0&&v(e,i,l,Be.z,h)}else v(e,i,t,Be.z)}}for(var c=e.children,s=0,a=c.length;a>s;s++)b(c[s])}}function _(e,t,i,n,r){for(var o=0,s=e.length;s>o;o++){var a=e[o],h=a.object,l=a.geometry,c=void 0===r?a.material:r,u=a.group;h.modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,h.matrixWorld),h.normalMatrix.getNormalMatrix(h.modelViewMatrix),xe.renderBufferDirect(t,i,n,l,c,h,u)}}function x(e,t,i,n,r){for(var o=r,s=0,a=e.length;a>s;s++){var h=e[s];h.modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,h.matrixWorld),h.normalMatrix.getNormalMatrix(h.modelViewMatrix),void 0===r&&(o=h.material),S(o);var l=T(t,i,n,o,h);Te="",h.render(function(e){xe.renderBufferImmediate(e,l,o)})}}function w(e,t,i,n){var o=Xe.get(e),s=Ye.getParameters(e,t,i,n),a=Ye.getProgramCode(e,s),l=o.program,c=!0;if(void 0===l)e.addEventListener("dispose",h);else if(l.code!==a)p(e);else{if(void 0!==s.shaderID)return;c=!1}if(c){if(s.shaderID){var u=r.ShaderLib[s.shaderID];o.__webglShader={name:e.type,uniforms:r.UniformsUtils.clone(u.uniforms),vertexShader:u.vertexShader,fragmentShader:u.fragmentShader}}else o.__webglShader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.__webglShader=o.__webglShader,l=Ye.acquireProgram(e,s,a),o.program=l,e.program=l}var d=l.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var f=0;f<xe.maxMorphTargets;f++)d["morphTarget"+f]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals)for(e.numSupportedMorphNormals=0,f=0;f<xe.maxMorphNormals;f++)d["morphNormal"+f]>=0&&e.numSupportedMorphNormals++;o.uniformsList=[];var m=o.program.getUniforms();for(var y in o.__webglShader.uniforms){var g=m[y];g&&o.uniformsList.push([o.__webglShader.uniforms[y],g])}}function S(e){M(e),e.transparent===!0?$e.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha):$e.setBlending(r.NoBlending),$e.setDepthFunc(e.depthFunc),$e.setDepthTest(e.depthTest),$e.setDepthWrite(e.depthWrite),$e.setColorWrite(e.colorWrite),$e.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)}function M(e){e.side!==r.DoubleSide?$e.enable(Ie.CULL_FACE):$e.disable(Ie.CULL_FACE),$e.setFlipSided(e.side===r.BackSide)}function T(e,t,i,n,o){ke=0;var s=Xe.get(n);(n.needsUpdate||!s.program)&&(w(n,t,i,o),n.needsUpdate=!1);var a=!1,h=!1,l=!1,c=s.program,u=c.getUniforms(),p=s.__webglShader.uniforms;if(c.id!==we&&(Ie.useProgram(c.program),we=c.id,a=!0,h=!0,l=!0),n.id!==Me&&(-1===Me&&(l=!0),Me=n.id,h=!0),(a||e!==Ee)&&(Ie.uniformMatrix4fv(u.projectionMatrix,!1,e.projectionMatrix.elements),We.logarithmicDepthBuffer&&Ie.uniform1f(u.logDepthBufFC,2/(Math.log(e.far+1)/Math.LN2)),e!==Ee&&(Ee=e),(n instanceof r.ShaderMaterial||n instanceof r.MeshPhongMaterial||n.envMap)&&void 0!==u.cameraPosition&&(Be.setFromMatrixPosition(e.matrixWorld),Ie.uniform3f(u.cameraPosition,Be.x,Be.y,Be.z)),(n instanceof r.MeshPhongMaterial||n instanceof r.MeshLambertMaterial||n instanceof r.MeshBasicMaterial||n instanceof r.ShaderMaterial||n.skinning)&&void 0!==u.viewMatrix&&Ie.uniformMatrix4fv(u.viewMatrix,!1,e.matrixWorldInverse.elements)),n.skinning)if(o.bindMatrix&&void 0!==u.bindMatrix&&Ie.uniformMatrix4fv(u.bindMatrix,!1,o.bindMatrix.elements),o.bindMatrixInverse&&void 0!==u.bindMatrixInverse&&Ie.uniformMatrix4fv(u.bindMatrixInverse,!1,o.bindMatrixInverse.elements),We.floatVertexTextures&&o.skeleton&&o.skeleton.useVertexTexture){if(void 0!==u.boneTexture){var d=B();Ie.uniform1i(u.boneTexture,d),xe.setTexture(o.skeleton.boneTexture,d)}void 0!==u.boneTextureWidth&&Ie.uniform1i(u.boneTextureWidth,o.skeleton.boneTextureWidth),void 0!==u.boneTextureHeight&&Ie.uniform1i(u.boneTextureHeight,o.skeleton.boneTextureHeight)}else o.skeleton&&o.skeleton.boneMatrices&&void 0!==u.boneGlobalMatrices&&Ie.uniformMatrix4fv(u.boneGlobalMatrices,!1,o.skeleton.boneMatrices);return h&&(i&&n.fog&&P(p,i),(n instanceof r.MeshPhongMaterial||n instanceof r.MeshLambertMaterial||n.lights)&&(je&&(l=!0,V(t,e),je=!1),l?(R(p,Ve),O(p,!0)):O(p,!1)),(n instanceof r.MeshBasicMaterial||n instanceof r.MeshLambertMaterial||n instanceof r.MeshPhongMaterial)&&E(p,n),n instanceof r.LineBasicMaterial?k(p,n):n instanceof r.LineDashedMaterial?(k(p,n),A(p,n)):n instanceof r.PointsMaterial?C(p,n):n instanceof r.MeshPhongMaterial?L(p,n):n instanceof r.MeshDepthMaterial?(p.mNear.value=e.near,p.mFar.value=e.far,p.opacity.value=n.opacity):n instanceof r.MeshNormalMaterial&&(p.opacity.value=n.opacity),o.receiveShadow&&!n._shadowPass&&F(p,t),N(s.uniformsList)),D(u,o),void 0!==u.modelMatrix&&Ie.uniformMatrix4fv(u.modelMatrix,!1,o.matrixWorld.elements),c}function E(e,t){e.opacity.value=t.opacity,e.diffuse.value=t.color,t.emissive&&(e.emissive.value=t.emissive),e.map.value=t.map,e.specularMap.value=t.specularMap,e.alphaMap.value=t.alphaMap,t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity);var i;if(t.map?i=t.map:t.specularMap?i=t.specularMap:t.displacementMap?i=t.displacementMap:t.normalMap?i=t.normalMap:t.bumpMap?i=t.bumpMap:t.alphaMap?i=t.alphaMap:t.emissiveMap&&(i=t.emissiveMap),void 0!==i){var n=i.offset,o=i.repeat;e.offsetRepeat.value.set(n.x,n.y,o.x,o.y)}e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap instanceof r.WebGLRenderTargetCube?1:-1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio}function k(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}function A(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}function C(e,t){if(e.psColor.value=t.color,e.opacity.value=t.opacity,e.size.value=t.size,e.scale.value=Y.height/2,e.map.value=t.map,null!==t.map){var i=t.map.offset,n=t.map.repeat;e.offsetRepeat.value.set(i.x,i.y,n.x,n.y)}}function P(e,t){e.fogColor.value=t.color,t instanceof r.Fog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t instanceof r.FogExp2&&(e.fogDensity.value=t.density)}function L(e,t){e.specular.value=t.specular,
e.shininess.value=t.shininess,t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function R(e,t){e.ambientLightColor.value=t.ambient,e.directionalLightColor.value=t.directional.colors,e.directionalLightDirection.value=t.directional.positions,e.pointLightColor.value=t.point.colors,e.pointLightPosition.value=t.point.positions,e.pointLightDistance.value=t.point.distances,e.pointLightDecay.value=t.point.decays,e.spotLightColor.value=t.spot.colors,e.spotLightPosition.value=t.spot.positions,e.spotLightDistance.value=t.spot.distances,e.spotLightDirection.value=t.spot.directions,e.spotLightAngleCos.value=t.spot.anglesCos,e.spotLightExponent.value=t.spot.exponents,e.spotLightDecay.value=t.spot.decays,e.hemisphereLightSkyColor.value=t.hemi.skyColors,e.hemisphereLightGroundColor.value=t.hemi.groundColors,e.hemisphereLightDirection.value=t.hemi.positions}function O(e,t){e.ambientLightColor.needsUpdate=t,e.directionalLightColor.needsUpdate=t,e.directionalLightDirection.needsUpdate=t,e.pointLightColor.needsUpdate=t,e.pointLightPosition.needsUpdate=t,e.pointLightDistance.needsUpdate=t,e.pointLightDecay.needsUpdate=t,e.spotLightColor.needsUpdate=t,e.spotLightPosition.needsUpdate=t,e.spotLightDistance.needsUpdate=t,e.spotLightDirection.needsUpdate=t,e.spotLightAngleCos.needsUpdate=t,e.spotLightExponent.needsUpdate=t,e.spotLightDecay.needsUpdate=t,e.hemisphereLightSkyColor.needsUpdate=t,e.hemisphereLightGroundColor.needsUpdate=t,e.hemisphereLightDirection.needsUpdate=t}function F(e,t){if(e.shadowMatrix)for(var i=0,n=0,o=t.length;o>n;n++){var s=t[n];s.castShadow&&(s instanceof r.SpotLight||s instanceof r.DirectionalLight)&&(e.shadowMap.value[i]=s.shadowMap,e.shadowMapSize.value[i]=s.shadowMapSize,e.shadowMatrix.value[i]=s.shadowMatrix,e.shadowDarkness.value[i]=s.shadowDarkness,e.shadowBias.value[i]=s.shadowBias,i++)}}function D(e,t){Ie.uniformMatrix4fv(e.modelViewMatrix,!1,t.modelViewMatrix.elements),e.normalMatrix&&Ie.uniformMatrix3fv(e.normalMatrix,!1,t.normalMatrix.elements)}function B(){var e=ke;return e>=We.maxTextures&&console.warn("WebGLRenderer: trying to use "+e+" texture units while this GPU supports only "+We.maxTextures),ke+=1,e}function N(e){for(var t,i,n=0,o=e.length;o>n;n++){var s=e[n][0];if(s.needsUpdate!==!1){var a=s.type,h=s.value,l=e[n][1];switch(a){case"1i":Ie.uniform1i(l,h);break;case"1f":Ie.uniform1f(l,h);break;case"2f":Ie.uniform2f(l,h[0],h[1]);break;case"3f":Ie.uniform3f(l,h[0],h[1],h[2]);break;case"4f":Ie.uniform4f(l,h[0],h[1],h[2],h[3]);break;case"1iv":Ie.uniform1iv(l,h);break;case"3iv":Ie.uniform3iv(l,h);break;case"1fv":Ie.uniform1fv(l,h);break;case"2fv":Ie.uniform2fv(l,h);break;case"3fv":Ie.uniform3fv(l,h);break;case"4fv":Ie.uniform4fv(l,h);break;case"Matrix3fv":Ie.uniformMatrix3fv(l,!1,h);break;case"Matrix4fv":Ie.uniformMatrix4fv(l,!1,h);break;case"i":Ie.uniform1i(l,h);break;case"f":Ie.uniform1f(l,h);break;case"v2":Ie.uniform2f(l,h.x,h.y);break;case"v3":Ie.uniform3f(l,h.x,h.y,h.z);break;case"v4":Ie.uniform4f(l,h.x,h.y,h.z,h.w);break;case"c":Ie.uniform3f(l,h.r,h.g,h.b);break;case"iv1":Ie.uniform1iv(l,h);break;case"iv":Ie.uniform3iv(l,h);break;case"fv1":Ie.uniform1fv(l,h);break;case"fv":Ie.uniform3fv(l,h);break;case"v2v":void 0===s._array&&(s._array=new Float32Array(2*h.length));for(var c=0,u=0,p=h.length;p>c;c++,u+=2)s._array[u+0]=h[c].x,s._array[u+1]=h[c].y;Ie.uniform2fv(l,s._array);break;case"v3v":void 0===s._array&&(s._array=new Float32Array(3*h.length));for(var c=0,d=0,p=h.length;p>c;c++,d+=3)s._array[d+0]=h[c].x,s._array[d+1]=h[c].y,s._array[d+2]=h[c].z;Ie.uniform3fv(l,s._array);break;case"v4v":void 0===s._array&&(s._array=new Float32Array(4*h.length));for(var c=0,f=0,p=h.length;p>c;c++,f+=4)s._array[f+0]=h[c].x,s._array[f+1]=h[c].y,s._array[f+2]=h[c].z,s._array[f+3]=h[c].w;Ie.uniform4fv(l,s._array);break;case"m3":Ie.uniformMatrix3fv(l,!1,h.elements);break;case"m3v":void 0===s._array&&(s._array=new Float32Array(9*h.length));for(var c=0,p=h.length;p>c;c++)h[c].flattenToArrayOffset(s._array,9*c);Ie.uniformMatrix3fv(l,!1,s._array);break;case"m4":Ie.uniformMatrix4fv(l,!1,h.elements);break;case"m4v":void 0===s._array&&(s._array=new Float32Array(16*h.length));for(var c=0,p=h.length;p>c;c++)h[c].flattenToArrayOffset(s._array,16*c);Ie.uniformMatrix4fv(l,!1,s._array);break;case"t":if(t=h,i=B(),Ie.uniform1i(l,i),!t)continue;t instanceof r.CubeTexture||Array.isArray(t.image)&&6===t.image.length?G(t,i):t instanceof r.WebGLRenderTargetCube?q(t,i):xe.setTexture(t,i);break;case"tv":void 0===s._array&&(s._array=[]);for(var c=0,p=s.value.length;p>c;c++)s._array[c]=B();Ie.uniform1iv(l,s._array);for(var c=0,p=s.value.length;p>c;c++)t=s.value[c],i=s._array[c],t&&xe.setTexture(t,i);break;default:console.warn("THREE.WebGLRenderer: Unknown uniform type: "+a)}}}}function j(e,t,i,n){e[t+0]=i.r*n,e[t+1]=i.g*n,e[t+2]=i.b*n}function V(e,t){var i,n,o,s,a,h,l,c,u=0,p=0,d=0,f=Ve,m=t.matrixWorldInverse,y=f.directional.colors,g=f.directional.positions,v=f.point.colors,b=f.point.positions,_=f.point.distances,x=f.point.decays,w=f.spot.colors,S=f.spot.positions,M=f.spot.distances,T=f.spot.directions,E=f.spot.anglesCos,k=f.spot.exponents,A=f.spot.decays,C=f.hemi.skyColors,P=f.hemi.groundColors,L=f.hemi.positions,R=0,O=0,F=0,D=0,B=0,N=0,V=0,z=0,U=0,I=0,G=0,q=0;for(i=0,n=e.length;n>i;i++)if(o=e[i],!o.onlyShadow)if(s=o.color,l=o.intensity,c=o.distance,o instanceof r.AmbientLight){if(!o.visible)continue;u+=s.r,p+=s.g,d+=s.b}else if(o instanceof r.DirectionalLight){if(B+=1,!o.visible)continue;Ne.setFromMatrixPosition(o.matrixWorld),Be.setFromMatrixPosition(o.target.matrixWorld),Ne.sub(Be),Ne.transformDirection(m),U=3*R,g[U+0]=Ne.x,g[U+1]=Ne.y,g[U+2]=Ne.z,j(y,U,s,l),R+=1}else if(o instanceof r.PointLight){if(N+=1,!o.visible)continue;I=3*O,j(v,I,s,l),Be.setFromMatrixPosition(o.matrixWorld),Be.applyMatrix4(m),b[I+0]=Be.x,b[I+1]=Be.y,b[I+2]=Be.z,_[O]=c,x[O]=0===o.distance?0:o.decay,O+=1}else if(o instanceof r.SpotLight){if(V+=1,!o.visible)continue;G=3*F,j(w,G,s,l),Ne.setFromMatrixPosition(o.matrixWorld),Be.copy(Ne).applyMatrix4(m),S[G+0]=Be.x,S[G+1]=Be.y,S[G+2]=Be.z,M[F]=c,Be.setFromMatrixPosition(o.target.matrixWorld),Ne.sub(Be),Ne.transformDirection(m),T[G+0]=Ne.x,T[G+1]=Ne.y,T[G+2]=Ne.z,E[F]=Math.cos(o.angle),k[F]=o.exponent,A[F]=0===o.distance?0:o.decay,F+=1}else if(o instanceof r.HemisphereLight){if(z+=1,!o.visible)continue;Ne.setFromMatrixPosition(o.matrixWorld),Ne.transformDirection(m),q=3*D,L[q+0]=Ne.x,L[q+1]=Ne.y,L[q+2]=Ne.z,a=o.color,h=o.groundColor,j(C,q,a,l),j(P,q,h,l),D+=1}for(i=3*R,n=Math.max(y.length,3*B);n>i;i++)y[i]=0;for(i=3*O,n=Math.max(v.length,3*N);n>i;i++)v[i]=0;for(i=3*F,n=Math.max(w.length,3*V);n>i;i++)w[i]=0;for(i=3*D,n=Math.max(C.length,3*z);n>i;i++)C[i]=0;for(i=3*D,n=Math.max(P.length,3*z);n>i;i++)P[i]=0;f.directional.length=R,f.point.length=O,f.spot.length=F,f.hemi.length=D,f.ambient[0]=u,f.ambient[1]=p,f.ambient[2]=d}function z(e,t,i){var n;if(i?(Ie.texParameteri(e,Ie.TEXTURE_WRAP_S,J(t.wrapS)),Ie.texParameteri(e,Ie.TEXTURE_WRAP_T,J(t.wrapT)),Ie.texParameteri(e,Ie.TEXTURE_MAG_FILTER,J(t.magFilter)),Ie.texParameteri(e,Ie.TEXTURE_MIN_FILTER,J(t.minFilter))):(Ie.texParameteri(e,Ie.TEXTURE_WRAP_S,Ie.CLAMP_TO_EDGE),Ie.texParameteri(e,Ie.TEXTURE_WRAP_T,Ie.CLAMP_TO_EDGE),(t.wrapS!==r.ClampToEdgeWrapping||t.wrapT!==r.ClampToEdgeWrapping)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping. ( "+t.sourceFile+" )"),Ie.texParameteri(e,Ie.TEXTURE_MAG_FILTER,X(t.magFilter)),Ie.texParameteri(e,Ie.TEXTURE_MIN_FILTER,X(t.minFilter)),t.minFilter!==r.NearestFilter&&t.minFilter!==r.LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter. ( "+t.sourceFile+" )")),n=He.get("EXT_texture_filter_anisotropic")){if(t.type===r.FloatType&&null===He.get("OES_texture_float_linear"))return;if(t.type===r.HalfFloatType&&null===He.get("OES_texture_half_float_linear"))return;(t.anisotropy>1||Xe.get(t).__currentAnisotropy)&&(Ie.texParameterf(e,n.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,xe.getMaxAnisotropy())),Xe.get(t).__currentAnisotropy=t.anisotropy)}}function U(e,t,i){void 0===e.__webglInit&&(e.__webglInit=!0,t.__webglInit=!0,t.addEventListener("dispose",s),e.__webglTexture=Ie.createTexture(),ze.textures++),$e.activeTexture(Ie.TEXTURE0+i),$e.bindTexture(Ie.TEXTURE_2D,e.__webglTexture),Ie.pixelStorei(Ie.UNPACK_FLIP_Y_WEBGL,t.flipY),Ie.pixelStorei(Ie.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),Ie.pixelStorei(Ie.UNPACK_ALIGNMENT,t.unpackAlignment),t.image=I(t.image,We.maxTextureSize);var n=t.image,o=r.Math.isPowerOfTwo(n.width)&&r.Math.isPowerOfTwo(n.height),a=J(t.format),h=J(t.type);z(Ie.TEXTURE_2D,t,o);var l,c=t.mipmaps;if(t instanceof r.DataTexture)if(c.length>0&&o){for(var u=0,p=c.length;p>u;u++)l=c[u],$e.texImage2D(Ie.TEXTURE_2D,u,a,l.width,l.height,0,a,h,l.data);t.generateMipmaps=!1}else $e.texImage2D(Ie.TEXTURE_2D,0,a,n.width,n.height,0,a,h,n.data);else if(t instanceof r.CompressedTexture)for(var u=0,p=c.length;p>u;u++)l=c[u],t.format!==r.RGBAFormat&&t.format!==r.RGBFormat?$e.getCompressedTextureFormats().indexOf(a)>-1?$e.compressedTexImage2D(Ie.TEXTURE_2D,u,a,l.width,l.height,0,l.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):$e.texImage2D(Ie.TEXTURE_2D,u,a,l.width,l.height,0,a,h,l.data);else if(c.length>0&&o){for(var u=0,p=c.length;p>u;u++)l=c[u],$e.texImage2D(Ie.TEXTURE_2D,u,a,a,h,l);t.generateMipmaps=!1}else $e.texImage2D(Ie.TEXTURE_2D,0,a,a,h,t.image);t.generateMipmaps&&o&&Ie.generateMipmap(Ie.TEXTURE_2D),e.__version=t.version,t.onUpdate&&t.onUpdate(t)}function I(e,t){if(e.width>t||e.height>t){var i=t/Math.max(e.width,e.height),n=document.createElement("canvas");n.width=Math.floor(e.width*i),n.height=Math.floor(e.height*i);var r=n.getContext("2d");return r.drawImage(e,0,0,e.width,e.height,0,0,n.width,n.height),console.warn("THREE.WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+n.width+"x"+n.height,e),n}return e}function G(e,t){var i=Xe.get(e);if(6===e.image.length)if(e.version>0&&i.__version!==e.version){i.__image__webglTextureCube||(e.addEventListener("dispose",s),i.__image__webglTextureCube=Ie.createTexture(),ze.textures++),$e.activeTexture(Ie.TEXTURE0+t),$e.bindTexture(Ie.TEXTURE_CUBE_MAP,i.__image__webglTextureCube),Ie.pixelStorei(Ie.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var n=e instanceof r.CompressedTexture,o=e.image[0]instanceof r.DataTexture,a=[],h=0;6>h;h++)!xe.autoScaleCubemaps||n||o?a[h]=o?e.image[h].image:e.image[h]:a[h]=I(e.image[h],We.maxCubemapSize);var l=a[0],c=r.Math.isPowerOfTwo(l.width)&&r.Math.isPowerOfTwo(l.height),u=J(e.format),p=J(e.type);z(Ie.TEXTURE_CUBE_MAP,e,c);for(var h=0;6>h;h++)if(n)for(var d,f=a[h].mipmaps,m=0,y=f.length;y>m;m++)d=f[m],e.format!==r.RGBAFormat&&e.format!==r.RGBFormat?$e.getCompressedTextureFormats().indexOf(u)>-1?$e.compressedTexImage2D(Ie.TEXTURE_CUBE_MAP_POSITIVE_X+h,m,u,d.width,d.height,0,d.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()"):$e.texImage2D(Ie.TEXTURE_CUBE_MAP_POSITIVE_X+h,m,u,d.width,d.height,0,u,p,d.data);else o?$e.texImage2D(Ie.TEXTURE_CUBE_MAP_POSITIVE_X+h,0,u,a[h].width,a[h].height,0,u,p,a[h].data):$e.texImage2D(Ie.TEXTURE_CUBE_MAP_POSITIVE_X+h,0,u,u,p,a[h]);e.generateMipmaps&&c&&Ie.generateMipmap(Ie.TEXTURE_CUBE_MAP),i.__version=e.version,e.onUpdate&&e.onUpdate(e)}else $e.activeTexture(Ie.TEXTURE0+t),$e.bindTexture(Ie.TEXTURE_CUBE_MAP,i.__image__webglTextureCube)}function q(e,t){$e.activeTexture(Ie.TEXTURE0+t),$e.bindTexture(Ie.TEXTURE_CUBE_MAP,Xe.get(e).__webglTexture)}function H(e,t,i){Ie.bindFramebuffer(Ie.FRAMEBUFFER,e),Ie.framebufferTexture2D(Ie.FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,i,Xe.get(t).__webglTexture,0)}function W(e,t){Ie.bindRenderbuffer(Ie.RENDERBUFFER,e),t.depthBuffer&&!t.stencilBuffer?(Ie.renderbufferStorage(Ie.RENDERBUFFER,Ie.DEPTH_COMPONENT16,t.width,t.height),Ie.framebufferRenderbuffer(Ie.FRAMEBUFFER,Ie.DEPTH_ATTACHMENT,Ie.RENDERBUFFER,e)):t.depthBuffer&&t.stencilBuffer?(Ie.renderbufferStorage(Ie.RENDERBUFFER,Ie.DEPTH_STENCIL,t.width,t.height),Ie.framebufferRenderbuffer(Ie.FRAMEBUFFER,Ie.DEPTH_STENCIL_ATTACHMENT,Ie.RENDERBUFFER,e)):Ie.renderbufferStorage(Ie.RENDERBUFFER,Ie.RGBA4,t.width,t.height)}function $(e){e instanceof r.WebGLRenderTargetCube?($e.bindTexture(Ie.TEXTURE_CUBE_MAP,Xe.get(e).__webglTexture),Ie.generateMipmap(Ie.TEXTURE_CUBE_MAP),$e.bindTexture(Ie.TEXTURE_CUBE_MAP,null)):($e.bindTexture(Ie.TEXTURE_2D,Xe.get(e).__webglTexture),Ie.generateMipmap(Ie.TEXTURE_2D),$e.bindTexture(Ie.TEXTURE_2D,null))}function X(e){return e===r.NearestFilter||e===r.NearestMipMapNearestFilter||e===r.NearestMipMapLinearFilter?Ie.NEAREST:Ie.LINEAR}function J(e){var t;if(e===r.RepeatWrapping)return Ie.REPEAT;if(e===r.ClampToEdgeWrapping)return Ie.CLAMP_TO_EDGE;if(e===r.MirroredRepeatWrapping)return Ie.MIRRORED_REPEAT;if(e===r.NearestFilter)return Ie.NEAREST;if(e===r.NearestMipMapNearestFilter)return Ie.NEAREST_MIPMAP_NEAREST;if(e===r.NearestMipMapLinearFilter)return Ie.NEAREST_MIPMAP_LINEAR;if(e===r.LinearFilter)return Ie.LINEAR;if(e===r.LinearMipMapNearestFilter)return Ie.LINEAR_MIPMAP_NEAREST;if(e===r.LinearMipMapLinearFilter)return Ie.LINEAR_MIPMAP_LINEAR;if(e===r.UnsignedByteType)return Ie.UNSIGNED_BYTE;if(e===r.UnsignedShort4444Type)return Ie.UNSIGNED_SHORT_4_4_4_4;if(e===r.UnsignedShort5551Type)return Ie.UNSIGNED_SHORT_5_5_5_1;if(e===r.UnsignedShort565Type)return Ie.UNSIGNED_SHORT_5_6_5;if(e===r.ByteType)return Ie.BYTE;if(e===r.ShortType)return Ie.SHORT;if(e===r.UnsignedShortType)return Ie.UNSIGNED_SHORT;if(e===r.IntType)return Ie.INT;if(e===r.UnsignedIntType)return Ie.UNSIGNED_INT;if(e===r.FloatType)return Ie.FLOAT;if(t=He.get("OES_texture_half_float"),null!==t&&e===r.HalfFloatType)return t.HALF_FLOAT_OES;if(e===r.AlphaFormat)return Ie.ALPHA;if(e===r.RGBFormat)return Ie.RGB;if(e===r.RGBAFormat)return Ie.RGBA;if(e===r.LuminanceFormat)return Ie.LUMINANCE;if(e===r.LuminanceAlphaFormat)return Ie.LUMINANCE_ALPHA;if(e===r.AddEquation)return Ie.FUNC_ADD;if(e===r.SubtractEquation)return Ie.FUNC_SUBTRACT;if(e===r.ReverseSubtractEquation)return Ie.FUNC_REVERSE_SUBTRACT;if(e===r.ZeroFactor)return Ie.ZERO;if(e===r.OneFactor)return Ie.ONE;if(e===r.SrcColorFactor)return Ie.SRC_COLOR;if(e===r.OneMinusSrcColorFactor)return Ie.ONE_MINUS_SRC_COLOR;if(e===r.SrcAlphaFactor)return Ie.SRC_ALPHA;if(e===r.OneMinusSrcAlphaFactor)return Ie.ONE_MINUS_SRC_ALPHA;if(e===r.DstAlphaFactor)return Ie.DST_ALPHA;if(e===r.OneMinusDstAlphaFactor)return Ie.ONE_MINUS_DST_ALPHA;if(e===r.DstColorFactor)return Ie.DST_COLOR;if(e===r.OneMinusDstColorFactor)return Ie.ONE_MINUS_DST_COLOR;if(e===r.SrcAlphaSaturateFactor)return Ie.SRC_ALPHA_SATURATE;if(t=He.get("WEBGL_compressed_texture_s3tc"),null!==t){if(e===r.RGB_S3TC_DXT1_Format)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===r.RGBA_S3TC_DXT1_Format)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===r.RGBA_S3TC_DXT3_Format)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===r.RGBA_S3TC_DXT5_Format)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(t=He.get("WEBGL_compressed_texture_pvrtc"),null!==t){if(e===r.RGB_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===r.RGB_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===r.RGBA_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===r.RGBA_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(t=He.get("EXT_blend_minmax"),null!==t){if(e===r.MinEquation)return t.MIN_EXT;if(e===r.MaxEquation)return t.MAX_EXT}return 0}console.log("THREE.WebGLRenderer",r.REVISION),e=e||{};var Y=void 0!==e.canvas?e.canvas:document.createElement("canvas"),Q=void 0!==e.context?e.context:null,K=Y.width,Z=Y.height,ee=1,te=void 0!==e.alpha?e.alpha:!1,ie=void 0!==e.depth?e.depth:!0,ne=void 0!==e.stencil?e.stencil:!0,re=void 0!==e.antialias?e.antialias:!1,oe=void 0!==e.premultipliedAlpha?e.premultipliedAlpha:!0,se=void 0!==e.preserveDrawingBuffer?e.preserveDrawingBuffer:!1,ae=new r.Color(0),he=0,le=[],ce=[],ue=-1,pe=[],de=-1,fe=[],me=-1,ye=[],ge=-1,ve=new Float32Array(8),be=[],_e=[];this.domElement=Y,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0;var xe=this,we=null,Se=null,Me=-1,Te="",Ee=null,ke=0,Ae=0,Ce=0,Pe=Y.width,Le=Y.height,Re=0,Oe=0,Fe=new r.Frustum,De=new r.Matrix4,Be=new r.Vector3,Ne=new r.Vector3,je=!0,Ve={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[],decays:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[],decays:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},ze={geometries:0,textures:0},Ue={calls:0,vertices:0,faces:0,points:0};this.info={render:Ue,memory:ze,programs:null};var Ie;try{var Ge={alpha:te,depth:ie,stencil:ne,antialias:re,premultipliedAlpha:oe,preserveDrawingBuffer:se};if(Ie=Q||Y.getContext("webgl",Ge)||Y.getContext("experimental-webgl",Ge),null===Ie)throw null!==Y.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";Y.addEventListener("webglcontextlost",o,!1)}catch(qe){console.error("THREE.WebGLRenderer: "+qe)}var He=new r.WebGLExtensions(Ie);He.get("OES_texture_float"),He.get("OES_texture_float_linear"),He.get("OES_texture_half_float"),He.get("OES_texture_half_float_linear"),He.get("OES_standard_derivatives"),He.get("ANGLE_instanced_arrays"),He.get("OES_element_index_uint")&&(r.BufferGeometry.MaxIndex=4294967296);var We=new r.WebGLCapabilities(Ie,He,e),$e=new r.WebGLState(Ie,He,J),Xe=new r.WebGLProperties,Je=new r.WebGLObjects(Ie,Xe,this.info),Ye=new r.WebGLPrograms(this,We);this.info.programs=Ye.programs;var Qe=new r.WebGLBufferRenderer(Ie,He,Ue),Ke=new r.WebGLIndexedBufferRenderer(Ie,He,Ue);i(),this.context=Ie,this.capabilities=We,this.extensions=He,this.state=$e;var Ze=new r.WebGLShadowMap(this,le,Je);this.shadowMap=Ze;var et=new r.SpritePlugin(this,be),tt=new r.LensFlarePlugin(this,_e);this.getContext=function(){return Ie},this.getContextAttributes=function(){return Ie.getContextAttributes()},this.forceContextLoss=function(){He.get("WEBGL_lose_context").loseContext()},this.getMaxAnisotropy=function(){var e;return function(){if(void 0!==e)return e;var t=He.get("EXT_texture_filter_anisotropic");return e=null!==t?Ie.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}}(),this.getPrecision=function(){return We.precision},this.getPixelRatio=function(){return ee},this.setPixelRatio=function(e){void 0!==e&&(ee=e)},this.getSize=function(){return{width:K,height:Z}},this.setSize=function(e,t,i){K=e,Z=t,Y.width=e*ee,Y.height=t*ee,i!==!1&&(Y.style.width=e+"px",Y.style.height=t+"px"),this.setViewport(0,0,e,t)},this.setViewport=function(e,t,i,n){Ae=e*ee,Ce=t*ee,Pe=i*ee,Le=n*ee,Ie.viewport(Ae,Ce,Pe,Le)},this.setScissor=function(e,t,i,n){Ie.scissor(e*ee,t*ee,i*ee,n*ee)},this.enableScissorTest=function(e){$e.setScissorTest(e)},this.getClearColor=function(){return ae},this.setClearColor=function(e,i){ae.set(e),he=void 0!==i?i:1,t(ae.r,ae.g,ae.b,he)},this.getClearAlpha=function(){return he},this.setClearAlpha=function(e){he=e,t(ae.r,ae.g,ae.b,he)},this.clear=function(e,t,i){var n=0;(void 0===e||e)&&(n|=Ie.COLOR_BUFFER_BIT),(void 0===t||t)&&(n|=Ie.DEPTH_BUFFER_BIT),(void 0===i||i)&&(n|=Ie.STENCIL_BUFFER_BIT),Ie.clear(n)},this.clearColor=function(){Ie.clear(Ie.COLOR_BUFFER_BIT)},this.clearDepth=function(){Ie.clear(Ie.DEPTH_BUFFER_BIT)},this.clearStencil=function(){Ie.clear(Ie.STENCIL_BUFFER_BIT)},this.clearTarget=function(e,t,i,n){this.setRenderTarget(e),this.clear(t,i,n)},this.resetGLState=n,this.dispose=function(){Y.removeEventListener("webglcontextlost",o,!1)},this.renderBufferImmediate=function(e,t,i){$e.initAttributes();var n=Xe.get(e);e.hasPositions&&!n.position&&(n.position=Ie.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=Ie.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=Ie.createBuffer()),e.hasColors&&!n.color&&(n.color=Ie.createBuffer());var o=t.getAttributes();if(e.hasPositions&&(Ie.bindBuffer(Ie.ARRAY_BUFFER,n.position),Ie.bufferData(Ie.ARRAY_BUFFER,e.positionArray,Ie.DYNAMIC_DRAW),$e.enableAttribute(o.position),Ie.vertexAttribPointer(o.position,3,Ie.FLOAT,!1,0,0)),e.hasNormals){if(Ie.bindBuffer(Ie.ARRAY_BUFFER,n.normal),"MeshPhongMaterial"!==i.type&&i.shading===r.FlatShading)for(var s=0,a=3*e.count;a>s;s+=9){var h=e.normalArray,l=(h[s+0]+h[s+3]+h[s+6])/3,c=(h[s+1]+h[s+4]+h[s+7])/3,u=(h[s+2]+h[s+5]+h[s+8])/3;h[s+0]=l,h[s+1]=c,h[s+2]=u,h[s+3]=l,h[s+4]=c,h[s+5]=u,h[s+6]=l,h[s+7]=c,h[s+8]=u}Ie.bufferData(Ie.ARRAY_BUFFER,e.normalArray,Ie.DYNAMIC_DRAW),$e.enableAttribute(o.normal),Ie.vertexAttribPointer(o.normal,3,Ie.FLOAT,!1,0,0)}e.hasUvs&&i.map&&(Ie.bindBuffer(Ie.ARRAY_BUFFER,n.uv),Ie.bufferData(Ie.ARRAY_BUFFER,e.uvArray,Ie.DYNAMIC_DRAW),$e.enableAttribute(o.uv),Ie.vertexAttribPointer(o.uv,2,Ie.FLOAT,!1,0,0)),e.hasColors&&i.vertexColors!==r.NoColors&&(Ie.bindBuffer(Ie.ARRAY_BUFFER,n.color),Ie.bufferData(Ie.ARRAY_BUFFER,e.colorArray,Ie.DYNAMIC_DRAW),$e.enableAttribute(o.color),Ie.vertexAttribPointer(o.color,3,Ie.FLOAT,!1,0,0)),$e.disableUnusedAttributes(),Ie.drawArrays(Ie.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,i,n,o,s,a){S(o);var h=T(e,t,i,o,s),l=!1,c=n.id+"_"+h.id+"_"+o.wireframe;c!==Te&&(Te=c,l=!0);var u=s.morphTargetInfluences;if(void 0!==u){for(var p=[],m=0,y=u.length;y>m;m++){var g=u[m];p.push([g,m])}p.sort(f),p.length>8&&(p.length=8);for(var v=n.morphAttributes,m=0,y=p.length;y>m;m++){var g=p[m];if(ve[m]=g[0],0!==g[0]){var b=g[1];o.morphTargets===!0&&v.position&&n.addAttribute("morphTarget"+m,v.position[b]),o.morphNormals===!0&&v.normal&&n.addAttribute("morphNormal"+m,v.normal[b])}else o.morphTargets===!0&&n.removeAttribute("morphTarget"+m),o.morphNormals===!0&&n.removeAttribute("morphNormal"+m)}var _=h.getUniforms();null!==_.morphTargetInfluences&&Ie.uniform1fv(_.morphTargetInfluences,ve),l=!0}var b=n.index,x=n.attributes.position;o.wireframe===!0&&(b=Je.getWireframeAttribute(n));var w;if(null!==b?(w=Ke,w.setIndex(b)):w=Qe,l&&(d(o,h,n),null!==b&&Ie.bindBuffer(Ie.ELEMENT_ARRAY_BUFFER,Je.getAttributeBuffer(b))),void 0===a){var M;M=null!==b?b.count:x instanceof r.InterleavedBufferAttribute?x.data.array.length/3:x.count;var E=n.drawRange;a={start:E.start,count:Math.min(E.count,M)}}if(s instanceof r.Mesh)o.wireframe===!0?($e.setLineWidth(o.wireframeLinewidth*ee),w.setMode(Ie.LINES)):w.setMode(Ie.TRIANGLES),n instanceof r.InstancedBufferGeometry&&n.maxInstancedCount>0?w.renderInstances(n):w.render(a.start,a.count);else if(s instanceof r.Line){var k=o.linewidth;void 0===k&&(k=1),$e.setLineWidth(k*ee),s instanceof r.LineSegments?w.setMode(Ie.LINES):w.setMode(Ie.LINE_STRIP),w.render(a.start,a.count)}else s instanceof r.Points&&(w.setMode(Ie.POINTS),w.render(a.start,a.count))},this.render=function(e,t,i,n){if(t instanceof r.Camera==!1)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");var o=e.fog;if(Te="",Me=-1,Ee=null,je=!0,e.autoUpdate===!0&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),t.matrixWorldInverse.getInverse(t.matrixWorld),De.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),Fe.setFromMatrix(De),le.length=0,ue=-1,de=-1,me=-1,ge=-1,be.length=0,_e.length=0,b(e),ce.length=ue+1,pe.length=de+1,fe.length=me+1,ye.length=ge+1,xe.sortObjects===!0&&(ce.sort(m),pe.sort(y)),Ze.render(e,t),Ue.calls=0,Ue.vertices=0,Ue.faces=0,Ue.points=0,this.setRenderTarget(i),(this.autoClear||n)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),e.overrideMaterial){var s=e.overrideMaterial;_(ce,t,le,o,s),_(pe,t,le,o,s),x(fe,t,le,o,s),x(ye,t,le,o,s)}else $e.setBlending(r.NoBlending),_(ce,t,le,o),x(fe,t,le,o),_(pe,t,le,o),x(ye,t,le,o);et.render(e,t),tt.render(e,t,Re,Oe),i&&i.generateMipmaps&&i.minFilter!==r.NearestFilter&&i.minFilter!==r.LinearFilter&&$(i),$e.setDepthTest(!0),$e.setDepthWrite(!0),$e.setColorWrite(!0)},this.setFaceCulling=function(e,t){e===r.CullFaceNone?$e.disable(Ie.CULL_FACE):(t===r.FrontFaceDirectionCW?Ie.frontFace(Ie.CW):Ie.frontFace(Ie.CCW),e===r.CullFaceBack?Ie.cullFace(Ie.BACK):e===r.CullFaceFront?Ie.cullFace(Ie.FRONT):Ie.cullFace(Ie.FRONT_AND_BACK),$e.enable(Ie.CULL_FACE))},this.setTexture=function(e,t){var i=Xe.get(e);if(e.version>0&&i.__version!==e.version){var n=e.image;return void 0===n?void console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",e):n.complete===!1?void console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",e):void U(i,e,t)}$e.activeTexture(Ie.TEXTURE0+t),$e.bindTexture(Ie.TEXTURE_2D,i.__webglTexture)},this.setRenderTarget=function(e){var t=e instanceof r.WebGLRenderTargetCube;if(e&&void 0===Xe.get(e).__webglFramebuffer){var i=Xe.get(e);void 0===e.depthBuffer&&(e.depthBuffer=!0),void 0===e.stencilBuffer&&(e.stencilBuffer=!0),e.addEventListener("dispose",a),i.__webglTexture=Ie.createTexture(),ze.textures++;var n=r.Math.isPowerOfTwo(e.width)&&r.Math.isPowerOfTwo(e.height),o=J(e.format),s=J(e.type);if(t){i.__webglFramebuffer=[],i.__webglRenderbuffer=[],$e.bindTexture(Ie.TEXTURE_CUBE_MAP,i.__webglTexture),z(Ie.TEXTURE_CUBE_MAP,e,n);for(var h=0;6>h;h++)i.__webglFramebuffer[h]=Ie.createFramebuffer(),i.__webglRenderbuffer[h]=Ie.createRenderbuffer(),$e.texImage2D(Ie.TEXTURE_CUBE_MAP_POSITIVE_X+h,0,o,e.width,e.height,0,o,s,null),H(i.__webglFramebuffer[h],e,Ie.TEXTURE_CUBE_MAP_POSITIVE_X+h),W(i.__webglRenderbuffer[h],e);e.generateMipmaps&&n&&Ie.generateMipmap(Ie.TEXTURE_CUBE_MAP)}else i.__webglFramebuffer=Ie.createFramebuffer(),e.shareDepthFrom?i.__webglRenderbuffer=e.shareDepthFrom.__webglRenderbuffer:i.__webglRenderbuffer=Ie.createRenderbuffer(),$e.bindTexture(Ie.TEXTURE_2D,i.__webglTexture),z(Ie.TEXTURE_2D,e,n),$e.texImage2D(Ie.TEXTURE_2D,0,o,e.width,e.height,0,o,s,null),H(i.__webglFramebuffer,e,Ie.TEXTURE_2D),e.shareDepthFrom?e.depthBuffer&&!e.stencilBuffer?Ie.framebufferRenderbuffer(Ie.FRAMEBUFFER,Ie.DEPTH_ATTACHMENT,Ie.RENDERBUFFER,i.__webglRenderbuffer):e.depthBuffer&&e.stencilBuffer&&Ie.framebufferRenderbuffer(Ie.FRAMEBUFFER,Ie.DEPTH_STENCIL_ATTACHMENT,Ie.RENDERBUFFER,i.__webglRenderbuffer):W(i.__webglRenderbuffer,e),e.generateMipmaps&&n&&Ie.generateMipmap(Ie.TEXTURE_2D);t?$e.bindTexture(Ie.TEXTURE_CUBE_MAP,null):$e.bindTexture(Ie.TEXTURE_2D,null),Ie.bindRenderbuffer(Ie.RENDERBUFFER,null),Ie.bindFramebuffer(Ie.FRAMEBUFFER,null)}var l,c,u,p,d;if(e){var i=Xe.get(e);l=t?i.__webglFramebuffer[e.activeCubeFace]:i.__webglFramebuffer,c=e.width,u=e.height,p=0,d=0}else l=null,c=Pe,u=Le,p=Ae,d=Ce;l!==Se&&(Ie.bindFramebuffer(Ie.FRAMEBUFFER,l),Ie.viewport(p,d,c,u),Se=l),Re=c,Oe=u},this.readRenderTargetPixels=function(e,t,i,n,o,s){if(!(e instanceof r.WebGLRenderTarget))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");if(Xe.get(e).__webglFramebuffer){if(e.format!==r.RGBAFormat)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA format. readPixels can read only RGBA format.");var a=!1;Xe.get(e).__webglFramebuffer!==Se&&(Ie.bindFramebuffer(Ie.FRAMEBUFFER,Xe.get(e).__webglFramebuffer),a=!0),Ie.checkFramebufferStatus(Ie.FRAMEBUFFER)===Ie.FRAMEBUFFER_COMPLETE?Ie.readPixels(t,i,n,o,Ie.RGBA,Ie.UNSIGNED_BYTE,s):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."),a&&Ie.bindFramebuffer(Ie.FRAMEBUFFER,Se)}},this.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),He.get("OES_texture_float")},this.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),He.get("OES_texture_half_float")},this.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),He.get("OES_standard_derivatives")},this.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),He.get("WEBGL_compressed_texture_s3tc")},this.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),He.get("WEBGL_compressed_texture_pvrtc")},this.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),He.get("EXT_blend_minmax")},this.supportsVertexTextures=function(){return We.vertexTextures},this.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),He.get("ANGLE_instanced_arrays")},this.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},this.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},this.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},this.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Object.defineProperties(this,{shadowMapEnabled:{get:function(){return Ze.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),Ze.enabled=e}},shadowMapType:{get:function(){return Ze.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),Ze.type=e}},shadowMapCullFace:{get:function(){return Ze.cullFace},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),Ze.cullFace=e}},shadowMapDebug:{get:function(){return Ze.debug},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapDebug is now .shadowMap.debug."),Ze.debug=e}}})},r.WebGLRenderTarget=function(e,t,i){this.uuid=r.Math.generateUUID(),this.width=e,this.height=t,i=i||{},this.wrapS=void 0!==i.wrapS?i.wrapS:r.ClampToEdgeWrapping,this.wrapT=void 0!==i.wrapT?i.wrapT:r.ClampToEdgeWrapping,this.magFilter=void 0!==i.magFilter?i.magFilter:r.LinearFilter,this.minFilter=void 0!==i.minFilter?i.minFilter:r.LinearMipMapLinearFilter,this.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,this.offset=new r.Vector2(0,0),this.repeat=new r.Vector2(1,1),this.format=void 0!==i.format?i.format:r.RGBAFormat,this.type=void 0!==i.type?i.type:r.UnsignedByteType,this.depthBuffer=void 0!==i.depthBuffer?i.depthBuffer:!0,this.stencilBuffer=void 0!==i.stencilBuffer?i.stencilBuffer:!0,this.generateMipmaps=!0,this.shareDepthFrom=void 0!==i.shareDepthFrom?i.shareDepthFrom:null},r.WebGLRenderTarget.prototype={constructor:r.WebGLRenderTarget,setSize:function(e,t){(this.width!==e||this.height!==t)&&(this.width=e,this.height=t,this.dispose())},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.format=e.format,this.type=e.type,this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.generateMipmaps=e.generateMipmaps,
this.shareDepthFrom=e.shareDepthFrom,this},dispose:function(){this.dispatchEvent({type:"dispose"})}},r.EventDispatcher.prototype.apply(r.WebGLRenderTarget.prototype),r.WebGLRenderTargetCube=function(e,t,i){r.WebGLRenderTarget.call(this,e,t,i),this.activeCubeFace=0},r.WebGLRenderTargetCube.prototype=Object.create(r.WebGLRenderTarget.prototype),r.WebGLRenderTargetCube.prototype.constructor=r.WebGLRenderTargetCube,r.WebGLBufferRenderer=function(e,t,i){function n(e){a=e}function o(t,n){e.drawArrays(a,t,n),i.calls++,i.vertices+=n,a===e.TRIANGLES&&(i.faces+=n/3)}function s(e){var i=t.get("ANGLE_instanced_arrays");if(null===i)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");var n=e.attributes.position;n instanceof r.InterleavedBufferAttribute?i.drawArraysInstancedANGLE(a,0,n.data.count,e.maxInstancedCount):i.drawArraysInstancedANGLE(a,0,n.count,e.maxInstancedCount)}var a;this.setMode=n,this.render=o,this.renderInstances=s},r.WebGLIndexedBufferRenderer=function(e,t,i){function n(e){a=e}function r(i){i.array instanceof Uint32Array&&t.get("OES_element_index_uint")?(h=e.UNSIGNED_INT,l=4):(h=e.UNSIGNED_SHORT,l=2)}function o(t,n){e.drawElements(a,n,h,t*l),i.calls++,i.vertices+=n,a===e.TRIANGLES&&(i.faces+=n/3)}function s(e){var i=t.get("ANGLE_instanced_arrays");if(null===i)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");var n=e.index;i.drawElementsInstancedANGLE(a,n.array.length,h,0,e.maxInstancedCount)}var a,h,l;this.setMode=n,this.setIndex=r,this.render=o,this.renderInstances=s},r.WebGLExtensions=function(e){var t={};this.get=function(i){if(void 0!==t[i])return t[i];var n;switch(i){case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(i)}return null===n&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),t[i]=n,n}},r.WebGLCapabilities=function(e,t,i){function n(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}this.getMaxPrecision=n,this.precision=void 0!==i.precision?i.precision:"highp",this.logarithmicDepthBuffer=void 0!==i.logarithmicDepthBuffer?i.logarithmicDepthBuffer:!1,this.maxTextures=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),this.maxVertexTextures=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.maxCubemapSize=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),this.maxAttributes=e.getParameter(e.MAX_VERTEX_ATTRIBS),this.maxVertexUniforms=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),this.maxVaryings=e.getParameter(e.MAX_VARYING_VECTORS),this.maxFragmentUniforms=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),this.vertexTextures=this.maxVertexTextures>0,this.floatFragmentTextures=!!t.get("OES_texture_float"),this.floatVertexTextures=this.vertexTextures&&this.floatFragmentTextures;var r=n(this.precision);r!==this.precision&&(console.warn("THREE.WebGLRenderer:",this.precision,"not supported, using",r,"instead."),this.precision=r),this.logarithmicDepthBuffer&&(this.logarithmicDepthBuffer=!!t.get("EXT_frag_depth"))},r.WebGLGeometries=function(e,t,i){function n(e){var t=e.geometry;if(void 0!==c[t.id])return c[t.id];t.addEventListener("dispose",o);var n;return t instanceof r.BufferGeometry?n=t:t instanceof r.Geometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new r.BufferGeometry).setFromObject(e)),n=t._bufferGeometry),c[t.id]=n,i.memory.geometries++,n}function o(e){var n=e.target,r=c[n.id];h(r.attributes),n.removeEventListener("dispose",o),delete c[n.id];var s=t.get(n);s.wireframe&&a(s.wireframe),i.memory.geometries--}function s(e){return e instanceof r.InterleavedBufferAttribute?t.get(e.data).__webglBuffer:t.get(e).__webglBuffer}function a(t){var i=s(t);void 0!==i&&(e.deleteBuffer(i),l(t))}function h(e){for(var t in e)a(e[t])}function l(e){e instanceof r.InterleavedBufferAttribute?t["delete"](e.data):t["delete"](e)}var c={};this.get=n},r.WebGLObjects=function(e,t,i){function n(t){var i=u.get(t);t.geometry instanceof r.Geometry&&i.updateFromObject(t);var n=i.index,s=i.attributes;null!==n&&o(n,e.ELEMENT_ARRAY_BUFFER);for(var a in s)o(s[a],e.ARRAY_BUFFER);var h=i.morphAttributes;for(var a in h)for(var l=h[a],c=0,p=l.length;p>c;c++)o(l[c],e.ARRAY_BUFFER);return i}function o(e,i){var n=e instanceof r.InterleavedBufferAttribute?e.data:e,o=t.get(n);void 0===o.__webglBuffer?s(o,n,i):o.version!==n.version&&a(o,n,i)}function s(t,i,n){t.__webglBuffer=e.createBuffer(),e.bindBuffer(n,t.__webglBuffer);var r=i.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW;e.bufferData(n,i.array,r),t.version=i.version}function a(t,i,n){e.bindBuffer(n,t.__webglBuffer),i.dynamic===!1||-1===i.updateRange.count?e.bufferSubData(n,0,i.array):0===i.updateRange.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(e.bufferSubData(n,i.updateRange.offset*i.array.BYTES_PER_ELEMENT,i.array.subarray(i.updateRange.offset,i.updateRange.offset+i.updateRange.count)),i.updateRange.count=0),t.version=i.version}function h(e){return e instanceof r.InterleavedBufferAttribute?t.get(e.data).__webglBuffer:t.get(e).__webglBuffer}function l(i){var n=t.get(i);if(void 0!==n.wireframe)return n.wireframe;var s=[],a=i.index,h=i.attributes,l=h.position;if(null!==a)for(var u={},p=a.array,d=0,f=p.length;f>d;d+=3){var m=p[d+0],y=p[d+1],g=p[d+2];c(u,m,y)&&s.push(m,y),c(u,y,g)&&s.push(y,g),c(u,g,m)&&s.push(g,m)}else for(var p=h.position.array,d=0,f=p.length/3-1;f>d;d+=3){var m=d+0,y=d+1,g=d+2;s.push(m,y,y,g,g,m)}var v=l.count>65535?Uint32Array:Uint16Array,b=new r.BufferAttribute(new v(s),1);return o(b,e.ELEMENT_ARRAY_BUFFER),n.wireframe=b,b}function c(e,t,i){if(t>i){var n=t;t=i,i=n}var r=e[t];return void 0===r?(e[t]=[i],!0):-1===r.indexOf(i)?(r.push(i),!0):!1}var u=new r.WebGLGeometries(e,t,i);this.getAttributeBuffer=h,this.getWireframeAttribute=l,this.update=n},r.WebGLProgram=function(){function e(e){var t=[];for(var i in e){var n=e[i];n!==!1&&t.push("#define "+i+" "+n)}return t.join("\n")}function t(e,t,i){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),o=0;r>o;o++){var s=e.getActiveUniform(t,o),a=s.name,h=e.getUniformLocation(t,a),l=a.lastIndexOf("[0]");-1!==l&&l===a.length-3&&(n[a.substr(0,l)]=h),n[a]=h}return n}function i(e,t,i){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;r>o;o++){var s=e.getActiveAttrib(t,o),a=s.name;n[a]=e.getAttribLocation(t,a)}return n}function n(e){return""!==e}var o=0;return function(s,a,h,l){var c=s.context,u=h.defines,p=h.__webglShader.vertexShader,d=h.__webglShader.fragmentShader,f="SHADOWMAP_TYPE_BASIC";l.shadowMapType===r.PCFShadowMap?f="SHADOWMAP_TYPE_PCF":l.shadowMapType===r.PCFSoftShadowMap&&(f="SHADOWMAP_TYPE_PCF_SOFT");var m="ENVMAP_TYPE_CUBE",y="ENVMAP_MODE_REFLECTION",g="ENVMAP_BLENDING_MULTIPLY";if(l.envMap){switch(h.envMap.mapping){case r.CubeReflectionMapping:case r.CubeRefractionMapping:m="ENVMAP_TYPE_CUBE";break;case r.EquirectangularReflectionMapping:case r.EquirectangularRefractionMapping:m="ENVMAP_TYPE_EQUIREC";break;case r.SphericalReflectionMapping:m="ENVMAP_TYPE_SPHERE"}switch(h.envMap.mapping){case r.CubeRefractionMapping:case r.EquirectangularRefractionMapping:y="ENVMAP_MODE_REFRACTION"}switch(h.combine){case r.MultiplyOperation:g="ENVMAP_BLENDING_MULTIPLY";break;case r.MixOperation:g="ENVMAP_BLENDING_MIX";break;case r.AddOperation:g="ENVMAP_BLENDING_ADD"}}var v,b,_=s.gammaFactor>0?s.gammaFactor:1,x=e(u),w=c.createProgram();h instanceof r.RawShaderMaterial?(v="",b=""):(v=["precision "+l.precision+" float;","precision "+l.precision+" int;","#define SHADER_NAME "+h.__webglShader.name,x,l.supportsVertexTextures?"#define VERTEX_TEXTURES":"",s.gammaInput?"#define GAMMA_INPUT":"",s.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+_,"#define MAX_DIR_LIGHTS "+l.maxDirLights,"#define MAX_POINT_LIGHTS "+l.maxPointLights,"#define MAX_SPOT_LIGHTS "+l.maxSpotLights,"#define MAX_HEMI_LIGHTS "+l.maxHemiLights,"#define MAX_SHADOWS "+l.maxShadows,"#define MAX_BONES "+l.maxBones,l.map?"#define USE_MAP":"",l.envMap?"#define USE_ENVMAP":"",l.envMap?"#define "+y:"",l.lightMap?"#define USE_LIGHTMAP":"",l.aoMap?"#define USE_AOMAP":"",l.emissiveMap?"#define USE_EMISSIVEMAP":"",l.bumpMap?"#define USE_BUMPMAP":"",l.normalMap?"#define USE_NORMALMAP":"",l.displacementMap&&l.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",l.specularMap?"#define USE_SPECULARMAP":"",l.alphaMap?"#define USE_ALPHAMAP":"",l.vertexColors?"#define USE_COLOR":"",l.flatShading?"#define FLAT_SHADED":"",l.skinning?"#define USE_SKINNING":"",l.useVertexTexture?"#define BONE_TEXTURE":"",l.morphTargets?"#define USE_MORPHTARGETS":"",l.morphNormals&&l.flatShading===!1?"#define USE_MORPHNORMALS":"",l.doubleSided?"#define DOUBLE_SIDED":"",l.flipSided?"#define FLIP_SIDED":"",l.shadowMapEnabled?"#define USE_SHADOWMAP":"",l.shadowMapEnabled?"#define "+f:"",l.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",l.sizeAttenuation?"#define USE_SIZEATTENUATION":"",l.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",l.logarithmicDepthBuffer&&s.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif","\n"].filter(n).join("\n"),b=[l.bumpMap||l.normalMap||l.flatShading||h.derivatives?"#extension GL_OES_standard_derivatives : enable":"",l.logarithmicDepthBuffer&&s.extensions.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"","precision "+l.precision+" float;","precision "+l.precision+" int;","#define SHADER_NAME "+h.__webglShader.name,x,"#define MAX_DIR_LIGHTS "+l.maxDirLights,"#define MAX_POINT_LIGHTS "+l.maxPointLights,"#define MAX_SPOT_LIGHTS "+l.maxSpotLights,"#define MAX_HEMI_LIGHTS "+l.maxHemiLights,"#define MAX_SHADOWS "+l.maxShadows,l.alphaTest?"#define ALPHATEST "+l.alphaTest:"",s.gammaInput?"#define GAMMA_INPUT":"",s.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+_,l.useFog&&l.fog?"#define USE_FOG":"",l.useFog&&l.fogExp?"#define FOG_EXP2":"",l.map?"#define USE_MAP":"",l.envMap?"#define USE_ENVMAP":"",l.envMap?"#define "+m:"",l.envMap?"#define "+y:"",l.envMap?"#define "+g:"",l.lightMap?"#define USE_LIGHTMAP":"",l.aoMap?"#define USE_AOMAP":"",l.emissiveMap?"#define USE_EMISSIVEMAP":"",l.bumpMap?"#define USE_BUMPMAP":"",l.normalMap?"#define USE_NORMALMAP":"",l.specularMap?"#define USE_SPECULARMAP":"",l.alphaMap?"#define USE_ALPHAMAP":"",l.vertexColors?"#define USE_COLOR":"",l.flatShading?"#define FLAT_SHADED":"",l.metal?"#define METAL":"",l.doubleSided?"#define DOUBLE_SIDED":"",l.flipSided?"#define FLIP_SIDED":"",l.shadowMapEnabled?"#define USE_SHADOWMAP":"",l.shadowMapEnabled?"#define "+f:"",l.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",l.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",l.logarithmicDepthBuffer&&s.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","\n"].filter(n).join("\n"));var S=v+p,M=b+d,T=r.WebGLShader(c,c.VERTEX_SHADER,S),E=r.WebGLShader(c,c.FRAGMENT_SHADER,M);c.attachShader(w,T),c.attachShader(w,E),void 0!==h.index0AttributeName?c.bindAttribLocation(w,0,h.index0AttributeName):l.morphTargets===!0&&c.bindAttribLocation(w,0,"position"),c.linkProgram(w);var k=c.getProgramInfoLog(w),A=c.getShaderInfoLog(T),C=c.getShaderInfoLog(E),P=!0,L=!0;c.getProgramParameter(w,c.LINK_STATUS)===!1?(P=!1,console.error("THREE.WebGLProgram: shader error: ",c.getError(),"gl.VALIDATE_STATUS",c.getProgramParameter(w,c.VALIDATE_STATUS),"gl.getProgramInfoLog",k,A,C)):""!==k?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",k):(""===A||""===C)&&(L=!1),L&&(this.diagnostics={runnable:P,material:h,programLog:k,vertexShader:{log:A,prefix:v},fragmentShader:{log:C,prefix:b}}),c.deleteShader(T),c.deleteShader(E);var R;this.getUniforms=function(){return void 0===R&&(R=t(c,w)),R};var O;return this.getAttributes=function(){return void 0===O&&(O=i(c,w)),O},this.destroy=function(){c.deleteProgram(w),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=o++,this.code=a,this.usedTimes=1,this.program=w,this.vertexShader=T,this.fragmentShader=E,this}}(),r.WebGLPrograms=function(e,t){function i(e){if(t.floatVertexTextures&&e&&e.skeleton&&e.skeleton.useVertexTexture)return 1024;var i=t.maxVertexUniforms,n=Math.floor((i-20)/4),o=n;return void 0!==e&&e instanceof r.SkinnedMesh&&(o=Math.min(e.skeleton.bones.length,o),o<e.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+e.skeleton.bones.length+", this GPU supports just "+o+" (try OpenGL instead of ANGLE)")),o}function n(e){for(var t=0,i=0,n=0,o=0,s=0,a=e.length;a>s;s++){var h=e[s];h.onlyShadow||h.visible===!1||(h instanceof r.DirectionalLight&&t++,h instanceof r.PointLight&&i++,h instanceof r.SpotLight&&n++,h instanceof r.HemisphereLight&&o++)}return{directional:t,point:i,spot:n,hemi:o}}function o(e){for(var t=0,i=0,n=e.length;n>i;i++){var o=e[i];o.castShadow&&(o instanceof r.SpotLight&&t++,o instanceof r.DirectionalLight&&t++)}return t}var s=[],a={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},h=["precision","supportsVertexTextures","map","envMap","envMapMode","lightMap","aoMap","emissiveMap","bumpMap","normalMap","specularMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","maxDirLights","maxPointLights","maxSpotLights","maxHemiLights","maxShadows","shadowMapEnabled","shadowMapType","shadowMapDebug","alphaTest","metal","doubleSided","flipSided"];this.getParameters=function(s,h,l,c){var u=a[s.type],p=n(h),d=o(h),f=i(c),m=e.getPrecision();null!==s.precision&&(m=t.getMaxPrecision(s.precision),m!==s.precision&&console.warn("THREE.WebGLRenderer.initMaterial:",s.precision,"not supported, using",m,"instead."));var y={shaderID:u,precision:m,supportsVertexTextures:t.vertexTextures,map:!!s.map,envMap:!!s.envMap,envMapMode:s.envMap&&s.envMap.mapping,lightMap:!!s.lightMap,aoMap:!!s.aoMap,emissiveMap:!!s.emissiveMap,bumpMap:!!s.bumpMap,normalMap:!!s.normalMap,displacementMap:!!s.displacementMap,specularMap:!!s.specularMap,alphaMap:!!s.alphaMap,combine:s.combine,vertexColors:s.vertexColors,fog:l,useFog:s.fog,fogExp:l instanceof r.FogExp2,flatShading:s.shading===r.FlatShading,sizeAttenuation:s.sizeAttenuation,logarithmicDepthBuffer:t.logarithmicDepthBuffer,skinning:s.skinning,maxBones:f,useVertexTexture:t.floatVertexTextures&&c&&c.skeleton&&c.skeleton.useVertexTexture,morphTargets:s.morphTargets,morphNormals:s.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,maxDirLights:p.directional,maxPointLights:p.point,maxSpotLights:p.spot,maxHemiLights:p.hemi,maxShadows:d,shadowMapEnabled:e.shadowMap.enabled&&c.receiveShadow&&d>0,shadowMapType:e.shadowMap.type,shadowMapDebug:e.shadowMap.debug,alphaTest:s.alphaTest,metal:s.metal,doubleSided:s.side===r.DoubleSide,flipSided:s.side===r.BackSide};return y},this.getProgramCode=function(e,t){var i=[];if(t.shaderID?i.push(t.shaderID):(i.push(e.fragmentShader),i.push(e.vertexShader)),void 0!==e.defines)for(var n in e.defines)i.push(n),i.push(e.defines[n]);for(var r=0;r<h.length;r++){var o=h[r];i.push(o),i.push(t[o])}return i.join()},this.acquireProgram=function(t,i,n){for(var o,a=0,h=s.length;h>a;a++){var l=s[a];if(l.code===n){o=l,++o.usedTimes;break}}return void 0===o&&(o=new r.WebGLProgram(e,n,t,i),s.push(o)),o},this.releaseProgram=function(e){if(0===--e.usedTimes){var t=s.indexOf(e);s[t]=s[s.length-1],s.pop(),e.destroy()}},this.programs=s},r.WebGLProperties=function(){var e={};this.get=function(t){var i=t.uuid,n=e[i];return void 0===n&&(n={},e[i]=n),n},this["delete"]=function(t){delete e[t.uuid]},this.clear=function(){e={}}},r.WebGLShader=function(){var e=function(e){for(var t=e.split("\n"),i=0;i<t.length;i++)t[i]=i+1+": "+t[i];return t.join("\n")};return function(t,i,n){var r=t.createShader(i);return t.shaderSource(r,n),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)===!1&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(r)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",i===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(r),e(n)),r}}(),r.WebGLShadowMap=function(e,t,i){function n(e,t){var i,n=e.geometry,o=void 0!==n.morphTargets&&n.morphTargets.length>0&&t.morphTargets,s=e instanceof r.SkinnedMesh&&t.skinning;return i=e.customDepthMaterial?e.customDepthMaterial:s?o?g:y:o?m:f,i.visible=t.visible,i.wireframe=t.wireframe,i.wireframeLinewidth=t.wireframeLinewidth,i}function o(e,t){if(e.visible!==!1){if((e instanceof r.Mesh||e instanceof r.Line||e instanceof r.Points)&&e.castShadow&&(e.frustumCulled===!1||h.intersectsObject(e)===!0)){var i=e.material;i.visible===!0&&(e.modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld),u.push(e))}for(var n=e.children,s=0,a=n.length;a>s;s++)o(n[s],t)}}var s=e.context,a=e.state,h=new r.Frustum,l=new r.Matrix4,c=(new r.Vector3,new r.Vector3,new r.Vector3),u=[],p=r.ShaderLib.depthRGBA,d=r.UniformsUtils.clone(p.uniforms),f=new r.ShaderMaterial({uniforms:d,vertexShader:p.vertexShader,fragmentShader:p.fragmentShader}),m=new r.ShaderMaterial({uniforms:d,vertexShader:p.vertexShader,fragmentShader:p.fragmentShader,morphTargets:!0}),y=new r.ShaderMaterial({uniforms:d,vertexShader:p.vertexShader,fragmentShader:p.fragmentShader,skinning:!0}),g=new r.ShaderMaterial({uniforms:d,vertexShader:p.vertexShader,fragmentShader:p.fragmentShader,morphTargets:!0,skinning:!0});f._shadowPass=!0,m._shadowPass=!0,y._shadowPass=!0,g._shadowPass=!0;var v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=r.PCFShadowMap,this.cullFace=r.CullFaceFront,this.render=function(p,d){if(v.enabled!==!1&&(v.autoUpdate!==!1||v.needsUpdate!==!1)){s.clearColor(1,1,1,1),a.disable(s.BLEND),a.enable(s.CULL_FACE),s.frontFace(s.CCW),v.cullFace===r.CullFaceFront?s.cullFace(s.FRONT):s.cullFace(s.BACK),a.setDepthTest(!0);for(var f=0,m=t.length;m>f;f++){var y=t[f];if(y.castShadow){if(!y.shadowMap){var g=r.LinearFilter;v.type===r.PCFSoftShadowMap&&(g=r.NearestFilter);var b={minFilter:g,magFilter:g,format:r.RGBAFormat};y.shadowMap=new r.WebGLRenderTarget(y.shadowMapWidth,y.shadowMapHeight,b),y.shadowMapSize=new r.Vector2(y.shadowMapWidth,y.shadowMapHeight),y.shadowMatrix=new r.Matrix4}if(!y.shadowCamera){if(y instanceof r.SpotLight)y.shadowCamera=new r.PerspectiveCamera(y.shadowCameraFov,y.shadowMapWidth/y.shadowMapHeight,y.shadowCameraNear,y.shadowCameraFar);else{if(!(y instanceof r.DirectionalLight)){console.error("THREE.ShadowMapPlugin: Unsupported light type for shadow",y);continue}y.shadowCamera=new r.OrthographicCamera(y.shadowCameraLeft,y.shadowCameraRight,y.shadowCameraTop,y.shadowCameraBottom,y.shadowCameraNear,y.shadowCameraFar)}p.add(y.shadowCamera),p.autoUpdate===!0&&p.updateMatrixWorld()}y.shadowCameraVisible&&!y.cameraHelper&&(y.cameraHelper=new r.CameraHelper(y.shadowCamera),p.add(y.cameraHelper));var _=y.shadowMap,x=y.shadowMatrix,w=y.shadowCamera;w.position.setFromMatrixPosition(y.matrixWorld),c.setFromMatrixPosition(y.target.matrixWorld),w.lookAt(c),w.updateMatrixWorld(),w.matrixWorldInverse.getInverse(w.matrixWorld),y.cameraHelper&&(y.cameraHelper.visible=y.shadowCameraVisible),y.shadowCameraVisible&&y.cameraHelper.update(),x.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),x.multiply(w.projectionMatrix),x.multiply(w.matrixWorldInverse),l.multiplyMatrices(w.projectionMatrix,w.matrixWorldInverse),h.setFromMatrix(l),e.setRenderTarget(_),e.clear(),u.length=0,o(p,w);for(var S=0,M=u.length;M>S;S++){var T=u[S],E=i.update(T),k=T.material;if(k instanceof r.MeshFaceMaterial)for(var A=E.groups,C=k.materials,P=0,L=A.length;L>P;P++){var R=A[P],O=C[R.materialIndex];O.visible===!0&&e.renderBufferDirect(w,t,null,E,n(T,O),T,R)}else e.renderBufferDirect(w,t,null,E,n(T,k),T)}}}var F=e.getClearColor(),D=e.getClearAlpha();e.setClearColor(F,D),a.enable(s.BLEND),v.cullFace===r.CullFaceFront&&s.cullFace(s.BACK),e.resetGLState(),v.needsUpdate=!1}}},r.WebGLState=function(e,t,i){var n=this,o=new Uint8Array(16),s=new Uint8Array(16),a={},h=null,l=null,c=null,u=null,p=null,d=null,f=null,m=null,y=null,g=null,v=null,b=null,_=null,x=null,w=null,S=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),M=void 0,T={};this.init=function(){e.clearColor(0,0,0,1),e.clearDepth(1),e.clearStencil(0),this.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.frontFace(e.CCW),e.cullFace(e.BACK),this.enable(e.CULL_FACE),this.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA)},this.initAttributes=function(){for(var e=0,t=o.length;t>e;e++)o[e]=0},this.enableAttribute=function(t){o[t]=1,0===s[t]&&(e.enableVertexAttribArray(t),s[t]=1)},this.disableUnusedAttributes=function(){for(var t=0,i=s.length;i>t;t++)s[t]!==o[t]&&(e.disableVertexAttribArray(t),s[t]=0)},this.enable=function(t){a[t]!==!0&&(e.enable(t),a[t]=!0)},this.disable=function(t){a[t]!==!1&&(e.disable(t),a[t]=!1)},this.getCompressedTextureFormats=function(){if(null===h&&(h=[],t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")))for(var i=e.getParameter(e.COMPRESSED_TEXTURE_FORMATS),n=0;n<i.length;n++)h.push(i[n]);return h},this.setBlending=function(t,n,o,s,a,h,y){t!==l&&(t===r.NoBlending?this.disable(e.BLEND):t===r.AdditiveBlending?(this.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE)):t===r.SubtractiveBlending?(this.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR)):t===r.MultiplyBlending?(this.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.SRC_COLOR)):t===r.CustomBlending?this.enable(e.BLEND):(this.enable(e.BLEND),e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)),l=t),t===r.CustomBlending?(a=a||n,h=h||o,y=y||s,(n!==c||a!==d)&&(e.blendEquationSeparate(i(n),i(a)),c=n,d=a),(o!==u||s!==p||h!==f||y!==m)&&(e.blendFuncSeparate(i(o),i(s),i(h),i(y)),u=o,p=s,f=h,m=y)):(c=null,u=null,p=null,d=null,f=null,m=null)},this.setDepthFunc=function(t){if(y!==t){if(t)switch(t){case r.NeverDepth:e.depthFunc(e.NEVER);break;case r.AlwaysDepth:e.depthFunc(e.ALWAYS);break;case r.LessDepth:e.depthFunc(e.LESS);break;case r.LessEqualDepth:e.depthFunc(e.LEQUAL);break;case r.EqualDepth:e.depthFunc(e.EQUAL);break;case r.GreaterEqualDepth:e.depthFunc(e.GEQUAL);break;case r.GreaterDepth:e.depthFunc(e.GREATER);break;case r.NotEqualDepth:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}else e.depthFunc(e.LEQUAL);y=t}},this.setDepthTest=function(t){t?this.enable(e.DEPTH_TEST):this.disable(e.DEPTH_TEST)},this.setDepthWrite=function(t){g!==t&&(e.depthMask(t),g=t)},this.setColorWrite=function(t){v!==t&&(e.colorMask(t,t,t,t),v=t)},this.setFlipSided=function(t){b!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),b=t)},this.setLineWidth=function(t){t!==_&&(e.lineWidth(t),_=t)},this.setPolygonOffset=function(t,i,n){t?this.enable(e.POLYGON_OFFSET_FILL):this.disable(e.POLYGON_OFFSET_FILL),!t||x===i&&w===n||(e.polygonOffset(i,n),x=i,w=n)},this.setScissorTest=function(t){t?this.enable(e.SCISSOR_TEST):this.disable(e.SCISSOR_TEST)},this.activeTexture=function(t){void 0===t&&(t=e.TEXTURE0+S-1),M!==t&&(e.activeTexture(t),M=t)},this.bindTexture=function(t,i){void 0===M&&n.activeTexture();var r=T[M];void 0===r&&(r={type:void 0,texture:void 0},T[M]=r),(r.type!==t||r.texture!==i)&&(e.bindTexture(t,i),r.type=t,r.texture=i)},this.compressedTexImage2D=function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(t){console.error(t)}},this.texImage2D=function(){try{e.texImage2D.apply(e,arguments)}catch(t){console.error(t)}},this.reset=function(){for(var t=0;t<s.length;t++)1===s[t]&&(e.disableVertexAttribArray(t),s[t]=0);a={},h=null,l=null,g=null,v=null,b=null}},r.LensFlarePlugin=function(e,t){function i(t){var i=p.createProgram(),n=p.createShader(p.FRAGMENT_SHADER),r=p.createShader(p.VERTEX_SHADER),o="precision "+e.getPrecision()+" float;\n";return p.shaderSource(n,o+t.fragmentShader),p.shaderSource(r,o+t.vertexShader),p.compileShader(n),p.compileShader(r),p.attachShader(i,n),p.attachShader(i,r),p.linkProgram(i),i}var n,o,s,a,h,l,c,u,p=e.context,d=e.state,f=function(){var e=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),t=new Uint16Array([0,1,2,0,2,3]);n=p.createBuffer(),o=p.createBuffer(),p.bindBuffer(p.ARRAY_BUFFER,n),p.bufferData(p.ARRAY_BUFFER,e,p.STATIC_DRAW),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,o),p.bufferData(p.ELEMENT_ARRAY_BUFFER,t,p.STATIC_DRAW),c=p.createTexture(),u=p.createTexture(),d.bindTexture(p.TEXTURE_2D,c),p.texImage2D(p.TEXTURE_2D,0,p.RGB,16,16,0,p.RGB,p.UNSIGNED_BYTE,null),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),d.bindTexture(p.TEXTURE_2D,u),p.texImage2D(p.TEXTURE_2D,0,p.RGBA,16,16,0,p.RGBA,p.UNSIGNED_BYTE,null),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),l=p.getParameter(p.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;var r;r=l?{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")}:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision mediump float;","uniform lowp int renderType;","uniform sampler2D map;","uniform sampler2D occlusionMap;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;","visibility = ( 1.0 - visibility / 4.0 );","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * visibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},s=i(r),a={vertex:p.getAttribLocation(s,"position"),uv:p.getAttribLocation(s,"uv")},h={renderType:p.getUniformLocation(s,"renderType"),map:p.getUniformLocation(s,"map"),occlusionMap:p.getUniformLocation(s,"occlusionMap"),opacity:p.getUniformLocation(s,"opacity"),color:p.getUniformLocation(s,"color"),scale:p.getUniformLocation(s,"scale"),rotation:p.getUniformLocation(s,"rotation"),screenPosition:p.getUniformLocation(s,"screenPosition")}};this.render=function(i,m,y,g){if(0!==t.length){var v=new r.Vector3,b=g/y,_=.5*y,x=.5*g,w=16/g,S=new r.Vector2(w*b,w),M=new r.Vector3(1,1,0),T=new r.Vector2(1,1);void 0===s&&f(),p.useProgram(s),d.initAttributes(),d.enableAttribute(a.vertex),d.enableAttribute(a.uv),d.disableUnusedAttributes(),p.uniform1i(h.occlusionMap,0),p.uniform1i(h.map,1),p.bindBuffer(p.ARRAY_BUFFER,n),p.vertexAttribPointer(a.vertex,2,p.FLOAT,!1,16,0),p.vertexAttribPointer(a.uv,2,p.FLOAT,!1,16,8),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,o),d.disable(p.CULL_FACE),p.depthMask(!1);for(var E=0,k=t.length;k>E;E++){w=16/g,S.set(w*b,w);var A=t[E];if(v.set(A.matrixWorld.elements[12],A.matrixWorld.elements[13],A.matrixWorld.elements[14]),v.applyMatrix4(m.matrixWorldInverse),v.applyProjection(m.projectionMatrix),M.copy(v),T.x=M.x*_+_,T.y=M.y*x+x,l||T.x>0&&T.x<y&&T.y>0&&T.y<g){d.activeTexture(p.TEXTURE0),d.bindTexture(p.TEXTURE_2D,null),d.activeTexture(p.TEXTURE1),
d.bindTexture(p.TEXTURE_2D,c),p.copyTexImage2D(p.TEXTURE_2D,0,p.RGB,T.x-8,T.y-8,16,16,0),p.uniform1i(h.renderType,0),p.uniform2f(h.scale,S.x,S.y),p.uniform3f(h.screenPosition,M.x,M.y,M.z),d.disable(p.BLEND),d.enable(p.DEPTH_TEST),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0),d.activeTexture(p.TEXTURE0),d.bindTexture(p.TEXTURE_2D,u),p.copyTexImage2D(p.TEXTURE_2D,0,p.RGBA,T.x-8,T.y-8,16,16,0),p.uniform1i(h.renderType,1),d.disable(p.DEPTH_TEST),d.activeTexture(p.TEXTURE1),d.bindTexture(p.TEXTURE_2D,c),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0),A.positionScreen.copy(M),A.customUpdateCallback?A.customUpdateCallback(A):A.updateLensFlares(),p.uniform1i(h.renderType,2),d.enable(p.BLEND);for(var C=0,P=A.lensFlares.length;P>C;C++){var L=A.lensFlares[C];L.opacity>.001&&L.scale>.001&&(M.x=L.x,M.y=L.y,M.z=L.z,w=L.size*L.scale/g,S.x=w*b,S.y=w,p.uniform3f(h.screenPosition,M.x,M.y,M.z),p.uniform2f(h.scale,S.x,S.y),p.uniform1f(h.rotation,L.rotation),p.uniform1f(h.opacity,L.opacity),p.uniform3f(h.color,L.color.r,L.color.g,L.color.b),d.setBlending(L.blending,L.blendEquation,L.blendSrc,L.blendDst),e.setTexture(L.texture,1),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0))}}}d.enable(p.CULL_FACE),d.enable(p.DEPTH_TEST),p.depthMask(!0),e.resetGLState()}}},r.SpritePlugin=function(e,t){function i(){var t=u.createProgram(),i=u.createShader(u.VERTEX_SHADER),n=u.createShader(u.FRAGMENT_SHADER);return u.shaderSource(i,["precision "+e.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),u.shaderSource(n,["precision "+e.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),u.compileShader(i),u.compileShader(n),u.attachShader(t,i),u.attachShader(t,n),u.linkProgram(t),t}function n(e,t){return e.z!==t.z?t.z-e.z:t.id-e.id}var o,s,a,h,l,c,u=e.context,p=e.state,d=new r.Vector3,f=new r.Quaternion,m=new r.Vector3,y=function(){var e=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),t=new Uint16Array([0,1,2,0,2,3]);o=u.createBuffer(),s=u.createBuffer(),u.bindBuffer(u.ARRAY_BUFFER,o),u.bufferData(u.ARRAY_BUFFER,e,u.STATIC_DRAW),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,s),u.bufferData(u.ELEMENT_ARRAY_BUFFER,t,u.STATIC_DRAW),a=i(),h={position:u.getAttribLocation(a,"position"),uv:u.getAttribLocation(a,"uv")},l={uvOffset:u.getUniformLocation(a,"uvOffset"),uvScale:u.getUniformLocation(a,"uvScale"),rotation:u.getUniformLocation(a,"rotation"),scale:u.getUniformLocation(a,"scale"),color:u.getUniformLocation(a,"color"),map:u.getUniformLocation(a,"map"),opacity:u.getUniformLocation(a,"opacity"),modelViewMatrix:u.getUniformLocation(a,"modelViewMatrix"),projectionMatrix:u.getUniformLocation(a,"projectionMatrix"),fogType:u.getUniformLocation(a,"fogType"),fogDensity:u.getUniformLocation(a,"fogDensity"),fogNear:u.getUniformLocation(a,"fogNear"),fogFar:u.getUniformLocation(a,"fogFar"),fogColor:u.getUniformLocation(a,"fogColor"),alphaTest:u.getUniformLocation(a,"alphaTest")};var n=document.createElement("canvas");n.width=8,n.height=8;var p=n.getContext("2d");p.fillStyle="white",p.fillRect(0,0,8,8),c=new r.Texture(n),c.needsUpdate=!0};this.render=function(i,g){if(0!==t.length){void 0===a&&y(),u.useProgram(a),p.initAttributes(),p.enableAttribute(h.position),p.enableAttribute(h.uv),p.disableUnusedAttributes(),p.disable(u.CULL_FACE),p.enable(u.BLEND),u.bindBuffer(u.ARRAY_BUFFER,o),u.vertexAttribPointer(h.position,2,u.FLOAT,!1,16,0),u.vertexAttribPointer(h.uv,2,u.FLOAT,!1,16,8),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,s),u.uniformMatrix4fv(l.projectionMatrix,!1,g.projectionMatrix.elements),p.activeTexture(u.TEXTURE0),u.uniform1i(l.map,0);var v=0,b=0,_=i.fog;_?(u.uniform3f(l.fogColor,_.color.r,_.color.g,_.color.b),_ instanceof r.Fog?(u.uniform1f(l.fogNear,_.near),u.uniform1f(l.fogFar,_.far),u.uniform1i(l.fogType,1),v=1,b=1):_ instanceof r.FogExp2&&(u.uniform1f(l.fogDensity,_.density),u.uniform1i(l.fogType,2),v=2,b=2)):(u.uniform1i(l.fogType,0),v=0,b=0);for(var x=0,w=t.length;w>x;x++){var S=t[x];S.modelViewMatrix.multiplyMatrices(g.matrixWorldInverse,S.matrixWorld),S.z=-S.modelViewMatrix.elements[14]}t.sort(n);for(var M=[],x=0,w=t.length;w>x;x++){var S=t[x],T=S.material;u.uniform1f(l.alphaTest,T.alphaTest),u.uniformMatrix4fv(l.modelViewMatrix,!1,S.modelViewMatrix.elements),S.matrixWorld.decompose(d,f,m),M[0]=m.x,M[1]=m.y;var E=0;i.fog&&T.fog&&(E=b),v!==E&&(u.uniform1i(l.fogType,E),v=E),null!==T.map?(u.uniform2f(l.uvOffset,T.map.offset.x,T.map.offset.y),u.uniform2f(l.uvScale,T.map.repeat.x,T.map.repeat.y)):(u.uniform2f(l.uvOffset,0,0),u.uniform2f(l.uvScale,1,1)),u.uniform1f(l.opacity,T.opacity),u.uniform3f(l.color,T.color.r,T.color.g,T.color.b),u.uniform1f(l.rotation,T.rotation),u.uniform2fv(l.scale,M),p.setBlending(T.blending,T.blendEquation,T.blendSrc,T.blendDst),p.setDepthTest(T.depthTest),p.setDepthWrite(T.depthWrite),T.map&&T.map.image&&T.map.image.width?e.setTexture(T.map,0):e.setTexture(c,0),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0)}p.enable(u.CULL_FACE),e.resetGLState()}}},r.GeometryUtils={merge:function(e,t,i){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var n;t instanceof r.Mesh&&(t.matrixAutoUpdate&&t.updateMatrix(),n=t.matrix,t=t.geometry),e.merge(t,n,i)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},r.ImageUtils={crossOrigin:void 0,loadTexture:function(e,t,i,n){var o=new r.ImageLoader;o.crossOrigin=this.crossOrigin;var s=new r.Texture(void 0,t);return o.load(e,function(e){s.image=e,s.needsUpdate=!0,i&&i(s)},void 0,function(e){n&&n(e)}),s.sourceFile=e,s},loadTextureCube:function(e,t,i,n){var o=[],s=new r.ImageLoader;s.crossOrigin=this.crossOrigin;for(var a=new r.CubeTexture(o,t),h=0,l=function(t){s.load(e[t],function(e){a.images[t]=e,h+=1,6===h&&(a.needsUpdate=!0,i&&i(a))},void 0,n)},c=0,u=e.length;u>c;++c)l(c);return a},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},getNormalMap:function(e,t){var i=function(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]},n=function(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]},r=function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return[e[0]/t,e[1]/t,e[2]/t]};t=1|t;var o=e.width,s=e.height,a=document.createElement("canvas");a.width=o,a.height=s;var h=a.getContext("2d");h.drawImage(e,0,0);for(var l=h.getImageData(0,0,o,s).data,c=h.createImageData(o,s),u=c.data,p=0;o>p;p++)for(var d=0;s>d;d++){var f=0>d-1?0:d-1,m=d+1>s-1?s-1:d+1,y=0>p-1?0:p-1,g=p+1>o-1?o-1:p+1,v=[],b=[0,0,l[4*(d*o+p)]/255*t];v.push([-1,0,l[4*(d*o+y)]/255*t]),v.push([-1,-1,l[4*(f*o+y)]/255*t]),v.push([0,-1,l[4*(f*o+p)]/255*t]),v.push([1,-1,l[4*(f*o+g)]/255*t]),v.push([1,0,l[4*(d*o+g)]/255*t]),v.push([1,1,l[4*(m*o+g)]/255*t]),v.push([0,1,l[4*(m*o+p)]/255*t]),v.push([-1,1,l[4*(m*o+y)]/255*t]);for(var _=[],x=v.length,w=0;x>w;w++){var S=v[w],M=v[(w+1)%x];S=n(S,b),M=n(M,b),_.push(r(i(S,M)))}for(var T=[0,0,0],w=0;w<_.length;w++)T[0]+=_[w][0],T[1]+=_[w][1],T[2]+=_[w][2];T[0]/=_.length,T[1]/=_.length,T[2]/=_.length;var E=4*(d*o+p);u[E]=(T[0]+1)/2*255|0,u[E+1]=(T[1]+1)/2*255|0,u[E+2]=255*T[2]|0,u[E+3]=255}return h.putImageData(c,0,0),a},generateDataTexture:function(e,t,i){for(var n=e*t,o=new Uint8Array(3*n),s=Math.floor(255*i.r),a=Math.floor(255*i.g),h=Math.floor(255*i.b),l=0;n>l;l++)o[3*l]=s,o[3*l+1]=a,o[3*l+2]=h;var c=new r.DataTexture(o,e,t,r.RGBFormat);return c.needsUpdate=!0,c}},r.SceneUtils={createMultiMaterialObject:function(e,t){for(var i=new r.Group,n=0,o=t.length;o>n;n++)i.add(new r.Mesh(e,t[n]));return i},detach:function(e,t,i){e.applyMatrix(t.matrixWorld),t.remove(e),i.add(e)},attach:function(e,t,i){var n=new r.Matrix4;n.getInverse(i.matrixWorld),e.applyMatrix(n),t.remove(e),i.add(e)}},r.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){try{return this.faces[this.face.toLowerCase()][this.weight][this.style]}catch(e){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(e){var t=e.familyName.toLowerCase(),i=this;return i.faces[t]=i.faces[t]||{},i.faces[t][e.cssFontWeight]=i.faces[t][e.cssFontWeight]||{},i.faces[t][e.cssFontWeight][e.cssFontStyle]=e,i.faces[t][e.cssFontWeight][e.cssFontStyle]=e,e},drawText:function(e){var t,i=this.getFace(),n=this.size/i.resolution,o=0,s=String(e).split(""),a=s.length,h=[];for(t=0;a>t;t++){var l=new r.Path,c=this.extractGlyphPoints(s[t],i,n,o,l);o+=c.offset,h.push(c.path)}var u=o/2;return{paths:h,offset:u}},extractGlyphPoints:function(e,t,i,n,o){var s,a,h,l,c,u,p,d,f,m,y,g,v,b,_,x,w,S,M,T=[],E=t.glyphs[e]||t.glyphs["?"];if(E){if(E.o)for(l=E._cachedOutline||(E._cachedOutline=E.o.split(" ")),u=l.length,p=i,d=i,s=0;u>s;)switch(c=l[s++]){case"m":f=l[s++]*p+n,m=l[s++]*d,o.moveTo(f,m);break;case"l":f=l[s++]*p+n,m=l[s++]*d,o.lineTo(f,m);break;case"q":if(y=l[s++]*p+n,g=l[s++]*d,_=l[s++]*p+n,x=l[s++]*d,o.quadraticCurveTo(_,x,y,g),M=T[T.length-1])for(v=M.x,b=M.y,a=1,h=this.divisions;h>=a;a++){var k=a/h;r.Shape.Utils.b2(k,v,_,y),r.Shape.Utils.b2(k,b,x,g)}break;case"b":if(y=l[s++]*p+n,g=l[s++]*d,_=l[s++]*p+n,x=l[s++]*d,w=l[s++]*p+n,S=l[s++]*d,o.bezierCurveTo(_,x,w,S,y,g),M=T[T.length-1])for(v=M.x,b=M.y,a=1,h=this.divisions;h>=a;a++){var k=a/h;r.Shape.Utils.b3(k,v,_,w,y),r.Shape.Utils.b3(k,b,x,S,g)}}return{offset:E.ha*i,path:o}}}},r.FontUtils.generateShapes=function(e,t){t=t||{};var i=void 0!==t.size?t.size:100,n=void 0!==t.curveSegments?t.curveSegments:4,o=void 0!==t.font?t.font:"helvetiker",s=void 0!==t.weight?t.weight:"normal",a=void 0!==t.style?t.style:"normal";r.FontUtils.size=i,r.FontUtils.divisions=n,r.FontUtils.face=o,r.FontUtils.weight=s,r.FontUtils.style=a;for(var h=r.FontUtils.drawText(e),l=h.paths,c=[],u=0,p=l.length;p>u;u++)Array.prototype.push.apply(c,l[u].toShapes());return c},function(e){var t=1e-10,i=function(e,t){var i=e.length;if(3>i)return null;var o,s,a,h=[],l=[],c=[];if(n(e)>0)for(s=0;i>s;s++)l[s]=s;else for(s=0;i>s;s++)l[s]=i-1-s;var u=i,p=2*u;for(s=u-1;u>2;){if(p--<=0)return console.warn("THREE.FontUtils: Warning, unable to triangulate polygon! in Triangulate.process()"),t?c:h;if(o=s,o>=u&&(o=0),s=o+1,s>=u&&(s=0),a=s+1,a>=u&&(a=0),r(e,o,s,a,u,l)){var d,f,m,y,g;for(d=l[o],f=l[s],m=l[a],h.push([e[d],e[f],e[m]]),c.push([l[o],l[s],l[a]]),y=s,g=s+1;u>g;y++,g++)l[y]=l[g];u--,p=2*u}}return t?c:h},n=function(e){for(var t=e.length,i=0,n=t-1,r=0;t>r;n=r++)i+=e[n].x*e[r].y-e[r].x*e[n].y;return.5*i},r=function(e,i,n,r,o,s){var a,h,l,c,u,p,d,f,m;if(h=e[s[i]].x,l=e[s[i]].y,c=e[s[n]].x,u=e[s[n]].y,p=e[s[r]].x,d=e[s[r]].y,t>(c-h)*(d-l)-(u-l)*(p-h))return!1;var y,g,v,b,_,x,w,S,M,T,E,k,A,C,P;for(y=p-c,g=d-u,v=h-p,b=l-d,_=c-h,x=u-l,a=0;o>a;a++)if(f=e[s[a]].x,m=e[s[a]].y,!(f===h&&m===l||f===c&&m===u||f===p&&m===d)&&(w=f-h,S=m-l,M=f-c,T=m-u,E=f-p,k=m-d,P=y*T-g*M,A=_*S-x*w,C=v*k-b*E,P>=-t&&C>=-t&&A>=-t))return!1;return!0};return e.Triangulate=i,e.Triangulate.area=n,e}(r.FontUtils),r.typeface_js={faces:r.FontUtils.faces,loadFace:r.FontUtils.loadFace},"undefined"!=typeof n&&(n._typeface_js=r.typeface_js),r.Audio=function(e){r.Object3D.call(this),this.type="Audio",this.context=e.context,this.source=this.context.createBufferSource(),this.source.onended=this.onEnded.bind(this),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.panner=this.context.createPanner(),this.panner.connect(this.gain),this.autoplay=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1},r.Audio.prototype=Object.create(r.Object3D.prototype),r.Audio.prototype.constructor=r.Audio,r.Audio.prototype.load=function(e){var t=this,i=new XMLHttpRequest;return i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=function(e){t.context.decodeAudioData(this.response,function(e){t.source.buffer=e,t.autoplay&&t.play()})},i.send(),this},r.Audio.prototype.play=function(){if(this.isPlaying===!0)return void console.warn("THREE.Audio: Audio is already playing.");var e=this.context.createBufferSource();e.buffer=this.source.buffer,e.loop=this.source.loop,e.onended=this.source.onended,e.start(0,this.startTime),e.playbackRate.value=this.playbackRate,this.isPlaying=!0,this.source=e,this.connect()},r.Audio.prototype.pause=function(){this.source.stop(),this.startTime=this.context.currentTime},r.Audio.prototype.stop=function(){this.source.stop(),this.startTime=0},r.Audio.prototype.connect=function(){void 0!==this.filter?(this.source.connect(this.filter),this.filter.connect(this.panner)):this.source.connect(this.panner)},r.Audio.prototype.disconnect=function(){void 0!==this.filter?(this.source.disconnect(this.filter),this.filter.disconnect(this.panner)):this.source.disconnect(this.panner)},r.Audio.prototype.setFilter=function(e){this.isPlaying===!0?(this.disconnect(),this.filter=e,this.connect()):this.filter=e},r.Audio.prototype.getFilter=function(){return this.filter},r.Audio.prototype.setPlaybackRate=function(e){this.playbackRate=e,this.isPlaying===!0&&(this.source.playbackRate.value=this.playbackRate)},r.Audio.prototype.getPlaybackRate=function(){return this.playbackRate},r.Audio.prototype.onEnded=function(){this.isPlaying=!1},r.Audio.prototype.setLoop=function(e){this.source.loop=e},r.Audio.prototype.getLoop=function(){return this.source.loop},r.Audio.prototype.setRefDistance=function(e){this.panner.refDistance=e},r.Audio.prototype.getRefDistance=function(){return this.panner.refDistance},r.Audio.prototype.setRolloffFactor=function(e){this.panner.rolloffFactor=e},r.Audio.prototype.getRolloffFactor=function(){return this.panner.rolloffFactor},r.Audio.prototype.setVolume=function(e){this.gain.gain.value=e},r.Audio.prototype.getVolume=function(){return this.gain.gain.value},r.Audio.prototype.updateMatrixWorld=function(){var e=new r.Vector3;return function(t){r.Object3D.prototype.updateMatrixWorld.call(this,t),e.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(e.x,e.y,e.z)}}(),r.AudioListener=function(){r.Object3D.call(this),this.type="AudioListener",this.context=new(window.AudioContext||window.webkitAudioContext)},r.AudioListener.prototype=Object.create(r.Object3D.prototype),r.AudioListener.prototype.constructor=r.AudioListener,r.AudioListener.prototype.updateMatrixWorld=function(){var e=new r.Vector3,t=new r.Quaternion,i=new r.Vector3,n=new r.Vector3;return function(o){r.Object3D.prototype.updateMatrixWorld.call(this,o);var s=this.context.listener,a=this.up;this.matrixWorld.decompose(e,t,i),n.set(0,0,-1).applyQuaternion(t),s.setPosition(e.x,e.y,e.z),s.setOrientation(n.x,n.y,n.z,a.x,a.y,a.z)}}(),r.Curve=function(){},r.Curve.prototype.getPoint=function(e){return console.warn("THREE.Curve: Warning, getPoint() not implemented!"),null},r.Curve.prototype.getPointAt=function(e){var t=this.getUtoTmapping(e);return this.getPoint(t)},r.Curve.prototype.getPoints=function(e){e||(e=5);var t,i=[];for(t=0;e>=t;t++)i.push(this.getPoint(t/e));return i},r.Curve.prototype.getSpacedPoints=function(e){e||(e=5);var t,i=[];for(t=0;e>=t;t++)i.push(this.getPointAt(t/e));return i},r.Curve.prototype.getLength=function(){var e=this.getLengths();return e[e.length-1]},r.Curve.prototype.getLengths=function(e){if(e||(e=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,i,n=[],r=this.getPoint(0),o=0;for(n.push(0),i=1;e>=i;i++)t=this.getPoint(i/e),o+=t.distanceTo(r),n.push(o),r=t;return this.cacheArcLengths=n,n},r.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},r.Curve.prototype.getUtoTmapping=function(e,t){var i,n=this.getLengths(),r=0,o=n.length;i=t?t:e*n[o-1];for(var s,a=0,h=o-1;h>=a;)if(r=Math.floor(a+(h-a)/2),s=n[r]-i,0>s)a=r+1;else{if(!(s>0)){h=r;break}h=r-1}if(r=h,n[r]===i){var l=r/(o-1);return l}var c=n[r],u=n[r+1],p=u-c,d=(i-c)/p,l=(r+d)/(o-1);return l},r.Curve.prototype.getTangent=function(e){var t=1e-4,i=e-t,n=e+t;0>i&&(i=0),n>1&&(n=1);var r=this.getPoint(i),o=this.getPoint(n),s=o.clone().sub(r);return s.normalize()},r.Curve.prototype.getTangentAt=function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},r.Curve.Utils={tangentQuadraticBezier:function(e,t,i,n){return 2*(1-e)*(i-t)+2*e*(n-i)},tangentCubicBezier:function(e,t,i,n,r){return-3*t*(1-e)*(1-e)+3*i*(1-e)*(1-e)-6*e*i*(1-e)+6*e*n*(1-e)-3*e*e*n+3*e*e*r},tangentSpline:function(e,t,i,n,r){var o=6*e*e-6*e,s=3*e*e-4*e+1,a=-6*e*e+6*e,h=3*e*e-2*e;return o+s+a+h},interpolate:function(e,t,i,n,r){var o=.5*(i-e),s=.5*(n-t),a=r*r,h=r*a;return(2*t-2*i+o+s)*h+(-3*t+3*i-2*o-s)*a+o*r+t}},r.Curve.create=function(e,t){return e.prototype=Object.create(r.Curve.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},r.CurvePath=function(){this.curves=[],this.bends=[],this.autoClose=!1},r.CurvePath.prototype=Object.create(r.Curve.prototype),r.CurvePath.prototype.constructor=r.CurvePath,r.CurvePath.prototype.add=function(e){this.curves.push(e)},r.CurvePath.prototype.checkConnection=function(){},r.CurvePath.prototype.closePath=function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new r.LineCurve(t,e))},r.CurvePath.prototype.getPoint=function(e){for(var t,i,n=e*this.getLength(),r=this.getCurveLengths(),o=0;o<r.length;){if(r[o]>=n){t=r[o]-n,i=this.curves[o];var s=1-t/i.getLength();return i.getPointAt(s)}o++}return null},r.CurvePath.prototype.getLength=function(){var e=this.getCurveLengths();return e[e.length-1]},r.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;var e,t=[],i=0,n=this.curves.length;for(e=0;n>e;e++)i+=this.curves[e].getLength(),t.push(i);return this.cacheLengths=t,t},r.CurvePath.prototype.getBoundingBox=function(){var e,t,i,n,o,s,a=this.getPoints();e=t=Number.NEGATIVE_INFINITY,n=o=Number.POSITIVE_INFINITY;var h,l,c,u,p=a[0]instanceof r.Vector3;for(u=p?new r.Vector3:new r.Vector2,l=0,c=a.length;c>l;l++)h=a[l],h.x>e?e=h.x:h.x<n&&(n=h.x),h.y>t?t=h.y:h.y<o&&(o=h.y),p&&(h.z>i?i=h.z:h.z<s&&(s=h.z)),u.add(h);var d={minX:n,minY:o,maxX:e,maxY:t};return p&&(d.maxZ=i,d.minZ=s),d},r.CurvePath.prototype.createPointsGeometry=function(e){var t=this.getPoints(e,!0);return this.createGeometry(t)},r.CurvePath.prototype.createSpacedPointsGeometry=function(e){var t=this.getSpacedPoints(e,!0);return this.createGeometry(t)},r.CurvePath.prototype.createGeometry=function(e){for(var t=new r.Geometry,i=0;i<e.length;i++)t.vertices.push(new r.Vector3(e[i].x,e[i].y,e[i].z||0));return t},r.CurvePath.prototype.addWrapPath=function(e){this.bends.push(e)},r.CurvePath.prototype.getTransformedPoints=function(e,t){var i,n,r=this.getPoints(e);for(t||(t=this.bends),i=0,n=t.length;n>i;i++)r=this.getWrapPoints(r,t[i]);return r},r.CurvePath.prototype.getTransformedSpacedPoints=function(e,t){var i,n,r=this.getSpacedPoints(e);for(t||(t=this.bends),i=0,n=t.length;n>i;i++)r=this.getWrapPoints(r,t[i]);return r},r.CurvePath.prototype.getWrapPoints=function(e,t){var i,n,r,o,s,a,h=this.getBoundingBox();for(i=0,n=e.length;n>i;i++){r=e[i],o=r.x,s=r.y,a=o/h.maxX,a=t.getUtoTmapping(a,o);var l=t.getPoint(a),c=t.getTangent(a);c.set(-c.y,c.x).multiplyScalar(s),r.x=l.x+c.x,r.y=l.y+c.y}return e},r.Path=function(e){r.CurvePath.call(this),this.actions=[],e&&this.fromPoints(e)},r.Path.prototype=Object.create(r.CurvePath.prototype),r.Path.prototype.constructor=r.Path,r.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"},r.Path.prototype.fromPoints=function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,i=e.length;i>t;t++)this.lineTo(e[t].x,e[t].y)},r.Path.prototype.moveTo=function(e,t){var i=Array.prototype.slice.call(arguments);this.actions.push({action:r.PathActions.MOVE_TO,args:i})},r.Path.prototype.lineTo=function(e,t){var i=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args,o=n[n.length-2],s=n[n.length-1],a=new r.LineCurve(new r.Vector2(o,s),new r.Vector2(e,t));this.curves.push(a),this.actions.push({action:r.PathActions.LINE_TO,args:i})},r.Path.prototype.quadraticCurveTo=function(e,t,i,n){var o=Array.prototype.slice.call(arguments),s=this.actions[this.actions.length-1].args,a=s[s.length-2],h=s[s.length-1],l=new r.QuadraticBezierCurve(new r.Vector2(a,h),new r.Vector2(e,t),new r.Vector2(i,n));this.curves.push(l),this.actions.push({action:r.PathActions.QUADRATIC_CURVE_TO,args:o})},r.Path.prototype.bezierCurveTo=function(e,t,i,n,o,s){var a=Array.prototype.slice.call(arguments),h=this.actions[this.actions.length-1].args,l=h[h.length-2],c=h[h.length-1],u=new r.CubicBezierCurve(new r.Vector2(l,c),new r.Vector2(e,t),new r.Vector2(i,n),new r.Vector2(o,s));this.curves.push(u),this.actions.push({action:r.PathActions.BEZIER_CURVE_TO,args:a})},r.Path.prototype.splineThru=function(e){var t=Array.prototype.slice.call(arguments),i=this.actions[this.actions.length-1].args,n=i[i.length-2],o=i[i.length-1],s=[new r.Vector2(n,o)];Array.prototype.push.apply(s,e);var a=new r.SplineCurve(s);this.curves.push(a),this.actions.push({action:r.PathActions.CSPLINE_THRU,args:t})},r.Path.prototype.arc=function(e,t,i,n,r,o){var s=this.actions[this.actions.length-1].args,a=s[s.length-2],h=s[s.length-1];this.absarc(e+a,t+h,i,n,r,o)},r.Path.prototype.absarc=function(e,t,i,n,r,o){this.absellipse(e,t,i,i,n,r,o)},r.Path.prototype.ellipse=function(e,t,i,n,r,o,s,a){var h=this.actions[this.actions.length-1].args,l=h[h.length-2],c=h[h.length-1];this.absellipse(e+l,t+c,i,n,r,o,s,a)},r.Path.prototype.absellipse=function(e,t,i,n,o,s,a,h){var l=[e,t,i,n,o,s,a,h||0],c=new r.EllipseCurve(e,t,i,n,o,s,a,h);this.curves.push(c);var u=c.getPoint(1);l.push(u.x),l.push(u.y),this.actions.push({action:r.PathActions.ELLIPSE,args:l})},r.Path.prototype.getSpacedPoints=function(e,t){e||(e=40);for(var i=[],n=0;e>n;n++)i.push(this.getPoint(n/e));return i},r.Path.prototype.getPoints=function(e,t){if(this.useSpacedPoints)return this.getSpacedPoints(e,t);e=e||12;var i,n,o,s,a,h,l,c,u,p,d,f,m,y,g,v,b,_,x=[];for(i=0,n=this.actions.length;n>i;i++)switch(o=this.actions[i],s=o.action,a=o.args,s){case r.PathActions.MOVE_TO:x.push(new r.Vector2(a[0],a[1]));break;case r.PathActions.LINE_TO:x.push(new r.Vector2(a[0],a[1]));break;case r.PathActions.QUADRATIC_CURVE_TO:for(h=a[2],l=a[3],p=a[0],d=a[1],x.length>0?(y=x[x.length-1],f=y.x,m=y.y):(y=this.actions[i-1].args,f=y[y.length-2],m=y[y.length-1]),g=1;e>=g;g++)v=g/e,b=r.Shape.Utils.b2(v,f,p,h),_=r.Shape.Utils.b2(v,m,d,l),x.push(new r.Vector2(b,_));break;case r.PathActions.BEZIER_CURVE_TO:for(h=a[4],l=a[5],p=a[0],d=a[1],c=a[2],u=a[3],x.length>0?(y=x[x.length-1],f=y.x,m=y.y):(y=this.actions[i-1].args,f=y[y.length-2],m=y[y.length-1]),g=1;e>=g;g++)v=g/e,b=r.Shape.Utils.b3(v,f,p,c,h),_=r.Shape.Utils.b3(v,m,d,u,l),x.push(new r.Vector2(b,_));break;case r.PathActions.CSPLINE_THRU:y=this.actions[i-1].args;var w=new r.Vector2(y[y.length-2],y[y.length-1]),S=[w],M=e*a[0].length;S=S.concat(a[0]);var T=new r.SplineCurve(S);for(g=1;M>=g;g++)x.push(T.getPointAt(g/M));break;case r.PathActions.ARC:var E,k=a[0],A=a[1],C=a[2],P=a[3],L=a[4],R=!!a[5],O=L-P,F=2*e;for(g=1;F>=g;g++)v=g/F,R||(v=1-v),E=P+v*O,b=k+C*Math.cos(E),_=A+C*Math.sin(E),x.push(new r.Vector2(b,_));break;case r.PathActions.ELLIPSE:var E,D,B,k=a[0],A=a[1],N=a[2],j=a[3],P=a[4],L=a[5],R=!!a[6],V=a[7],O=L-P,F=2*e;for(0!==V&&(D=Math.cos(V),B=Math.sin(V)),g=1;F>=g;g++){if(v=g/F,R||(v=1-v),E=P+v*O,b=k+N*Math.cos(E),_=A+j*Math.sin(E),0!==V){var z=b,U=_;b=(z-k)*D-(U-A)*B+k,_=(z-k)*B+(U-A)*D+A}x.push(new r.Vector2(b,_))}}var I=x[x.length-1],G=1e-10;return Math.abs(I.x-x[0].x)<G&&Math.abs(I.y-x[0].y)<G&&x.splice(x.length-1,1),t&&x.push(x[0]),x},r.Path.prototype.toShapes=function(e,t){function i(e){var t,i,n,o,s,a=[],h=new r.Path;for(t=0,i=e.length;i>t;t++)n=e[t],s=n.args,o=n.action,o===r.PathActions.MOVE_TO&&0!==h.actions.length&&(a.push(h),h=new r.Path),h[o].apply(h,s);return 0!==h.actions.length&&a.push(h),a}function n(e){for(var t=[],i=0,n=e.length;n>i;i++){var o=e[i],s=new r.Shape;s.actions=o.actions,s.curves=o.curves,t.push(s)}return t}function o(e,t){for(var i=1e-10,n=t.length,r=!1,o=n-1,s=0;n>s;o=s++){var a=t[o],h=t[s],l=h.x-a.x,c=h.y-a.y;if(Math.abs(c)>i){if(0>c&&(a=t[s],l=-l,h=t[o],c=-c),e.y<a.y||e.y>h.y)continue;if(e.y===a.y){if(e.x===a.x)return!0}else{var u=c*(e.x-a.x)-l*(e.y-a.y);if(0===u)return!0;if(0>u)continue;r=!r}}else{if(e.y!==a.y)continue;if(h.x<=e.x&&e.x<=a.x||a.x<=e.x&&e.x<=h.x)return!0}}return r}var s=i(this.actions);if(0===s.length)return[];if(t===!0)return n(s);var a,h,l,c=[];if(1===s.length)return h=s[0],l=new r.Shape,l.actions=h.actions,l.curves=h.curves,c.push(l),c;var u=!r.Shape.Utils.isClockWise(s[0].getPoints());u=e?!u:u;var p,d=[],f=[],m=[],y=0;f[y]=void 0,m[y]=[];var g,v;for(g=0,v=s.length;v>g;g++)h=s[g],p=h.getPoints(),a=r.Shape.Utils.isClockWise(p),a=e?!a:a,a?(!u&&f[y]&&y++,f[y]={s:new r.Shape,p:p},f[y].s.actions=h.actions,f[y].s.curves=h.curves,u&&y++,m[y]=[]):m[y].push({h:h,p:p[0]});if(!f[0])return n(s);if(f.length>1){for(var b=!1,_=[],x=0,w=f.length;w>x;x++)d[x]=[];for(var x=0,w=f.length;w>x;x++)for(var S=m[x],M=0;M<S.length;M++){for(var T=S[M],E=!0,k=0;k<f.length;k++)o(T.p,f[k].p)&&(x!==k&&_.push({froms:x,tos:k,hole:M}),E?(E=!1,d[k].push(T)):b=!0);E&&d[x].push(T)}_.length>0&&(b||(m=d))}var A,C,P;for(g=0,v=f.length;v>g;g++)for(l=f[g].s,c.push(l),A=m[g],C=0,P=A.length;P>C;C++)l.holes.push(A[C].h);return c},r.Shape=function(){r.Path.apply(this,arguments),this.holes=[]},r.Shape.prototype=Object.create(r.Path.prototype),r.Shape.prototype.constructor=r.Shape,r.Shape.prototype.extrude=function(e){var t=new r.ExtrudeGeometry(this,e);return t},r.Shape.prototype.makeGeometry=function(e){var t=new r.ShapeGeometry(this,e);return t},r.Shape.prototype.getPointsHoles=function(e){var t,i=this.holes.length,n=[];for(t=0;i>t;t++)n[t]=this.holes[t].getTransformedPoints(e,this.bends);return n},r.Shape.prototype.getSpacedPointsHoles=function(e){var t,i=this.holes.length,n=[];for(t=0;i>t;t++)n[t]=this.holes[t].getTransformedSpacedPoints(e,this.bends);return n},r.Shape.prototype.extractAllPoints=function(e){return{shape:this.getTransformedPoints(e),holes:this.getPointsHoles(e)}},r.Shape.prototype.extractPoints=function(e){return this.useSpacedPoints?this.extractAllSpacedPoints(e):this.extractAllPoints(e)},r.Shape.prototype.extractAllSpacedPoints=function(e){return{shape:this.getTransformedSpacedPoints(e),holes:this.getSpacedPointsHoles(e)}},r.Shape.Utils={triangulateShape:function(e,t){function i(e,t,i){return e.x!==t.x?e.x<t.x?e.x<=i.x&&i.x<=t.x:t.x<=i.x&&i.x<=e.x:e.y<t.y?e.y<=i.y&&i.y<=t.y:t.y<=i.y&&i.y<=e.y}function n(e,t,n,r,o){var s=1e-10,a=t.x-e.x,h=t.y-e.y,l=r.x-n.x,c=r.y-n.y,u=e.x-n.x,p=e.y-n.y,d=h*l-a*c,f=h*u-a*p;if(Math.abs(d)>s){var m;if(d>0){if(0>f||f>d)return[];if(m=c*u-l*p,0>m||m>d)return[]}else{if(f>0||d>f)return[];if(m=c*u-l*p,m>0||d>m)return[]}if(0===m)return!o||0!==f&&f!==d?[e]:[];if(m===d)return!o||0!==f&&f!==d?[t]:[];if(0===f)return[n];if(f===d)return[r];var y=m/d;return[{x:e.x+y*a,y:e.y+y*h}]}if(0!==f||c*u!==l*p)return[];var g=0===a&&0===h,v=0===l&&0===c;if(g&&v)return e.x!==n.x||e.y!==n.y?[]:[e];if(g)return i(n,r,e)?[e]:[];if(v)return i(e,t,n)?[n]:[];var b,_,x,w,S,M,T,E;return 0!==a?(e.x<t.x?(b=e,x=e.x,_=t,w=t.x):(b=t,x=t.x,_=e,w=e.x),n.x<r.x?(S=n,T=n.x,M=r,E=r.x):(S=r,T=r.x,M=n,E=n.x)):(e.y<t.y?(b=e,x=e.y,_=t,w=t.y):(b=t,x=t.y,_=e,w=e.y),n.y<r.y?(S=n,T=n.y,M=r,E=r.y):(S=r,T=r.y,M=n,E=n.y)),T>=x?T>w?[]:w===T?o?[]:[S]:E>=w?[S,_]:[S,M]:x>E?[]:x===E?o?[]:[b]:E>=w?[b,_]:[b,M]}function o(e,t,i,n){var r=1e-10,o=t.x-e.x,s=t.y-e.y,a=i.x-e.x,h=i.y-e.y,l=n.x-e.x,c=n.y-e.y,u=o*h-s*a,p=o*c-s*l;if(Math.abs(u)>r){var d=l*h-c*a;return u>0?p>=0&&d>=0:p>=0||d>=0}return p>0}function s(e,t){function i(e,t){var i=v.length-1,n=e-1;0>n&&(n=i);var r=e+1;r>i&&(r=0);var s=o(v[e],v[n],v[r],a[t]);if(!s)return!1;var h=a.length-1,l=t-1;0>l&&(l=h);var c=t+1;return c>h&&(c=0),s=o(a[t],a[l],a[c],v[e]),s?!0:!1}function r(e,t){var i,r,o;for(i=0;i<v.length;i++)if(r=i+1,r%=v.length,o=n(e,t,v[i],v[r],!0),o.length>0)return!0;return!1}function s(e,i){var r,o,s,a,h;for(r=0;r<b.length;r++)for(o=t[b[r]],s=0;s<o.length;s++)if(a=s+1,a%=o.length,h=n(e,i,o[s],o[a],!0),h.length>0)return!0;return!1}for(var a,h,l,c,u,p,d,f,m,y,g,v=e.concat(),b=[],_=[],x=0,w=t.length;w>x;x++)b.push(x);for(var S=0,M=2*b.length;b.length>0;){if(M--,0>M){console.log("Infinite Loop! Holes left:"+b.length+", Probably Hole outside Shape!");break}for(l=S;l<v.length;l++){c=v[l],h=-1;for(var x=0;x<b.length;x++)if(p=b[x],d=c.x+":"+c.y+":"+p,void 0===_[d]){a=t[p];for(var T=0;T<a.length;T++)if(u=a[T],i(l,T)&&!r(c,u)&&!s(c,u)){h=T,b.splice(x,1),f=v.slice(0,l+1),m=v.slice(l),y=a.slice(h),g=a.slice(0,h+1),v=f.concat(y).concat(g).concat(m),S=l;break}if(h>=0)break;_[d]=!0}if(h>=0)break}}return v}for(var a,h,l,c,u,p,d={},f=e.concat(),m=0,y=t.length;y>m;m++)Array.prototype.push.apply(f,t[m]);for(a=0,h=f.length;h>a;a++)u=f[a].x+":"+f[a].y,void 0!==d[u]&&console.warn("THREE.Shape: Duplicate point",u),d[u]=a;var g=s(e,t),v=r.FontUtils.Triangulate(g,!1);for(a=0,h=v.length;h>a;a++)for(c=v[a],l=0;3>l;l++)u=c[l].x+":"+c[l].y,p=d[u],void 0!==p&&(c[l]=p);return v.concat()},isClockWise:function(e){return r.FontUtils.Triangulate.area(e)<0},b2p0:function(e,t){var i=1-e;return i*i*t},b2p1:function(e,t){return 2*(1-e)*e*t},b2p2:function(e,t){return e*e*t},b2:function(e,t,i,n){return this.b2p0(e,t)+this.b2p1(e,i)+this.b2p2(e,n)},b3p0:function(e,t){var i=1-e;return i*i*i*t},b3p1:function(e,t){var i=1-e;return 3*i*i*e*t},b3p2:function(e,t){var i=1-e;return 3*i*e*e*t},b3p3:function(e,t){return e*e*e*t},b3:function(e,t,i,n,r){return this.b3p0(e,t)+this.b3p1(e,i)+this.b3p2(e,n)+this.b3p3(e,r)}},r.LineCurve=function(e,t){this.v1=e,this.v2=t},r.LineCurve.prototype=Object.create(r.Curve.prototype),r.LineCurve.prototype.constructor=r.LineCurve,r.LineCurve.prototype.getPoint=function(e){var t=this.v2.clone().sub(this.v1);return t.multiplyScalar(e).add(this.v1),t},r.LineCurve.prototype.getPointAt=function(e){return this.getPoint(e)},r.LineCurve.prototype.getTangent=function(e){var t=this.v2.clone().sub(this.v1);return t.normalize()},r.QuadraticBezierCurve=function(e,t,i){this.v0=e,this.v1=t,this.v2=i},r.QuadraticBezierCurve.prototype=Object.create(r.Curve.prototype),
r.QuadraticBezierCurve.prototype.constructor=r.QuadraticBezierCurve,r.QuadraticBezierCurve.prototype.getPoint=function(e){var t=new r.Vector2;return t.x=r.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x),t.y=r.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y),t},r.QuadraticBezierCurve.prototype.getTangent=function(e){var t=new r.Vector2;return t.x=r.Curve.Utils.tangentQuadraticBezier(e,this.v0.x,this.v1.x,this.v2.x),t.y=r.Curve.Utils.tangentQuadraticBezier(e,this.v0.y,this.v1.y,this.v2.y),t.normalize()},r.CubicBezierCurve=function(e,t,i,n){this.v0=e,this.v1=t,this.v2=i,this.v3=n},r.CubicBezierCurve.prototype=Object.create(r.Curve.prototype),r.CubicBezierCurve.prototype.constructor=r.CubicBezierCurve,r.CubicBezierCurve.prototype.getPoint=function(e){var t,i;return t=r.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),i=r.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new r.Vector2(t,i)},r.CubicBezierCurve.prototype.getTangent=function(e){var t,i;t=r.Curve.Utils.tangentCubicBezier(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),i=r.Curve.Utils.tangentCubicBezier(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y);var n=new r.Vector2(t,i);return n.normalize(),n},r.SplineCurve=function(e){this.points=void 0==e?[]:e},r.SplineCurve.prototype=Object.create(r.Curve.prototype),r.SplineCurve.prototype.constructor=r.SplineCurve,r.SplineCurve.prototype.getPoint=function(e){var t=this.points,i=(t.length-1)*e,n=Math.floor(i),o=i-n,s=t[0===n?n:n-1],a=t[n],h=t[n>t.length-2?t.length-1:n+1],l=t[n>t.length-3?t.length-1:n+2],c=new r.Vector2;return c.x=r.Curve.Utils.interpolate(s.x,a.x,h.x,l.x,o),c.y=r.Curve.Utils.interpolate(s.y,a.y,h.y,l.y,o),c},r.EllipseCurve=function(e,t,i,n,r,o,s,a){this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=n,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=s,this.aRotation=a||0},r.EllipseCurve.prototype=Object.create(r.Curve.prototype),r.EllipseCurve.prototype.constructor=r.EllipseCurve,r.EllipseCurve.prototype.getPoint=function(e){var t=this.aEndAngle-this.aStartAngle;0>t&&(t+=2*Math.PI),t>2*Math.PI&&(t-=2*Math.PI);var i;i=this.aClockwise===!0?this.aEndAngle+(1-e)*(2*Math.PI-t):this.aStartAngle+e*t;var n=this.aX+this.xRadius*Math.cos(i),o=this.aY+this.yRadius*Math.sin(i);if(0!==this.aRotation){var s=Math.cos(this.aRotation),a=Math.sin(this.aRotation),h=n,l=o;n=(h-this.aX)*s-(l-this.aY)*a+this.aX,o=(h-this.aX)*a+(l-this.aY)*s+this.aY}return new r.Vector2(n,o)},r.ArcCurve=function(e,t,i,n,o,s){r.EllipseCurve.call(this,e,t,i,i,n,o,s)},r.ArcCurve.prototype=Object.create(r.EllipseCurve.prototype),r.ArcCurve.prototype.constructor=r.ArcCurve,r.LineCurve3=r.Curve.create(function(e,t){this.v1=e,this.v2=t},function(e){var t=new r.Vector3;return t.subVectors(this.v2,this.v1),t.multiplyScalar(e),t.add(this.v1),t}),r.QuadraticBezierCurve3=r.Curve.create(function(e,t,i){this.v0=e,this.v1=t,this.v2=i},function(e){var t=new r.Vector3;return t.x=r.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x),t.y=r.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y),t.z=r.Shape.Utils.b2(e,this.v0.z,this.v1.z,this.v2.z),t}),r.CubicBezierCurve3=r.Curve.create(function(e,t,i,n){this.v0=e,this.v1=t,this.v2=i,this.v3=n},function(e){var t=new r.Vector3;return t.x=r.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),t.y=r.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),t.z=r.Shape.Utils.b3(e,this.v0.z,this.v1.z,this.v2.z,this.v3.z),t}),r.SplineCurve3=r.Curve.create(function(e){console.warn("THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3"),this.points=void 0==e?[]:e},function(e){var t=this.points,i=(t.length-1)*e,n=Math.floor(i),o=i-n,s=t[0==n?n:n-1],a=t[n],h=t[n>t.length-2?t.length-1:n+1],l=t[n>t.length-3?t.length-1:n+2],c=new r.Vector3;return c.x=r.Curve.Utils.interpolate(s.x,a.x,h.x,l.x,o),c.y=r.Curve.Utils.interpolate(s.y,a.y,h.y,l.y,o),c.z=r.Curve.Utils.interpolate(s.z,a.z,h.z,l.z,o),c}),r.CatmullRomCurve3=function(){function e(){}var t=new r.Vector3,i=new e,n=new e,o=new e;return e.prototype.init=function(e,t,i,n){this.c0=e,this.c1=i,this.c2=-3*e+3*t-2*i-n,this.c3=2*e-2*t+i+n},e.prototype.initNonuniformCatmullRom=function(e,t,i,n,r,o,s){var a=(t-e)/r-(i-e)/(r+o)+(i-t)/o,h=(i-t)/o-(n-t)/(o+s)+(n-i)/s;a*=o,h*=o,this.init(t,i,a,h)},e.prototype.initCatmullRom=function(e,t,i,n,r){this.init(t,i,r*(i-e),r*(n-t))},e.prototype.calc=function(e){var t=e*e,i=t*e;return this.c0+this.c1*e+this.c2*t+this.c3*i},r.Curve.create(function(e){this.points=e||[]},function(e){var s,a,h,l,c=this.points;l=c.length,2>l&&console.log("duh, you need at least 2 points"),s=(l-1)*e,a=Math.floor(s),h=s-a,0===h&&a===l-1&&(a=l-2,h=1);var u,p,d,f;if(0===a?(t.subVectors(c[0],c[1]).add(c[0]),u=t):u=c[a-1],p=c[a],d=c[a+1],l>a+2?f=c[a+2]:(t.subVectors(c[l-1],c[l-2]).add(c[l-2]),f=t),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var m="chordal"===this.type?.5:.25,y=Math.pow(u.distanceToSquared(p),m),g=Math.pow(p.distanceToSquared(d),m),v=Math.pow(d.distanceToSquared(f),m);1e-4>g&&(g=1),1e-4>y&&(y=g),1e-4>v&&(v=g),i.initNonuniformCatmullRom(u.x,p.x,d.x,f.x,y,g,v),n.initNonuniformCatmullRom(u.y,p.y,d.y,f.y,y,g,v),o.initNonuniformCatmullRom(u.z,p.z,d.z,f.z,y,g,v)}else if("catmullrom"===this.type){var b=void 0!==this.tension?this.tension:.5;i.initCatmullRom(u.x,p.x,d.x,f.x,b),n.initCatmullRom(u.y,p.y,d.y,f.y,b),o.initCatmullRom(u.z,p.z,d.z,f.z,b)}var _=new r.Vector3(i.calc(h),n.calc(h),o.calc(h));return _})}(),r.ClosedSplineCurve3=r.Curve.create(function(e){this.points=void 0==e?[]:e},function(e){var t=this.points,i=(t.length-0)*e,n=Math.floor(i),o=i-n;n+=n>0?0:(Math.floor(Math.abs(n)/t.length)+1)*t.length;var s=t[(n-1)%t.length],a=t[n%t.length],h=t[(n+1)%t.length],l=t[(n+2)%t.length],c=new r.Vector3;return c.x=r.Curve.Utils.interpolate(s.x,a.x,h.x,l.x,o),c.y=r.Curve.Utils.interpolate(s.y,a.y,h.y,l.y,o),c.z=r.Curve.Utils.interpolate(s.z,a.z,h.z,l.z,o),c}),r.AnimationHandler={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2,add:function(){console.warn("THREE.AnimationHandler.add() has been deprecated.")},get:function(){console.warn("THREE.AnimationHandler.get() has been deprecated.")},remove:function(){console.warn("THREE.AnimationHandler.remove() has been deprecated.")},animations:[],init:function(e){if(e.initialized===!0)return e;for(var t=0;t<e.hierarchy.length;t++){for(var i=0;i<e.hierarchy[t].keys.length;i++)if(e.hierarchy[t].keys[i].time<0&&(e.hierarchy[t].keys[i].time=0),void 0!==e.hierarchy[t].keys[i].rot&&!(e.hierarchy[t].keys[i].rot instanceof r.Quaternion)){var n=e.hierarchy[t].keys[i].rot;e.hierarchy[t].keys[i].rot=(new r.Quaternion).fromArray(n)}if(e.hierarchy[t].keys.length&&void 0!==e.hierarchy[t].keys[0].morphTargets){for(var o={},i=0;i<e.hierarchy[t].keys.length;i++)for(var s=0;s<e.hierarchy[t].keys[i].morphTargets.length;s++){var a=e.hierarchy[t].keys[i].morphTargets[s];o[a]=-1}e.hierarchy[t].usedMorphTargets=o;for(var i=0;i<e.hierarchy[t].keys.length;i++){var h={};for(var a in o){for(var s=0;s<e.hierarchy[t].keys[i].morphTargets.length;s++)if(e.hierarchy[t].keys[i].morphTargets[s]===a){h[a]=e.hierarchy[t].keys[i].morphTargetsInfluences[s];break}s===e.hierarchy[t].keys[i].morphTargets.length&&(h[a]=0)}e.hierarchy[t].keys[i].morphTargetsInfluences=h}}for(var i=1;i<e.hierarchy[t].keys.length;i++)e.hierarchy[t].keys[i].time===e.hierarchy[t].keys[i-1].time&&(e.hierarchy[t].keys.splice(i,1),i--);for(var i=0;i<e.hierarchy[t].keys.length;i++)e.hierarchy[t].keys[i].index=i}return e.initialized=!0,e},parse:function(e){var t=function(e,i){i.push(e);for(var n=0;n<e.children.length;n++)t(e.children[n],i)},i=[];if(e instanceof r.SkinnedMesh)for(var n=0;n<e.skeleton.bones.length;n++)i.push(e.skeleton.bones[n]);else t(e,i);return i},play:function(e){-1===this.animations.indexOf(e)&&this.animations.push(e)},stop:function(e){var t=this.animations.indexOf(e);-1!==t&&this.animations.splice(t,1)},update:function(e){for(var t=0;t<this.animations.length;t++)this.animations[t].resetBlendWeights();for(var t=0;t<this.animations.length;t++)this.animations[t].update(e)}},r.Animation=function(e,t){this.root=e,this.data=r.AnimationHandler.init(t),this.hierarchy=r.AnimationHandler.parse(e),this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.loop=!0,this.weight=0,this.interpolationType=r.AnimationHandler.LINEAR},r.Animation.prototype={constructor:r.Animation,keyTypes:["pos","rot","scl"],play:function(e,t){this.currentTime=void 0!==e?e:0,this.weight=void 0!==t?t:1,this.isPlaying=!0,this.reset(),r.AnimationHandler.play(this)},stop:function(){this.isPlaying=!1,r.AnimationHandler.stop(this)},reset:function(){for(var e=0,t=this.hierarchy.length;t>e;e++){var i=this.hierarchy[e];void 0===i.animationCache&&(i.animationCache={animations:{},blending:{positionWeight:0,quaternionWeight:0,scaleWeight:0}});var n=this.data.name,r=i.animationCache.animations,o=r[n];void 0===o&&(o={prevKey:{pos:0,rot:0,scl:0},nextKey:{pos:0,rot:0,scl:0},originalMatrix:i.matrix},r[n]=o);for(var s=0;3>s;s++){for(var a=this.keyTypes[s],h=this.data.hierarchy[e].keys[0],l=this.getNextKeyWith(a,e,1);l.time<this.currentTime&&l.index>h.index;)h=l,l=this.getNextKeyWith(a,e,l.index+1);o.prevKey[a]=h,o.nextKey[a]=l}}},resetBlendWeights:function(){for(var e=0,t=this.hierarchy.length;t>e;e++){var i=this.hierarchy[e],n=i.animationCache;if(void 0!==n){var r=n.blending;r.positionWeight=0,r.quaternionWeight=0,r.scaleWeight=0}}},update:function(){var e=[],t=new r.Vector3,i=new r.Vector3,n=new r.Quaternion,o=function(e,t){var i,n,r,o,a,h,l,c,u,p=[],d=[];return i=(e.length-1)*t,n=Math.floor(i),r=i-n,p[0]=0===n?n:n-1,p[1]=n,p[2]=n>e.length-2?n:n+1,p[3]=n>e.length-3?n:n+2,h=e[p[0]],l=e[p[1]],c=e[p[2]],u=e[p[3]],o=r*r,a=r*o,d[0]=s(h[0],l[0],c[0],u[0],r,o,a),d[1]=s(h[1],l[1],c[1],u[1],r,o,a),d[2]=s(h[2],l[2],c[2],u[2],r,o,a),d},s=function(e,t,i,n,r,o,s){var a=.5*(i-e),h=.5*(n-t);return(2*(t-i)+a+h)*s+(-3*(t-i)-2*a-h)*o+a*r+t};return function(s){if(this.isPlaying!==!1&&(this.currentTime+=s*this.timeScale,0!==this.weight)){var a=this.data.length;(this.currentTime>a||this.currentTime<0)&&(this.loop?(this.currentTime%=a,this.currentTime<0&&(this.currentTime+=a),this.reset()):this.stop());for(var h=0,l=this.hierarchy.length;l>h;h++)for(var c=this.hierarchy[h],u=c.animationCache.animations[this.data.name],p=c.animationCache.blending,d=0;3>d;d++){var f=this.keyTypes[d],m=u.prevKey[f],y=u.nextKey[f];if(this.timeScale>0&&y.time<=this.currentTime||this.timeScale<0&&m.time>=this.currentTime){for(m=this.data.hierarchy[h].keys[0],y=this.getNextKeyWith(f,h,1);y.time<this.currentTime&&y.index>m.index;)m=y,y=this.getNextKeyWith(f,h,y.index+1);u.prevKey[f]=m,u.nextKey[f]=y}var g=(this.currentTime-m.time)/(y.time-m.time),v=m[f],b=y[f];if(0>g&&(g=0),g>1&&(g=1),"pos"===f){if(this.interpolationType===r.AnimationHandler.LINEAR){i.x=v[0]+(b[0]-v[0])*g,i.y=v[1]+(b[1]-v[1])*g,i.z=v[2]+(b[2]-v[2])*g;var _=this.weight/(this.weight+p.positionWeight);c.position.lerp(i,_),p.positionWeight+=this.weight}else if(this.interpolationType===r.AnimationHandler.CATMULLROM||this.interpolationType===r.AnimationHandler.CATMULLROM_FORWARD){e[0]=this.getPrevKeyWith("pos",h,m.index-1).pos,e[1]=v,e[2]=b,e[3]=this.getNextKeyWith("pos",h,y.index+1).pos,g=.33*g+.33;var x=o(e,g),_=this.weight/(this.weight+p.positionWeight);p.positionWeight+=this.weight;var w=c.position;if(w.x=w.x+(x[0]-w.x)*_,w.y=w.y+(x[1]-w.y)*_,w.z=w.z+(x[2]-w.z)*_,this.interpolationType===r.AnimationHandler.CATMULLROM_FORWARD){var S=o(e,1.01*g);t.set(S[0],S[1],S[2]),t.sub(w),t.y=0,t.normalize();var M=Math.atan2(t.x,t.z);c.rotation.set(0,M,0)}}}else if("rot"===f)if(r.Quaternion.slerp(v,b,n,g),0===p.quaternionWeight)c.quaternion.copy(n),p.quaternionWeight=this.weight;else{var _=this.weight/(this.weight+p.quaternionWeight);r.Quaternion.slerp(c.quaternion,n,c.quaternion,_),p.quaternionWeight+=this.weight}else if("scl"===f){i.x=v[0]+(b[0]-v[0])*g,i.y=v[1]+(b[1]-v[1])*g,i.z=v[2]+(b[2]-v[2])*g;var _=this.weight/(this.weight+p.scaleWeight);c.scale.lerp(i,_),p.scaleWeight+=this.weight}}return!0}}}(),getNextKeyWith:function(e,t,i){var n=this.data.hierarchy[t].keys;for(this.interpolationType===r.AnimationHandler.CATMULLROM||this.interpolationType===r.AnimationHandler.CATMULLROM_FORWARD?i=i<n.length-1?i:n.length-1:i%=n.length;i<n.length;i++)if(void 0!==n[i][e])return n[i];return this.data.hierarchy[t].keys[0]},getPrevKeyWith:function(e,t,i){var n=this.data.hierarchy[t].keys;for(i=this.interpolationType===r.AnimationHandler.CATMULLROM||this.interpolationType===r.AnimationHandler.CATMULLROM_FORWARD?i>0?i:0:i>=0?i:i+n.length;i>=0;i--)if(void 0!==n[i][e])return n[i];return this.data.hierarchy[t].keys[n.length-1]}},r.KeyFrameAnimation=function(e){this.root=e.node,this.data=r.AnimationHandler.init(e),this.hierarchy=r.AnimationHandler.parse(this.root),this.currentTime=0,this.timeScale=.001,this.isPlaying=!1,this.isPaused=!0,this.loop=!0;for(var t=0,i=this.hierarchy.length;i>t;t++){var n=this.data.hierarchy[t].keys,o=this.data.hierarchy[t].sids,s=this.hierarchy[t];if(n.length&&o){for(var a=0;a<o.length;a++){var h=o[a],l=this.getNextKeyWith(h,t,0);l&&l.apply(h)}s.matrixAutoUpdate=!1,this.data.hierarchy[t].node.updateMatrix(),s.matrixWorldNeedsUpdate=!0}}},r.KeyFrameAnimation.prototype={constructor:r.KeyFrameAnimation,play:function(e){if(this.currentTime=void 0!==e?e:0,this.isPlaying===!1){this.isPlaying=!0;var t,i,n,o=this.hierarchy.length;for(t=0;o>t;t++){i=this.hierarchy[t],n=this.data.hierarchy[t],void 0===n.animationCache&&(n.animationCache={},n.animationCache.prevKey=null,n.animationCache.nextKey=null,n.animationCache.originalMatrix=i.matrix);var s=this.data.hierarchy[t].keys;s.length&&(n.animationCache.prevKey=s[0],n.animationCache.nextKey=s[1],this.startTime=Math.min(s[0].time,this.startTime),this.endTime=Math.max(s[s.length-1].time,this.endTime))}this.update(0)}this.isPaused=!1,r.AnimationHandler.play(this)},stop:function(){this.isPlaying=!1,this.isPaused=!1,r.AnimationHandler.stop(this);for(var e=0;e<this.data.hierarchy.length;e++){var t=this.hierarchy[e],i=this.data.hierarchy[e];if(void 0!==i.animationCache){var n=i.animationCache.originalMatrix;n.copy(t.matrix),t.matrix=n,delete i.animationCache}}},update:function(e){if(this.isPlaying!==!1){this.currentTime+=e*this.timeScale;var t=this.data.length;this.loop===!0&&this.currentTime>t&&(this.currentTime%=t),this.currentTime=Math.min(this.currentTime,t);for(var i=0,n=this.hierarchy.length;n>i;i++){var r=this.hierarchy[i],o=this.data.hierarchy[i],s=o.keys,a=o.animationCache;if(s.length){var h=a.prevKey,l=a.nextKey;if(l.time<=this.currentTime){for(;l.time<this.currentTime&&l.index>h.index;)h=l,l=s[h.index+1];a.prevKey=h,a.nextKey=l}l.time>=this.currentTime?h.interpolate(l,this.currentTime):h.interpolate(l,l.time),this.data.hierarchy[i].node.updateMatrix(),r.matrixWorldNeedsUpdate=!0}}}},getNextKeyWith:function(e,t,i){var n=this.data.hierarchy[t].keys;for(i%=n.length;i<n.length;i++)if(n[i].hasTarget(e))return n[i];return n[0]},getPrevKeyWith:function(e,t,i){var n=this.data.hierarchy[t].keys;for(i=i>=0?i:i+n.length;i>=0;i--)if(n[i].hasTarget(e))return n[i];return n[n.length-1]}},r.MorphAnimation=function(e){this.mesh=e,this.frames=e.morphTargetInfluences.length,this.currentTime=0,this.duration=1e3,this.loop=!0,this.lastFrame=0,this.currentFrame=0,this.isPlaying=!1},r.MorphAnimation.prototype={constructor:r.MorphAnimation,play:function(){this.isPlaying=!0},pause:function(){this.isPlaying=!1},update:function(e){if(this.isPlaying!==!1){this.currentTime+=e,this.loop===!0&&this.currentTime>this.duration&&(this.currentTime%=this.duration),this.currentTime=Math.min(this.currentTime,this.duration);var t=this.duration/this.frames,i=Math.floor(this.currentTime/t),n=this.mesh.morphTargetInfluences;i!==this.currentFrame&&(n[this.lastFrame]=0,n[this.currentFrame]=1,n[i]=0,this.lastFrame=this.currentFrame,this.currentFrame=i);var r=this.currentTime%t/t;n[i]=r,n[this.lastFrame]=1-r}}},r.BoxGeometry=function(e,t,i,n,o,s){function a(e,t,i,n,o,s,a,l){var c,u,p,d=h.widthSegments,f=h.heightSegments,m=o/2,y=s/2,g=h.vertices.length;"x"===e&&"y"===t||"y"===e&&"x"===t?c="z":"x"===e&&"z"===t||"z"===e&&"x"===t?(c="y",f=h.depthSegments):("z"===e&&"y"===t||"y"===e&&"z"===t)&&(c="x",d=h.depthSegments);var v=d+1,b=f+1,_=o/d,x=s/f,w=new r.Vector3;for(w[c]=a>0?1:-1,p=0;b>p;p++)for(u=0;v>u;u++){var S=new r.Vector3;S[e]=(u*_-m)*i,S[t]=(p*x-y)*n,S[c]=a,h.vertices.push(S)}for(p=0;f>p;p++)for(u=0;d>u;u++){var M=u+v*p,T=u+v*(p+1),E=u+1+v*(p+1),k=u+1+v*p,A=new r.Vector2(u/d,1-p/f),C=new r.Vector2(u/d,1-(p+1)/f),P=new r.Vector2((u+1)/d,1-(p+1)/f),L=new r.Vector2((u+1)/d,1-p/f),R=new r.Face3(M+g,T+g,k+g);R.normal.copy(w),R.vertexNormals.push(w.clone(),w.clone(),w.clone()),R.materialIndex=l,h.faces.push(R),h.faceVertexUvs[0].push([A,C,L]),R=new r.Face3(T+g,E+g,k+g),R.normal.copy(w),R.vertexNormals.push(w.clone(),w.clone(),w.clone()),R.materialIndex=l,h.faces.push(R),h.faceVertexUvs[0].push([C.clone(),P,L.clone()])}}r.Geometry.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:n,heightSegments:o,depthSegments:s},this.widthSegments=n||1,this.heightSegments=o||1,this.depthSegments=s||1;var h=this,l=e/2,c=t/2,u=i/2;a("z","y",-1,-1,i,t,l,0),a("z","y",1,-1,i,t,-l,1),a("x","z",1,1,e,i,c,2),a("x","z",1,-1,e,i,-c,3),a("x","y",1,-1,e,t,u,4),a("x","y",-1,-1,e,t,-u,5),this.mergeVertices()},r.BoxGeometry.prototype=Object.create(r.Geometry.prototype),r.BoxGeometry.prototype.constructor=r.BoxGeometry,r.BoxGeometry.prototype.clone=function(){var e=new r.BoxGeometry(this.parameters.width,this.parameters.height,this.parameters.depth,this.parameters.widthSegments,this.parameters.heightSegments,this.parameters.depthSegments);return e},r.CubeGeometry=r.BoxGeometry,r.CircleGeometry=function(e,t,i,n){r.Geometry.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:n},e=e||50,t=void 0!==t?Math.max(3,t):8,i=void 0!==i?i:0,n=void 0!==n?n:2*Math.PI;var o,s=[],a=new r.Vector3,h=new r.Vector2(.5,.5);for(this.vertices.push(a),s.push(h),o=0;t>=o;o++){var l=new r.Vector3,c=i+o/t*n;l.x=e*Math.cos(c),l.y=e*Math.sin(c),this.vertices.push(l),s.push(new r.Vector2((l.x/e+1)/2,(l.y/e+1)/2))}var u=new r.Vector3(0,0,1);for(o=1;t>=o;o++)this.faces.push(new r.Face3(o,o+1,0,[u.clone(),u.clone(),u.clone()])),this.faceVertexUvs[0].push([s[o].clone(),s[o+1].clone(),h.clone()]);this.computeFaceNormals(),this.boundingSphere=new r.Sphere(new r.Vector3,e)},r.CircleGeometry.prototype=Object.create(r.Geometry.prototype),r.CircleGeometry.prototype.constructor=r.CircleGeometry,r.CircleGeometry.prototype.clone=function(){var e=new r.CircleGeometry(this.parameters.radius,this.parameters.segments,this.parameters.thetaStart,this.parameters.thetaLength);return e},r.CircleBufferGeometry=function(e,t,i,n){r.BufferGeometry.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:n},e=e||50,t=void 0!==t?Math.max(3,t):8,i=void 0!==i?i:0,n=void 0!==n?n:2*Math.PI;var o=t+2,s=new Float32Array(3*o),a=new Float32Array(3*o),h=new Float32Array(2*o);a[3]=1,h[0]=.5,h[1]=.5;for(var l=0,c=3,u=2;t>=l;l++,c+=3,u+=2){var p=i+l/t*n;s[c]=e*Math.cos(p),s[c+1]=e*Math.sin(p),a[c+2]=1,h[u]=(s[c]/e+1)/2,h[u+1]=(s[c+1]/e+1)/2}for(var d=[],c=1;t>=c;c++)d.push(c),d.push(c+1),d.push(0);this.setIndex(new r.BufferAttribute(new Uint16Array(d),1)),this.addAttribute("position",new r.BufferAttribute(s,3)),this.addAttribute("normal",new r.BufferAttribute(a,3)),this.addAttribute("uv",new r.BufferAttribute(h,2)),this.boundingSphere=new r.Sphere(new r.Vector3,e)},r.CircleBufferGeometry.prototype=Object.create(r.BufferGeometry.prototype),r.CircleBufferGeometry.prototype.constructor=r.CircleBufferGeometry,r.CircleBufferGeometry.prototype.clone=function(){var e=new r.CircleBufferGeometry(this.parameters.radius,this.parameters.segments,this.parameters.thetaStart,this.parameters.thetaLength);return e.copy(this),e},r.CylinderGeometry=function(e,t,i,n,o,s,a,h){r.Geometry.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:n,heightSegments:o,openEnded:s,thetaStart:a,thetaLength:h},e=void 0!==e?e:20,t=void 0!==t?t:20,i=void 0!==i?i:100,n=n||8,o=o||1,s=void 0!==s?s:!1,a=void 0!==a?a:0,h=void 0!==h?h:2*Math.PI;var l,c,u=i/2,p=[],d=[];for(c=0;o>=c;c++){var f=[],m=[],y=c/o,g=y*(t-e)+e;for(l=0;n>=l;l++){var v=l/n,b=new r.Vector3;b.x=g*Math.sin(v*h+a),b.y=-y*i+u,b.z=g*Math.cos(v*h+a),this.vertices.push(b),f.push(this.vertices.length-1),m.push(new r.Vector2(v,1-y))}p.push(f),d.push(m)}var _,x,w=(t-e)/i;for(l=0;n>l;l++)for(0!==e?(_=this.vertices[p[0][l]].clone(),x=this.vertices[p[0][l+1]].clone()):(_=this.vertices[p[1][l]].clone(),x=this.vertices[p[1][l+1]].clone()),_.setY(Math.sqrt(_.x*_.x+_.z*_.z)*w).normalize(),x.setY(Math.sqrt(x.x*x.x+x.z*x.z)*w).normalize(),c=0;o>c;c++){var S=p[c][l],M=p[c+1][l],T=p[c+1][l+1],E=p[c][l+1],k=_.clone(),A=_.clone(),C=x.clone(),P=x.clone(),L=d[c][l].clone(),R=d[c+1][l].clone(),O=d[c+1][l+1].clone(),F=d[c][l+1].clone();this.faces.push(new r.Face3(S,M,E,[k,A,P])),this.faceVertexUvs[0].push([L,R,F]),this.faces.push(new r.Face3(M,T,E,[A.clone(),C,P.clone()])),this.faceVertexUvs[0].push([R.clone(),O,F.clone()])}if(s===!1&&e>0)for(this.vertices.push(new r.Vector3(0,u,0)),l=0;n>l;l++){var S=p[0][l],M=p[0][l+1],T=this.vertices.length-1,k=new r.Vector3(0,1,0),A=new r.Vector3(0,1,0),C=new r.Vector3(0,1,0),L=d[0][l].clone(),R=d[0][l+1].clone(),O=new r.Vector2(R.x,0);this.faces.push(new r.Face3(S,M,T,[k,A,C],void 0,1)),this.faceVertexUvs[0].push([L,R,O])}if(s===!1&&t>0)for(this.vertices.push(new r.Vector3(0,-u,0)),l=0;n>l;l++){var S=p[o][l+1],M=p[o][l],T=this.vertices.length-1,k=new r.Vector3(0,-1,0),A=new r.Vector3(0,-1,0),C=new r.Vector3(0,-1,0),L=d[o][l+1].clone(),R=d[o][l].clone(),O=new r.Vector2(R.x,1);this.faces.push(new r.Face3(S,M,T,[k,A,C],void 0,2)),this.faceVertexUvs[0].push([L,R,O])}this.computeFaceNormals()},r.CylinderGeometry.prototype=Object.create(r.Geometry.prototype),r.CylinderGeometry.prototype.constructor=r.CylinderGeometry,r.CylinderGeometry.prototype.clone=function(){var e=new r.CylinderGeometry(this.parameters.radiusTop,this.parameters.radiusBottom,this.parameters.height,this.parameters.radialSegments,this.parameters.heightSegments,this.parameters.openEnded,this.parameters.thetaStart,this.parameters.thetaLength);return e},r.EdgesGeometry=function(e,t){r.BufferGeometry.call(this),t=void 0!==t?t:1;var i,n=Math.cos(r.Math.degToRad(t)),o=[0,0],s={},a=function(e,t){return e-t},h=["a","b","c"];e instanceof r.BufferGeometry?(i=new r.Geometry,i.fromBufferGeometry(e)):i=e.clone(),i.mergeVertices(),i.computeFaceNormals();for(var l=i.vertices,c=i.faces,u=0,p=c.length;p>u;u++)for(var d=c[u],f=0;3>f;f++){o[0]=d[h[f]],o[1]=d[h[(f+1)%3]],o.sort(a);var m=o.toString();void 0===s[m]?s[m]={vert1:o[0],vert2:o[1],face1:u,face2:void 0}:s[m].face2=u}var y=[];for(var m in s){var g=s[m];if(void 0===g.face2||c[g.face1].normal.dot(c[g.face2].normal)<=n){var v=l[g.vert1];y.push(v.x),y.push(v.y),y.push(v.z),v=l[g.vert2],y.push(v.x),y.push(v.y),y.push(v.z)}}this.addAttribute("position",new r.BufferAttribute(new Float32Array(y),3))},r.EdgesGeometry.prototype=Object.create(r.BufferGeometry.prototype),r.EdgesGeometry.prototype.constructor=r.EdgesGeometry,r.ExtrudeGeometry=function(e,t){return"undefined"==typeof e?void(e=[]):(r.Geometry.call(this),this.type="ExtrudeGeometry",e=Array.isArray(e)?e:[e],this.addShapeList(e,t),void this.computeFaceNormals())},r.ExtrudeGeometry.prototype=Object.create(r.Geometry.prototype),r.ExtrudeGeometry.prototype.constructor=r.ExtrudeGeometry,r.ExtrudeGeometry.prototype.addShapeList=function(e,t){for(var i=e.length,n=0;i>n;n++){var r=e[n];this.addShape(r,t)}},r.ExtrudeGeometry.prototype.addShape=function(e,t){function i(e,t,i){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(i).add(e)}function n(e,t,i){var n,o,s=1e-10,a=1,h=e.x-t.x,l=e.y-t.y,c=i.x-e.x,u=i.y-e.y,p=h*h+l*l,d=h*u-l*c;if(Math.abs(d)>s){var f=Math.sqrt(p),m=Math.sqrt(c*c+u*u),y=t.x-l/f,g=t.y+h/f,v=i.x-u/m,b=i.y+c/m,_=((v-y)*u-(b-g)*c)/(h*u-l*c);n=y+h*_-e.x,o=g+l*_-e.y;var x=n*n+o*o;if(2>=x)return new r.Vector2(n,o);a=Math.sqrt(x/2)}else{var w=!1;h>s?c>s&&(w=!0):-s>h?-s>c&&(w=!0):Math.sign(l)===Math.sign(u)&&(w=!0),w?(n=-l,o=h,a=Math.sqrt(p)):(n=h,o=l,a=Math.sqrt(p/2))}return new r.Vector2(n/a,o/a)}function o(){if(_){var e=0,t=G*e;for(W=0;q>W;W++)I=D[W],l(I[2]+t,I[1]+t,I[0]+t);for(e=w+2*b,t=G*e,W=0;q>W;W++)I=D[W],l(I[0]+t,I[1]+t,I[2]+t)}else{for(W=0;q>W;W++)I=D[W],l(I[2],I[1],I[0]);for(W=0;q>W;W++)I=D[W],l(I[0]+G*w,I[1]+G*w,I[2]+G*w)}}function s(){var e=0;for(a(B,e),e+=B.length,k=0,A=O.length;A>k;k++)E=O[k],a(E,e),e+=E.length}function a(e,t){var i,n;for(W=e.length;--W>=0;){i=W,n=W-1,0>n&&(n=e.length-1);var r=0,o=w+2*b;for(r=0;o>r;r++){var s=G*r,a=G*(r+1),h=t+i+s,l=t+n+s,u=t+n+a,p=t+i+a;c(h,l,u,p,e,r,o,i,n)}}}function h(e,t,i){C.vertices.push(new r.Vector3(e,t,i))}function l(e,t,i){e+=P,t+=P,i+=P,C.faces.push(new r.Face3(e,t,i));var n=T.generateTopUV(C,e,t,i);C.faceVertexUvs[0].push(n)}function c(e,t,i,n,o,s,a,h,l){e+=P,t+=P,i+=P,n+=P,C.faces.push(new r.Face3(e,t,n)),C.faces.push(new r.Face3(t,i,n));var c=T.generateSideWallUV(C,e,t,i,n);C.faceVertexUvs[0].push([c[0],c[1],c[3]]),C.faceVertexUvs[0].push([c[1],c[2],c[3]])}var u,p,d,f,m,y=void 0!==t.amount?t.amount:100,g=void 0!==t.bevelThickness?t.bevelThickness:6,v=void 0!==t.bevelSize?t.bevelSize:g-2,b=void 0!==t.bevelSegments?t.bevelSegments:3,_=void 0!==t.bevelEnabled?t.bevelEnabled:!0,x=void 0!==t.curveSegments?t.curveSegments:12,w=void 0!==t.steps?t.steps:1,S=t.extrudePath,M=!1,T=void 0!==t.UVGenerator?t.UVGenerator:r.ExtrudeGeometry.WorldUVGenerator;S&&(u=S.getSpacedPoints(w),M=!0,_=!1,p=void 0!==t.frames?t.frames:new r.TubeGeometry.FrenetFrames(S,w,!1),d=new r.Vector3,f=new r.Vector3,m=new r.Vector3),_||(b=0,g=0,v=0);var E,k,A,C=this,P=this.vertices.length,L=e.extractPoints(x),R=L.shape,O=L.holes,F=!r.Shape.Utils.isClockWise(R);if(F){for(R=R.reverse(),k=0,A=O.length;A>k;k++)E=O[k],r.Shape.Utils.isClockWise(E)&&(O[k]=E.reverse());F=!1}var D=r.Shape.Utils.triangulateShape(R,O),B=R;for(k=0,A=O.length;A>k;k++)E=O[k],R=R.concat(E);for(var N,j,V,z,U,I,G=R.length,q=D.length,H=[],W=0,$=B.length,X=$-1,J=W+1;$>W;W++,X++,J++)X===$&&(X=0),J===$&&(J=0),H[W]=n(B[W],B[X],B[J]);var Y,Q=[],K=H.concat();for(k=0,A=O.length;A>k;k++){for(E=O[k],Y=[],W=0,$=E.length,X=$-1,J=W+1;$>W;W++,X++,J++)X===$&&(X=0),J===$&&(J=0),Y[W]=n(E[W],E[X],E[J]);Q.push(Y),K=K.concat(Y)}for(N=0;b>N;N++){for(V=N/b,z=g*(1-V),j=v*Math.sin(V*Math.PI/2),W=0,$=B.length;$>W;W++)U=i(B[W],H[W],j),h(U.x,U.y,-z);for(k=0,A=O.length;A>k;k++)for(E=O[k],Y=Q[k],W=0,$=E.length;$>W;W++)U=i(E[W],Y[W],j),h(U.x,U.y,-z)}for(j=v,W=0;G>W;W++)U=_?i(R[W],K[W],j):R[W],M?(f.copy(p.normals[0]).multiplyScalar(U.x),d.copy(p.binormals[0]).multiplyScalar(U.y),m.copy(u[0]).add(f).add(d),h(m.x,m.y,m.z)):h(U.x,U.y,0);var Z;for(Z=1;w>=Z;Z++)for(W=0;G>W;W++)U=_?i(R[W],K[W],j):R[W],M?(f.copy(p.normals[Z]).multiplyScalar(U.x),d.copy(p.binormals[Z]).multiplyScalar(U.y),m.copy(u[Z]).add(f).add(d),h(m.x,m.y,m.z)):h(U.x,U.y,y/w*Z);for(N=b-1;N>=0;N--){for(V=N/b,z=g*(1-V),j=v*Math.sin(V*Math.PI/2),W=0,$=B.length;$>W;W++)U=i(B[W],H[W],j),h(U.x,U.y,y+z);for(k=0,A=O.length;A>k;k++)for(E=O[k],Y=Q[k],W=0,$=E.length;$>W;W++)U=i(E[W],Y[W],j),M?h(U.x,U.y+u[w-1].y,u[w-1].x+z):h(U.x,U.y,y+z)}o(),s()},r.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(e,t,i,n){var o=e.vertices,s=o[t],a=o[i],h=o[n];return[new r.Vector2(s.x,s.y),new r.Vector2(a.x,a.y),new r.Vector2(h.x,h.y)]},generateSideWallUV:function(e,t,i,n,o){var s=e.vertices,a=s[t],h=s[i],l=s[n],c=s[o];return Math.abs(a.y-h.y)<.01?[new r.Vector2(a.x,1-a.z),new r.Vector2(h.x,1-h.z),new r.Vector2(l.x,1-l.z),new r.Vector2(c.x,1-c.z)]:[new r.Vector2(a.y,1-a.z),new r.Vector2(h.y,1-h.z),new r.Vector2(l.y,1-l.z),new r.Vector2(c.y,1-c.z)]}},r.ShapeGeometry=function(e,t){r.Geometry.call(this),this.type="ShapeGeometry",Array.isArray(e)===!1&&(e=[e]),this.addShapeList(e,t),this.computeFaceNormals()},r.ShapeGeometry.prototype=Object.create(r.Geometry.prototype),r.ShapeGeometry.prototype.constructor=r.ShapeGeometry,r.ShapeGeometry.prototype.addShapeList=function(e,t){for(var i=0,n=e.length;n>i;i++)this.addShape(e[i],t);return this},r.ShapeGeometry.prototype.addShape=function(e,t){void 0===t&&(t={});var i,n,o,s=void 0!==t.curveSegments?t.curveSegments:12,a=t.material,h=void 0===t.UVGenerator?r.ExtrudeGeometry.WorldUVGenerator:t.UVGenerator,l=this.vertices.length,c=e.extractPoints(s),u=c.shape,p=c.holes,d=!r.Shape.Utils.isClockWise(u);if(d){for(u=u.reverse(),i=0,n=p.length;n>i;i++)o=p[i],r.Shape.Utils.isClockWise(o)&&(p[i]=o.reverse());d=!1}var f=r.Shape.Utils.triangulateShape(u,p);for(i=0,n=p.length;n>i;i++)o=p[i],u=u.concat(o);var m,y,g=u.length,v=f.length;for(i=0;g>i;i++)m=u[i],this.vertices.push(new r.Vector3(m.x,m.y,0));for(i=0;v>i;i++){y=f[i];var b=y[0]+l,_=y[1]+l,x=y[2]+l;this.faces.push(new r.Face3(b,_,x,null,null,a)),this.faceVertexUvs[0].push(h.generateTopUV(this,b,_,x))}},r.LatheGeometry=function(e,t,i,n){r.Geometry.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:n},t=t||12,i=i||0,n=n||2*Math.PI;for(var o=1/(e.length-1),s=1/t,a=0,h=t;h>=a;a++)for(var l=i+a*s*n,c=Math.cos(l),u=Math.sin(l),p=0,d=e.length;d>p;p++){var f=e[p],m=new r.Vector3;m.x=c*f.x-u*f.y,m.y=u*f.x+c*f.y,m.z=f.z,this.vertices.push(m)}for(var y=e.length,a=0,h=t;h>a;a++)for(var p=0,d=e.length-1;d>p;p++){var g=p+y*a,v=g,b=g+y,c=g+1+y,_=g+1,x=a*s,w=p*o,S=x+s,M=w+o;this.faces.push(new r.Face3(v,b,_)),this.faceVertexUvs[0].push([new r.Vector2(x,w),new r.Vector2(S,w),new r.Vector2(x,M)]),this.faces.push(new r.Face3(b,c,_)),this.faceVertexUvs[0].push([new r.Vector2(S,w),new r.Vector2(S,M),new r.Vector2(x,M)])}this.mergeVertices(),this.computeFaceNormals(),this.computeVertexNormals()},r.LatheGeometry.prototype=Object.create(r.Geometry.prototype),r.LatheGeometry.prototype.constructor=r.LatheGeometry,r.PlaneGeometry=function(e,t,i,n){r.Geometry.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:n},this.fromBufferGeometry(new r.PlaneBufferGeometry(e,t,i,n))},r.PlaneGeometry.prototype=Object.create(r.Geometry.prototype),r.PlaneGeometry.prototype.constructor=r.PlaneGeometry,r.PlaneGeometry.prototype.clone=function(){var e=new r.PlaneGeometry(this.parameters.width,this.parameters.height,this.parameters.widthSegments,this.parameters.heightSegments);return e},r.PlaneBufferGeometry=function(e,t,i,n){r.BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:n};for(var o=e/2,s=t/2,a=Math.floor(i)||1,h=Math.floor(n)||1,l=a+1,c=h+1,u=e/a,p=t/h,d=new Float32Array(l*c*3),f=new Float32Array(l*c*3),m=new Float32Array(l*c*2),y=0,g=0,v=0;c>v;v++)for(var b=v*p-s,_=0;l>_;_++){var x=_*u-o;d[y]=x,d[y+1]=-b,f[y+2]=1,m[g]=_/a,m[g+1]=1-v/h,y+=3,g+=2}y=0;for(var w=new(d.length/3>65535?Uint32Array:Uint16Array)(a*h*6),v=0;h>v;v++)for(var _=0;a>_;_++){var S=_+l*v,M=_+l*(v+1),T=_+1+l*(v+1),E=_+1+l*v;w[y]=S,w[y+1]=M,w[y+2]=E,w[y+3]=M,w[y+4]=T,w[y+5]=E,y+=6}this.setIndex(new r.BufferAttribute(w,1)),this.addAttribute("position",new r.BufferAttribute(d,3)),this.addAttribute("normal",new r.BufferAttribute(f,3)),this.addAttribute("uv",new r.BufferAttribute(m,2))},r.PlaneBufferGeometry.prototype=Object.create(r.BufferGeometry.prototype),r.PlaneBufferGeometry.prototype.constructor=r.PlaneBufferGeometry,r.PlaneBufferGeometry.prototype.clone=function(){var e=new r.PlaneBufferGeometry(this.parameters.width,this.parameters.height,this.parameters.widthSegments,this.parameters.heightSegments);return e.copy(this),e},r.RingGeometry=function(e,t,i,n,o,s){r.Geometry.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:n,thetaStart:o,thetaLength:s},e=e||0,t=t||50,o=void 0!==o?o:0,s=void 0!==s?s:2*Math.PI,i=void 0!==i?Math.max(3,i):8,n=void 0!==n?Math.max(1,n):8;var a,h,l=[],c=e,u=(t-e)/n;
for(a=0;n+1>a;a++){for(h=0;i+1>h;h++){var p=new r.Vector3,d=o+h/i*s;p.x=c*Math.cos(d),p.y=c*Math.sin(d),this.vertices.push(p),l.push(new r.Vector2((p.x/t+1)/2,(p.y/t+1)/2))}c+=u}var f=new r.Vector3(0,0,1);for(a=0;n>a;a++){var m=a*(i+1);for(h=0;i>h;h++){var d=h+m,y=d,g=d+i+1,v=d+i+2;this.faces.push(new r.Face3(y,g,v,[f.clone(),f.clone(),f.clone()])),this.faceVertexUvs[0].push([l[y].clone(),l[g].clone(),l[v].clone()]),y=d,g=d+i+2,v=d+1,this.faces.push(new r.Face3(y,g,v,[f.clone(),f.clone(),f.clone()])),this.faceVertexUvs[0].push([l[y].clone(),l[g].clone(),l[v].clone()])}}this.computeFaceNormals(),this.boundingSphere=new r.Sphere(new r.Vector3,c)},r.RingGeometry.prototype=Object.create(r.Geometry.prototype),r.RingGeometry.prototype.constructor=r.RingGeometry,r.RingGeometry.prototype.clone=function(){var e=new r.RingGeometry(this.parameters.innerRadius,this.parameters.outerRadius,this.parameters.thetaSegments,this.parameters.phiSegments,this.parameters.thetaStart,this.parameters.thetaLength);return e},r.SphereGeometry=function(e,t,i,n,o,s,a){r.Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:n,phiLength:o,thetaStart:s,thetaLength:a},this.fromBufferGeometry(new r.SphereBufferGeometry(e,t,i,n,o,s,a))},r.SphereGeometry.prototype=Object.create(r.Geometry.prototype),r.SphereGeometry.prototype.constructor=r.SphereGeometry,r.SphereGeometry.prototype.clone=function(){var e=new r.SphereGeometry(this.parameters.radius,this.parameters.widthSegments,this.parameters.heightSegments,this.parameters.phiStart,this.parameters.phiLength,this.parameters.thetaStart,this.parameters.thetaLength);return e},r.SphereBufferGeometry=function(e,t,i,n,o,s,a){r.BufferGeometry.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:n,phiLength:o,thetaStart:s,thetaLength:a},e=e||50,t=Math.max(3,Math.floor(t)||8),i=Math.max(2,Math.floor(i)||6),n=void 0!==n?n:0,o=void 0!==o?o:2*Math.PI,s=void 0!==s?s:0,a=void 0!==a?a:Math.PI;for(var h=s+a,l=(t+1)*(i+1),c=new r.BufferAttribute(new Float32Array(3*l),3),u=new r.BufferAttribute(new Float32Array(3*l),3),p=new r.BufferAttribute(new Float32Array(2*l),2),d=0,f=[],m=new r.Vector3,y=0;i>=y;y++){for(var g=[],v=y/i,b=0;t>=b;b++){var _=b/t,x=-e*Math.cos(n+_*o)*Math.sin(s+v*a),w=e*Math.cos(s+v*a),S=e*Math.sin(n+_*o)*Math.sin(s+v*a);m.set(x,w,S).normalize(),c.setXYZ(d,x,w,S),u.setXYZ(d,m.x,m.y,m.z),p.setXY(d,_,1-v),g.push(d),d++}f.push(g)}for(var M=[],y=0;i>y;y++)for(var b=0;t>b;b++){var T=f[y][b+1],E=f[y][b],k=f[y+1][b],A=f[y+1][b+1];(0!==y||s>0)&&M.push(T,E,A),(y!==i-1||h<Math.PI)&&M.push(E,k,A)}this.setIndex(new r.BufferAttribute(new Uint16Array(M),1)),this.addAttribute("position",c),this.addAttribute("normal",u),this.addAttribute("uv",p),this.boundingSphere=new r.Sphere(new r.Vector3,e)},r.SphereBufferGeometry.prototype=Object.create(r.BufferGeometry.prototype),r.SphereBufferGeometry.prototype.constructor=r.SphereBufferGeometry,r.SphereBufferGeometry.prototype.clone=function(){var e=new r.SphereBufferGeometry(this.parameters.radius,this.parameters.widthSegments,this.parameters.heightSegments,this.parameters.phiStart,this.parameters.phiLength,this.parameters.thetaStart,this.parameters.thetaLength);return e.copy(this),e},r.TextGeometry=function(e,t){t=t||{};var i=r.FontUtils.generateShapes(e,t);t.amount=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),r.ExtrudeGeometry.call(this,i,t),this.type="TextGeometry"},r.TextGeometry.prototype=Object.create(r.ExtrudeGeometry.prototype),r.TextGeometry.prototype.constructor=r.TextGeometry,r.TorusGeometry=function(e,t,i,n,o){r.Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:n,arc:o},e=e||100,t=t||40,i=i||8,n=n||6,o=o||2*Math.PI;for(var s=new r.Vector3,a=[],h=[],l=0;i>=l;l++)for(var c=0;n>=c;c++){var u=c/n*o,p=l/i*Math.PI*2;s.x=e*Math.cos(u),s.y=e*Math.sin(u);var d=new r.Vector3;d.x=(e+t*Math.cos(p))*Math.cos(u),d.y=(e+t*Math.cos(p))*Math.sin(u),d.z=t*Math.sin(p),this.vertices.push(d),a.push(new r.Vector2(c/n,l/i)),h.push(d.clone().sub(s).normalize())}for(var l=1;i>=l;l++)for(var c=1;n>=c;c++){var f=(n+1)*l+c-1,m=(n+1)*(l-1)+c-1,y=(n+1)*(l-1)+c,g=(n+1)*l+c,v=new r.Face3(f,m,g,[h[f].clone(),h[m].clone(),h[g].clone()]);this.faces.push(v),this.faceVertexUvs[0].push([a[f].clone(),a[m].clone(),a[g].clone()]),v=new r.Face3(m,y,g,[h[m].clone(),h[y].clone(),h[g].clone()]),this.faces.push(v),this.faceVertexUvs[0].push([a[m].clone(),a[y].clone(),a[g].clone()])}this.computeFaceNormals()},r.TorusGeometry.prototype=Object.create(r.Geometry.prototype),r.TorusGeometry.prototype.constructor=r.TorusGeometry,r.TorusGeometry.prototype.clone=function(){var e=new r.TorusGeometry(this.parameters.radius,this.parameters.tube,this.parameters.radialSegments,this.parameters.tubularSegments,this.parameters.arc);return e},r.TorusKnotGeometry=function(e,t,i,n,o,s,a){function h(e,t,i,n,o){var s=Math.cos(e),a=Math.sin(e),h=t/i*e,l=Math.cos(h),c=n*(2+l)*.5*s,u=n*(2+l)*a*.5,p=o*n*Math.sin(h)*.5;return new r.Vector3(c,u,p)}r.Geometry.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:n,p:o,q:s,heightScale:a},e=e||100,t=t||40,i=i||64,n=n||8,o=o||2,s=s||3,a=a||1;for(var l=new Array(i),c=new r.Vector3,u=new r.Vector3,p=new r.Vector3,d=0;i>d;++d){l[d]=new Array(n);var f=d/i*2*o*Math.PI,m=h(f,s,o,e,a),y=h(f+.01,s,o,e,a);c.subVectors(y,m),u.addVectors(y,m),p.crossVectors(c,u),u.crossVectors(p,c),p.normalize(),u.normalize();for(var g=0;n>g;++g){var v=g/n*2*Math.PI,b=-t*Math.cos(v),_=t*Math.sin(v),x=new r.Vector3;x.x=m.x+b*u.x+_*p.x,x.y=m.y+b*u.y+_*p.y,x.z=m.z+b*u.z+_*p.z,l[d][g]=this.vertices.push(x)-1}}for(var d=0;i>d;++d)for(var g=0;n>g;++g){var w=(d+1)%i,S=(g+1)%n,M=l[d][g],T=l[w][g],E=l[w][S],k=l[d][S],A=new r.Vector2(d/i,g/n),C=new r.Vector2((d+1)/i,g/n),P=new r.Vector2((d+1)/i,(g+1)/n),L=new r.Vector2(d/i,(g+1)/n);this.faces.push(new r.Face3(M,T,k)),this.faceVertexUvs[0].push([A,C,L]),this.faces.push(new r.Face3(T,E,k)),this.faceVertexUvs[0].push([C.clone(),P,L.clone()])}this.computeFaceNormals(),this.computeVertexNormals()},r.TorusKnotGeometry.prototype=Object.create(r.Geometry.prototype),r.TorusKnotGeometry.prototype.constructor=r.TorusKnotGeometry,r.TorusKnotGeometry.prototype.clone=function(){var e=new r.TorusKnotGeometry(this.parameters.radius,this.parameters.tube,this.parameters.radialSegments,this.parameters.tubularSegments,this.parameters.p,this.parameters.q,this.parameters.heightScale);return e},r.TubeGeometry=function(e,t,i,n,o,s){function a(e,t,i){return P.vertices.push(new r.Vector3(e,t,i))-1}r.Geometry.call(this),this.type="TubeGeometry",this.parameters={path:e,segments:t,radius:i,radialSegments:n,closed:o},t=t||64,i=i||1,n=n||8,o=o||!1,s=s||r.TubeGeometry.NoTaper;var h,l,c,u,p,d,f,m,y,g,v,b,_,x,w,S,M,T,E,k,A,C=[],P=this,L=t+1,R=new r.Vector3,O=new r.TubeGeometry.FrenetFrames(e,t,o),F=O.tangents,D=O.normals,B=O.binormals;for(this.tangents=F,this.normals=D,this.binormals=B,g=0;L>g;g++)for(C[g]=[],u=g/(L-1),y=e.getPointAt(u),h=F[g],l=D[g],c=B[g],d=i*s(u),v=0;n>v;v++)p=v/n*2*Math.PI,f=-d*Math.cos(p),m=d*Math.sin(p),R.copy(y),R.x+=f*l.x+m*c.x,R.y+=f*l.y+m*c.y,R.z+=f*l.z+m*c.z,C[g][v]=a(R.x,R.y,R.z);for(g=0;t>g;g++)for(v=0;n>v;v++)b=o?(g+1)%t:g+1,_=(v+1)%n,x=C[g][v],w=C[b][v],S=C[b][_],M=C[g][_],T=new r.Vector2(g/t,v/n),E=new r.Vector2((g+1)/t,v/n),k=new r.Vector2((g+1)/t,(v+1)/n),A=new r.Vector2(g/t,(v+1)/n),this.faces.push(new r.Face3(x,w,M)),this.faceVertexUvs[0].push([T,E,A]),this.faces.push(new r.Face3(w,S,M)),this.faceVertexUvs[0].push([E.clone(),k,A.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},r.TubeGeometry.prototype=Object.create(r.Geometry.prototype),r.TubeGeometry.prototype.constructor=r.TubeGeometry,r.TubeGeometry.NoTaper=function(e){return 1},r.TubeGeometry.SinusoidalTaper=function(e){return Math.sin(Math.PI*e)},r.TubeGeometry.FrenetFrames=function(e,t,i){function n(){f[0]=new r.Vector3,m[0]=new r.Vector3,s=Number.MAX_VALUE,a=Math.abs(d[0].x),h=Math.abs(d[0].y),l=Math.abs(d[0].z),s>=a&&(s=a,p.set(1,0,0)),s>=h&&(s=h,p.set(0,1,0)),s>=l&&p.set(0,0,1),y.crossVectors(d[0],p).normalize(),f[0].crossVectors(d[0],y),m[0].crossVectors(d[0],f[0])}var o,s,a,h,l,c,u,p=new r.Vector3,d=[],f=[],m=[],y=new r.Vector3,g=new r.Matrix4,v=t+1,b=1e-4;for(this.tangents=d,this.normals=f,this.binormals=m,c=0;v>c;c++)u=c/(v-1),d[c]=e.getTangentAt(u),d[c].normalize();for(n(),c=1;v>c;c++)f[c]=f[c-1].clone(),m[c]=m[c-1].clone(),y.crossVectors(d[c-1],d[c]),y.length()>b&&(y.normalize(),o=Math.acos(r.Math.clamp(d[c-1].dot(d[c]),-1,1)),f[c].applyMatrix4(g.makeRotationAxis(y,o))),m[c].crossVectors(d[c],f[c]);if(i)for(o=Math.acos(r.Math.clamp(f[0].dot(f[v-1]),-1,1)),o/=v-1,d[0].dot(y.crossVectors(f[0],f[v-1]))>0&&(o=-o),c=1;v>c;c++)f[c].applyMatrix4(g.makeRotationAxis(d[c],o*c)),m[c].crossVectors(d[c],f[c])},r.PolyhedronGeometry=function(e,t,i,n){function o(e){var t=e.normalize().clone();t.index=u.vertices.push(t)-1;var i=h(e)/2/Math.PI+.5,n=l(e)/Math.PI+.5;return t.uv=new r.Vector2(i,1-n),t}function s(e,t,i,n){var o=new r.Face3(e.index,t.index,i.index,[e.clone(),t.clone(),i.clone()],void 0,n);u.faces.push(o),_.copy(e).add(t).add(i).divideScalar(3);var s=h(_);u.faceVertexUvs[0].push([c(e.uv,e,s),c(t.uv,t,s),c(i.uv,i,s)])}function a(e,t){for(var i=Math.pow(2,t),n=o(u.vertices[e.a]),r=o(u.vertices[e.b]),a=o(u.vertices[e.c]),h=[],l=e.materialIndex,c=0;i>=c;c++){h[c]=[];for(var p=o(n.clone().lerp(a,c/i)),d=o(r.clone().lerp(a,c/i)),f=i-c,m=0;f>=m;m++)0===m&&c===i?h[c][m]=p:h[c][m]=o(p.clone().lerp(d,m/f))}for(var c=0;i>c;c++)for(var m=0;2*(i-c)-1>m;m++){var y=Math.floor(m/2);m%2===0?s(h[c][y+1],h[c+1][y],h[c][y],l):s(h[c][y+1],h[c+1][y+1],h[c+1][y],l)}}function h(e){return Math.atan2(e.z,-e.x)}function l(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}function c(e,t,i){return 0>i&&1===e.x&&(e=new r.Vector2(e.x-1,e.y)),0===t.x&&0===t.z&&(e=new r.Vector2(i/2/Math.PI+.5,e.y)),e.clone()}r.Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:n},i=i||1,n=n||0;for(var u=this,p=0,d=e.length;d>p;p+=3)o(new r.Vector3(e[p],e[p+1],e[p+2]));for(var f=this.vertices,m=[],p=0,y=0,d=t.length;d>p;p+=3,y++){var g=f[t[p]],v=f[t[p+1]],b=f[t[p+2]];m[y]=new r.Face3(g.index,v.index,b.index,[g.clone(),v.clone(),b.clone()],void 0,y)}for(var _=new r.Vector3,p=0,d=m.length;d>p;p++)a(m[p],n);for(var p=0,d=this.faceVertexUvs[0].length;d>p;p++){var x=this.faceVertexUvs[0][p],w=x[0].x,S=x[1].x,M=x[2].x,T=Math.max(w,Math.max(S,M)),E=Math.min(w,Math.min(S,M));T>.9&&.1>E&&(.2>w&&(x[0].x+=1),.2>S&&(x[1].x+=1),.2>M&&(x[2].x+=1))}for(var p=0,d=this.vertices.length;d>p;p++)this.vertices[p].multiplyScalar(i);this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new r.Sphere(new r.Vector3,i)},r.PolyhedronGeometry.prototype=Object.create(r.Geometry.prototype),r.PolyhedronGeometry.prototype.constructor=r.PolyhedronGeometry,r.PolyhedronGeometry.prototype.clone=function(){var e=new r.PolyhedronGeometry(this.parameters.vertices,this.parameters.indices,this.parameters.radius,this.parameters.detail);return e.copy(this)},r.PolyhedronGeometry.prototype.copy=function(e){return r.Geometry.prototype.copy.call(this,e),this},r.DodecahedronGeometry=function(e,t){var i=(1+Math.sqrt(5))/2,n=1/i,o=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];r.PolyhedronGeometry.call(this,o,s,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}},r.DodecahedronGeometry.prototype=Object.create(r.PolyhedronGeometry.prototype),r.DodecahedronGeometry.prototype.constructor=r.DodecahedronGeometry,r.DodecahedronGeometry.prototype.clone=function(){var e=new r.DodecahedronGeometry(this.parameters.radius,this.parameters.detail);return e.copy(this),e},r.IcosahedronGeometry=function(e,t){var i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],o=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];r.PolyhedronGeometry.call(this,n,o,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}},r.IcosahedronGeometry.prototype=Object.create(r.PolyhedronGeometry.prototype),r.IcosahedronGeometry.prototype.constructor=r.IcosahedronGeometry,r.IcosahedronGeometry.prototype.clone=function(){var e=new r.IcosahedronGeometry(this.parameters.radius,this.parameters.detail);return e.copy(this),e},r.OctahedronGeometry=function(e,t){var i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],n=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];r.PolyhedronGeometry.call(this,i,n,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}},r.OctahedronGeometry.prototype=Object.create(r.PolyhedronGeometry.prototype),r.OctahedronGeometry.prototype.constructor=r.OctahedronGeometry,r.OctahedronGeometry.prototype.clone=function(){var e=new r.OctahedronGeometry(this.parameters.radius,this.parameters.detail);return e.copy(this),e},r.TetrahedronGeometry=function(e,t){var i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],n=[2,1,0,0,3,2,1,3,0,2,3,1];r.PolyhedronGeometry.call(this,i,n,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}},r.TetrahedronGeometry.prototype=Object.create(r.PolyhedronGeometry.prototype),r.TetrahedronGeometry.prototype.constructor=r.TetrahedronGeometry,r.TetrahedronGeometry.prototype.clone=function(){var e=new r.TetrahedronGeometry(this.parameters.radius,this.parameters.detail);return e.copy(this),e},r.ParametricGeometry=function(e,t,i){r.Geometry.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:i};var n,o,s,a,h,l=this.vertices,c=this.faces,u=this.faceVertexUvs[0],p=t+1;for(n=0;i>=n;n++)for(h=n/i,o=0;t>=o;o++)a=o/t,s=e(a,h),l.push(s);var d,f,m,y,g,v,b,_;for(n=0;i>n;n++)for(o=0;t>o;o++)d=n*p+o,f=n*p+o+1,m=(n+1)*p+o+1,y=(n+1)*p+o,g=new r.Vector2(o/t,n/i),v=new r.Vector2((o+1)/t,n/i),b=new r.Vector2((o+1)/t,(n+1)/i),_=new r.Vector2(o/t,(n+1)/i),c.push(new r.Face3(d,f,y)),u.push([g,v,_]),c.push(new r.Face3(f,m,y)),u.push([v.clone(),b,_.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},r.ParametricGeometry.prototype=Object.create(r.Geometry.prototype),r.ParametricGeometry.prototype.constructor=r.ParametricGeometry,r.WireframeGeometry=function(e){r.BufferGeometry.call(this);var t=[0,0],i={},n=function(e,t){return e-t},o=["a","b","c"];if(e instanceof r.Geometry){for(var s=e.vertices,a=e.faces,h=0,l=new Uint32Array(6*a.length),c=0,u=a.length;u>c;c++)for(var p=a[c],d=0;3>d;d++){t[0]=p[o[d]],t[1]=p[o[(d+1)%3]],t.sort(n);var f=t.toString();void 0===i[f]&&(l[2*h]=t[0],l[2*h+1]=t[1],i[f]=!0,h++)}for(var m=new Float32Array(2*h*3),c=0,u=h;u>c;c++)for(var d=0;2>d;d++){var y=s[l[2*c+d]],g=6*c+3*d;m[g+0]=y.x,m[g+1]=y.y,m[g+2]=y.z}this.addAttribute("position",new r.BufferAttribute(m,3))}else if(e instanceof r.BufferGeometry)if(null!==e.index){var v=e.index.array,s=e.attributes.position,b=e.drawcalls,h=0;0===b.length&&e.addDrawCall(0,v.length);for(var l=new Uint32Array(2*v.length),_=0,x=b.length;x>_;++_)for(var w=b[_],S=w.start,M=w.count,c=S,T=S+M;T>c;c+=3)for(var d=0;3>d;d++){t[0]=v[c+d],t[1]=v[c+(d+1)%3],t.sort(n);var f=t.toString();void 0===i[f]&&(l[2*h]=t[0],l[2*h+1]=t[1],i[f]=!0,h++)}for(var m=new Float32Array(2*h*3),c=0,u=h;u>c;c++)for(var d=0;2>d;d++){var g=6*c+3*d,E=l[2*c+d];m[g+0]=s.getX(E),m[g+1]=s.getY(E),m[g+2]=s.getZ(E)}this.addAttribute("position",new r.BufferAttribute(m,3))}else{for(var s=e.attributes.position.array,h=s.length/3,k=h/3,m=new Float32Array(2*h*3),c=0,u=k;u>c;c++)for(var d=0;3>d;d++){var g=18*c+6*d,A=9*c+3*d;m[g+0]=s[A],m[g+1]=s[A+1],m[g+2]=s[A+2];var E=9*c+3*((d+1)%3);m[g+3]=s[E],m[g+4]=s[E+1],m[g+5]=s[E+2]}this.addAttribute("position",new r.BufferAttribute(m,3))}},r.WireframeGeometry.prototype=Object.create(r.BufferGeometry.prototype),r.WireframeGeometry.prototype.constructor=r.WireframeGeometry,r.AxisHelper=function(e){e=e||1;var t=new Float32Array([0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e]),i=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]),n=new r.BufferGeometry;n.addAttribute("position",new r.BufferAttribute(t,3)),n.addAttribute("color",new r.BufferAttribute(i,3));var o=new r.LineBasicMaterial({vertexColors:r.VertexColors});r.LineSegments.call(this,n,o)},r.AxisHelper.prototype=Object.create(r.LineSegments.prototype),r.AxisHelper.prototype.constructor=r.AxisHelper,r.ArrowHelper=function(){var e=new r.Geometry;e.vertices.push(new r.Vector3(0,0,0),new r.Vector3(0,1,0));var t=new r.CylinderGeometry(0,.5,1,5,1);return t.translate(0,-.5,0),function(i,n,o,s,a,h){r.Object3D.call(this),void 0===s&&(s=16776960),void 0===o&&(o=1),void 0===a&&(a=.2*o),void 0===h&&(h=.2*a),this.position.copy(n),o>a&&(this.line=new r.Line(e,new r.LineBasicMaterial({color:s})),this.line.matrixAutoUpdate=!1,this.add(this.line)),this.cone=new r.Mesh(t,new r.MeshBasicMaterial({color:s})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(i),this.setLength(o,a,h)}}(),r.ArrowHelper.prototype=Object.create(r.Object3D.prototype),r.ArrowHelper.prototype.constructor=r.ArrowHelper,r.ArrowHelper.prototype.setDirection=function(){var e,t=new r.Vector3;return function(i){i.y>.99999?this.quaternion.set(0,0,0,1):i.y<-.99999?this.quaternion.set(1,0,0,0):(t.set(i.z,0,-i.x).normalize(),e=Math.acos(i.y),this.quaternion.setFromAxisAngle(t,e))}}(),r.ArrowHelper.prototype.setLength=function(e,t,i){void 0===t&&(t=.2*e),void 0===i&&(i=.2*t),e>t&&(this.line.scale.set(1,e-t,1),this.line.updateMatrix()),this.cone.scale.set(i,t,i),this.cone.position.y=e,this.cone.updateMatrix()},r.ArrowHelper.prototype.setColor=function(e){void 0!==this.line&&this.line.material.color.set(e),this.cone.material.color.set(e)},r.BoxHelper=function(e){var t=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),n=new r.BufferGeometry;n.setIndex(new r.BufferAttribute(t,1)),n.addAttribute("position",new r.BufferAttribute(i,3)),r.LineSegments.call(this,n,new r.LineBasicMaterial({color:16776960})),void 0!==e&&this.update(e)},r.BoxHelper.prototype=Object.create(r.LineSegments.prototype),r.BoxHelper.prototype.constructor=r.BoxHelper,r.BoxHelper.prototype.update=function(){var e=new r.Box3;return function(t){if(e.setFromObject(t),!e.empty()){var i=e.min,n=e.max,r=this.geometry.attributes.position,o=r.array;o[0]=n.x,o[1]=n.y,o[2]=n.z,o[3]=i.x,o[4]=n.y,o[5]=n.z,o[6]=i.x,o[7]=i.y,o[8]=n.z,o[9]=n.x,o[10]=i.y,o[11]=n.z,o[12]=n.x,o[13]=n.y,o[14]=i.z,o[15]=i.x,o[16]=n.y,o[17]=i.z,o[18]=i.x,o[19]=i.y,o[20]=i.z,o[21]=n.x,o[22]=i.y,o[23]=i.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),r.BoundingBoxHelper=function(e,t){var i=void 0!==t?t:8947848;this.object=e,this.box=new r.Box3,r.Mesh.call(this,new r.BoxGeometry(1,1,1),new r.MeshBasicMaterial({color:i,wireframe:!0}))},r.BoundingBoxHelper.prototype=Object.create(r.Mesh.prototype),r.BoundingBoxHelper.prototype.constructor=r.BoundingBoxHelper,r.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position)},r.CameraHelper=function(e){function t(e,t,n){i(e,n),i(t,n)}function i(e,t){n.vertices.push(new r.Vector3),n.colors.push(new r.Color(t)),void 0===s[e]&&(s[e]=[]),s[e].push(n.vertices.length-1)}var n=new r.Geometry,o=new r.LineBasicMaterial({color:16777215,vertexColors:r.FaceColors}),s={},a=16755200,h=16711680,l=43775,c=16777215,u=3355443;t("n1","n2",a),t("n2","n4",a),t("n4","n3",a),t("n3","n1",a),t("f1","f2",a),t("f2","f4",a),t("f4","f3",a),t("f3","f1",a),t("n1","f1",a),t("n2","f2",a),t("n3","f3",a),t("n4","f4",a),t("p","n1",h),t("p","n2",h),t("p","n3",h),t("p","n4",h),t("u1","u2",l),t("u2","u3",l),t("u3","u1",l),t("c","t",c),t("p","c",u),t("cn1","cn2",u),t("cn3","cn4",u),t("cf1","cf2",u),t("cf3","cf4",u),r.LineSegments.call(this,n,o),this.camera=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()},r.CameraHelper.prototype=Object.create(r.LineSegments.prototype),r.CameraHelper.prototype.constructor=r.CameraHelper,r.CameraHelper.prototype.update=function(){var e,t,i=new r.Vector3,n=new r.Camera,o=function(r,o,s,a){i.set(o,s,a).unproject(n);var h=t[r];if(void 0!==h)for(var l=0,c=h.length;c>l;l++)e.vertices[h[l]].copy(i)};return function(){e=this.geometry,t=this.pointMap;var i=1,r=1;n.projectionMatrix.copy(this.camera.projectionMatrix),o("c",0,0,-1),o("t",0,0,1),o("n1",-i,-r,-1),o("n2",i,-r,-1),o("n3",-i,r,-1),o("n4",i,r,-1),o("f1",-i,-r,1),o("f2",i,-r,1),o("f3",-i,r,1),o("f4",i,r,1),o("u1",.7*i,1.1*r,-1),o("u2",.7*-i,1.1*r,-1),o("u3",0,2*r,-1),o("cf1",-i,0,1),o("cf2",i,0,1),o("cf3",0,-r,1),o("cf4",0,r,1),o("cn1",-i,0,-1),o("cn2",i,0,-1),o("cn3",0,-r,-1),o("cn4",0,r,-1),e.verticesNeedUpdate=!0}}(),r.DirectionalLightHelper=function(e,t){r.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,t=t||1;var i=new r.Geometry;i.vertices.push(new r.Vector3(-t,t,0),new r.Vector3(t,t,0),new r.Vector3(t,-t,0),new r.Vector3(-t,-t,0),new r.Vector3(-t,t,0));var n=new r.LineBasicMaterial({fog:!1});n.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightPlane=new r.Line(i,n),this.add(this.lightPlane),i=new r.Geometry,i.vertices.push(new r.Vector3,new r.Vector3),n=new r.LineBasicMaterial({fog:!1}),n.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new r.Line(i,n),this.add(this.targetLine),this.update()},r.DirectionalLightHelper.prototype=Object.create(r.Object3D.prototype),r.DirectionalLightHelper.prototype.constructor=r.DirectionalLightHelper,r.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},r.DirectionalLightHelper.prototype.update=function(){var e=new r.Vector3,t=new r.Vector3,i=new r.Vector3;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),i.subVectors(t,e),this.lightPlane.lookAt(i),this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.vertices[1].copy(i),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.lightPlane.material.color)}}(),r.EdgesHelper=function(e,t,i){var n=void 0!==t?t:16777215;r.LineSegments.call(this,new r.EdgesGeometry(e.geometry,i),new r.LineBasicMaterial({color:n})),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1},r.EdgesHelper.prototype=Object.create(r.LineSegments.prototype),r.EdgesHelper.prototype.constructor=r.EdgesHelper,r.FaceNormalsHelper=function(e,t,i,n){this.object=e,this.size=void 0!==t?t:1;var o=void 0!==i?i:16776960,s=void 0!==n?n:1,a=0,h=this.object.geometry;h instanceof r.Geometry?a=h.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var l=new r.BufferGeometry,c=new r.Float32Attribute(2*a*3,3);l.addAttribute("position",c),r.LineSegments.call(this,l,new r.LineBasicMaterial({color:o,linewidth:s})),this.matrixAutoUpdate=!1,this.update()},r.FaceNormalsHelper.prototype=Object.create(r.LineSegments.prototype),r.FaceNormalsHelper.prototype.constructor=r.FaceNormalsHelper,r.FaceNormalsHelper.prototype.update=function(){var e=new r.Vector3,t=new r.Vector3,i=new r.Matrix3;return function(){this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);for(var n=this.object.matrixWorld,r=this.geometry.attributes.position,o=this.object.geometry,s=o.vertices,a=o.faces,h=0,l=0,c=a.length;c>l;l++){var u=a[l],p=u.normal;e.copy(s[u.a]).add(s[u.b]).add(s[u.c]).divideScalar(3).applyMatrix4(n),t.copy(p).applyMatrix3(i).normalize().multiplyScalar(this.size).add(e),r.setXYZ(h,e.x,e.y,e.z),h+=1,r.setXYZ(h,t.x,t.y,t.z),h+=1}return r.needsUpdate=!0,this}}(),r.GridHelper=function(e,t){var i=new r.Geometry,n=new r.LineBasicMaterial({vertexColors:r.VertexColors});this.color1=new r.Color(4473924),this.color2=new r.Color(8947848);for(var o=-e;e>=o;o+=t){i.vertices.push(new r.Vector3(-e,0,o),new r.Vector3(e,0,o),new r.Vector3(o,0,-e),new r.Vector3(o,0,e));var s=0===o?this.color1:this.color2;i.colors.push(s,s,s,s)}r.LineSegments.call(this,i,n)},r.GridHelper.prototype=Object.create(r.LineSegments.prototype),r.GridHelper.prototype.constructor=r.GridHelper,r.GridHelper.prototype.setColors=function(e,t){this.color1.set(e),this.color2.set(t),this.geometry.colorsNeedUpdate=!0},r.HemisphereLightHelper=function(e,t){r.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new r.Color,new r.Color];var i=new r.SphereGeometry(t,4,2);i.rotateX(-Math.PI/2);for(var n=0,o=8;o>n;n++)i.faces[n].color=this.colors[4>n?0:1];var s=new r.MeshBasicMaterial({vertexColors:r.FaceColors,wireframe:!0});this.lightSphere=new r.Mesh(i,s),this.add(this.lightSphere),this.update()},r.HemisphereLightHelper.prototype=Object.create(r.Object3D.prototype),r.HemisphereLightHelper.prototype.constructor=r.HemisphereLightHelper,r.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},r.HemisphereLightHelper.prototype.update=function(){var e=new r.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),r.PointLightHelper=function(e,t){this.light=e,this.light.updateMatrixWorld();var i=new r.SphereGeometry(t,4,2),n=new r.MeshBasicMaterial({wireframe:!0,fog:!1});n.color.copy(this.light.color).multiplyScalar(this.light.intensity),r.Mesh.call(this,i,n),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1},r.PointLightHelper.prototype=Object.create(r.Mesh.prototype),r.PointLightHelper.prototype.constructor=r.PointLightHelper,r.PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},r.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},r.SkeletonHelper=function(e){this.bones=this.getBoneList(e);for(var t=new r.Geometry,i=0;i<this.bones.length;i++){var n=this.bones[i];n.parent instanceof r.Bone&&(t.vertices.push(new r.Vector3),t.vertices.push(new r.Vector3),t.colors.push(new r.Color(0,0,1)),t.colors.push(new r.Color(0,1,0)))}t.dynamic=!0;var o=new r.LineBasicMaterial({vertexColors:r.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});r.LineSegments.call(this,t,o),this.root=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.update()},r.SkeletonHelper.prototype=Object.create(r.LineSegments.prototype),r.SkeletonHelper.prototype.constructor=r.SkeletonHelper,r.SkeletonHelper.prototype.getBoneList=function(e){var t=[];e instanceof r.Bone&&t.push(e);for(var i=0;i<e.children.length;i++)t.push.apply(t,this.getBoneList(e.children[i]));return t},r.SkeletonHelper.prototype.update=function(){for(var e=this.geometry,t=(new r.Matrix4).getInverse(this.root.matrixWorld),i=new r.Matrix4,n=0,o=0;o<this.bones.length;o++){var s=this.bones[o];s.parent instanceof r.Bone&&(i.multiplyMatrices(t,s.matrixWorld),e.vertices[n].setFromMatrixPosition(i),i.multiplyMatrices(t,s.parent.matrixWorld),e.vertices[n+1].setFromMatrixPosition(i),n+=2)}e.verticesNeedUpdate=!0,e.computeBoundingSphere()},r.SpotLightHelper=function(e){r.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;var t=new r.CylinderGeometry(0,1,1,8,1,!0);t.translate(0,-.5,0),t.rotateX(-Math.PI/2);var i=new r.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new r.Mesh(t,i),this.add(this.cone),this.update()},r.SpotLightHelper.prototype=Object.create(r.Object3D.prototype),r.SpotLightHelper.prototype.constructor=r.SpotLightHelper,r.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},r.SpotLightHelper.prototype.update=function(){var e=new r.Vector3,t=new r.Vector3;return function(){var i=this.light.distance?this.light.distance:1e4,n=i*Math.tan(this.light.angle);this.cone.scale.set(n,n,i),e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(t.sub(e)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),r.VertexNormalsHelper=function(e,t,i,n){this.object=e,this.size=void 0!==t?t:1;var o=void 0!==i?i:16711680,s=void 0!==n?n:1,a=0,h=this.object.geometry;h instanceof r.Geometry?a=3*h.faces.length:h instanceof r.BufferGeometry&&(a=h.attributes.normal.count);var l=new r.BufferGeometry,c=new r.Float32Attribute(2*a*3,3);l.addAttribute("position",c),r.LineSegments.call(this,l,new r.LineBasicMaterial({color:o,linewidth:s})),this.matrixAutoUpdate=!1,this.update()},r.VertexNormalsHelper.prototype=Object.create(r.LineSegments.prototype),r.VertexNormalsHelper.prototype.constructor=r.VertexNormalsHelper,r.VertexNormalsHelper.prototype.update=function(){var e=new r.Vector3,t=new r.Vector3,i=new r.Matrix3;return function(){var n=["a","b","c"];this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);var o=this.object.matrixWorld,s=this.geometry.attributes.position,a=this.object.geometry;if(a instanceof r.Geometry)for(var h=a.vertices,l=a.faces,c=0,u=0,p=l.length;p>u;u++)for(var d=l[u],f=0,m=d.vertexNormals.length;m>f;f++){var y=h[d[n[f]]],g=d.vertexNormals[f];e.copy(y).applyMatrix4(o),t.copy(g).applyMatrix3(i).normalize().multiplyScalar(this.size).add(e),s.setXYZ(c,e.x,e.y,e.z),c+=1,s.setXYZ(c,t.x,t.y,t.z),c+=1}else if(a instanceof r.BufferGeometry)for(var v=a.attributes.position,b=a.attributes.normal,c=0,f=0,m=v.count;m>f;f++)e.set(v.getX(f),v.getY(f),v.getZ(f)).applyMatrix4(o),t.set(b.getX(f),b.getY(f),b.getZ(f)),t.applyMatrix3(i).normalize().multiplyScalar(this.size).add(e),s.setXYZ(c,e.x,e.y,e.z),c+=1,s.setXYZ(c,t.x,t.y,t.z),c+=1;return s.needsUpdate=!0,this}}(),r.WireframeHelper=function(e,t){var i=void 0!==t?t:16777215;r.LineSegments.call(this,new r.WireframeGeometry(e.geometry),new r.LineBasicMaterial({color:i})),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1},r.WireframeHelper.prototype=Object.create(r.LineSegments.prototype),r.WireframeHelper.prototype.constructor=r.WireframeHelper,r.ImmediateRenderObject=function(){r.Object3D.call(this),this.render=function(e){}},r.ImmediateRenderObject.prototype=Object.create(r.Object3D.prototype),r.ImmediateRenderObject.prototype.constructor=r.ImmediateRenderObject,r.MorphBlendMesh=function(e,t){r.Mesh.call(this,e,t),this.animationsMap={},this.animationsList=[];var i=this.geometry.morphTargets.length,n="__default",o=0,s=i-1,a=i/1;this.createAnimation(n,o,s,a),this.setAnimationWeight(n,1)},r.MorphBlendMesh.prototype=Object.create(r.Mesh.prototype),r.MorphBlendMesh.prototype.constructor=r.MorphBlendMesh,r.MorphBlendMesh.prototype.createAnimation=function(e,t,i,n){var r={start:t,end:i,length:i-t+1,fps:n,duration:(i-t)/n,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[e]=r,this.animationsList.push(r)},r.MorphBlendMesh.prototype.autoCreateAnimations=function(e){for(var t,i=/([a-z]+)_?(\d+)/,n={},r=this.geometry,o=0,s=r.morphTargets.length;s>o;o++){var a=r.morphTargets[o],h=a.name.match(i);if(h&&h.length>1){
var l=h[1];n[l]||(n[l]={start:1/0,end:-(1/0)});var c=n[l];o<c.start&&(c.start=o),o>c.end&&(c.end=o),t||(t=l)}}for(var l in n){var c=n[l];this.createAnimation(l,c.start,c.end,e)}this.firstAnimation=t},r.MorphBlendMesh.prototype.setAnimationDirectionForward=function(e){var t=this.animationsMap[e];t&&(t.direction=1,t.directionBackwards=!1)},r.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(e){var t=this.animationsMap[e];t&&(t.direction=-1,t.directionBackwards=!0)},r.MorphBlendMesh.prototype.setAnimationFPS=function(e,t){var i=this.animationsMap[e];i&&(i.fps=t,i.duration=(i.end-i.start)/i.fps)},r.MorphBlendMesh.prototype.setAnimationDuration=function(e,t){var i=this.animationsMap[e];i&&(i.duration=t,i.fps=(i.end-i.start)/i.duration)},r.MorphBlendMesh.prototype.setAnimationWeight=function(e,t){var i=this.animationsMap[e];i&&(i.weight=t)},r.MorphBlendMesh.prototype.setAnimationTime=function(e,t){var i=this.animationsMap[e];i&&(i.time=t)},r.MorphBlendMesh.prototype.getAnimationTime=function(e){var t=0,i=this.animationsMap[e];return i&&(t=i.time),t},r.MorphBlendMesh.prototype.getAnimationDuration=function(e){var t=-1,i=this.animationsMap[e];return i&&(t=i.duration),t},r.MorphBlendMesh.prototype.playAnimation=function(e){var t=this.animationsMap[e];t?(t.time=0,t.active=!0):console.warn("THREE.MorphBlendMesh: animation["+e+"] undefined in .playAnimation()")},r.MorphBlendMesh.prototype.stopAnimation=function(e){var t=this.animationsMap[e];t&&(t.active=!1)},r.MorphBlendMesh.prototype.update=function(e){for(var t=0,i=this.animationsList.length;i>t;t++){var n=this.animationsList[t];if(n.active){var o=n.duration/n.length;n.time+=n.direction*e,n.mirroredLoop?(n.time>n.duration||n.time<0)&&(n.direction*=-1,n.time>n.duration&&(n.time=n.duration,n.directionBackwards=!0),n.time<0&&(n.time=0,n.directionBackwards=!1)):(n.time=n.time%n.duration,n.time<0&&(n.time+=n.duration));var s=n.start+r.Math.clamp(Math.floor(n.time/o),0,n.length-1),a=n.weight;s!==n.currentFrame&&(this.morphTargetInfluences[n.lastFrame]=0,this.morphTargetInfluences[n.currentFrame]=1*a,this.morphTargetInfluences[s]=0,n.lastFrame=n.currentFrame,n.currentFrame=s);var h=n.time%o/o;n.directionBackwards&&(h=1-h),n.currentFrame!==n.lastFrame?(this.morphTargetInfluences[n.currentFrame]=h*a,this.morphTargetInfluences[n.lastFrame]=(1-h)*a):this.morphTargetInfluences[n.currentFrame]=a}}},"undefined"!=typeof i?("undefined"!=typeof t&&t.exports&&(i=t.exports=r),i.THREE=r):this.THREE=r},{}],111:[function(require,module,exports){!function(root){"use strict";function Main(e){Tone=e()}function Module(e){e(Tone)}var Tone;Main(function(){function e(e){return void 0===e}function t(e){return"function"==typeof e}var i;if(e(window.AudioContext)&&(window.AudioContext=window.webkitAudioContext),e(window.OfflineAudioContext)&&(window.OfflineAudioContext=window.webkitOfflineAudioContext),e(AudioContext))throw new Error("Web Audio is not supported in this browser");i=new AudioContext,t(AudioContext.prototype.createGain)||(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),t(AudioContext.prototype.createDelay)||(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),t(AudioContext.prototype.createPeriodicWave)||(AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable),t(AudioBufferSourceNode.prototype.start)||(AudioBufferSourceNode.prototype.start=AudioBufferSourceNode.prototype.noteGrainOn),t(AudioBufferSourceNode.prototype.stop)||(AudioBufferSourceNode.prototype.stop=AudioBufferSourceNode.prototype.noteOff),t(OscillatorNode.prototype.start)||(OscillatorNode.prototype.start=OscillatorNode.prototype.noteOn),t(OscillatorNode.prototype.stop)||(OscillatorNode.prototype.stop=OscillatorNode.prototype.noteOff),t(OscillatorNode.prototype.setPeriodicWave)||(OscillatorNode.prototype.setPeriodicWave=OscillatorNode.prototype.setWaveTable),AudioNode.prototype._nativeConnect=AudioNode.prototype.connect,AudioNode.prototype.connect=function(t,i,n){if(t.input)Array.isArray(t.input)?(e(n)&&(n=0),this.connect(t.input[n])):this.connect(t.input,i,n);else try{t instanceof AudioNode?this._nativeConnect(t,i,n):this._nativeConnect(t,i)}catch(r){throw new Error("error connecting to node: "+t)}};var n=function(t,i){e(t)||1===t?this.input=this.context.createGain():t>1&&(this.input=new Array(t)),e(i)||1===i?this.output=this.context.createGain():i>1&&(this.output=new Array(t))};n.prototype.set=function(t,i,r){if("object"==typeof t)r=i;else if("string"==typeof t){var o={};o[t]=i,t=o}for(var s in t){i=t[s];var a=this;if(-1!==s.indexOf(".")){for(var h=s.split("."),l=0;l<h.length-1;l++)a=a[h[l]];s=h[h.length-1]}var c=a[s];e(c)||(c instanceof n.Signal?c.value!==i&&(e(r)?c.value=i:c.rampTo(i,r)):c instanceof AudioParam?c.value!==i&&(c.value=i):c instanceof n?c.set(i):c!==i&&(a[s]=i))}return this},n.prototype.get=function(i){e(i)?i=this._collectDefaults(this.constructor):"string"==typeof i&&(i=[i]);for(var r={},o=0;o<i.length;o++){var s=i[o],a=this,h=r;if(-1!==s.indexOf(".")){for(var l=s.split("."),c=0;c<l.length-1;c++){var u=l[c];h[u]=h[u]||{},h=h[u],a=a[u]}s=l[l.length-1]}var p=a[s];"object"==typeof i[s]?h[s]=p.get():p instanceof n.Signal?h[s]=p.value:p instanceof AudioParam?h[s]=p.value:p instanceof n?h[s]=p.get():t(p)||e(p)||(h[s]=p)}return r},n.prototype._collectDefaults=function(t){var i=[];if(e(t.defaults)||(i=Object.keys(t.defaults)),!e(t._super))for(var n=this._collectDefaults(t._super),r=0;r<n.length;r++)-1===i.indexOf(n[r])&&i.push(n[r]);return i},n.prototype.setPreset=function(e){return!this.isUndef(this.preset)&&this.preset.hasOwnProperty(e)&&this.set(this.preset[e]),this},n.prototype.toString=function(){for(var e in n){var i=e[0].match(/^[A-Z]$/),r=n[e]===this.constructor;if(t(n[e])&&i&&r)return e}return"Tone"},n.context=i,n.prototype.context=n.context,n.prototype.bufferSize=2048,n.prototype.bufferTime=n.prototype.bufferSize/n.context.sampleRate,n.prototype.dispose=function(){return this.isUndef(this.input)||(this.input instanceof AudioNode&&this.input.disconnect(),this.input=null),this.isUndef(this.output)||(this.output instanceof AudioNode&&this.output.disconnect(),this.output=null),this};var r=null;n.prototype.noGC=function(){return this.output.connect(r),this},AudioNode.prototype.noGC=function(){return this.connect(r),this},n.prototype.connect=function(e,t,i){return Array.isArray(this.output)?(t=this.defaultArg(t,0),this.output[t].connect(e,0,i)):this.output.connect(e,t,i),this},n.prototype.disconnect=function(e){return Array.isArray(this.output)?(e=this.defaultArg(e,0),this.output[e].disconnect()):this.output.disconnect(),this},n.prototype.connectSeries=function(){if(arguments.length>1)for(var e=arguments[0],t=1;t<arguments.length;t++){var i=arguments[t];e.connect(i),e=i}return this},n.prototype.connectParallel=function(){var e=arguments[0];if(arguments.length>1)for(var t=1;t<arguments.length;t++){var i=arguments[t];e.connect(i)}return this},n.prototype.chain=function(){if(arguments.length>0)for(var e=this,t=0;t<arguments.length;t++){var i=arguments[t];e.connect(i),e=i}return this},n.prototype.fan=function(){if(arguments.length>0)for(var e=0;e<arguments.length;e++)this.connect(arguments[e]);return this},AudioNode.prototype.chain=n.prototype.chain,AudioNode.prototype.fan=n.prototype.fan,n.prototype.defaultArg=function(t,i){if("object"==typeof t&&"object"==typeof i){var n={};for(var r in t)n[r]=this.defaultArg(t[r],t[r]);for(var o in i)n[o]=this.defaultArg(t[o],i[o]);return n}return e(t)?i:t},n.prototype.optionsObject=function(e,t,i){var n={};if(1===e.length&&"object"==typeof e[0])n=e[0];else for(var r=0;r<t.length;r++)n[t[r]]=e[r];return this.isUndef(i)?n:this.defaultArg(n,i)},n.prototype.isUndef=e,n.prototype.isFunction=t,n.prototype._readOnly=function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)this._readOnly(e[t]);else Object.defineProperty(this,e,{writable:!1,enumerable:!0})},n.prototype._writable=function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)this._writable(e[t]);else Object.defineProperty(this,e,{writable:!0})},n.prototype.equalPowerScale=function(e){var t=.5*Math.PI;return Math.sin(e*t)},n.prototype.dbToGain=function(e){return Math.pow(2,e/6)},n.prototype.gainToDb=function(e){return 20*(Math.log(e)/Math.LN10)},n.prototype.now=function(){return this.context.currentTime},n.prototype.samplesToSeconds=function(e){return e/this.context.sampleRate},n.prototype.toSamples=function(e){var t=this.toSeconds(e);return Math.round(t*this.context.sampleRate)},n.prototype.toSeconds=function(e,t){if(t=this.defaultArg(t,this.now()),"number"==typeof e)return e;if("string"==typeof e){var i=0;return"+"===e.charAt(0)&&(e=e.slice(1),i=t),parseFloat(e)+i}return t},n.prototype.isFrequency=function(){var e=new RegExp(/\d*\.?\d+hz$/i);return function(t){return e.test(t)}}(),n.prototype.frequencyToSeconds=function(e){return 1/parseFloat(e)},n.prototype.secondsToFrequency=function(e){return 1/e},n.extend=function(t,i){function r(){}e(i)&&(i=n),r.prototype=i.prototype,t.prototype=new r,t.prototype.constructor=t,t._super=i},n.Type={Default:"number",Time:"time",Frequency:"frequency",Gain:"gain",NormalRange:"normalrange",AudioRange:"audiorange",Decibels:"db",Interval:"interval",BPM:"bpm",Positive:"positive",Cents:"cents",Degrees:"degrees",MIDI:"midi",TransportTime:"transporttime"},n.State={Started:"started",Stopped:"stopped",Paused:"paused"},n.noOp=function(){};var o=[];return n._initAudioContext=function(e){e(n.context),o.push(e)},n.setContext=function(e){n.prototype.context=e,n.context=e;for(var t=0;t<o.length;t++)o[t](e)},n.startMobile=function(){var e=n.context.createOscillator(),t=n.context.createGain();t.gain.value=0,e.connect(t),t.connect(n.context.destination);var i=n.context.currentTime;e.start(i),e.stop(i+1)},n._initAudioContext(function(e){n.prototype.bufferTime=n.prototype.bufferSize/e.sampleRate,r=e.createGain(),r.gain.value=0,r.connect(e.destination)}),n.version="r5",console.log("%c * Tone.js "+n.version+" * ","background: #000; color: #fff"),n}),Module(function(e){return e.SignalBase=function(){},e.extend(e.SignalBase),e.SignalBase.prototype.connect=function(t,i,n){return t.constructor===e.Signal?(t._value.cancelScheduledValues(0),t._value.value=0,t.overridden=!0):t instanceof AudioParam&&(t.cancelScheduledValues(0),t.value=0),e.prototype.connect.call(this,t,i,n),this},e.SignalBase}),Module(function(e){return e.WaveShaper=function(e,t){this._shaper=this.input=this.output=this.context.createWaveShaper(),this._curve=null,Array.isArray(e)?this.curve=e:isFinite(e)||this.isUndef(e)?this._curve=new Float32Array(this.defaultArg(e,1024)):this.isFunction(e)&&(this._curve=new Float32Array(this.defaultArg(t,1024)),this.setMap(e))},e.extend(e.WaveShaper,e.SignalBase),e.WaveShaper.prototype.setMap=function(e){for(var t=0,i=this._curve.length;i>t;t++){var n=t/i*2-1;this._curve[t]=e(n,t)}return this._shaper.curve=this._curve,this},Object.defineProperty(e.WaveShaper.prototype,"curve",{get:function(){return this._shaper.curve},set:function(e){if(this._isSafari()){var t=e[0];e.unshift(t)}this._curve=new Float32Array(e),this._shaper.curve=this._curve}}),Object.defineProperty(e.WaveShaper.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(e){this._shaper.oversample=e}}),e.WaveShaper.prototype._isSafari=function(){var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("safari")&&-1===e.indexOf("chrome")},e.WaveShaper.prototype.dispose=function(){return e.prototype.dispose.call(this),this._shaper.disconnect(),this._shaper=null,this._curve=null,this},e.WaveShaper}),Module(function(e){return e.Signal=function(){var t=this.optionsObject(arguments,["value","units"],e.Signal.defaults);this.units=t.units,this.convert=t.convert,this.overridden=!1,this.output=this._scaler=this.context.createGain(),this.input=this._value=this._scaler.gain,t.value instanceof AudioParam?(this._scaler.connect(t.value),t.value.value=0):(this.isUndef(t.param)||(this._scaler.connect(t.param),t.param.value=0),this.value=t.value),e.Signal._constant.chain(this._scaler)},e.extend(e.Signal,e.SignalBase),e.Signal.defaults={value:0,param:void 0,units:e.Type.Default,convert:!0},Object.defineProperty(e.Signal.prototype,"value",{get:function(){return this._toUnits(this._value.value)},set:function(e){var t=this._fromUnits(e);this.cancelScheduledValues(0),this._value.value=t}}),e.Signal.prototype._fromUnits=function(t){if(!this.convert&&!this.isUndef(this.convert))return t;switch(this.units){case e.Type.Time:return this.toSeconds(t);case e.Type.Frequency:return this.toFrequency(t);case e.Type.Decibels:return this.dbToGain(t);case e.Type.NormalRange:return Math.min(Math.max(t,0),1);case e.Type.AudioRange:return Math.min(Math.max(t,-1),1);case e.Type.Positive:return Math.max(t,0);default:return t}},e.Signal.prototype._toUnits=function(t){if(!this.convert&&!this.isUndef(this.convert))return t;switch(this.units){case e.Type.Decibels:return this.gainToDb(t);default:return t}},e.Signal.prototype.setValueAtTime=function(e,t){return e=this._fromUnits(e),this._value.setValueAtTime(e,this.toSeconds(t)),this},e.Signal.prototype.setCurrentValueNow=function(e){e=this.defaultArg(e,this.now());var t=this._value.value;return this.cancelScheduledValues(e),this._value.setValueAtTime(t,e),this},e.Signal.prototype.linearRampToValueAtTime=function(e,t){return e=this._fromUnits(e),this._value.linearRampToValueAtTime(e,this.toSeconds(t)),this},e.Signal.prototype.exponentialRampToValueAtTime=function(e,t){return e=this._fromUnits(e),e=Math.max(1e-5,e),this._value.exponentialRampToValueAtTime(e,this.toSeconds(t)),this},e.Signal.prototype.exponentialRampToValueNow=function(e,t){var i=this.now(),n=this.value;return this.setValueAtTime(Math.max(n,1e-4),i),this.exponentialRampToValueAtTime(e,i+this.toSeconds(t)),this},e.Signal.prototype.linearRampToValueNow=function(e,t){var i=this.now();return this.setCurrentValueNow(i),this.linearRampToValueAtTime(e,i+this.toSeconds(t)),this},e.Signal.prototype.setTargetAtTime=function(e,t,i){return e=this._fromUnits(e),i=Math.max(1e-5,i),this._value.setTargetAtTime(e,this.toSeconds(t),i),this},e.Signal.prototype.setValueCurveAtTime=function(e,t,i){for(var n=0;n<e.length;n++)e[n]=this._fromUnits(e[n]);return this._value.setValueCurveAtTime(e,this.toSeconds(t),this.toSeconds(i)),this},e.Signal.prototype.cancelScheduledValues=function(e){return this._value.cancelScheduledValues(this.toSeconds(e)),this},e.Signal.prototype.rampTo=function(t,i){return i=this.defaultArg(i,0),this.units===e.Type.Frequency||this.units===e.Type.BPM?this.exponentialRampToValueNow(t,i):this.linearRampToValueNow(t,i),this},e.Signal.prototype.dispose=function(){return e.prototype.dispose.call(this),this._value=null,this._scaler=null,this},e.Signal._generator=null,e.Signal._constant=null,e._initAudioContext(function(t){e.Signal._generator=t.createOscillator(),e.Signal._constant=new e.WaveShaper([1,1]),e.Signal._generator.connect(e.Signal._constant),e.Signal._generator.start(0),e.Signal._generator.noGC()}),e.Signal}),Module(function(e){return e.Pow=function(t){this._exp=this.defaultArg(t,1),this._expScaler=this.input=this.output=new e.WaveShaper(this._expFunc(this._exp),8192)},e.extend(e.Pow,e.SignalBase),Object.defineProperty(e.Pow.prototype,"value",{get:function(){return this._exp},set:function(e){this._exp=e,this._expScaler.setMap(this._expFunc(this._exp))}}),e.Pow.prototype._expFunc=function(e){return function(t){return Math.pow(Math.abs(t),e)}},e.Pow.prototype.dispose=function(){return e.prototype.dispose.call(this),this._expScaler.dispose(),this._expScaler=null,this},e.Pow}),Module(function(e){return e.Envelope=function(){var t=this.optionsObject(arguments,["attack","decay","sustain","release"],e.Envelope.defaults);this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this._nextAttack=1/0,this._nextDecay=1/0,this._nextSustain=1/0,this._nextRelease=1/0,this._nextStandby=1/0,this._attackCurve=e.Envelope.Type.Linear,this._peakValue=1,this._minOutput=1e-4,this._sig=this.output=new e.Signal(0),this.attackCurve=t.attackCurve},e.extend(e.Envelope),e.Envelope.defaults={attack:.01,decay:.1,sustain:.5,release:1,attackCurve:"linear"},e.Envelope.prototype._timeMult=.25,Object.defineProperty(e.Envelope.prototype,"value",{get:function(){return this._sig.value}}),Object.defineProperty(e.Envelope.prototype,"attackCurve",{get:function(){return this._attackCurve},set:function(t){if(t!==e.Envelope.Type.Linear&&t!==e.Envelope.Type.Exponential)throw Error('attackCurve must be either "linear" or "exponential". Invalid type: ',t);this._attackCurve=t}}),e.Envelope.prototype._phaseAtTime=function(t){return this._nextRelease>t?this._nextAttack<=t&&this._nextDecay>t?e.Envelope.Phase.Attack:this._nextDecay<=t&&this._nextSustain>t?e.Envelope.Phase.Decay:this._nextSustain<=t&&this._nextRelease>t?e.Envelope.Phase.Sustain:e.Envelope.Phase.Standby:this._nextRelease<t&&this._nextStandby>t?e.Envelope.Phase.Release:e.Envelope.Phase.Standby},e.Envelope.prototype._exponentialApproach=function(e,t,i,n,r){return i+(t-i)*Math.exp(-(r-e)/n)},e.Envelope.prototype._linearInterpolate=function(e,t,i,n,r){return t+(n-t)*((r-e)/(i-e))},e.Envelope.prototype._exponentialInterpolate=function(e,t,i,n,r){return t*Math.pow(n/t,(r-e)/(i-e))},e.Envelope.prototype._valueAtTime=function(t){var i=this.toSeconds(this.attack),n=this.toSeconds(this.decay),r=this.toSeconds(this.release);switch(this._phaseAtTime(t)){case e.Envelope.Phase.Attack:return this._attackCurve===e.Envelope.Type.Linear?this._linearInterpolate(this._nextAttack,this._minOutput,this._nextAttack+i,this._peakValue,t):this._exponentialInterpolate(this._nextAttack,this._minOutput,this._nextAttack+i,this._peakValue,t);case e.Envelope.Phase.Decay:return this._exponentialApproach(this._nextDecay,this._peakValue,this.sustain*this._peakValue,n*this._timeMult,t);case e.Envelope.Phase.Release:return this._exponentialApproach(this._nextRelease,this._peakValue,this._minOutput,r*this._timeMult,t);case e.Envelope.Phase.Sustain:return this.sustain*this._peakValue;case e.Envelope.Phase.Standby:return this._minOutput}},e.Envelope.prototype.triggerAttack=function(t,i){t=this.toSeconds(t);var n=this.toSeconds(this.attack),r=this.toSeconds(this.decay),o=this._valueAtTime(t),s=o*n;this._nextAttack=t-s,this._nextDecay=this._nextAttack+n,this._nextSustain=this._nextDecay+r,this._nextRelease=1/0,this._peakValue=this.defaultArg(i,1);var a=this._peakValue,h=this.sustain*a;return this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(o,t),this._attackCurve===e.Envelope.Type.Linear?this._sig.linearRampToValueAtTime(a,this._nextDecay):this._sig.exponentialRampToValueAtTime(a,this._nextDecay),this._sig.setTargetAtTime(h,this._nextDecay,r*this._timeMult),this},e.Envelope.prototype.triggerRelease=function(t){t=this.toSeconds(t);var i=this._phaseAtTime(t),n=this.toSeconds(this.release),r=this._valueAtTime(t);return this._peakValue=r,this._nextRelease=t,this._nextStandby=this._nextRelease+n,this._sig.cancelScheduledValues(this._nextRelease),i===e.Envelope.Phase.Attack?(this._sig.setCurrentValueNow(),this.attackCurve===e.Envelope.Type.Linear?this._sig.linearRampToValueAtTime(this._peakValue,this._nextRelease):this._sig.exponentialRampToValueAtTime(this._peakValue,this._nextRelease)):this._sig.setValueAtTime(this._peakValue,this._nextRelease),this._sig.setTargetAtTime(this._minOutput,this._nextRelease,n*this._timeMult),this},e.Envelope.prototype.triggerAttackRelease=function(e,t,i){return t=this.toSeconds(t),this.triggerAttack(t,i),this.triggerRelease(t+this.toSeconds(e)),this},e.Envelope.prototype.connect=e.Signal.prototype.connect,e.Envelope.prototype.dispose=function(){return e.prototype.dispose.call(this),this._sig.dispose(),this._sig=null,this},e.Envelope.Phase={Attack:"attack",Decay:"decay",Sustain:"sustain",Release:"release",Standby:"standby"},e.Envelope.Type={Linear:"linear",Exponential:"exponential"},e.Envelope}),Module(function(e){return e.AmplitudeEnvelope=function(){e.Envelope.apply(this,arguments),this.input=this.output=this.context.createGain(),this._sig.connect(this.output.gain)},e.extend(e.AmplitudeEnvelope,e.Envelope),e.AmplitudeEnvelope}),Module(function(e){return e.Compressor=function(){var t=this.optionsObject(arguments,["threshold","ratio"],e.Compressor.defaults);this._compressor=this.input=this.output=this.context.createDynamicsCompressor(),this.threshold=this._compressor.threshold,this.attack=new e.Signal(this._compressor.attack,e.Type.Time),this.release=new e.Signal(this._compressor.release,e.Type.Time),this.knee=this._compressor.knee,this.ratio=this._compressor.ratio,this._readOnly(["knee","release","attack","ratio","threshold"]),this.set(t)},e.extend(e.Compressor),e.Compressor.defaults={ratio:12,threshold:-24,release:.25,attack:.003,knee:30},e.Compressor.prototype.dispose=function(){return e.prototype.dispose.call(this),this._writable(["knee","release","attack","ratio","threshold"]),this._compressor.disconnect(),this._compressor=null,this.attack.dispose(),this.attack=null,this.release.dispose(),this.release=null,this.threshold=null,this.ratio=null,this.knee=null,this},e.Compressor}),Module(function(e){return e.Add=function(t){e.call(this,2,0),this._sum=this.input[0]=this.input[1]=this.output=this.context.createGain(),this._value=this.input[1]=new e.Signal(t),this._value.connect(this._sum)},e.extend(e.Add,e.Signal),e.Add.prototype.dispose=function(){return e.prototype.dispose.call(this),this._sum.disconnect(),this._sum=null,this._value.dispose(),this._value=null,this},e.Add}),Module(function(e){return e.Multiply=function(t){e.call(this,2,0),this._mult=this.input[0]=this.output=this.context.createGain(),this._value=this.input[1]=this.output.gain,this._value.value=this.defaultArg(t,0)},e.extend(e.Multiply,e.Signal),e.Multiply.prototype.dispose=function(){return e.prototype.dispose.call(this),this._mult.disconnect(),this._mult=null,this._value=null,this},e.Multiply}),Module(function(e){return e.Negate=function(){this._multiply=this.input=this.output=new e.Multiply(-1)},e.extend(e.Negate,e.SignalBase),e.Negate.prototype.dispose=function(){return e.prototype.dispose.call(this),this._multiply.dispose(),this._multiply=null,this},e.Negate}),Module(function(e){return e.Subtract=function(t){e.call(this,2,0),this._sum=this.input[0]=this.output=this.context.createGain(),this._neg=new e.Negate,this._value=this.input[1]=new e.Signal(t),this._value.chain(this._neg,this._sum)},e.extend(e.Subtract,e.Signal),e.Subtract.prototype.dispose=function(){return e.prototype.dispose.call(this),this._neg.dispose(),this._neg=null,this._sum.disconnect(),this._sum=null,this._value.dispose(),this._value=null,this},e.Subtract}),Module(function(e){return e.GreaterThanZero=function(){this._thresh=this.output=new e.WaveShaper(function(e){return 0>=e?0:1}),this._scale=this.input=new e.Multiply(1e4),this._scale.connect(this._thresh)},e.extend(e.GreaterThanZero,e.SignalBase),e.GreaterThanZero.prototype.dispose=function(){return e.prototype.dispose.call(this),this._scale.dispose(),this._scale=null,this._thresh.dispose(),this._thresh=null,this},e.GreaterThanZero}),Module(function(e){return e.EqualZero=function(){this._scale=this.input=new e.Multiply(1e4),this._thresh=new e.WaveShaper(function(e){return 0===e?1:0},128),this._gtz=this.output=new e.GreaterThanZero,this._scale.chain(this._thresh,this._gtz)},e.extend(e.EqualZero,e.SignalBase),e.EqualZero.prototype.dispose=function(){return e.prototype.dispose.call(this),this._gtz.dispose(),this._gtz=null,this._scale.dispose(),this._scale=null,this._thresh.dispose(),this._thresh=null,this},e.EqualZero}),Module(function(e){return e.Equal=function(t){e.call(this,2,0),this._sub=this.input[0]=new e.Subtract(t),this._equals=this.output=new e.EqualZero,this._sub.connect(this._equals),this.input[1]=this._sub.input[1]},e.extend(e.Equal,e.SignalBase),Object.defineProperty(e.Equal.prototype,"value",{get:function(){return this._sub.value},set:function(e){this._sub.value=e}}),e.Equal.prototype.dispose=function(){return e.prototype.dispose.call(this),this._equals.dispose(),this._equals=null,this._sub.dispose(),this._sub=null,this},e.Equal}),Module(function(e){e.Select=function(i){i=this.defaultArg(i,2),e.call(this,i,1),this.gate=new e.Signal(0),this._readOnly("gate");for(var n=0;i>n;n++){var r=new t(n);this.input[n]=r,this.gate.connect(r.selecter),r.connect(this.output)}},e.extend(e.Select,e.SignalBase),e.Select.prototype.select=function(e,t){return e=Math.floor(e),this.gate.setValueAtTime(e,this.toSeconds(t)),this},e.Select.prototype.dispose=function(){this._writable("gate"),this.gate.dispose(),this.gate=null;for(var t=0;t<this.input.length;t++)this.input[t].dispose(),this.input[t]=null;return e.prototype.dispose.call(this),this};var t=function(t){this.selecter=new e.Equal(t),this.gate=this.input=this.output=this.context.createGain(),this.selecter.connect(this.gate.gain)};return e.extend(t),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.selecter.dispose(),this.gate.disconnect(),this.selecter=null,this.gate=null},e.Select}),Module(function(e){return e.IfThenElse=function(){e.call(this,3,0),this._selector=this.output=new e.Select(2),this["if"]=this.input[0]=this._selector.gate,this.then=this.input[1]=this._selector.input[1],this["else"]=this.input[2]=this._selector.input[0]},e.extend(e.IfThenElse,e.SignalBase),e.IfThenElse.prototype.dispose=function(){return e.prototype.dispose.call(this),this._selector.dispose(),this._selector=null,this["if"]=null,this.then=null,this["else"]=null,this},e.IfThenElse}),Module(function(e){return e.OR=function(t){t=this.defaultArg(t,2),e.call(this,t,0),this._sum=this.context.createGain(),this._gtz=this.output=new e.GreaterThanZero;for(var i=0;t>i;i++)this.input[i]=this._sum;this._sum.connect(this._gtz)},e.extend(e.OR,e.SignalBase),e.OR.prototype.dispose=function(){return e.prototype.dispose.call(this),this._gtz.dispose(),this._gtz=null,this._sum.disconnect(),this._sum=null,this},e.OR}),Module(function(e){return e.AND=function(t){t=this.defaultArg(t,2),e.call(this,t,0),this._equals=this.output=new e.Equal(t);for(var i=0;t>i;i++)this.input[i]=this._equals},e.extend(e.AND,e.SignalBase),e.AND.prototype.dispose=function(){return e.prototype.dispose.call(this),this._equals.dispose(),this._equals=null,this},e.AND}),Module(function(e){return e.NOT=e.EqualZero,e.NOT}),Module(function(e){return e.GreaterThan=function(t){e.call(this,2,0),this._value=this.input[0]=new e.Subtract(t),this.input[1]=this._value.input[1],this._gtz=this.output=new e.GreaterThanZero,this._value.connect(this._gtz)},e.extend(e.GreaterThan,e.Signal),e.GreaterThan.prototype.dispose=function(){return e.prototype.dispose.call(this),this._value.dispose(),this._value=null,this._gtz.dispose(),this._gtz=null,this},e.GreaterThan}),Module(function(e){return e.LessThan=function(t){e.call(this,2,0),this._neg=this.input[0]=new e.Negate,this._gt=this.output=new e.GreaterThan,this._rhNeg=new e.Negate,this._value=this.input[1]=new e.Signal(t),this._neg.connect(this._gt),this._value.connect(this._rhNeg),this._rhNeg.connect(this._gt,0,1)},e.extend(e.LessThan,e.Signal),e.LessThan.prototype.dispose=function(){return e.prototype.dispose.call(this),this._neg.dispose(),this._neg=null,this._gt.dispose(),this._gt=null,this._rhNeg.dispose(),this._rhNeg=null,this._value.dispose(),this._value=null,this},e.LessThan}),Module(function(e){return e.Abs=function(){e.call(this,1,0),this._ltz=new e.LessThan(0),this._switch=this.output=new e.Select(2),this._negate=new e.Negate,this.input.connect(this._switch,0,0),this.input.connect(this._negate),this._negate.connect(this._switch,0,1),this.input.chain(this._ltz,this._switch.gate)},e.extend(e.Abs,e.SignalBase),e.Abs.prototype.dispose=function(){return e.prototype.dispose.call(this),this._switch.dispose(),this._switch=null,this._ltz.dispose(),this._ltz=null,this._negate.dispose(),this._negate=null,this},e.Abs}),Module(function(e){return e.Max=function(t){e.call(this,2,0),this.input[0]=this.context.createGain(),this._value=this.input[1]=new e.Signal(t),this._ifThenElse=this.output=new e.IfThenElse,this._gt=new e.GreaterThan,this.input[0].chain(this._gt,this._ifThenElse["if"]),this.input[0].connect(this._ifThenElse.then),this._value.connect(this._ifThenElse["else"]),this._value.connect(this._gt,0,1)},e.extend(e.Max,e.Signal),e.Max.prototype.dispose=function(){return e.prototype.dispose.call(this),this._value.dispose(),this._ifThenElse.dispose(),this._gt.dispose(),this._value=null,this._ifThenElse=null,this._gt=null,this},e.Max}),Module(function(e){return e.Min=function(t){e.call(this,2,0),this.input[0]=this.context.createGain(),this._ifThenElse=this.output=new e.IfThenElse,this._lt=new e.LessThan,this._value=this.input[1]=new e.Signal(t),this.input[0].chain(this._lt,this._ifThenElse["if"]),this.input[0].connect(this._ifThenElse.then),this._value.connect(this._ifThenElse["else"]),this._value.connect(this._lt,0,1)},e.extend(e.Min,e.Signal),e.Min.prototype.dispose=function(){return e.prototype.dispose.call(this),this._value.dispose(),this._ifThenElse.dispose(),this._lt.dispose(),this._value=null,this._ifThenElse=null,this._lt=null,this},e.Min}),Module(function(e){return e.Modulo=function(t){e.call(this,1,1),this._shaper=new e.WaveShaper(Math.pow(2,16)),this._multiply=new e.Multiply,this._subtract=this.output=new e.Subtract,this._modSignal=new e.Signal(t),this.input.fan(this._shaper,this._subtract),this._modSignal.connect(this._multiply,0,0),this._shaper.connect(this._multiply,0,1),this._multiply.connect(this._subtract,0,1),this._setWaveShaper(t)},e.extend(e.Modulo,e.SignalBase),e.Modulo.prototype._setWaveShaper=function(e){this._shaper.setMap(function(t){var i=Math.floor((t+1e-4)/e);return i})},Object.defineProperty(e.Modulo.prototype,"value",{get:function(){return this._modSignal.value},set:function(e){this._modSignal.value=e,this._setWaveShaper(e)}}),e.Modulo.prototype.dispose=function(){return e.prototype.dispose.call(this),this._shaper.dispose(),this._shaper=null,this._multiply.dispose(),this._multiply=null,this._subtract.dispose(),this._subtract=null,this._modSignal.dispose(),this._modSignal=null,this},e.Modulo}),Module(function(e){function t(e,t,i){var n=new e;return i._eval(t[0]).connect(n,0,0),i._eval(t[1]).connect(n,0,1),n}function i(e,t,i){var n=new e;return i._eval(t[0]).connect(n,0,0),n}function n(e){return e?parseFloat(e):void 0}function r(e){return e&&e.args?parseFloat(e.args):void 0}return e.Expr=function(){var e=this._replacements(Array.prototype.slice.call(arguments)),t=this._parseInputs(e);this._nodes=[],this.input=new Array(t);for(var i=0;t>i;i++)this.input[i]=this.context.createGain();var n,r=this._parseTree(e);try{n=this._eval(r)}catch(o){throw this._disposeNodes(),new Error("Could evaluate expression: "+e)}this.output=n},e.extend(e.Expr,e.SignalBase),e.Expr._Expressions={value:{signal:{regexp:/^\d+\.\d+|^\d+/,method:function(t){var i=new e.Signal(n(t));return i}},input:{regexp:/^\$\d/,method:function(e,t){return t.input[n(e.substr(1))]}}},glue:{"(":{regexp:/^\(/},")":{regexp:/^\)/},",":{regexp:/^,/}},func:{abs:{regexp:/^abs/,method:i.bind(this,e.Abs)},min:{regexp:/^min/,method:t.bind(this,e.Min)},max:{regexp:/^max/,method:t.bind(this,e.Max)},"if":{regexp:/^if/,method:function(t,i){var n=new e.IfThenElse;return i._eval(t[0]).connect(n["if"]),i._eval(t[1]).connect(n.then),i._eval(t[2]).connect(n["else"]),n}},gt0:{regexp:/^gt0/,method:i.bind(this,e.GreaterThanZero)},eq0:{regexp:/^eq0/,method:i.bind(this,e.EqualZero)},mod:{regexp:/^mod/,method:function(t,i){var n=r(t[1]),o=new e.Modulo(n);return i._eval(t[0]).connect(o),o}},pow:{regexp:/^pow/,method:function(t,i){var n=r(t[1]),o=new e.Pow(n);return i._eval(t[0]).connect(o),o}}},binary:{"+":{regexp:/^\+/,precedence:1,method:t.bind(this,e.Add)},"-":{regexp:/^\-/,precedence:1,method:function(n,r){return 1===n.length?i(e.Negate,n,r):t(e.Subtract,n,r)}},"*":{regexp:/^\*/,precedence:0,method:t.bind(this,e.Multiply)},">":{regexp:/^\>/,
precedence:2,method:t.bind(this,e.GreaterThan)},"<":{regexp:/^</,precedence:2,method:t.bind(this,e.LessThan)},"==":{regexp:/^==/,precedence:3,method:t.bind(this,e.Equal)},"&&":{regexp:/^&&/,precedence:4,method:t.bind(this,e.AND)},"||":{regexp:/^\|\|/,precedence:5,method:t.bind(this,e.OR)}},unary:{"-":{regexp:/^\-/,method:i.bind(this,e.Negate)},"!":{regexp:/^\!/,method:i.bind(this,e.NOT)}}},e.Expr.prototype._parseInputs=function(e){var t=e.match(/\$\d/g),i=0;if(null!==t)for(var n=0;n<t.length;n++){var r=parseInt(t[n].substr(1))+1;i=Math.max(i,r)}return i},e.Expr.prototype._replacements=function(e){for(var t=e.shift(),i=0;i<e.length;i++)t=t.replace(/\%/i,e[i]);return t},e.Expr.prototype._tokenize=function(t){function i(t){for(var i in e.Expr._Expressions){var n=e.Expr._Expressions[i];for(var r in n){var o=n[r],s=o.regexp,a=t.match(s);if(null!==a)return{type:i,value:a[0],method:o.method}}}throw new SyntaxError("Unexpected token "+t)}for(var n=-1,r=[];t.length>0;){t=t.trim();var o=i(t);r.push(o),t=t.substr(o.value.length)}return{next:function(){return r[++n]},peek:function(){return r[n+1]}}},e.Expr.prototype._parseTree=function(t){function i(e,t){return!c(e)&&"glue"===e.type&&e.value===t}function n(t,i,n){var r=!1,o=e.Expr._Expressions[i];if(!c(t))for(var s in o){var a=o[s];if(a.regexp.test(t.value)){if(c(n))return!0;if(a.precedence===n)return!0}}return r}function r(e){c(e)&&(e=5);var t;t=0>e?o():r(e-1);for(var i=l.peek();n(i,"binary",e);)i=l.next(),t={operator:i.value,method:i.method,args:[t,r(e)]},i=l.peek();return t}function o(){var e,t;return e=l.peek(),n(e,"unary")?(e=l.next(),t=o(),{operator:e.value,method:e.method,args:[t]}):s()}function s(){var e,t;if(e=l.peek(),c(e))throw new SyntaxError("Unexpected termination of expression");if("func"===e.type)return e=l.next(),a(e);if("value"===e.type)return e=l.next(),{method:e.method,args:e.value};if(i(e,"(")){if(l.next(),t=r(),e=l.next(),!i(e,")"))throw new SyntaxError("Expected )");return t}throw new SyntaxError("Parse error, cannot process token "+e.value)}function a(e){var t,n=[];if(t=l.next(),!i(t,"("))throw new SyntaxError('Expected ( in a function call "'+e.value+'"');if(t=l.peek(),i(t,")")||(n=h()),t=l.next(),!i(t,")"))throw new SyntaxError('Expected ) in a function call "'+e.value+'"');return{method:e.method,args:n,name:name}}function h(){for(var e,t,n=[];;){if(t=r(),c(t))break;if(n.push(t),e=l.peek(),!i(e,","))break;l.next()}return n}var l=this._tokenize(t),c=this.isUndef.bind(this);return r()},e.Expr.prototype._eval=function(e){if(!this.isUndef(e)){var t=e.method(e.args,this);return this._nodes.push(t),t}},e.Expr.prototype._disposeNodes=function(){for(var e=0;e<this._nodes.length;e++){var t=this._nodes[e];this.isFunction(t.dispose)?t.dispose():this.isFunction(t.disconnect)&&t.disconnect(),t=null,this._nodes[e]=null}this._nodes=null},e.Expr.prototype.dispose=function(){e.prototype.dispose.call(this),this._disposeNodes()},e.Expr}),Module(function(e){return e.EqualPowerGain=function(){this._eqPower=this.input=this.output=new e.WaveShaper(function(e){return Math.abs(e)<.001?0:this.equalPowerScale(e)}.bind(this),4096)},e.extend(e.EqualPowerGain,e.SignalBase),e.EqualPowerGain.prototype.dispose=function(){return e.prototype.dispose.call(this),this._eqPower.dispose(),this._eqPower=null,this},e.EqualPowerGain}),Module(function(e){return e.CrossFade=function(t){e.call(this,2,1),this.a=this.input[0]=this.context.createGain(),this.b=this.input[1]=this.context.createGain(),this.fade=new e.Signal(this.defaultArg(t,.5),e.Type.NormalRange),this._equalPowerA=new e.EqualPowerGain,this._equalPowerB=new e.EqualPowerGain,this._invert=new e.Expr("1 - $0"),this.a.connect(this.output),this.b.connect(this.output),this.fade.chain(this._equalPowerB,this.b.gain),this.fade.chain(this._invert,this._equalPowerA,this.a.gain),this._readOnly("fade")},e.extend(e.CrossFade),e.CrossFade.prototype.dispose=function(){return e.prototype.dispose.call(this),this._writable("fade"),this._equalPowerA.dispose(),this._equalPowerA=null,this._equalPowerB.dispose(),this._equalPowerB=null,this.fade.dispose(),this.fade=null,this._invert.dispose(),this._invert=null,this.a.disconnect(),this.a=null,this.b.disconnect(),this.b=null,this},e.CrossFade}),Module(function(e){return e.Filter=function(){e.call(this);var t=this.optionsObject(arguments,["frequency","type","rolloff"],e.Filter.defaults);this._filters=[],this.frequency=new e.Signal(t.frequency,e.Type.Frequency),this.detune=new e.Signal(0,e.Type.Cents),this.gain=new e.Signal({value:t.gain,units:e.Type.Decibels,convert:!1}),this.Q=new e.Signal(t.Q),this._type=t.type,this._rolloff=t.rolloff,this.rolloff=t.rolloff,this._readOnly(["detune","frequency","gain","Q"])},e.extend(e.Filter),e.Filter.defaults={type:"lowpass",frequency:350,rolloff:-12,Q:1,gain:0},Object.defineProperty(e.Filter.prototype,"type",{get:function(){return this._type},set:function(e){var t=["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"];if(-1===t.indexOf(e))throw new TypeError("Tone.Filter does not have filter type "+e);this._type=e;for(var i=0;i<this._filters.length;i++)this._filters[i].type=e}}),Object.defineProperty(e.Filter.prototype,"rolloff",{get:function(){return this._rolloff},set:function(e){var t=[-12,-24,-48],i=t.indexOf(e);if(-1===i)throw new RangeError("Filter rolloff can only be -12, -24, or -48");i++,this._rolloff=e,this.input.disconnect();for(var n=0;n<this._filters.length;n++)this._filters[n].disconnect(),this._filters[n]=null;this._filters=new Array(i);for(var r=0;i>r;r++){var o=this.context.createBiquadFilter();o.type=this._type,this.frequency.connect(o.frequency),this.detune.connect(o.detune),this.Q.connect(o.Q),this.gain.connect(o.gain),this._filters[r]=o}var s=[this.input].concat(this._filters).concat([this.output]);this.connectSeries.apply(this,s)}}),e.Filter.prototype.dispose=function(){e.prototype.dispose.call(this);for(var t=0;t<this._filters.length;t++)this._filters[t].disconnect(),this._filters[t]=null;return this._filters=null,this._writable(["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.frequency=null,this.Q=null,this.detune.dispose(),this.detune=null,this.gain.dispose(),this.gain=null,this},e.Filter}),Module(function(e){return e.MultibandSplit=function(){var t=this.optionsObject(arguments,["lowFrequency","highFrequency"],e.MultibandSplit.defaults);this.input=this.context.createGain(),this.output=new Array(3),this.low=this.output[0]=new e.Filter(0,"lowpass"),this._lowMidFilter=new e.Filter(0,"highpass"),this.mid=this.output[1]=new e.Filter(0,"lowpass"),this.high=this.output[2]=new e.Filter(0,"highpass"),this.lowFrequency=new e.Signal(t.lowFrequency,e.Type.Frequency),this.highFrequency=new e.Signal(t.highFrequency,e.Type.Frequency),this.Q=new e.Signal(t.Q),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.connect(this.low.frequency),this.lowFrequency.connect(this._lowMidFilter.frequency),this.highFrequency.connect(this.mid.frequency),this.highFrequency.connect(this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),this._readOnly(["high","mid","low","highFrequency","lowFrequency"])},e.extend(e.MultibandSplit),e.MultibandSplit.defaults={lowFrequency:400,highFrequency:2500,Q:1},e.MultibandSplit.prototype.dispose=function(){return e.prototype.dispose.call(this),this._writable(["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this.low=null,this._lowMidFilter.dispose(),this._lowMidFilter=null,this.mid.dispose(),this.mid=null,this.high.dispose(),this.high=null,this.lowFrequency.dispose(),this.lowFrequency=null,this.highFrequency.dispose(),this.highFrequency=null,this.Q.dispose(),this.Q=null,this},e.MultibandSplit}),Module(function(e){return e.EQ3=function(){var t=this.optionsObject(arguments,["low","mid","high"],e.EQ3.defaults);this.output=this.context.createGain(),this._multibandSplit=this.input=new e.MultibandSplit({lowFrequency:t.lowFrequency,highFrequency:t.highFrequency}),this._lowGain=this.context.createGain(),this._midGain=this.context.createGain(),this._highGain=this.context.createGain(),this.low=new e.Signal(this._lowGain.gain,e.Type.Decibels),this.mid=new e.Signal(this._midGain.gain,e.Type.Decibels),this.high=new e.Signal(this._highGain.gain,e.Type.Decibels),this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),this.low.value=t.low,this.mid.value=t.mid,this.high.value=t.high,this._readOnly(["low","mid","high","lowFrequency","highFrequency"])},e.extend(e.EQ3),e.EQ3.defaults={low:0,mid:0,high:0,lowFrequency:400,highFrequency:2500},e.EQ3.prototype.dispose=function(){return e.prototype.dispose.call(this),this._writable(["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this._multibandSplit=null,this.lowFrequency=null,this.highFrequency=null,this._lowGain.disconnect(),this._lowGain=null,this._midGain.disconnect(),this._midGain=null,this._highGain.disconnect(),this._highGain=null,this.low.dispose(),this.low=null,this.mid.dispose(),this.mid=null,this.high.dispose(),this.high=null,this.Q=null,this},e.EQ3}),Module(function(e){return e.Scale=function(t,i){this._outputMin=this.defaultArg(t,0),this._outputMax=this.defaultArg(i,1),this._scale=this.input=new e.Multiply(1),this._add=this.output=new e.Add(0),this._scale.connect(this._add),this._setRange()},e.extend(e.Scale,e.SignalBase),Object.defineProperty(e.Scale.prototype,"min",{get:function(){return this._outputMin},set:function(e){this._outputMin=e,this._setRange()}}),Object.defineProperty(e.Scale.prototype,"max",{get:function(){return this._outputMax},set:function(e){this._outputMax=e,this._setRange()}}),e.Scale.prototype._setRange=function(){this._add.value=this._outputMin,this._scale.value=this._outputMax-this._outputMin},e.Scale.prototype.dispose=function(){return e.prototype.dispose.call(this),this._add.dispose(),this._add=null,this._scale.dispose(),this._scale=null,this},e.Scale}),Module(function(e){return e.ScaleExp=function(t,i,n){this._scale=this.output=new e.Scale(t,i),this._exp=this.input=new e.Pow(this.defaultArg(n,2)),this._exp.connect(this._scale)},e.extend(e.ScaleExp,e.SignalBase),Object.defineProperty(e.ScaleExp.prototype,"exponent",{get:function(){return this._exp.value},set:function(e){this._exp.value=e}}),Object.defineProperty(e.ScaleExp.prototype,"min",{get:function(){return this._scale.min},set:function(e){this._scale.min=e}}),Object.defineProperty(e.ScaleExp.prototype,"max",{get:function(){return this._scale.max},set:function(e){this._scale.max=e}}),e.ScaleExp.prototype.dispose=function(){return e.prototype.dispose.call(this),this._scale.dispose(),this._scale=null,this._exp.dispose(),this._exp=null,this},e.ScaleExp}),Module(function(e){return e.FeedbackCombFilter=function(){e.call(this);var t=this.optionsObject(arguments,["delayTime","resonance"],e.FeedbackCombFilter.defaults);this.resonance=new e.Signal(t.resonance,e.Type.NormalRange),this._delay=this.input=this.output=this.context.createDelay(1),this.delayTime=new e.Signal(t.delayTime,e.Type.Time),this._feedback=this.context.createGain(),this._delay.chain(this._feedback,this._delay),this.resonance.connect(this._feedback.gain),this.delayTime.connect(this._delay.delayTime),this._readOnly(["resonance","delayTime"])},e.extend(e.FeedbackCombFilter),e.FeedbackCombFilter.defaults={delayTime:.1,resonance:.5},e.FeedbackCombFilter.prototype.dispose=function(){return e.prototype.dispose.call(this),this._writable(["resonance","delayTime"]),this._delay.disconnect(),this._delay=null,this.delayTime.dispose(),this.delayTime=null,this.resonance.dispose(),this.resonance=null,this._feedback.disconnect(),this._feedback=null,this},e.FeedbackCombFilter}),Module(function(e){return e.Follower=function(){e.call(this);var t=this.optionsObject(arguments,["attack","release"],e.Follower.defaults);this._abs=new e.Abs,this._filter=this.context.createBiquadFilter(),this._filter.type="lowpass",this._filter.frequency.value=0,this._filter.Q.value=-100,this._frequencyValues=new e.WaveShaper,this._sub=new e.Subtract,this._delay=this.context.createDelay(),this._delay.delayTime.value=this.bufferTime,this._mult=new e.Multiply(1e4),this._attack=t.attack,this._release=t.release,this.input.chain(this._abs,this._filter,this.output),this._abs.connect(this._sub,0,1),this._filter.chain(this._delay,this._sub),this._sub.chain(this._mult,this._frequencyValues,this._filter.frequency),this._setAttackRelease(this._attack,this._release)},e.extend(e.Follower),e.Follower.defaults={attack:.05,release:.5},e.Follower.prototype._setAttackRelease=function(e,t){var i=this.bufferTime;e=this.secondsToFrequency(this.toSeconds(e)),t=this.secondsToFrequency(this.toSeconds(t)),e=Math.max(e,i),t=Math.max(t,i),this._frequencyValues.setMap(function(i){return 0>=i?e:t})},Object.defineProperty(e.Follower.prototype,"attack",{get:function(){return this._attack},set:function(e){this._attack=e,this._setAttackRelease(this._attack,this._release)}}),Object.defineProperty(e.Follower.prototype,"release",{get:function(){return this._release},set:function(e){this._release=e,this._setAttackRelease(this._attack,this._release)}}),e.Follower.prototype.connect=e.Signal.prototype.connect,e.Follower.prototype.dispose=function(){return e.prototype.dispose.call(this),this._filter.disconnect(),this._filter=null,this._frequencyValues.disconnect(),this._frequencyValues=null,this._delay.disconnect(),this._delay=null,this._sub.disconnect(),this._sub=null,this._abs.dispose(),this._abs=null,this._mult.dispose(),this._mult=null,this._curve=null,this},e.Follower}),Module(function(e){return e.Gate=function(){e.call(this);var t=this.optionsObject(arguments,["threshold","attack","release"],e.Gate.defaults);this._follower=new e.Follower(t.attack,t.release),this._gt=new e.GreaterThan(this.dbToGain(t.threshold)),this.input.connect(this.output),this.input.chain(this._gt,this._follower,this.output.gain)},e.extend(e.Gate),e.Gate.defaults={attack:.1,release:.1,threshold:-40},Object.defineProperty(e.Gate.prototype,"threshold",{get:function(){return this.gainToDb(this._gt.value)},set:function(e){this._gt.value=this.dbToGain(e)}}),Object.defineProperty(e.Gate.prototype,"attack",{get:function(){return this._follower.attack},set:function(e){this._follower.attack=e}}),Object.defineProperty(e.Gate.prototype,"release",{get:function(){return this._follower.release},set:function(e){this._follower.release=e}}),e.Gate.prototype.dispose=function(){return e.prototype.dispose.call(this),this._follower.dispose(),this._gt.dispose(),this._follower=null,this._gt=null,this},e.Gate}),Module(function(e){return e.Clock=function(t,i){this._oscillator=null,this._jsNode=this.context.createScriptProcessor(this.bufferSize,1,1),this._jsNode.onaudioprocess=this._processBuffer.bind(this),this.frequency=new e.Signal(t,e.Type.Frequency),this._upTick=!1,this.tick=i,this.onended=e.noOp,this._jsNode.noGC()},e.extend(e.Clock),e.Clock.prototype.start=function(e){if(!this._oscillator){this._oscillator=this.context.createOscillator(),this._oscillator.type="square",this._oscillator.connect(this._jsNode),this.frequency.connect(this._oscillator.frequency),this._upTick=!1;var t=this.toSeconds(e);this._oscillator.start(t)}return this},e.Clock.prototype.stop=function(e){if(this._oscillator){var t=this.now(),i=this.toSeconds(e,t);this._oscillator.stop(i),this._oscillator=null,e?setTimeout(this.onended,1e3*(i-t)):this.onended()}return this},e.Clock.prototype._processBuffer=function(e){for(var t=this.defaultArg(e.playbackTime,this.now()),i=this._jsNode.bufferSize,n=e.inputBuffer.getChannelData(0),r=this._upTick,o=this,s=0;i>s;s++){var a=n[s];a>0&&!r?(r=!0,setTimeout(function(){var e=t+o.samplesToSeconds(s+2*i);return function(){o.tick&&o.tick(e)}}(),0)):0>a&&r&&(r=!1)}this._upTick=r},e.Clock.prototype.dispose=function(){return this._jsNode.disconnect(),this.frequency.dispose(),this.frequency=null,this._oscillator&&(this._oscillator.disconnect(),this._oscillator=null),this._jsNode.onaudioprocess=e.noOp,this._jsNode=null,this.tick=null,this.onended=e.noOp,this},e.Clock}),Module(function(Tone){Tone.Transport=function(){this._clock=new Tone.Clock(0,this._processTick.bind(this)),this._clock.onended=this._onended.bind(this),this.loop=!1,this.bpm=new Tone.Signal(120,Tone.Type.BPM),this._bpmMult=new Tone.Multiply(1/60*tatum),this.state=Tone.State.Stopped,this.bpm.chain(this._bpmMult,this._clock.frequency)},Tone.extend(Tone.Transport),Tone.Transport.defaults={bpm:120,swing:0,swingSubdivision:"16n",timeSignature:4,loopStart:0,loopEnd:"4m"};var tatum=12,timelineTicks=0,transportTicks=0,swingSubdivision="16n",swingTatum=3,swingAmount=0,transportTimeSignature=4,loopStart=0,loopEnd=4*tatum,intervals=[],timeouts=[],transportTimeline=[],timelineProgress=0,SyncedSources=[],SyncedSignals=[];Tone.Transport.prototype._processTick=function(e){this.state===Tone.State.Started&&(swingAmount>0&&timelineTicks%tatum!==0&&timelineTicks%swingTatum===0&&(e+=this._ticksToSeconds(swingTatum)*swingAmount),processIntervals(e),processTimeouts(e),processTimeline(e),transportTicks+=1,timelineTicks+=1,this.loop&&timelineTicks===loopEnd&&this._setTicks(loopStart))},Tone.Transport.prototype._setTicks=function(e){timelineTicks=e;for(var t=0;t<transportTimeline.length;t++){var i=transportTimeline[t];if(i.callbackTick()>=e){timelineProgress=t;break}}};var processIntervals=function(e){for(var t=0,i=intervals.length;i>t;t++){var n=intervals[t];n.testInterval(transportTicks)&&n.doCallback(e)}},processTimeouts=function(e){for(var t=0,i=0,n=timeouts.length;n>i;i++){var r=timeouts[i],o=r.callbackTick();if(transportTicks>=o)r.doCallback(e),t++;else if(o>transportTicks)break}timeouts.splice(0,t)},processTimeline=function(e){for(var t=timelineProgress,i=transportTimeline.length;i>t;t++){var n=transportTimeline[t],r=n.callbackTick();if(r===timelineTicks)timelineProgress=t,n.doCallback(e);else if(r>timelineTicks)break}};Tone.Transport.prototype.setInterval=function(e,t,i){var n=this._toTicks(t),r=new TimelineEvent(e,i,n,transportTicks);return intervals.push(r),r.id},Tone.Transport.prototype.clearInterval=function(e){for(var t=0;t<intervals.length;t++){var i=intervals[t];if(i.id===e)return intervals.splice(t,1),!0}return!1},Tone.Transport.prototype.clearIntervals=function(){var e=intervals.length>0;return intervals=[],e},Tone.Transport.prototype.setTimeout=function(e,t,i){for(var n=this._toTicks(t),r=new TimelineEvent(e,i,n+transportTicks,0),o=0,s=timeouts.length;s>o;o++){var a=timeouts[o];if(a.callbackTick()>r.callbackTick())return timeouts.splice(o,0,r),r.id}return timeouts.push(r),r.id},Tone.Transport.prototype.clearTimeout=function(e){for(var t=0;t<timeouts.length;t++){var i=timeouts[t];if(i.id===e)return timeouts.splice(t,1),!0}return!1},Tone.Transport.prototype.clearTimeouts=function(){var e=timeouts.length>0;return timeouts=[],e},Tone.Transport.prototype.setTimeline=function(e,t,i){for(var n=this._toTicks(t),r=new TimelineEvent(e,i,n,0),o=timelineProgress,s=transportTimeline.length;s>o;o++){var a=transportTimeline[o];if(a.callbackTick()>r.callbackTick())return transportTimeline.splice(o,0,r),r.id}return transportTimeline.push(r),r.id},Tone.Transport.prototype.clearTimeline=function(e){for(var t=0;t<transportTimeline.length;t++){var i=transportTimeline[t];if(i.id===e)return transportTimeline.splice(t,1),!0}return!1},Tone.Transport.prototype.clearTimelines=function(){timelineProgress=0;var e=transportTimeline.length>0;return transportTimeline=[],e},Tone.Transport.prototype._toTicks=function(e){var t=this.toSeconds(e),i=this.notationToSeconds("4n"),n=t/i,r=n*tatum;return Math.round(r)},Tone.Transport.prototype._ticksToSeconds=function(e,t,i){e=Math.floor(e);var n=this.notationToSeconds("4n",t,i);return n*e/tatum},Tone.Transport.prototype.nextBeat=function(e){e=this.defaultArg(e,"4n");var t=this._toTicks(e),i=transportTicks%t,n=i;return i>0&&(n=t-i),this._ticksToSeconds(n)},Tone.Transport.prototype.start=function(e,t){if(this.state===Tone.State.Stopped||this.state===Tone.State.Paused){this.isUndef(t)||this._setTicks(this._toTicks(t)),this.state=Tone.State.Started;var i=this.toSeconds(e);this._clock.start(i);for(var n=0;n<SyncedSources.length;n++){var r=SyncedSources[n].source,o=SyncedSources[n].delay;r.start(i+o)}}return this},Tone.Transport.prototype.stop=function(e){if(this.state===Tone.State.Started||this.state===Tone.State.Paused){var t=this.toSeconds(e);this._clock.stop(t);for(var i=0;i<SyncedSources.length;i++){var n=SyncedSources[i].source;n.stop(t)}}else this._onended();return this},Tone.Transport.prototype._onended=function(){transportTicks=0,this._setTicks(0),this.clearTimeouts(),this.state=Tone.State.Stopped},Tone.Transport.prototype.pause=function(e){if(this.state===Tone.State.Started){this.state=Tone.State.Paused;var t=this.toSeconds(e);this._clock.stop(t);for(var i=0;i<SyncedSources.length;i++){var n=SyncedSources[i].source;n.pause(t)}}return this},Object.defineProperty(Tone.Transport.prototype,"timeSignature",{get:function(){return transportTimeSignature},set:function(e){transportTimeSignature=e}}),Object.defineProperty(Tone.Transport.prototype,"loopStart",{get:function(){return this._ticksToSeconds(loopStart)},set:function(e){loopStart=this._toTicks(e)}}),Object.defineProperty(Tone.Transport.prototype,"loopEnd",{get:function(){return this._ticksToSeconds(loopEnd)},set:function(e){loopEnd=this._toTicks(e)}}),Tone.Transport.prototype.setLoopPoints=function(e,t){return this.loopStart=e,this.loopEnd=t,this},Object.defineProperty(Tone.Transport.prototype,"swing",{get:function(){return 2*swingAmount},set:function(e){swingAmount=.5*e}}),Object.defineProperty(Tone.Transport.prototype,"swingSubdivision",{get:function(){return swingSubdivision},set:function(e){swingSubdivision=e,swingTatum=this._toTicks(e)}}),Object.defineProperty(Tone.Transport.prototype,"position",{get:function(){var e=timelineTicks/tatum,t=Math.floor(e/transportTimeSignature),i=Math.floor(e%1*4);e=Math.floor(e)%transportTimeSignature;var n=[t,e,i];return n.join(":")},set:function(e){var t=this._toTicks(e);this._setTicks(t)}}),Tone.Transport.prototype.syncSource=function(e,t){return SyncedSources.push({source:e,delay:this.toSeconds(this.defaultArg(t,0))}),this},Tone.Transport.prototype.unsyncSource=function(e){for(var t=0;t<SyncedSources.length;t++)SyncedSources[t].source===e&&SyncedSources.splice(t,1);return this},Tone.Transport.prototype.syncSignal=function(e,t){t||(t=0!==e._value.value?e._value.value/this.bpm.value:0);var i=this.context.createGain();return i.gain.value=t,this.bpm.chain(i,e._value),SyncedSignals.push({ratio:i,signal:e,initial:e._value.value}),e._value.value=0,this},Tone.Transport.prototype.unsyncSignal=function(e){for(var t=0;t<SyncedSignals.length;t++){var i=SyncedSignals[t];i.signal===e&&(i.ratio.disconnect(),i.signal._value.value=i.initial,SyncedSignals.splice(t,1))}return this},Tone.Transport.prototype.dispose=function(){return this._clock.dispose(),this._clock=null,this.bpm.dispose(),this.bpm=null,this._bpmMult.dispose(),this._bpmMult=null,this};var TimelineEventIDCounter=0,TimelineEvent=function(e,t,i,n){this.startTicks=n,this.tickTime=i,this.callback=e,this.context=t,this.id=TimelineEventIDCounter++};TimelineEvent.prototype.doCallback=function(e){this.callback.call(this.context,e)},TimelineEvent.prototype.callbackTick=function(){return this.startTicks+this.tickTime},TimelineEvent.prototype.testInterval=function(e){return(e-this.startTicks)%this.tickTime===0},Tone.prototype.isNotation=function(){var e=new RegExp(/[0-9]+[mnt]$/i);return function(t){return e.test(t)}}(),Tone.prototype.isTransportTime=function(){var e=new RegExp(/^\d+(\.\d+)?:\d+(\.\d+)?(:\d+(\.\d+)?)?$/i);return function(t){return e.test(t)}}(),Tone.prototype.notationToSeconds=function(e,t,i){t=this.defaultArg(t,Tone.Transport.bpm.value),i=this.defaultArg(i,transportTimeSignature);var n=60/t,r=parseInt(e,10),o=0;0===r&&(o=0);var s=e.slice(-1);return o="t"===s?4/r*2/3:"n"===s?4/r:"m"===s?r*i:0,n*o},Tone.prototype.transportTimeToSeconds=function(e,t,i){t=this.defaultArg(t,Tone.Transport.bpm.value),i=this.defaultArg(i,transportTimeSignature);var n=0,r=0,o=0,s=e.split(":");2===s.length?(n=parseFloat(s[0]),r=parseFloat(s[1])):1===s.length?r=parseFloat(s[0]):3===s.length&&(n=parseFloat(s[0]),r=parseFloat(s[1]),o=parseFloat(s[2]));var a=n*i+r+o/4;return a*this.notationToSeconds("4n")},Tone.prototype.toTransportTime=function(e,t,i){var n=this.toSeconds(e,t,i);t=this.defaultArg(t,Tone.Transport.bpm.value),i=this.defaultArg(i,transportTimeSignature);var r=this.notationToSeconds("4n"),o=n/r,s=Math.floor(o/i),a=Math.floor(o%1*4);o=Math.floor(o)%i;var h=[s,o,a];return h.join(":")},Tone.prototype.toFrequency=function(e,t){return this.isFrequency(e)?parseFloat(e):this.isNotation(e)||this.isTransportTime(e)?this.secondsToFrequency(this.toSeconds(e,t)):e},Tone.prototype.toSeconds=function(time,now){if(now=this.defaultArg(now,this.now()),"number"==typeof time)return time;if("string"==typeof time){var plusTime=0;"+"===time.charAt(0)&&(plusTime=now,time=time.slice(1));var components=time.split(/[\(\)\-\+\/\*]/);if(components.length>1){for(var originalTime=time,i=0;i<components.length;i++){var symb=components[i].trim();if(""!==symb){var val=this.toSeconds(symb);time=time.replace(symb,val)}}try{time=eval(time)}catch(e){throw new EvalError("problem evaluating Tone.Type.Time: "+originalTime)}}else time=this.isNotation(time)?this.notationToSeconds(time):this.isTransportTime(time)?this.transportTimeToSeconds(time):this.isFrequency(time)?this.frequencyToSeconds(time):parseFloat(time);return time+plusTime}return now};var TransportConstructor=Tone.Transport;return Tone._initAudioContext(function(){if("function"==typeof Tone.Transport)Tone.Transport=new Tone.Transport;else{Tone.Transport.stop();var e=Tone.Transport.bpm.value;Tone.Transport._clock.dispose(),TransportConstructor.call(Tone.Transport),Tone.Transport.bpm.value=e}}),Tone.Transport}),Module(function(e){e.Master=function(){e.call(this),this._unmutedVolume=1,this._muted=!1,this.volume=new e.Signal(this.output.gain,e.Type.Decibels),this.input.chain(this.output,this.context.destination)},e.extend(e.Master),e.Master.defaults={volume:0,mute:!1},Object.defineProperty(e.Master.prototype,"mute",{get:function(){return this._muted},set:function(e){!this._muted&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-(1/0)):this._muted&&!e&&(this.volume.value=this._unmutedVolume),this._muted=e}}),e.Master.prototype.chain=function(){this.input.disconnect(),this.input.chain.apply(this.input,arguments),arguments[arguments.length-1].connect(this.output)},e.prototype.toMaster=function(){return this.connect(e.Master),this},AudioNode.prototype.toMaster=function(){return this.connect(e.Master),this};var t=e.Master;return e._initAudioContext(function(){e.prototype.isUndef(e.Master)?(t.prototype.dispose.call(e.Master),t.call(e.Master)):e.Master=new t}),e.Master}),Module(function(e){return e.Source=function(t){e.call(this,0,1),t=this.defaultArg(t,e.Source.defaults),this.onended=t.onended,this._nextStart=1/0,this._nextStop=1/0,this.volume=new e.Signal({param:this.output.gain,value:t.volume,units:e.Type.Decibels}),this._readOnly("volume"),this._timeout=-1,this.output.channelCount=2,this.output.channelCountMode="explicit"},e.extend(e.Source),e.Source.defaults={onended:e.noOp,volume:0},Object.defineProperty(e.Source.prototype,"state",{get:function(){return this._stateAtTime(this.now())}}),e.Source.prototype._stateAtTime=function(t){return t=this.toSeconds(t),this._nextStart<=t&&this._nextStop>t?e.State.Started:this._nextStop<=t?e.State.Stopped:e.State.Stopped},e.Source.prototype.start=function(t){return t=this.toSeconds(t),(this._stateAtTime(t)!==e.State.Started||this.retrigger)&&(this._nextStart=t,this._nextStop=1/0,this._start.apply(this,arguments)),this},e.Source.prototype.stop=function(t){var i=this.now();if(t=this.toSeconds(t,i),this._stateAtTime(t)===e.State.Started){this._nextStop=this.toSeconds(t),clearTimeout(this._timeout);var n=t-i;n>0?this._timeout=setTimeout(this.onended,1e3*n+20):this.onended(),this._stop.apply(this,arguments)}return this},e.Source.prototype.pause=function(e){return this.stop(e),this},e.Source.prototype.sync=function(t){return e.Transport.syncSource(this,t),this},e.Source.prototype.unsync=function(){return e.Transport.unsyncSource(this),this},e.Source.prototype.dispose=function(){e.prototype.dispose.call(this),this.stop(),clearTimeout(this._timeout),this.onended=e.noOp,this._writable("volume"),this.volume.dispose(),this.volume=null},e.Source}),Module(function(e){return e.Oscillator=function(){var t=this.optionsObject(arguments,["frequency","type"],e.Oscillator.defaults);e.Source.call(this,t),this._oscillator=null,this.frequency=new e.Signal(t.frequency,e.Type.Frequency),this.detune=new e.Signal(t.detune,e.Type.Cents),this._wave=null,this._phase=t.phase,this._type=null,this.type=t.type,this.phase=this._phase,this._readOnly(["frequency","detune"])},e.extend(e.Oscillator,e.Source),e.Oscillator.defaults={type:"sine",frequency:440,detune:0,phase:0},e.Oscillator.prototype._start=function(e){this._oscillator=this.context.createOscillator(),this._oscillator.setPeriodicWave(this._wave),this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(this.toSeconds(e))},e.Oscillator.prototype._stop=function(e){return this._oscillator&&(this._oscillator.stop(this.toSeconds(e)),this._oscillator=null),this},e.Oscillator.prototype.syncFrequency=function(){return e.Transport.syncSignal(this.frequency),this},e.Oscillator.prototype.unsyncFrequency=function(){return e.Transport.unsyncSignal(this.frequency),this},Object.defineProperty(e.Oscillator.prototype,"type",{get:function(){return this._type},set:function(e){var t=e,i=4096,n=i/2,r=new Float32Array(n),o=new Float32Array(n),s=1,a=/(sine|triangle|square|sawtooth)(\d+)$/.exec(e);a&&(s=parseInt(a[2]),e=a[1],s=Math.max(s,2),n=s);for(var h=this._phase,l=1;n>l;++l){var c,u=2/(l*Math.PI);switch(e){case"sine":c=s>=l?1:0;break;case"square":c=1&l?2*u:0;break;case"sawtooth":c=u*(1&l?1:-1);break;case"triangle":c=1&l?2*(u*u)*(l-1>>1&1?-1:1):0;break;default:throw new TypeError("invalid oscillator type: "+e)}0!==c?(r[l]=-c*Math.sin(h*l),o[l]=c*Math.cos(h*l)):(r[l]=0,o[l]=0)}var p=this.context.createPeriodicWave(r,o);this._wave=p,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),this._type=t}}),Object.defineProperty(e.Oscillator.prototype,"phase",{get:function(){return this._phase*(180/Math.PI)},set:function(e){this._phase=e*Math.PI/180,this.type=this._type}}),e.Oscillator.prototype.dispose=function(){return e.Source.prototype.dispose.call(this),null!==this._oscillator&&(this._oscillator.disconnect(),this._oscillator=null),this._wave=null,this._writable(["frequency","detune"]),this.frequency.dispose(),this.frequency=null,this.detune.dispose(),this.detune=null,this},e.Oscillator}),Module(function(e){return e.AudioToGain=function(){this._norm=this.input=this.output=new e.WaveShaper(function(e){return(e+1)/2})},e.extend(e.AudioToGain,e.SignalBase),e.AudioToGain.prototype.dispose=function(){return e.prototype.dispose.call(this),this._norm.dispose(),this._norm=null,this},e.AudioToGain}),Module(function(e){return e.LFO=function(){var t=this.optionsObject(arguments,["frequency","min","max"],e.LFO.defaults);this.oscillator=new e.Oscillator({frequency:t.frequency,type:t.type,phase:t.phase+90}),this.frequency=this.oscillator.frequency,this.amplitude=this.oscillator.volume,this.amplitude.units=e.Type.NormalRange,this.amplitude.value=t.amplitude,this._a2g=new e.AudioToGain,this._scaler=this.output=new e.Scale(t.min,t.max),
this._units=e.Type.Default,this.oscillator.chain(this._a2g,this._scaler),this._readOnly(["amplitude","frequency","oscillator"])},e.extend(e.LFO,e.Oscillator),e.LFO.defaults={type:"sine",min:0,max:1,phase:0,frequency:"4n",amplitude:1},e.LFO.prototype.start=function(e){return this.oscillator.start(e),this},e.LFO.prototype.stop=function(e){return this.oscillator.stop(e),this},e.LFO.prototype.sync=function(e){return this.oscillator.sync(e),this.oscillator.syncFrequency(),this},e.LFO.prototype.unsync=function(){return this.oscillator.unsync(),this.oscillator.unsyncFrequency(),this},Object.defineProperty(e.LFO.prototype,"min",{get:function(){return this._toUnits(this._scaler.min)},set:function(e){e=this._fromUnits(e),this._scaler.min=e}}),Object.defineProperty(e.LFO.prototype,"max",{get:function(){return this._toUnits(this._scaler.max)},set:function(e){e=this._fromUnits(e),this._scaler.max=e}}),Object.defineProperty(e.LFO.prototype,"type",{get:function(){return this.oscillator.type},set:function(e){this.oscillator.type=e}}),Object.defineProperty(e.LFO.prototype,"phase",{get:function(){return this.oscillator.phase-90},set:function(e){this.oscillator.phase=e+90}}),Object.defineProperty(e.LFO.prototype,"units",{get:function(){return this._units},set:function(e){var t=this.min,i=this.max;this._units=e,this.min=t,this.max=i}}),e.LFO.prototype.connect=function(t){return t.constructor===e.Signal&&(this.convert=t.convert,this.units=t.units),e.Signal.prototype.connect.apply(this,arguments),this},e.LFO.prototype._fromUnits=e.Signal.prototype._fromUnits,e.LFO.prototype._toUnits=e.Signal.prototype._toUnits,e.LFO.prototype.dispose=function(){return e.prototype.dispose.call(this),this._writable(["amplitude","frequency","oscillator"]),this.oscillator.dispose(),this.oscillator=null,this._scaler.dispose(),this._scaler=null,this._a2g.dispose(),this._a2g=null,this.frequency=null,this.amplitude=null,this},e.LFO}),Module(function(e){return e.Limiter=function(t){this._compressor=this.input=this.output=new e.Compressor({attack:.001,decay:.001,threshold:t}),this.threshold=this._compressor.threshold,this._readOnly("threshold")},e.extend(e.Limiter),e.Limiter.prototype.dispose=function(){return e.prototype.dispose.call(this),this._compressor.dispose(),this._compressor=null,this._writable("threshold"),this.threshold=null,this},e.Limiter}),Module(function(e){return e.LowpassCombFilter=function(){e.call(this);var t=this.optionsObject(arguments,["delayTime","resonance","dampening"],e.LowpassCombFilter.defaults);this._delay=this.input=this.context.createDelay(1),this.delayTime=new e.Signal(t.delayTime,e.Type.Time),this._lowpass=this.output=this.context.createBiquadFilter(),this._lowpass.Q.value=0,this._lowpass.type="lowpass",this.dampening=new e.Signal(this._lowpass.frequency,e.Type.Frequency),this.dampening.value=t.dampening,this._feedback=this.context.createGain(),this.resonance=new e.Signal(t.resonance,e.Type.NormalRange),this._delay.chain(this._lowpass,this._feedback,this._delay),this.delayTime.connect(this._delay.delayTime),this.resonance.connect(this._feedback.gain),this.dampening.connect(this._lowpass.frequency),this._readOnly(["dampening","resonance","delayTime"])},e.extend(e.LowpassCombFilter),e.LowpassCombFilter.defaults={delayTime:.1,resonance:.5,dampening:3e3},e.LowpassCombFilter.prototype.dispose=function(){return e.prototype.dispose.call(this),this._writable(["dampening","resonance","delayTime"]),this.dampening.dispose(),this.dampening=null,this.resonance.dispose(),this.resonance=null,this._delay.disconnect(),this._delay=null,this._lowpass.disconnect(),this._lowpass=null,this._feedback.disconnect(),this._feedback=null,this.delayTime.dispose(),this.delayTime=null,this},e.LowpassCombFilter}),Module(function(e){return e.Merge=function(){e.call(this,2,0),this.left=this.input[0]=this.context.createGain(),this.right=this.input[1]=this.context.createGain(),this._merger=this.output=this.context.createChannelMerger(2),this.left.connect(this._merger,0,0),this.right.connect(this._merger,0,1)},e.extend(e.Merge),e.Merge.prototype.dispose=function(){return e.prototype.dispose.call(this),this.left.disconnect(),this.left=null,this.right.disconnect(),this.right=null,this._merger.disconnect(),this._merger=null,this},e.Merge}),Module(function(e){return e.Meter=function(t,i,n){e.call(this),this._channels=this.defaultArg(t,1),this._smoothing=this.defaultArg(i,.8),this._clipMemory=1e3*this.defaultArg(n,.5),this._volume=new Array(this._channels),this._values=new Array(this._channels);for(var r=0;r<this._channels;r++)this._volume[r]=0,this._values[r]=0;this._lastClip=0,this._jsNode=this.context.createScriptProcessor(this.bufferSize,this._channels,1),this._jsNode.onaudioprocess=this._onprocess.bind(this),this._jsNode.noGC(),this.input.connect(this.output),this.input.connect(this._jsNode)},e.extend(e.Meter),e.Meter.prototype._onprocess=function(e){for(var t=this._jsNode.bufferSize,i=this._smoothing,n=0;n<this._channels;n++){for(var r,o=e.inputBuffer.getChannelData(n),s=0,a=0,h=!1,l=0;t>l;l++)r=o[l],!h&&r>.95&&(h=!0,this._lastClip=Date.now()),a+=r,s+=r*r;var c=a/t,u=Math.sqrt(s/t);this._volume[n]=Math.max(u,this._volume[n]*i),this._values[n]=c}},e.Meter.prototype.getLevel=function(e){e=this.defaultArg(e,0);var t=this._volume[e];return 1e-5>t?0:t},e.Meter.prototype.getValue=function(e){return e=this.defaultArg(e,0),this._values[e]},e.Meter.prototype.getDb=function(e){return this.gainToDb(this.getLevel(e))},e.Meter.prototype.isClipped=function(){return Date.now()-this._lastClip<this._clipMemory},e.Meter.prototype.dispose=function(){return e.prototype.dispose.call(this),this._jsNode.disconnect(),this._jsNode.onaudioprocess=null,this._volume=null,this._values=null,this},e.Meter}),Module(function(e){return e.Split=function(){e.call(this,0,2),this._splitter=this.input=this.context.createChannelSplitter(2),this.left=this.output[0]=this.context.createGain(),this.right=this.output[1]=this.context.createGain(),this._splitter.connect(this.left,0,0),this._splitter.connect(this.right,1,0)},e.extend(e.Split),e.Split.prototype.dispose=function(){return e.prototype.dispose.call(this),this._splitter.disconnect(),this.left.disconnect(),this.right.disconnect(),this.left=null,this.right=null,this._splitter=null,this},e.Split}),Module(function(e){e.MidSideSplit=function(){e.call(this,0,2),this._split=this.input=new e.Split,this.mid=this.output[0]=new e.Expr("($0 + $1) * $2"),this.side=this.output[1]=new e.Expr("($0 - $1) * $2"),this._split.connect(this.mid,0,0),this._split.connect(this.mid,1,1),this._split.connect(this.side,0,0),this._split.connect(this.side,1,1),t.connect(this.mid,0,2),t.connect(this.side,0,2)},e.extend(e.MidSideSplit);var t=null;return e._initAudioContext(function(){t=new e.Signal(1/Math.sqrt(2))}),e.MidSideSplit.prototype.dispose=function(){return e.prototype.dispose.call(this),this.mid.dispose(),this.mid=null,this.side.dispose(),this.side=null,this._split.dispose(),this._split=null,this},e.MidSideSplit}),Module(function(e){e.MidSideMerge=function(){e.call(this,2,0),this.mid=this.input[0]=this.context.createGain(),this._left=new e.Expr("($0 + $1) * $2"),this.side=this.input[1]=this.context.createGain(),this._right=new e.Expr("($0 - $1) * $2"),this._merge=this.output=new e.Merge,this.mid.connect(this._left,0,0),this.side.connect(this._left,0,1),this.mid.connect(this._right,0,0),this.side.connect(this._right,0,1),this._left.connect(this._merge,0,0),this._right.connect(this._merge,0,1),t.connect(this._left,0,2),t.connect(this._right,0,2)},e.extend(e.MidSideMerge);var t=null;return e._initAudioContext(function(){t=new e.Signal(1/Math.sqrt(2))}),e.MidSideMerge.prototype.dispose=function(){return e.prototype.dispose.call(this),this.mid.disconnect(),this.mid=null,this.side.disconnect(),this.side=null,this._left.dispose(),this._left=null,this._right.dispose(),this._right=null,this._merge.dispose(),this._merge=null,this},e.MidSideMerge}),Module(function(e){return e.MidSideCompressor=function(t){t=this.defaultArg(t,e.MidSideCompressor.defaults),this._midSideSplit=this.input=new e.MidSideSplit,this._midSideMerge=this.output=new e.MidSideMerge,this.mid=new e.Compressor(t.mid),this.side=new e.Compressor(t.side),this._midSideSplit.mid.chain(this.mid,this._midSideMerge.mid),this._midSideSplit.side.chain(this.side,this._midSideMerge.side),this._readOnly(["mid","side"])},e.extend(e.MidSideCompressor),e.MidSideCompressor.defaults={mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}},e.MidSideCompressor.prototype.dispose=function(){return e.prototype.dispose.call(this),this._writable(["mid","side"]),this.mid.dispose(),this.mid=null,this.side.dispose(),this.side=null,this._midSideSplit.dispose(),this._midSideSplit=null,this._midSideMerge.dispose(),this._midSideMerge=null,this},e.MidSideCompressor}),Module(function(e){return e.Mono=function(){e.call(this,1,0),this._merge=this.output=new e.Merge,this.input.connect(this._merge,0,0),this.input.connect(this._merge,0,1),this.input.gain.value=this.dbToGain(-10)},e.extend(e.Mono),e.Mono.prototype.dispose=function(){return e.prototype.dispose.call(this),this._merge.dispose(),this._merge=null,this},e.Mono}),Module(function(e){return e.MultibandCompressor=function(t){t=this.defaultArg(arguments,e.MultibandCompressor.defaults),this._splitter=this.input=new e.MultibandSplit({lowFrequency:t.lowFrequency,highFrequency:t.highFrequency}),this.lowFrequency=this._splitter.lowFrequency,this.highFrequency=this._splitter.highFrequency,this.output=this.context.createGain(),this.low=new e.Compressor(t.low),this.mid=new e.Compressor(t.mid),this.high=new e.Compressor(t.high),this._splitter.low.chain(this.low,this.output),this._splitter.mid.chain(this.mid,this.output),this._splitter.high.chain(this.high,this.output),this._readOnly(["high","mid","low","highFrequency","lowFrequency"])},e.extend(e.MultibandCompressor),e.MultibandCompressor.defaults={low:e.Compressor.defaults,mid:e.Compressor.defaults,high:e.Compressor.defaults,lowFrequency:250,highFrequency:2e3},e.MultibandCompressor.prototype.dispose=function(){return e.prototype.dispose.call(this),this._splitter.dispose(),this._writable(["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this._splitter=null,this.low=null,this.mid=null,this.high=null,this.lowFrequency=null,this.highFrequency=null,this},e.MultibandCompressor}),Module(function(e){return e.GainToAudio=function(){this._norm=this.input=this.output=new e.WaveShaper(function(e){return 2*Math.abs(e)-1})},e.extend(e.GainToAudio,e.SignalBase),e.GainToAudio.prototype.dispose=function(){return e.prototype.dispose.call(this),this._norm.dispose(),this._norm=null,this},e.GainToAudio}),Module(function(e){return e.Panner=function(t){e.call(this),this._hasStereoPanner=this.isFunction(this.context.createStereoPanner),this._hasStereoPanner?(this._panner=this.input=this.output=this.context.createStereoPanner(),this.pan=new e.Signal(0,e.Type.NormalRange),this._scalePan=new e.GainToAudio,this.pan.chain(this._scalePan,this._panner.pan)):(this._crossFade=new e.CrossFade,this._merger=this.output=new e.Merge,this._splitter=this.input=new e.Split,this.pan=this._crossFade.fade,this._splitter.connect(this._crossFade,0,0),this._splitter.connect(this._crossFade,1,1),this._crossFade.a.connect(this._merger,0,0),this._crossFade.b.connect(this._merger,0,1)),this.pan.value=this.defaultArg(t,.5),this._readOnly("pan")},e.extend(e.Panner),e.Panner.prototype.dispose=function(){return e.prototype.dispose.call(this),this._writable("pan"),this._hasStereoPanner?(this._panner.disconnect(),this._panner=null,this.pan.dispose(),this.pan=null,this._scalePan.dispose(),this._scalePan=null):(this._crossFade.dispose(),this._crossFade=null,this._splitter.dispose(),this._splitter=null,this._merger.dispose(),this._merger=null,this.pan=null),this},e.Panner}),Module(function(e){return e.Volume=function(t){this.output=this.input=this.context.createGain(),this.volume=new e.Signal(this.output.gain,e.Type.Decibels),this.volume.value=this.defaultArg(t,0),this._readOnly("volume")},e.extend(e.Volume),e.Volume.prototype.dispose=function(){return e.prototype.dispose.call(this),this._writable("volume"),this.volume.dispose(),this.volume=null,this},e.Volume}),Module(function(e){return e.PanVol=function(t,i){this._panner=this.input=new e.Panner(t),this.pan=this._panner.pan,this._volume=this.output=new e.Volume(i),this.volume=this._volume.volume,this._panner.connect(this._volume),this._readOnly(["pan","volume"])},e.extend(e.PanVol),e.PanVol.prototype.dispose=function(){return e.prototype.dispose.call(this),this._writable(["pan","volume"]),this._panner.dispose(),this._panner=null,this._volume.dispose(),this._volume=null,this.pan=null,this.volume=null,this},e.PanVol}),Module(function(e){return e.ScaledEnvelope=function(){var t=this.optionsObject(arguments,["attack","decay","sustain","release"],e.Envelope.defaults);e.Envelope.call(this,t),t=this.defaultArg(t,e.ScaledEnvelope.defaults),this._exp=this.output=new e.Pow(t.exponent),this._scale=this.output=new e.Scale(t.min,t.max),this._sig.chain(this._exp,this._scale)},e.extend(e.ScaledEnvelope,e.Envelope),e.ScaledEnvelope.defaults={min:0,max:1,exponent:1},Object.defineProperty(e.ScaledEnvelope.prototype,"min",{get:function(){return this._scale.min},set:function(e){this._scale.min=e}}),Object.defineProperty(e.ScaledEnvelope.prototype,"max",{get:function(){return this._scale.max},set:function(e){this._scale.max=e}}),Object.defineProperty(e.ScaledEnvelope.prototype,"exponent",{get:function(){return this._exp.value},set:function(e){this._exp.value=e}}),e.ScaledEnvelope.prototype.dispose=function(){return e.Envelope.prototype.dispose.call(this),this._scale.dispose(),this._scale=null,this._exp.dispose(),this._exp=null,this},e.ScaledEnvelope}),Module(function(e){return e.Buffer=function(){var t=this.optionsObject(arguments,["url","onload"],e.Buffer.defaults);this._buffer=null,this._reversed=t.reverse,this.url=void 0,this.loaded=!1,this.onload=t.onload.bind(this,this),t.url instanceof AudioBuffer?(this._buffer.set(t.url),this.onload(this)):"string"==typeof t.url&&(this.url=t.url,e.Buffer._addToQueue(t.url,this))},e.extend(e.Buffer),e.Buffer.defaults={url:void 0,onload:e.noOp,reverse:!1},e.Buffer.prototype.set=function(t){return t instanceof e.Buffer?this._buffer=t.get():this._buffer=t,this.loaded=!0,this},e.Buffer.prototype.get=function(){return this._buffer},e.Buffer.prototype.load=function(t,i){return this.url=t,this.onload=this.defaultArg(i,this.onload),e.Buffer._addToQueue(t,this),this},e.Buffer.prototype.dispose=function(){return e.prototype.dispose.call(this),e.Buffer._removeFromQueue(this),this._buffer=null,this.onload=e.Buffer.defaults.onload,this},Object.defineProperty(e.Buffer.prototype,"duration",{get:function(){return this._buffer?this._buffer.duration:0}}),e.Buffer.prototype._reverse=function(){if(this.loaded)for(var e=0;e<this._buffer.numberOfChannels;e++)Array.prototype.reverse.call(this._buffer.getChannelData(e));return this},Object.defineProperty(e.Buffer.prototype,"reverse",{get:function(){return this._reversed},set:function(e){this._reversed!==e&&(this._reversed=e,this._reverse())}}),e.Buffer._queue=[],e.Buffer._currentDownloads=[],e.Buffer._totalDownloads=0,e.Buffer.MAX_SIMULTANEOUS_DOWNLOADS=6,e.Buffer._addToQueue=function(t,i){e.Buffer._queue.push({url:t,Buffer:i,progress:0,xhr:null}),this._totalDownloads++,e.Buffer._next()},e.Buffer._removeFromQueue=function(t){var i;for(i=0;i<e.Buffer._queue.length;i++){var n=e.Buffer._queue[i];n.Buffer===t&&e.Buffer._queue.splice(i,1)}for(i=0;i<e.Buffer._currentDownloads.length;i++){var r=e.Buffer._currentDownloads[i];r.Buffer===t&&(e.Buffer._currentDownloads.splice(i,1),r.xhr.abort(),r.xhr.onprogress=null,r.xhr.onload=null,r.xhr.onerror=null)}},e.Buffer._next=function(){if(e.Buffer._queue.length>0){if(e.Buffer._currentDownloads.length<e.Buffer.MAX_SIMULTANEOUS_DOWNLOADS){var t=e.Buffer._queue.shift();e.Buffer._currentDownloads.push(t),t.xhr=e.Buffer.load(t.url,function(i){var n=e.Buffer._currentDownloads.indexOf(t);e.Buffer._currentDownloads.splice(n,1),t.Buffer.set(i),t.Buffer._reversed&&t.Buffer._reverse(),t.Buffer.onload(t.Buffer),e.Buffer._onprogress(),e.Buffer._next()}),t.xhr.onprogress=function(i){t.progress=i.loaded/i.total,e.Buffer._onprogress()},t.xhr.onerror=e.Buffer.onerror}}else 0===e.Buffer._currentDownloads.length&&(e.Buffer.onload(),e.Buffer._totalDownloads=0)},e.Buffer._onprogress=function(){var t=0,i=e.Buffer._currentDownloads.length,n=0;if(i>0){for(var r=0;i>r;r++){var o=e.Buffer._currentDownloads[r];t+=o.progress}n=t}var s=i-n,a=e.Buffer._totalDownloads-e.Buffer._queue.length-s;e.Buffer.onprogress(a/e.Buffer._totalDownloads)},e.Buffer.load=function(t,i){var n=new XMLHttpRequest;return n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(){e.context.decodeAudioData(n.response,function(e){if(!e)throw new Error("could not decode audio data:"+t);i(e)})},n.send(),n},e.Buffer.onload=e.noOp,e.Buffer.onprogress=e.noOp,e.Buffer.onerror=e.noOp,e.Buffer}),Module(function(e){var t={};return e.prototype.send=function(e,i){t.hasOwnProperty(e)||(t[e]=this.context.createGain());var n=this.context.createGain();return n.gain.value=this.dbToGain(this.defaultArg(i,1)),this.output.chain(n,t[e]),n},e.prototype.receive=function(e,i){return t.hasOwnProperty(e)||(t[e]=this.context.createGain()),this.isUndef(i)&&(i=this.input),t[e].connect(i),this},e}),Module(function(e){function t(e,t,n){if(i.hasOwnProperty(e))for(var r=i[e],o=0,s=r.length;s>o;o++){var a=r[o];Array.isArray(n)?a.apply(window,[t].concat(n)):a(t,n)}}e.Note=function(t,i,n){this.value=n,this._channel=t,this._timelineID=e.Transport.setTimeline(this._trigger.bind(this),i)},e.Note.prototype._trigger=function(e){t(this._channel,e,this.value)},e.Note.prototype.dispose=function(){return e.Tranport.clearTimeline(this._timelineID),this.value=null,this};var i={};e.Note.route=function(e,t){i.hasOwnProperty(e)?i[e].push(t):i[e]=[t]},e.Note.unroute=function(e,t){if(i.hasOwnProperty(e)){var n=i[e],r=n.indexOf(t);-1!==r&&i[e].splice(r,1)}},e.Note.parseScore=function(t){var i=[];for(var n in t){var r=t[n];if("tempo"===n)e.Transport.bpm.value=r;else if("timeSignature"===n)e.Transport.timeSignature=r[0]/(r[1]/4);else{if(!Array.isArray(r))throw new TypeError("score parts must be Arrays");for(var o=0;o<r.length;o++){var s,a=r[o];if(Array.isArray(a)){var h=a[0],l=a.slice(1);s=new e.Note(n,h,l)}else s=new e.Note(n,a);i.push(s)}}}return i};var n={c:0,"c#":1,db:1,d:2,"d#":3,eb:3,e:4,f:5,"f#":6,gb:6,g:7,"g#":8,ab:8,a:9,"a#":10,bb:10,b:11},r=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],o=261.6255653005986;return e.prototype.noteToFrequency=function(e){var t=e.split(/(\d+)/);if(3===t.length){var i=n[t[0].toLowerCase()],r=t[1],s=i+12*parseInt(r,10);return Math.pow(2,(s-48)/12)*o}return 0},e.prototype.isNote=function(){var e=new RegExp(/[a-g]{1}([b#]{1}|[b#]{0})[0-9]+$/i);return function(t){return"string"==typeof t&&(t=t.toLowerCase()),e.test(t)}}(),e.prototype._overwrittenToFrequency=e.prototype.toFrequency,e.prototype.toFrequency=function(e,t){return this.isNote(e)&&(e=this.noteToFrequency(e)),this._overwrittenToFrequency(e,t)},e.prototype.frequencyToNote=function(e){var t=Math.log(e/o)/Math.LN2,i=Math.round(12*t)+48,n=Math.floor(i/12),s=r[i%12];return s+n.toString()},e.prototype.intervalToFrequencyRatio=function(e){return Math.pow(2,e/12)},e.prototype.midiToNote=function(e){var t=Math.floor(e/12)-2,i=e%12;return r[i]+t},e.prototype.noteToMidi=function(e){var t=e.split(/(\d+)/);if(3===t.length){var i=n[t[0].toLowerCase()],r=t[1];return i+12*(parseInt(r,10)+2)}return 0},e.Note}),Module(function(e){return e.PulseOscillator=function(){var t=this.optionsObject(arguments,["frequency","width"],e.Oscillator.defaults);e.Source.call(this,t),this.width=new e.Signal(t.width,e.Type.NormalRange),this._widthGate=this.context.createGain(),this._sawtooth=new e.Oscillator({frequency:t.frequency,detune:t.detune,type:"sawtooth",phase:t.phase}),this.frequency=this._sawtooth.frequency,this.detune=this._sawtooth.detune,this._thresh=new e.WaveShaper(function(e){return 0>e?-1:1}),this._sawtooth.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),this._readOnly(["width","frequency","detune"])},e.extend(e.PulseOscillator,e.Oscillator),e.PulseOscillator.defaults={frequency:440,detune:0,phase:0,width:.2},e.PulseOscillator.prototype._start=function(e){e=this.toSeconds(e),this._sawtooth.start(e),this._widthGate.gain.setValueAtTime(1,e)},e.PulseOscillator.prototype._stop=function(e){e=this.toSeconds(e),this._sawtooth.stop(e),this._widthGate.gain.setValueAtTime(0,e)},Object.defineProperty(e.PulseOscillator.prototype,"phase",{get:function(){return this._sawtooth.phase},set:function(e){this._sawtooth.phase=e}}),Object.defineProperty(e.PulseOscillator.prototype,"type",{get:function(){return"pulse"}}),e.PulseOscillator.prototype.dispose=function(){return e.Source.prototype.dispose.call(this),this._sawtooth.dispose(),this._sawtooth=null,this._writable(["width","frequency","detune"]),this.width.dispose(),this.width=null,this._widthGate.disconnect(),this._widthGate=null,this._widthGate=null,this._thresh.disconnect(),this._thresh=null,this.frequency=null,this.detune=null,this},e.PulseOscillator}),Module(function(e){return e.PWMOscillator=function(){var t=this.optionsObject(arguments,["frequency","modulationFrequency"],e.PWMOscillator.defaults);e.Source.call(this,t),this._pulse=new e.PulseOscillator(t.modulationFrequency),this._pulse._sawtooth.type="sine",this._modulator=new e.Oscillator({frequency:t.frequency,detune:t.detune}),this._scale=new e.Multiply(1.01),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this.modulationFrequency=this._pulse.frequency,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),this._readOnly(["modulationFrequency","frequency","detune"])},e.extend(e.PWMOscillator,e.Oscillator),e.PWMOscillator.defaults={frequency:440,detune:0,modulationFrequency:.4},e.PWMOscillator.prototype._start=function(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)},e.PWMOscillator.prototype._stop=function(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)},Object.defineProperty(e.PWMOscillator.prototype,"type",{get:function(){return"pwm"}}),Object.defineProperty(e.PWMOscillator.prototype,"phase",{get:function(){return this._modulator.phase},set:function(e){this._modulator.phase=e}}),e.PWMOscillator.prototype.dispose=function(){return e.Source.prototype.dispose.call(this),this._pulse.dispose(),this._pulse=null,this._scale.dispose(),this._scale=null,this._modulator.dispose(),this._modulator=null,this._writable(["modulationFrequency","frequency","detune"]),this.frequency=null,this.detune=null,this.modulationFrequency=null,this},e.PWMOscillator}),Module(function(e){e.OmniOscillator=function(){var t=this.optionsObject(arguments,["frequency","type"],e.OmniOscillator.defaults);e.Source.call(this,t),this.frequency=new e.Signal(t.frequency,e.Type.Frequency),this.detune=new e.Signal(t.detune,e.Type.Cents),this._sourceType=void 0,this._oscillator=null,this.type=t.type,this._readOnly(["frequency","detune"])},e.extend(e.OmniOscillator,e.Oscillator),e.OmniOscillator.defaults={frequency:440,detune:0,type:"sine",width:.4,modulationFrequency:.4};var t={PulseOscillator:"PulseOscillator",PWMOscillator:"PWMOscillator",Oscillator:"Oscillator"};return e.OmniOscillator.prototype._start=function(e){this._oscillator.start(e)},e.OmniOscillator.prototype._stop=function(e){this._oscillator.stop(e)},Object.defineProperty(e.OmniOscillator.prototype,"type",{get:function(){return this._oscillator.type},set:function(i){if(0===i.indexOf("sine")||0===i.indexOf("square")||0===i.indexOf("triangle")||0===i.indexOf("sawtooth"))this._sourceType!==t.Oscillator&&(this._sourceType=t.Oscillator,this._createNewOscillator(e.Oscillator)),this._oscillator.type=i;else if("pwm"===i)this._sourceType!==t.PWMOscillator&&(this._sourceType=t.PWMOscillator,this._createNewOscillator(e.PWMOscillator));else{if("pulse"!==i)throw new TypeError("Tone.OmniOscillator does not support type "+i);this._sourceType!==t.PulseOscillator&&(this._sourceType=t.PulseOscillator,this._createNewOscillator(e.PulseOscillator))}}}),e.OmniOscillator.prototype._createNewOscillator=function(t){var i=this.now()+this.bufferTime;if(null!==this._oscillator){var n=this._oscillator;n.stop(i),n.onended=function(){n.dispose(),n=null}}this._oscillator=new t,this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this.state===e.State.Started&&this._oscillator.start(i)},Object.defineProperty(e.OmniOscillator.prototype,"phase",{get:function(){return this._oscillator.phase},set:function(e){this._oscillator.phase=e}}),Object.defineProperty(e.OmniOscillator.prototype,"width",{get:function(){return this._sourceType===t.PulseOscillator?this._oscillator.width:void 0}}),Object.defineProperty(e.OmniOscillator.prototype,"modulationFrequency",{get:function(){return this._sourceType===t.PWMOscillator?this._oscillator.modulationFrequency:void 0}}),e.OmniOscillator.prototype.dispose=function(){return e.Source.prototype.dispose.call(this),this._writable(["frequency","detune"]),this.detune.dispose(),this.detune=null,this.frequency.dispose(),this.frequency=null,this._oscillator.dispose(),this._oscillator=null,this._sourceType=null,this},e.OmniOscillator}),Module(function(e){return e.Instrument=function(t){t=this.defaultArg(t,e.Instrument.defaults),this.output=this.context.createGain(),this.volume=new e.Signal({param:this.output.gain,units:e.Type.Decibels,value:t.volume}),this._readOnly(["volume"])},e.extend(e.Instrument),e.Instrument.defaults={volume:0},e.Instrument.prototype.triggerAttack=e.noOp,e.Instrument.prototype.triggerRelease=e.noOp,e.Instrument.prototype.triggerAttackRelease=function(e,t,i,n){return i=this.toSeconds(i),t=this.toSeconds(t),this.triggerAttack(e,i,n),this.triggerRelease(i+t),this},e.Instrument.prototype.dispose=function(){return e.prototype.dispose.call(this),this._writable(["volume"]),this.volume.dispose(),this.volume=null,this},e.Instrument}),Module(function(e){return e.Monophonic=function(t){t=this.defaultArg(t,e.Monophonic.defaults),e.Instrument.call(this,t),this.portamento=t.portamento},e.extend(e.Monophonic,e.Instrument),e.Monophonic.defaults={portamento:0},e.Monophonic.prototype.triggerAttack=function(e,t,i){return t=this.toSeconds(t),this._triggerEnvelopeAttack(t,i),this.setNote(e,t),this},e.Monophonic.prototype.triggerRelease=function(e){return this._triggerEnvelopeRelease(e),this},e.Monophonic.prototype._triggerEnvelopeAttack=function(){},e.Monophonic.prototype._triggerEnvelopeRelease=function(){},e.Monophonic.prototype.setNote=function(e,t){if(t=this.toSeconds(t),this.portamento>0){var i=this.frequency.value;this.frequency.setValueAtTime(i,t);var n=this.toSeconds(this.portamento);this.frequency.exponentialRampToValueAtTime(e,t+n)}else this.frequency.setValueAtTime(e,t);return this},e.Monophonic}),Module(function(e){return e.MonoSynth=function(t){t=this.defaultArg(t,e.MonoSynth.defaults),e.Monophonic.call(this,t),this.oscillator=new e.OmniOscillator(t.oscillator),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.filter=new e.Filter(t.filter),this.filterEnvelope=new e.ScaledEnvelope(t.filterEnvelope),this.envelope=new e.AmplitudeEnvelope(t.envelope),this.oscillator.chain(this.filter,this.envelope,this.output),this.oscillator.start(),this.filterEnvelope.connect(this.filter.frequency),this._readOnly(["oscillator","frequency","detune","filter","filterEnvelope","envelope"])},e.extend(e.MonoSynth,e.Monophonic),e.MonoSynth.defaults={frequency:"C4",detune:0,oscillator:{type:"square"},filter:{Q:6,type:"lowpass",rolloff:-24},envelope:{attack:.005,decay:.1,sustain:.9,release:1},filterEnvelope:{attack:.06,decay:.2,sustain:.5,release:2,min:20,max:4e3,exponent:2}},e.MonoSynth.prototype._triggerEnvelopeAttack=function(e,t){return this.envelope.triggerAttack(e,t),this.filterEnvelope.triggerAttack(e),this},e.MonoSynth.prototype._triggerEnvelopeRelease=function(e){return this.envelope.triggerRelease(e),this.filterEnvelope.triggerRelease(e),this},e.MonoSynth.prototype.dispose=function(){return e.Monophonic.prototype.dispose.call(this),this._writable(["oscillator","frequency","detune","filter","filterEnvelope","envelope"]),this.oscillator.dispose(),this.oscillator=null,this.envelope.dispose(),this.envelope=null,this.filterEnvelope.dispose(),this.filterEnvelope=null,this.filter.dispose(),this.filter=null,this.frequency=null,this.detune=null,this},e.MonoSynth}),Module(function(e){return e.AMSynth=function(t){t=this.defaultArg(t,e.AMSynth.defaults),e.Monophonic.call(this,t),this.carrier=new e.MonoSynth(t.carrier),this.carrier.volume.value=-10,this.modulator=new e.MonoSynth(t.modulator),this.modulator.volume.value=-10,this.frequency=new e.Signal(440,e.Type.Frequency),this.harmonicity=new e.Multiply(t.harmonicity),this.harmonicity.units=e.Type.Positive,this._modulationScale=new e.AudioToGain,this._modulationNode=this.context.createGain(),this.frequency.connect(this.carrier.frequency),this.frequency.chain(this.harmonicity,this.modulator.frequency),this.modulator.chain(this._modulationScale,this._modulationNode.gain),this.carrier.chain(this._modulationNode,this.output),this._readOnly(["carrier","modulator","frequency","harmonicity"])},e.extend(e.AMSynth,e.Monophonic),e.AMSynth.defaults={harmonicity:3,carrier:{volume:-10,oscillator:{type:"sine"},envelope:{attack:.01,decay:.01,sustain:1,release:.5},filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5,min:2e4,max:2e4},filter:{Q:6,type:"lowpass",rolloff:-24}},modulator:{volume:-10,oscillator:{type:"square"},envelope:{attack:2,decay:0,sustain:1,release:.5},filterEnvelope:{attack:4,decay:.2,sustain:.5,release:.5,min:20,max:1500},filter:{Q:6,type:"lowpass",rolloff:-24}}},e.AMSynth.prototype._triggerEnvelopeAttack=function(e,t){return e=this.toSeconds(e),this.carrier.envelope.triggerAttack(e,t),this.modulator.envelope.triggerAttack(e),this.carrier.filterEnvelope.triggerAttack(e),this.modulator.filterEnvelope.triggerAttack(e),this},e.AMSynth.prototype._triggerEnvelopeRelease=function(e){return this.carrier.triggerRelease(e),this.modulator.triggerRelease(e),this},e.AMSynth.prototype.dispose=function(){return e.Monophonic.prototype.dispose.call(this),this._writable(["carrier","modulator","frequency","harmonicity"]),this.carrier.dispose(),this.carrier=null,this.modulator.dispose(),this.modulator=null,this.frequency.dispose(),this.frequency=null,this.harmonicity.dispose(),this.harmonicity=null,this._modulationScale.dispose(),this._modulationScale=null,this._modulationNode.disconnect(),this._modulationNode=null,this},e.AMSynth}),Module(function(e){return e.DrumSynth=function(t){t=this.defaultArg(t,e.DrumSynth.defaults),e.Instrument.call(this,t),this.oscillator=new e.Oscillator(t.oscillator).start(),this.envelope=new e.AmplitudeEnvelope(t.envelope),this.octaves=t.octaves,this.pitchDecay=t.pitchDecay,this.oscillator.chain(this.envelope,this.output),this._readOnly(["oscillator","envelope"])},e.extend(e.DrumSynth,e.Instrument),e.DrumSynth.defaults={pitchDecay:.05,octaves:10,oscillator:{type:"sine"},envelope:{attack:.001,decay:.4,sustain:.01,release:1.4,attackCurve:"exponential"}},e.DrumSynth.prototype.triggerAttack=function(e,t,i){t=this.toSeconds(t),e=this.toFrequency(e);var n=e*this.octaves;return this.oscillator.frequency.setValueAtTime(n,t),this.oscillator.frequency.exponentialRampToValueAtTime(e,t+this.toSeconds(this.pitchDecay)),this.envelope.triggerAttack(t,i),this},e.DrumSynth.prototype.triggerRelease=function(e){return this.envelope.triggerRelease(e),this},e.DrumSynth.prototype.dispose=function(){return e.Instrument.prototype.dispose.call(this),this._writable(["oscillator","envelope"]),
this.oscillator.dispose(),this.oscillator=null,this.envelope.dispose(),this.envelope=null,this},e.DrumSynth}),Module(function(e){return e.DuoSynth=function(t){t=this.defaultArg(t,e.DuoSynth.defaults),e.Monophonic.call(this,t),this.voice0=new e.MonoSynth(t.voice0),this.voice0.volume.value=-10,this.voice1=new e.MonoSynth(t.voice1),this.voice1.volume.value=-10,this._vibrato=new e.LFO(t.vibratoRate,-50,50),this._vibrato.start(),this.vibratoRate=this._vibrato.frequency,this._vibratoGain=this.context.createGain(),this.vibratoAmount=new e.Signal(this._vibratoGain.gain,e.Type.Gain),this.vibratoAmount.value=t.vibratoAmount,this._vibratoDelay=this.toSeconds(t.vibratoDelay),this.frequency=new e.Signal(440,e.Type.Frequency),this.harmonicity=new e.Multiply(t.harmonicity),this.harmonicity.units=e.Type.Positive,this.frequency.connect(this.voice0.frequency),this.frequency.chain(this.harmonicity,this.voice1.frequency),this._vibrato.connect(this._vibratoGain),this._vibratoGain.fan(this.voice0.detune,this.voice1.detune),this.voice0.connect(this.output),this.voice1.connect(this.output),this._readOnly(["voice0","voice1","frequency","vibratoAmount","vibratoRate"])},e.extend(e.DuoSynth,e.Monophonic),e.DuoSynth.defaults={vibratoAmount:.5,vibratoRate:5,vibratoDelay:1,harmonicity:1.5,voice0:{volume:-10,portamento:0,oscillator:{type:"sine"},filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}},voice1:{volume:-10,portamento:0,oscillator:{type:"sine"},filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}},e.DuoSynth.prototype._triggerEnvelopeAttack=function(e,t){return e=this.toSeconds(e),this.voice0.envelope.triggerAttack(e,t),this.voice1.envelope.triggerAttack(e,t),this.voice0.filterEnvelope.triggerAttack(e),this.voice1.filterEnvelope.triggerAttack(e),this},e.DuoSynth.prototype._triggerEnvelopeRelease=function(e){return this.voice0.triggerRelease(e),this.voice1.triggerRelease(e),this},e.DuoSynth.prototype.dispose=function(){return e.Monophonic.prototype.dispose.call(this),this._writable(["voice0","voice1","frequency","vibratoAmount","vibratoRate"]),this.voice0.dispose(),this.voice0=null,this.voice1.dispose(),this.voice1=null,this.frequency.dispose(),this.frequency=null,this._vibrato.dispose(),this._vibrato=null,this._vibratoGain.disconnect(),this._vibratoGain=null,this.harmonicity.dispose(),this.harmonicity=null,this.vibratoAmount.dispose(),this.vibratoAmount=null,this.vibratoRate=null,this},e.DuoSynth}),Module(function(e){return e.FMSynth=function(t){t=this.defaultArg(t,e.FMSynth.defaults),e.Monophonic.call(this,t),this.carrier=new e.MonoSynth(t.carrier),this.carrier.volume.value=-10,this.modulator=new e.MonoSynth(t.modulator),this.modulator.volume.value=-10,this.frequency=new e.Signal(440,e.Type.Frequency),this.harmonicity=new e.Multiply(t.harmonicity),this.harmonicity.units=e.Type.Positive,this.modulationIndex=new e.Multiply(t.modulationIndex),this.modulationIndex.units=e.Type.Positive,this._modulationNode=this.context.createGain(),this.frequency.connect(this.carrier.frequency),this.frequency.chain(this.harmonicity,this.modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.modulator.connect(this._modulationNode.gain),this._modulationNode.gain.value=0,this._modulationNode.connect(this.carrier.frequency),this.carrier.connect(this.output),this._readOnly(["carrier","modulator","frequency","harmonicity","modulationIndex"])},e.extend(e.FMSynth,e.Monophonic),e.FMSynth.defaults={harmonicity:3,modulationIndex:10,carrier:{volume:-10,portamento:0,oscillator:{type:"sine"},envelope:{attack:.01,decay:0,sustain:1,release:.5},filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5,min:2e4,max:2e4}},modulator:{volume:-10,portamento:0,oscillator:{type:"triangle"},envelope:{attack:.01,decay:0,sustain:1,release:.5},filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5,min:2e4,max:2e4}}},e.FMSynth.prototype._triggerEnvelopeAttack=function(e,t){return e=this.toSeconds(e),this.carrier.envelope.triggerAttack(e,t),this.modulator.envelope.triggerAttack(e),this.carrier.filterEnvelope.triggerAttack(e),this.modulator.filterEnvelope.triggerAttack(e),this},e.FMSynth.prototype._triggerEnvelopeRelease=function(e){return this.carrier.triggerRelease(e),this.modulator.triggerRelease(e),this},e.FMSynth.prototype.dispose=function(){return e.Monophonic.prototype.dispose.call(this),this._writable(["carrier","modulator","frequency","harmonicity","modulationIndex"]),this.carrier.dispose(),this.carrier=null,this.modulator.dispose(),this.modulator=null,this.frequency.dispose(),this.frequency=null,this.modulationIndex.dispose(),this.modulationIndex=null,this.harmonicity.dispose(),this.harmonicity=null,this._modulationNode.disconnect(),this._modulationNode=null,this},e.FMSynth}),Module(function(e){e.Noise=function(){var t=this.optionsObject(arguments,["type"],e.Noise.defaults);e.Source.call(this,t),this._source=null,this._buffer=null,this.type=t.type},e.extend(e.Noise,e.Source),e.Noise.defaults={type:"white"},Object.defineProperty(e.Noise.prototype,"type",{get:function(){return this._buffer===n?"white":this._buffer===i?"brown":this._buffer===t?"pink":void 0},set:function(r){if(this.type!==r){switch(r){case"white":this._buffer=n;break;case"pink":this._buffer=t;break;case"brown":this._buffer=i;break;default:this._buffer=n}if(this.state===e.State.Started){var o=this.now()+this.bufferTime;this._source.onended=void 0,this._stop(o),this._start(o)}}}}),e.Noise.prototype._start=function(e){this._source=this.context.createBufferSource(),this._source.buffer=this._buffer,this._source.loop=!0,this.connectSeries(this._source,this.output),this._source.start(this.toSeconds(e)),this._source.onended=this.onended},e.Noise.prototype._stop=function(e){this._source&&this._source.stop(this.toSeconds(e))},e.Noise.prototype.dispose=function(){return e.Source.prototype.dispose.call(this),null!==this._source&&(this._source.disconnect(),this._source=null),this._buffer=null,this};var t=null,i=null,n=null;return e._initAudioContext(function(e){var r=e.sampleRate,o=4*r;t=function(){for(var t=e.createBuffer(2,o,r),i=0;i<t.numberOfChannels;i++){var n,s,a,h,l,c,u,p=t.getChannelData(i);n=s=a=h=l=c=u=0;for(var d=0;o>d;d++){var f=2*Math.random()-1;n=.99886*n+.0555179*f,s=.99332*s+.0750759*f,a=.969*a+.153852*f,h=.8665*h+.3104856*f,l=.55*l+.5329522*f,c=-.7616*c-.016898*f,p[d]=n+s+a+h+l+c+u+.5362*f,p[d]*=.11,u=.115926*f}}return t}(),i=function(){for(var t=e.createBuffer(2,o,r),i=0;i<t.numberOfChannels;i++)for(var n=t.getChannelData(i),s=0,a=0;o>a;a++){var h=2*Math.random()-1;n[a]=(s+.02*h)/1.02,s=n[a],n[a]*=3.5}return t}(),n=function(){for(var t=e.createBuffer(2,o,r),i=0;i<t.numberOfChannels;i++)for(var n=t.getChannelData(i),s=0;o>s;s++)n[s]=2*Math.random()-1;return t}()}),e.Noise}),Module(function(e){return e.NoiseSynth=function(t){t=this.defaultArg(t,e.NoiseSynth.defaults),e.Instrument.call(this,t),this.noise=new e.Noise,this.filter=new e.Filter(t.filter),this.filterEnvelope=new e.ScaledEnvelope(t.filterEnvelope),this.envelope=new e.AmplitudeEnvelope(t.envelope),this.noise.chain(this.filter,this.envelope,this.output),this.noise.start(),this.filterEnvelope.connect(this.filter.frequency),this._readOnly(["noise","filter","filterEnvelope","envelope"])},e.extend(e.NoiseSynth,e.Instrument),e.NoiseSynth.defaults={noise:{type:"white"},filter:{Q:6,type:"highpass",rolloff:-24},envelope:{attack:.005,decay:.1,sustain:0},filterEnvelope:{attack:.06,decay:.2,sustain:0,release:2,min:20,max:4e3,exponent:2}},e.NoiseSynth.prototype.triggerAttack=function(e,t){return this.envelope.triggerAttack(e,t),this.filterEnvelope.triggerAttack(e),this},e.NoiseSynth.prototype.triggerRelease=function(e){return this.envelope.triggerRelease(e),this.filterEnvelope.triggerRelease(e),this},e.NoiseSynth.prototype.triggerAttackRelease=function(e,t,i){return t=this.toSeconds(t),e=this.toSeconds(e),this.triggerAttack(t,i),this.triggerRelease(t+e),this},e.NoiseSynth.prototype.dispose=function(){return e.Instrument.prototype.dispose.call(this),this._writable(["noise","filter","filterEnvelope","envelope"]),this.noise.dispose(),this.noise=null,this.envelope.dispose(),this.envelope=null,this.filterEnvelope.dispose(),this.filterEnvelope=null,this.filter.dispose(),this.filter=null,this},e.NoiseSynth}),Module(function(e){return e.PluckSynth=function(t){t=this.defaultArg(t,e.PluckSynth.defaults),e.Instrument.call(this,t),this._noise=new e.Noise("pink"),this.attackNoise=1,this._lfcf=new e.LowpassCombFilter({resonance:t.resonance,dampening:t.dampening}),this.resonance=this._lfcf.resonance,this.dampening=this._lfcf.dampening,this._noise.connect(this._lfcf),this._lfcf.connect(this.output),this._readOnly(["resonance","dampening"])},e.extend(e.PluckSynth,e.Instrument),e.PluckSynth.defaults={attackNoise:1,dampening:4e3,resonance:.9},e.PluckSynth.prototype.triggerAttack=function(e,t){e=this.toFrequency(e),t=this.toSeconds(t);var i=1/e;return this._lfcf.delayTime.setValueAtTime(i,t),this._noise.start(t),this._noise.stop(t+i*this.attackNoise),this},e.PluckSynth.prototype.dispose=function(){return e.Instrument.prototype.dispose.call(this),this._noise.dispose(),this._lfcf.dispose(),this._noise=null,this._lfcf=null,this._writable(["resonance","dampening"]),this.dampening=null,this.resonance=null,this},e.PluckSynth}),Module(function(e){return e.PolySynth=function(){e.Instrument.call(this);var t=this.optionsObject(arguments,["polyphony","voice"],e.PolySynth.defaults);this.voices=new Array(t.polyphony),this._freeVoices=[],this._activeVoices={};for(var i=0;i<t.polyphony;i++){var n=new t.voice(arguments[2],arguments[3]);this.voices[i]=n,n.connect(this.output)}this._freeVoices=this.voices.slice(0)},e.extend(e.PolySynth,e.Instrument),e.PolySynth.defaults={polyphony:4,voice:e.MonoSynth},e.PolySynth.prototype.triggerAttack=function(e,t,i){Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++){var r=e[n],o=JSON.stringify(r);if(this._activeVoices[o])this._activeVoices[o].triggerAttack(r,t,i);else if(this._freeVoices.length>0){var s=this._freeVoices.shift();s.triggerAttack(r,t,i),this._activeVoices[o]=s}}return this},e.PolySynth.prototype.triggerAttackRelease=function(e,t,i,n){return i=this.toSeconds(i),this.triggerAttack(e,i,n),this.triggerRelease(e,i+this.toSeconds(t)),this},e.PolySynth.prototype.triggerRelease=function(e,t){Array.isArray(e)||(e=[e]);for(var i=0;i<e.length;i++){var n=JSON.stringify(e[i]),r=this._activeVoices[n];r&&(r.triggerRelease(t),this._freeVoices.push(r),delete this._activeVoices[n],r=null)}return this},e.PolySynth.prototype.set=function(e,t,i){for(var n=0;n<this.voices.length;n++)this.voices[n].set(e,t,i);return this},e.PolySynth.prototype.get=function(e){return this.voices[0].get(e)},e.PolySynth.prototype.setPreset=function(e){for(var t=0;t<this.voices.length;t++)this.voices[t].setPreset(e);return this},e.PolySynth.prototype.dispose=function(){e.Instrument.prototype.dispose.call(this);for(var t=0;t<this.voices.length;t++)this.voices[t].dispose(),this.voices[t]=null;return this.voices=null,this._activeVoices=null,this._freeVoices=null,this},e.PolySynth}),Module(function(e){return e.Player=function(){var t=this.optionsObject(arguments,["url","onload"],e.Player.defaults);e.Source.call(this,t),this._source=null,this.autostart=t.autostart,this._buffer=new e.Buffer({url:t.url,onload:this._onload.bind(this,t.onload),reverse:t.reverse}),this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.retrigger=t.retrigger},e.extend(e.Player,e.Source),e.Player.defaults={onload:e.noOp,playbackRate:1,loop:!1,autostart:!1,loopStart:0,loopEnd:0,retrigger:!1,reverse:!1},e.Player.prototype.load=function(e,t){return this._buffer.load(e,this._onload.bind(this,t)),this},e.Player.prototype._onload=function(e){e(this),this.autostart&&this.start()},e.Player.prototype._start=function(e,t,i){if(!this._buffer.loaded)throw Error("tried to start Player before the buffer was loaded");return t=this._loop?this.defaultArg(t,this._loopStart):this.defaultArg(t,0),t=this.toSeconds(t),i=this.defaultArg(i,this._buffer.duration-t),e=this.toSeconds(e),i=this.toSeconds(i),this._source=this.context.createBufferSource(),this._source.buffer=this._buffer.get(),this._loop?(this._source.loop=this._loop,this._source.loopStart=this.toSeconds(this._loopStart),this._source.loopEnd=this.toSeconds(this._loopEnd),i=65536):this._nextStop=e+i,this._source.playbackRate.value=this._playbackRate,this._source.onended=this.onended,this._source.connect(this.output),this._source.start(e,t,i),this},e.Player.prototype._stop=function(e){return this._source&&(this._source.stop(this.toSeconds(e)),this._source=null),this},e.Player.prototype.setLoopPoints=function(e,t){return this.loopStart=e,this.loopEnd=t,this},Object.defineProperty(e.Player.prototype,"loopStart",{get:function(){return this._loopStart},set:function(e){this._loopStart=e,this._source&&(this._source.loopStart=this.toSeconds(e))}}),Object.defineProperty(e.Player.prototype,"loopEnd",{get:function(){return this._loopEnd},set:function(e){this._loopEnd=e,this._source&&(this._source.loopEnd=this.toSeconds(e))}}),Object.defineProperty(e.Player.prototype,"buffer",{get:function(){return this._buffer},set:function(e){this._buffer.set(e)}}),Object.defineProperty(e.Player.prototype,"loop",{get:function(){return this._loop},set:function(e){this._loop=e,this._source&&(this._source.loop=e)}}),Object.defineProperty(e.Player.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(e){this._playbackRate=e,this._source&&(this._source.playbackRate.value=e)}}),Object.defineProperty(e.Player.prototype,"reverse",{get:function(){return this._buffer.reverse},set:function(e){this._buffer.reverse=e}}),e.Player.prototype.dispose=function(){return e.Source.prototype.dispose.call(this),null!==this._source&&(this._source.disconnect(),this._source=null),this._buffer.dispose(),this._buffer=null,this},e.Player}),Module(function(e){return e.Sampler=function(t,i){i=this.defaultArg(i,e.Sampler.defaults),e.Instrument.call(this,i),this.player=new e.Player(i.player),this.player.retrigger=!0,this._buffers={},this.envelope=new e.AmplitudeEnvelope(i.envelope),this.filterEnvelope=new e.ScaledEnvelope(i.filterEnvelope),this._sample=i.sample,this._pitch=i.pitch,this.filter=new e.Filter(i.filter),this._loadBuffers(t),this.pitch=i.pitch,this.player.chain(this.filter,this.envelope,this.output),this.filterEnvelope.connect(this.filter.frequency),this._readOnly(["player","filterEnvelope","envelope","filter"])},e.extend(e.Sampler,e.Instrument),e.Sampler.defaults={sample:0,pitch:0,player:{loop:!1},envelope:{attack:.001,decay:0,sustain:1,release:.1},filterEnvelope:{attack:.001,decay:.001,sustain:1,release:.5,min:20,max:2e4,exponent:2},filter:{type:"lowpass"}},e.Sampler.prototype._loadBuffers=function(t){if("string"==typeof t)this._buffers[0]=new e.Buffer(t,function(){this.sample="0"}.bind(this));else{t=this._flattenUrls(t);for(var i in t){this._sample=i;var n=t[i];this._buffers[i]=new e.Buffer(n)}}},e.Sampler.prototype._flattenUrls=function(e){var t={};for(var i in e)if(e.hasOwnProperty(i))if("object"==typeof e[i]){var n=this._flattenUrls(e[i]);for(var r in n)n.hasOwnProperty(r)&&(t[i+"."+r]=n[r])}else t[i]=e[i];return t},e.Sampler.prototype.triggerAttack=function(e,t,i){return t=this.toSeconds(t),e&&(this.sample=e),this.player.start(t),this.envelope.triggerAttack(t,i),this.filterEnvelope.triggerAttack(t),this},e.Sampler.prototype.triggerRelease=function(e){return e=this.toSeconds(e),this.filterEnvelope.triggerRelease(e),this.envelope.triggerRelease(e),this.player.stop(this.toSeconds(this.envelope.release)+e),this},Object.defineProperty(e.Sampler.prototype,"sample",{get:function(){return this._sample},set:function(e){if(!this._buffers.hasOwnProperty(e))throw new Error("Sampler does not have a sample named "+e);this._sample=e,this.player.buffer=this._buffers[e]}}),Object.defineProperty(e.Sampler.prototype,"reverse",{get:function(){for(var e in this._buffers)return this._buffers[e].reverse},set:function(e){for(var t in this._buffers)this._buffers[t].reverse=e}}),Object.defineProperty(e.Sampler.prototype,"pitch",{get:function(){return this._pitch},set:function(e){this._pitch=e,this.player.playbackRate=this.intervalToFrequencyRatio(e)}}),e.Sampler.prototype.dispose=function(){e.Instrument.prototype.dispose.call(this),this._writable(["player","filterEnvelope","envelope","filter"]),this.player.dispose(),this.filterEnvelope.dispose(),this.envelope.dispose(),this.filter.dispose(),this.player=null,this.filterEnvelope=null,this.envelope=null,this.filter=null;for(var t in this._buffers)this._buffers[t].dispose(),this._buffers[t]=null;return this._buffers=null,this},e.Sampler}),Module(function(e){return e.SimpleSynth=function(t){t=this.defaultArg(t,e.SimpleSynth.defaults),e.Monophonic.call(this,t),this.oscillator=new e.OmniOscillator(t.oscillator),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new e.AmplitudeEnvelope(t.envelope),this.oscillator.chain(this.envelope,this.output),this.oscillator.start(),this._readOnly(["oscillator","frequency","detune","envelope"])},e.extend(e.SimpleSynth,e.Monophonic),e.SimpleSynth.defaults={oscillator:{type:"triangle"},envelope:{attack:.005,decay:.1,sustain:.3,release:1}},e.SimpleSynth.prototype._triggerEnvelopeAttack=function(e,t){return this.envelope.triggerAttack(e,t),this},e.SimpleSynth.prototype._triggerEnvelopeRelease=function(e){return this.envelope.triggerRelease(e),this},e.SimpleSynth.prototype.dispose=function(){return e.Monophonic.prototype.dispose.call(this),this._writable(["oscillator","frequency","detune","envelope"]),this.oscillator.dispose(),this.oscillator=null,this.envelope.dispose(),this.envelope=null,this.frequency=null,this.detune=null,this},e.SimpleSynth}),Module(function(e){return e.SimpleAM=function(t){t=this.defaultArg(t,e.SimpleAM.defaults),e.Monophonic.call(this,t),this.carrier=new e.SimpleSynth(t.carrier),this.modulator=new e.SimpleSynth(t.modulator),this.frequency=new e.Signal(440,e.Type.Frequency),this.harmonicity=new e.Multiply(t.harmonicity),this.harmonicity.units=e.Type.Positive,this._modulationScale=new e.AudioToGain,this._modulationNode=this.context.createGain(),this.frequency.connect(this.carrier.frequency),this.frequency.chain(this.harmonicity,this.modulator.frequency),this.modulator.chain(this._modulationScale,this._modulationNode.gain),this.carrier.chain(this._modulationNode,this.output),this._readOnly(["carrier","modulator","frequency","harmonicity"])},e.extend(e.SimpleAM,e.Monophonic),e.SimpleAM.defaults={harmonicity:3,carrier:{volume:-10,portamento:0,oscillator:{type:"sine"},envelope:{attack:.01,decay:.01,sustain:1,release:.5}},modulator:{volume:-10,portamento:0,oscillator:{type:"sine"},envelope:{attack:.5,decay:.1,sustain:1,release:.5}}},e.SimpleAM.prototype._triggerEnvelopeAttack=function(e,t){return e=this.toSeconds(e),this.carrier.envelope.triggerAttack(e,t),this.modulator.envelope.triggerAttack(e),this},e.SimpleAM.prototype._triggerEnvelopeRelease=function(e){return this.carrier.triggerRelease(e),this.modulator.triggerRelease(e),this},e.SimpleAM.prototype.dispose=function(){return e.Monophonic.prototype.dispose.call(this),this._writable(["carrier","modulator","frequency","harmonicity"]),this.carrier.dispose(),this.carrier=null,this.modulator.dispose(),this.modulator=null,this.frequency.dispose(),this.frequency=null,this.harmonicity.dispose(),this.harmonicity=null,this._modulationScale.dispose(),this._modulationScale=null,this._modulationNode.disconnect(),this._modulationNode=null,this},e.SimpleAM}),Module(function(e){return e.SimpleFM=function(t){t=this.defaultArg(t,e.SimpleFM.defaults),e.Monophonic.call(this,t),this.carrier=new e.SimpleSynth(t.carrier),this.carrier.volume.value=-10,this.modulator=new e.SimpleSynth(t.modulator),this.modulator.volume.value=-10,this.frequency=new e.Signal(440,e.Type.Frequency),this.harmonicity=new e.Multiply(t.harmonicity),this.harmonicity.units=e.Type.Positive,this.modulationIndex=new e.Multiply(t.modulationIndex),this.modulationIndex.units=e.Type.Positive,this._modulationNode=this.context.createGain(),this.frequency.connect(this.carrier.frequency),this.frequency.chain(this.harmonicity,this.modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.modulator.connect(this._modulationNode.gain),this._modulationNode.gain.value=0,this._modulationNode.connect(this.carrier.frequency),this.carrier.connect(this.output),this._readOnly(["carrier","modulator","frequency","harmonicity","modulationIndex"])},e.extend(e.SimpleFM,e.Monophonic),e.SimpleFM.defaults={harmonicity:3,modulationIndex:10,carrier:{volume:-10,portamento:0,oscillator:{type:"sine"},envelope:{attack:.01,decay:0,sustain:1,release:.5}},modulator:{volume:-10,portamento:0,oscillator:{type:"triangle"},envelope:{attack:.01,decay:0,sustain:1,release:.5}}},e.SimpleFM.prototype._triggerEnvelopeAttack=function(e,t){return e=this.toSeconds(e),this.carrier.envelope.triggerAttack(e,t),this.modulator.envelope.triggerAttack(e),this},e.SimpleFM.prototype._triggerEnvelopeRelease=function(e){return this.carrier.triggerRelease(e),this.modulator.triggerRelease(e),this},e.SimpleFM.prototype.dispose=function(){return e.Monophonic.prototype.dispose.call(this),this._writable(["carrier","modulator","frequency","harmonicity","modulationIndex"]),this.carrier.dispose(),this.carrier=null,this.modulator.dispose(),this.modulator=null,this.frequency.dispose(),this.frequency=null,this.modulationIndex.dispose(),this.modulationIndex=null,this.harmonicity.dispose(),this.harmonicity=null,this._modulationNode.disconnect(),this._modulationNode=null,this},e.SimpleFM}),Module(function(e){return e.Effect=function(){e.call(this);var t=this.optionsObject(arguments,["wet"],e.Effect.defaults);this._dryWet=new e.CrossFade(t.wet),this.wet=this._dryWet.fade,this.effectSend=this.context.createGain(),this.effectReturn=this.context.createGain(),this.input.connect(this._dryWet.a),this.input.connect(this.effectSend),this.effectReturn.connect(this._dryWet.b),this._dryWet.connect(this.output),this._readOnly(["wet"])},e.extend(e.Effect),e.Effect.defaults={wet:1},e.Effect.prototype.connectEffect=function(e){return this.effectSend.chain(e,this.effectReturn),this},e.Effect.prototype.dispose=function(){return e.prototype.dispose.call(this),this._dryWet.dispose(),this._dryWet=null,this.effectSend.disconnect(),this.effectSend=null,this.effectReturn.disconnect(),this.effectReturn=null,this._writable(["wet"]),this.wet=null,this},e.Effect}),Module(function(e){return e.AutoFilter=function(){var t=this.optionsObject(arguments,["frequency","min","max"],e.AutoFilter.defaults);e.Effect.call(this,t),this._lfo=new e.LFO({frequency:t.frequency,amplitude:t.depth,min:t.min,max:t.max}),this.depth=this._lfo.amplitude,this.frequency=this._lfo.frequency,this.filter=new e.Filter(t.filter),this.connectEffect(this.filter),this._lfo.connect(this.filter.frequency),this.type=t.type,this._readOnly(["frequency","depth"])},e.extend(e.AutoFilter,e.Effect),e.AutoFilter.defaults={frequency:1,type:"sine",depth:1,min:200,max:1200,filter:{type:"lowpass",rolloff:-12,Q:1}},e.AutoFilter.prototype.start=function(e){return this._lfo.start(e),this},e.AutoFilter.prototype.stop=function(e){return this._lfo.stop(e),this},e.AutoFilter.prototype.sync=function(e){return this._lfo.sync(e),this},e.AutoFilter.prototype.unsync=function(){return this._lfo.unsync(),this},Object.defineProperty(e.AutoFilter.prototype,"type",{get:function(){return this._lfo.type},set:function(e){this._lfo.type=e}}),Object.defineProperty(e.AutoFilter.prototype,"min",{get:function(){return this._lfo.min},set:function(e){this._lfo.min=e}}),Object.defineProperty(e.AutoFilter.prototype,"max",{get:function(){return this._lfo.max},set:function(e){this._lfo.max=e}}),e.AutoFilter.prototype.dispose=function(){return e.Effect.prototype.dispose.call(this),this._lfo.dispose(),this._lfo=null,this.filter.dispose(),this.filter=null,this._writable(["frequency","depth"]),this.frequency=null,this.depth=null,this},e.AutoFilter}),Module(function(e){return e.AutoPanner=function(){var t=this.optionsObject(arguments,["frequency"],e.AutoPanner.defaults);e.Effect.call(this,t),this._lfo=new e.LFO({frequency:t.frequency,amplitude:t.depth,min:0,max:1,phase:90}),this.depth=this._lfo.amplitude,this._panner=new e.Panner,this.frequency=this._lfo.frequency,this.connectEffect(this._panner),this._lfo.connect(this._panner.pan),this.type=t.type,this._readOnly(["depth","frequency"])},e.extend(e.AutoPanner,e.Effect),e.AutoPanner.defaults={frequency:1,type:"sine",depth:1},e.AutoPanner.prototype.start=function(e){return this._lfo.start(e),this},e.AutoPanner.prototype.stop=function(e){return this._lfo.stop(e),this},e.AutoPanner.prototype.sync=function(e){return this._lfo.sync(e),this},e.AutoPanner.prototype.unsync=function(){return this._lfo.unsync(),this},Object.defineProperty(e.AutoPanner.prototype,"type",{get:function(){return this._lfo.type},set:function(e){this._lfo.type=e}}),e.AutoPanner.prototype.dispose=function(){return e.Effect.prototype.dispose.call(this),this._lfo.dispose(),this._lfo=null,this._panner.dispose(),this._panner=null,this._writable(["depth","frequency"]),this.frequency=null,this.depth=null,this},e.AutoPanner}),Module(function(e){return e.AutoWah=function(){var t=this.optionsObject(arguments,["baseFrequency","octaves","sensitivity"],e.AutoWah.defaults);e.Effect.call(this,t),this.follower=new e.Follower(t.follower),this._sweepRange=new e.ScaleExp(0,1,.5),this._baseFrequency=t.baseFrequency,this._octaves=t.octaves,this._inputBoost=this.context.createGain(),this._bandpass=new e.Filter({rolloff:-48,frequency:0,Q:t.Q}),this._peaking=new e.Filter(0,"peaking"),this._peaking.gain.value=t.gain,this.gain=this._peaking.gain,this.Q=this._bandpass.Q,this.effectSend.chain(this._inputBoost,this.follower,this._sweepRange),this._sweepRange.connect(this._bandpass.frequency),this._sweepRange.connect(this._peaking.frequency),this.effectSend.chain(this._bandpass,this._peaking,this.effectReturn),this._setSweepRange(),this.sensitivity=t.sensitivity,this._readOnly(["gain","Q"])},e.extend(e.AutoWah,e.Effect),e.AutoWah.defaults={baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:{attack:.3,release:.5}},Object.defineProperty(e.AutoWah.prototype,"octaves",{get:function(){return this._octaves},set:function(e){this._octaves=e,this._setSweepRange()}}),Object.defineProperty(e.AutoWah.prototype,"baseFrequency",{get:function(){return this._baseFrequency},set:function(e){this._baseFrequency=e,this._setSweepRange()}}),Object.defineProperty(e.AutoWah.prototype,"sensitivity",{get:function(){return this.gainToDb(1/this._inputBoost.gain.value)},set:function(e){this._inputBoost.gain.value=1/this.dbToGain(e)}}),e.AutoWah.prototype._setSweepRange=function(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)},e.AutoWah.prototype.dispose=function(){return e.Effect.prototype.dispose.call(this),this.follower.dispose(),this.follower=null,this._sweepRange.dispose(),this._sweepRange=null,this._bandpass.dispose(),this._bandpass=null,this._peaking.dispose(),this._peaking=null,this._inputBoost.disconnect(),this._inputBoost=null,this._writable(["gain","Q"]),this.gain=null,this.Q=null,this},e.AutoWah}),Module(function(e){return e.BitCrusher=function(){var t=this.optionsObject(arguments,["bits"],e.BitCrusher.defaults);e.Effect.call(this,t);var i=1/Math.pow(2,t.bits-1);this._subtract=new e.Subtract,this._modulo=new e.Modulo(i),this._bits=t.bits,this.effectSend.fan(this._subtract,this._modulo),this._modulo.connect(this._subtract,0,1),this._subtract.connect(this.effectReturn)},e.extend(e.BitCrusher,e.Effect),e.BitCrusher.defaults={bits:4},Object.defineProperty(e.BitCrusher.prototype,"bits",{get:function(){return this._bits},set:function(e){this._bits=e;var t=1/Math.pow(2,e-1);this._modulo.value=t}}),e.BitCrusher.prototype.dispose=function(){return e.Effect.prototype.dispose.call(this),this._subtract.dispose(),this._subtract=null,this._modulo.dispose(),this._modulo=null,this},e.BitCrusher}),Module(function(e){return e.Chebyshev=function(){var t=this.optionsObject(arguments,["order"],e.Chebyshev.defaults);e.Effect.call(this),this._shaper=new e.WaveShaper(4096),this._order=t.order,this.connectEffect(this._shaper),this.order=t.order,this.oversample=t.oversample},e.extend(e.Chebyshev,e.Effect),e.Chebyshev.defaults={order:1,oversample:"none"},e.Chebyshev.prototype._getCoefficient=function(e,t,i){return i.hasOwnProperty(t)?i[t]:(0===t?i[t]=0:1===t?i[t]=e:i[t]=2*e*this._getCoefficient(e,t-1,i)-this._getCoefficient(e,t-2,i),i[t])},Object.defineProperty(e.Chebyshev.prototype,"order",{get:function(){return this._order},set:function(e){this._order=e;for(var t=new Array(4096),i=t.length,n=0;i>n;++n){var r=2*n/i-1;0===r?t[n]=0:t[n]=this._getCoefficient(r,e,{})}this._shaper.curve=t}}),Object.defineProperty(e.Chebyshev.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(e){this._shaper.oversample=e}}),e.Chebyshev.prototype.dispose=function(){return e.Effect.prototype.dispose.call(this),this._shaper.dispose(),this._shaper=null,this},e.Chebyshev}),Module(function(e){return e.StereoEffect=function(){e.call(this);var t=this.optionsObject(arguments,["wet"],e.Effect.defaults);this._dryWet=new e.CrossFade(t.wet),this.wet=this._dryWet.fade,this._split=new e.Split,this.effectSendL=this._split.left,this.effectSendR=this._split.right,this._merge=new e.Merge,this.effectReturnL=this._merge.left,this.effectReturnR=this._merge.right,this.input.connect(this._split),this.input.connect(this._dryWet,0,0),this._merge.connect(this._dryWet,0,1),this._dryWet.connect(this.output),this._readOnly(["wet"])},e.extend(e.StereoEffect,e.Effect),e.StereoEffect.prototype.dispose=function(){return e.prototype.dispose.call(this),this._dryWet.dispose(),this._dryWet=null,this._split.dispose(),this._split=null,this._merge.dispose(),this._merge=null,this.effectSendL=null,this.effectSendR=null,this.effectReturnL=null,this.effectReturnR=null,this._writable(["wet"]),this.wet=null,this},e.StereoEffect}),Module(function(e){return e.FeedbackEffect=function(){var t=this.optionsObject(arguments,["feedback"]);t=this.defaultArg(t,e.FeedbackEffect.defaults),e.Effect.call(this,t),this.feedback=new e.Signal(t.feedback,e.Type.NormalRange),this._feedbackGain=this.context.createGain(),this.effectReturn.chain(this._feedbackGain,this.effectSend),this.feedback.connect(this._feedbackGain.gain),this._readOnly(["feedback"])},e.extend(e.FeedbackEffect,e.Effect),e.FeedbackEffect.defaults={feedback:.125},e.FeedbackEffect.prototype.dispose=function(){return e.Effect.prototype.dispose.call(this),this._writable(["feedback"]),this.feedback.dispose(),this.feedback=null,this._feedbackGain.disconnect(),this._feedbackGain=null,this},e.FeedbackEffect}),Module(function(e){return e.StereoXFeedbackEffect=function(){var t=this.optionsObject(arguments,["feedback"],e.FeedbackEffect.defaults);e.StereoEffect.call(this,t),this.feedback=new e.Signal(t.feedback,e.Type.NormalRange),this._feedbackLR=this.context.createGain(),this._feedbackRL=this.context.createGain(),this.effectReturnL.chain(this._feedbackLR,this.effectSendR),this.effectReturnR.chain(this._feedbackRL,this.effectSendL),this.feedback.fan(this._feedbackLR.gain,this._feedbackRL.gain),this._readOnly(["feedback"])},e.extend(e.StereoXFeedbackEffect,e.FeedbackEffect),e.StereoXFeedbackEffect.prototype.dispose=function(){return e.StereoEffect.prototype.dispose.call(this),this._writable(["feedback"]),this.feedback.dispose(),this.feedback=null,this._feedbackLR.disconnect(),this._feedbackLR=null,this._feedbackRL.disconnect(),this._feedbackRL=null,this},e.StereoXFeedbackEffect}),Module(function(e){return e.Chorus=function(){var t=this.optionsObject(arguments,["frequency","delayTime","depth"],e.Chorus.defaults);
e.StereoXFeedbackEffect.call(this,t),this._depth=t.depth,this._delayTime=t.delayTime/1e3,this._lfoL=new e.LFO(t.rate,0,1),this._lfoR=new e.LFO(t.rate,0,1),this._lfoR.phase=180,this._delayNodeL=this.context.createDelay(),this._delayNodeR=this.context.createDelay(),this.frequency=this._lfoL.frequency,this.connectSeries(this.effectSendL,this._delayNodeL,this.effectReturnL),this.connectSeries(this.effectSendR,this._delayNodeR,this.effectReturnR),this.input.connect(this.output),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this._lfoL.start(),this._lfoR.start(),this._lfoL.frequency.connect(this._lfoR.frequency),this.depth=this._depth,this.frequency.value=t.frequency,this.type=t.type,this._readOnly(["frequency"])},e.extend(e.Chorus,e.StereoXFeedbackEffect),e.Chorus.defaults={frequency:1.5,delayTime:3.5,depth:.7,feedback:.1,type:"sine"},Object.defineProperty(e.Chorus.prototype,"depth",{get:function(){return this._depth},set:function(e){this._depth=e;var t=this._delayTime*e;this._lfoL.min=Math.max(this._delayTime-t,0),this._lfoL.max=this._delayTime+t,this._lfoR.min=Math.max(this._delayTime-t,0),this._lfoR.max=this._delayTime+t}}),Object.defineProperty(e.Chorus.prototype,"delayTime",{get:function(){return 1e3*this._delayTime},set:function(e){this._delayTime=e/1e3,this.depth=this._depth}}),Object.defineProperty(e.Chorus.prototype,"type",{get:function(){return this._lfoL.type},set:function(e){this._lfoL.type=e,this._lfoR.type=e}}),e.Chorus.prototype.dispose=function(){return e.StereoXFeedbackEffect.prototype.dispose.call(this),this._lfoL.dispose(),this._lfoL=null,this._lfoR.dispose(),this._lfoR=null,this._delayNodeL.disconnect(),this._delayNodeL=null,this._delayNodeR.disconnect(),this._delayNodeR=null,this._writable("frequency"),this.frequency=null,this},e.Chorus}),Module(function(e){return e.Convolver=function(){var t=this.optionsObject(arguments,["url"],e.Convolver.defaults);e.Effect.call(this,t),this._convolver=this.context.createConvolver(),this._buffer=new e.Buffer(t.url,function(e){this.buffer=e,t.onload()}.bind(this)),this.connectEffect(this._convolver)},e.extend(e.Convolver,e.Effect),e.Convolver.defaults={url:"",onload:e.noOp},Object.defineProperty(e.Convolver.prototype,"buffer",{get:function(){return this._buffer.get()},set:function(e){this._buffer.set(e),this._convolver.buffer=this._buffer.get()}}),e.Convolver.prototype.load=function(e,t){return this._buffer.load(e,function(e){this.buffer=e,t&&t()}.bind(this)),this},e.Convolver.prototype.dispose=function(){return e.Effect.prototype.dispose.call(this),this._convolver.disconnect(),this._convolver=null,this._buffer.dispose(),this._buffer=null,this},e.Convolver}),Module(function(e){return e.Distortion=function(){var t=this.optionsObject(arguments,["distortion"],e.Distortion.defaults);e.Effect.call(this,t),this._shaper=new e.WaveShaper(4096),this._distortion=t.distortion,this.connectEffect(this._shaper),this.distortion=t.distortion,this.oversample=t.oversample},e.extend(e.Distortion,e.Effect),e.Distortion.defaults={distortion:.4,oversample:"none"},Object.defineProperty(e.Distortion.prototype,"distortion",{get:function(){return this._distortion},set:function(e){this._distortion=e;var t=100*e,i=Math.PI/180;this._shaper.setMap(function(e){return Math.abs(e)<.001?0:(3+t)*e*20*i/(Math.PI+t*Math.abs(e))})}}),Object.defineProperty(e.Distortion.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(e){this._shaper.oversample=e}}),e.Distortion.prototype.dispose=function(){return e.Effect.prototype.dispose.call(this),this._shaper.dispose(),this._shaper=null,this},e.Distortion}),Module(function(e){return e.FeedbackDelay=function(){var t=this.optionsObject(arguments,["delayTime","feedback"],e.FeedbackDelay.defaults);e.FeedbackEffect.call(this,t),this.delayTime=new e.Signal(t.delayTime,e.Type.Time),this._delayNode=this.context.createDelay(4),this.connectEffect(this._delayNode),this.delayTime.connect(this._delayNode.delayTime),this._readOnly(["delayTime"])},e.extend(e.FeedbackDelay,e.FeedbackEffect),e.FeedbackDelay.defaults={delayTime:.25},e.FeedbackDelay.prototype.dispose=function(){return e.FeedbackEffect.prototype.dispose.call(this),this.delayTime.dispose(),this._delayNode.disconnect(),this._delayNode=null,this._writable(["delayTime"]),this.delayTime=null,this},e.FeedbackDelay}),Module(function(e){var t=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100],i=[225,556,441,341];return e.Freeverb=function(){var n=this.optionsObject(arguments,["roomSize","dampening"],e.Freeverb.defaults);e.StereoEffect.call(this,n),this.roomSize=new e.Signal(n.roomSize,e.Type.NormalRange),this.dampening=new e.Signal(n.dampening,e.Type.Frequency),this._combFilters=[],this._allpassFiltersL=[],this._allpassFiltersR=[];for(var r=0;r<i.length;r++){var o=this.context.createBiquadFilter();o.type="allpass",o.frequency.value=i[r],this._allpassFiltersL.push(o)}for(var s=0;s<i.length;s++){var a=this.context.createBiquadFilter();a.type="allpass",a.frequency.value=i[s],this._allpassFiltersR.push(a)}for(var h=0;h<t.length;h++){var l=new e.LowpassCombFilter(t[h]);h<t.length/2?this.effectSendL.chain(l,this._allpassFiltersL[0]):this.effectSendR.chain(l,this._allpassFiltersR[0]),this.roomSize.connect(l.resonance),this.dampening.connect(l.dampening),this._combFilters.push(l)}this.connectSeries.apply(this,this._allpassFiltersL),this.connectSeries.apply(this,this._allpassFiltersR),this._allpassFiltersL[this._allpassFiltersL.length-1].connect(this.effectReturnL),this._allpassFiltersR[this._allpassFiltersR.length-1].connect(this.effectReturnR),this._readOnly(["roomSize","dampening"])},e.extend(e.Freeverb,e.StereoEffect),e.Freeverb.defaults={roomSize:.7,dampening:3e3},e.Freeverb.prototype.dispose=function(){e.StereoEffect.prototype.dispose.call(this);for(var t=0;t<this._allpassFiltersL.length;t++)this._allpassFiltersL[t].disconnect(),this._allpassFiltersL[t]=null;this._allpassFiltersL=null;for(var i=0;i<this._allpassFiltersR.length;i++)this._allpassFiltersR[i].disconnect(),this._allpassFiltersR[i]=null;this._allpassFiltersR=null;for(var n=0;n<this._combFilters.length;n++)this._combFilters[n].dispose(),this._combFilters[n]=null;return this._combFilters=null,this._writable(["roomSize","dampening"]),this.roomSize.dispose(),this.roomSize=null,this.dampening.dispose(),this.dampening=null,this},e.Freeverb}),Module(function(e){var t=[.06748,.06404,.08212,.09004],i=[.773,.802,.753,.733],n=[347,113,37];return e.JCReverb=function(){var r=this.optionsObject(arguments,["roomSize"],e.JCReverb.defaults);e.StereoEffect.call(this,r),this.roomSize=new e.Signal(r.roomSize,e.Type.NormalRange),this._scaleRoomSize=new e.Scale(-.733,.197),this._allpassFilters=[],this._feedbackCombFilters=[];for(var o=0;o<n.length;o++){var s=this.context.createBiquadFilter();s.type="allpass",s.frequency.value=n[o],this._allpassFilters.push(s)}for(var a=0;a<t.length;a++){var h=new e.FeedbackCombFilter(t[a],.1);this._scaleRoomSize.connect(h.resonance),h.resonance.value=i[a],this._allpassFilters[this._allpassFilters.length-1].connect(h),a<t.length/2?h.connect(this.effectReturnL):h.connect(this.effectReturnR),this._feedbackCombFilters.push(h)}this.roomSize.connect(this._scaleRoomSize),this.connectSeries.apply(this,this._allpassFilters),this.effectSendL.connect(this._allpassFilters[0]),this.effectSendR.connect(this._allpassFilters[0]),this._readOnly(["roomSize"])},e.extend(e.JCReverb,e.StereoEffect),e.JCReverb.defaults={roomSize:.5},e.JCReverb.prototype.dispose=function(){e.StereoEffect.prototype.dispose.call(this);for(var t=0;t<this._allpassFilters.length;t++)this._allpassFilters[t].disconnect(),this._allpassFilters[t]=null;this._allpassFilters=null;for(var i=0;i<this._feedbackCombFilters.length;i++)this._feedbackCombFilters[i].dispose(),this._feedbackCombFilters[i]=null;return this._feedbackCombFilters=null,this._writable(["roomSize"]),this.roomSize.dispose(),this.roomSize=null,this._scaleRoomSize.dispose(),this._scaleRoomSize=null,this},e.JCReverb}),Module(function(e){return e.MidSideEffect=function(){e.Effect.call(this),this._midSideSplit=new e.MidSideSplit,this._midSideMerge=new e.MidSideMerge,this.midSend=this._midSideSplit.mid,this.sideSend=this._midSideSplit.side,this.midReturn=this._midSideMerge.mid,this.sideReturn=this._midSideMerge.side,this.effectSend.connect(this._midSideSplit),this._midSideMerge.connect(this.effectReturn)},e.extend(e.MidSideEffect,e.Effect),e.MidSideEffect.prototype.dispose=function(){return e.Effect.prototype.dispose.call(this),this._midSideSplit.dispose(),this._midSideSplit=null,this._midSideMerge.dispose(),this._midSideMerge=null,this.midSend=null,this.sideSend=null,this.midReturn=null,this.sideReturn=null,this},e.MidSideEffect}),Module(function(e){return e.Phaser=function(){var t=this.optionsObject(arguments,["frequency","depth","baseFrequency"],e.Phaser.defaults);e.StereoEffect.call(this,t),this._lfoL=new e.LFO(t.frequency,0,1),this._lfoR=new e.LFO(t.frequency,0,1),this._lfoR.phase=180,this._baseFrequency=t.baseFrequency,this._depth=t.depth,this.Q=new e.Signal(t.Q,e.Type.Positive),this._filtersL=this._makeFilters(t.stages,this._lfoL,this.Q),this._filtersR=this._makeFilters(t.stages,this._lfoR,this.Q),this.frequency=this._lfoL.frequency,this.frequency.value=t.frequency,this.effectSendL.connect(this._filtersL[0]),this.effectSendR.connect(this._filtersR[0]),this._filtersL[t.stages-1].connect(this.effectReturnL),this._filtersR[t.stages-1].connect(this.effectReturnR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=t.baseFrequency,this.depth=t.depth,this._lfoL.start(),this._lfoR.start(),this._readOnly(["frequency","Q"])},e.extend(e.Phaser,e.StereoEffect),e.Phaser.defaults={frequency:.5,depth:10,stages:10,Q:10,baseFrequency:350},e.Phaser.prototype._makeFilters=function(e,t,i){for(var n=new Array(e),r=0;e>r;r++){var o=this.context.createBiquadFilter();o.type="allpass",i.connect(o.Q),t.connect(o.frequency),n[r]=o}return this.connectSeries.apply(this,n),n},Object.defineProperty(e.Phaser.prototype,"depth",{get:function(){return this._depth},set:function(e){this._depth=e;var t=this._baseFrequency+this._baseFrequency*e;this._lfoL.max=t,this._lfoR.max=t}}),Object.defineProperty(e.Phaser.prototype,"baseFrequency",{get:function(){return this._baseFrequency},set:function(e){this._baseFrequency=e,this._lfoL.min=e,this._lfoR.min=e,this.depth=this._depth}}),e.Phaser.prototype.dispose=function(){e.StereoEffect.prototype.dispose.call(this),this._writable(["frequency","Q"]),this.Q.dispose(),this.Q=null,this._lfoL.dispose(),this._lfoL=null,this._lfoR.dispose(),this._lfoR=null;for(var t=0;t<this._filtersL.length;t++)this._filtersL[t].disconnect(),this._filtersL[t]=null;this._filtersL=null;for(var i=0;i<this._filtersR.length;i++)this._filtersR[i].disconnect(),this._filtersR[i]=null;return this._filtersR=null,this.frequency=null,this},e.Phaser}),Module(function(e){return e.PingPongDelay=function(){var t=this.optionsObject(arguments,["delayTime","feedback"],e.PingPongDelay.defaults);e.StereoXFeedbackEffect.call(this,t),this._leftDelay=this.context.createDelay(t.maxDelayTime),this._rightDelay=this.context.createDelay(t.maxDelayTime),this._rightPreDelay=this.context.createDelay(t.maxDelayTime),this.delayTime=new e.Signal(t.delayTime,e.Type.Time),this.effectSendL.chain(this._leftDelay,this.effectReturnL),this.effectSendR.chain(this._rightPreDelay,this._rightDelay,this.effectReturnR),this.delayTime.fan(this._leftDelay.delayTime,this._rightDelay.delayTime,this._rightPreDelay.delayTime),this._feedbackLR.disconnect(),this._feedbackLR.connect(this._rightDelay),this._readOnly(["delayTime"])},e.extend(e.PingPongDelay,e.StereoXFeedbackEffect),e.PingPongDelay.defaults={delayTime:.25,maxDelayTime:1},e.PingPongDelay.prototype.dispose=function(){return e.StereoXFeedbackEffect.prototype.dispose.call(this),this._leftDelay.disconnect(),this._leftDelay=null,this._rightDelay.disconnect(),this._rightDelay=null,this._rightPreDelay.disconnect(),this._rightPreDelay=null,this._writable(["delayTime"]),this.delayTime.dispose(),this.delayTime=null,this},e.PingPongDelay}),Module(function(e){return e.StereoFeedbackEffect=function(){var t=this.optionsObject(arguments,["feedback"],e.FeedbackEffect.defaults);e.StereoEffect.call(this,t),this.feedback=new e.Signal(t.feedback,e.Type.NormalRange),this._feedbackL=this.context.createGain(),this._feedbackR=this.context.createGain(),this.effectReturnL.chain(this._feedbackL,this.effectSendL),this.effectReturnR.chain(this._feedbackR,this.effectSendR),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),this._readOnly(["feedback"])},e.extend(e.StereoFeedbackEffect,e.FeedbackEffect),e.StereoFeedbackEffect.prototype.dispose=function(){return e.StereoEffect.prototype.dispose.call(this),this._writable(["feedback"]),this.feedback.dispose(),this.feedback=null,this._feedbackL.disconnect(),this._feedbackL=null,this._feedbackR.disconnect(),this._feedbackR=null,this},e.StereoFeedbackEffect}),Module(function(e){return e.StereoWidener=function(){var t=this.optionsObject(arguments,["width"],e.StereoWidener.defaults);e.MidSideEffect.call(this,t),this.width=new e.Signal(.5,e.Type.NormalRange),this._midMult=new e.Expr("$0 * ($1 * (1 - $2))"),this._sideMult=new e.Expr("$0 * ($1 * $2)"),this._two=new e.Signal(2),this._two.connect(this._midMult,0,1),this.width.connect(this._midMult,0,2),this._two.connect(this._sideMult,0,1),this.width.connect(this._sideMult,0,2),this.midSend.chain(this._midMult,this.midReturn),this.sideSend.chain(this._sideMult,this.sideReturn),this._readOnly(["width"])},e.extend(e.StereoWidener,e.MidSideEffect),e.StereoWidener.defaults={width:.5},e.StereoWidener.prototype.dispose=function(){return e.MidSideEffect.prototype.dispose.call(this),this._writable(["width"]),this.width.dispose(),this.width=null,this._midMult.dispose(),this._midMult=null,this._sideMult.dispose(),this._sideMult=null,this._two.dispose(),this._two=null,this},e.StereoWidener}),Module(function(e){return e.Tremolo=function(){var t=this.optionsObject(arguments,["frequency","depth"],e.Tremolo.defaults);e.Effect.call(this,t),this._lfo=new e.LFO({frequency:t.frequency,amplitude:t.depth,min:1,max:0}),this._amplitude=this.context.createGain(),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this._readOnly(["frequency","depth"]),this.connectEffect(this._amplitude),this._lfo.connect(this._amplitude.gain),this.type=t.type},e.extend(e.Tremolo,e.Effect),e.Tremolo.defaults={frequency:10,type:"sine",depth:.5},e.Tremolo.prototype.start=function(e){return this._lfo.start(e),this},e.Tremolo.prototype.stop=function(e){return this._lfo.stop(e),this},e.Tremolo.prototype.sync=function(e){return this._lfo.sync(e),this},e.Tremolo.prototype.unsync=function(){return this._lfo.unsync(),this},Object.defineProperty(e.Tremolo.prototype,"type",{get:function(){return this._lfo.type},set:function(e){this._lfo.type=e}}),e.Tremolo.prototype.dispose=function(){return e.Effect.prototype.dispose.call(this),this._writable(["frequency","depth"]),this._lfo.dispose(),this._lfo=null,this._amplitude.disconnect(),this._amplitude=null,this.frequency=null,this.depth=null,this},e.Tremolo}),Module(function(e){return e.Clip=function(t,i){if(t>i){var n=t;t=i,i=n}this.min=this.input=new e.Min(i),this._readOnly("min"),this.max=this.output=new e.Max(t),this._readOnly("max"),this.min.connect(this.max)},e.extend(e.Clip,e.SignalBase),e.Clip.prototype.dispose=function(){return e.prototype.dispose.call(this),this._writable("min"),this.min.dispose(),this.min=null,this._writable("max"),this.max.dispose(),this.max=null,this},e.Clip}),Module(function(e){return e.Normalize=function(t,i){this._inputMin=this.defaultArg(t,0),this._inputMax=this.defaultArg(i,1),this._sub=this.input=new e.Add(0),this._div=this.output=new e.Multiply(1),this._sub.connect(this._div),this._setRange()},e.extend(e.Normalize,e.SignalBase),Object.defineProperty(e.Normalize.prototype,"min",{get:function(){return this._inputMin},set:function(e){this._inputMin=e,this._setRange()}}),Object.defineProperty(e.Normalize.prototype,"max",{get:function(){return this._inputMax},set:function(e){this._inputMax=e,this._setRange()}}),e.Normalize.prototype._setRange=function(){this._sub.value=-this._inputMin,this._div.value=1/(this._inputMax-this._inputMin)},e.Normalize.prototype.dispose=function(){return e.prototype.dispose.call(this),this._sub.dispose(),this._sub=null,this._div.dispose(),this._div=null,this},e.Normalize}),Module(function(e){e.Route=function(i){i=this.defaultArg(i,2),e.call(this,1,i),this.gate=new e.Signal(0),this._readOnly("gate");for(var n=0;i>n;n++){var r=new t(n);this.output[n]=r,this.gate.connect(r.selecter),this.input.connect(r)}},e.extend(e.Route,e.SignalBase),e.Route.prototype.select=function(e,t){return e=Math.floor(e),this.gate.setValueAtTime(e,this.toSeconds(t)),this},e.Route.prototype.dispose=function(){this._writable("gate"),this.gate.dispose(),this.gate=null;for(var t=0;t<this.output.length;t++)this.output[t].dispose(),this.output[t]=null;return e.prototype.dispose.call(this),this};var t=function(t){this.selecter=new e.Equal(t),this.gate=this.input=this.output=this.context.createGain(),this.selecter.connect(this.gate.gain)};return e.extend(t),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.selecter.dispose(),this.selecter=null,this.gate.disconnect(),this.gate=null},e.Route}),Module(function(e){return e.Switch=function(t){t=this.defaultArg(t,!1),e.call(this),this.gate=new e.Signal(0),this._readOnly("gate"),this._thresh=new e.GreaterThan(.5),this.input.connect(this.output),this.gate.chain(this._thresh,this.output.gain),t&&this.open()},e.extend(e.Switch,e.SignalBase),e.Switch.prototype.open=function(e){return this.gate.setValueAtTime(1,this.toSeconds(e)),this},e.Switch.prototype.close=function(e){return this.gate.setValueAtTime(0,this.toSeconds(e)),this},e.Switch.prototype.dispose=function(){return e.prototype.dispose.call(this),this._writable("gate"),this.gate.dispose(),this.gate=null,this._thresh.dispose(),this._thresh=null,this},e.Switch}),Module(function(e){return e.Microphone=function(t){e.Source.call(this),this._mediaStream=null,this._stream=null,this._constraints={audio:!0};var i=this;MediaStreamTrack.getSources(function(e){t<e.length&&(i.constraints.audio={optional:[{sourceId:e[t].id}]})})},e.extend(e.Microphone,e.Source),e.Microphone.prototype._start=function(){navigator.getUserMedia(this._constraints,this._onStream.bind(this),this._onStreamError.bind(this))},e.Microphone.prototype._stop=function(){return this._stream.stop(),this},e.Microphone.prototype._onStream=function(e){this._stream=e,this._mediaStream=this.context.createMediaStreamSource(e),this._mediaStream.connect(this.output)},e.Microphone.prototype._onStreamError=function(e){console.error(e)},e.Microphone.prototype.dispose=function(){return e.Source.prototype.dispose.call(this),this._mediaStream&&(this._mediaStream.disconnect(),this._mediaStream=null),this._stream=null,this._constraints=null,this},navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,e.Microphone}),"function"==typeof define&&define.amd?define("Tone",[],function(){return Tone}):"object"==typeof module?module.exports=Tone:root.Tone=Tone}(this)},{}],112:[function(e,t,i){!function(){if("performance"in window==!1&&(window.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},"now"in window.performance==!1){var e=window.performance.timing&&window.performance.timing.navigationStart?window.performance.timing.navigationStart:Date.now();window.performance.now=function(){return Date.now()-e}}}();var n=n||function(){var e=[];return{getAll:function(){return e},removeAll:function(){e=[]},add:function(t){e.push(t)},remove:function(t){var i=e.indexOf(t);-1!==i&&e.splice(i,1)},update:function(t){if(0===e.length)return!1;var i=0;for(t=void 0!==t?t:window.performance.now();i<e.length;)e[i].update(t)?i++:e.splice(i,1);return!0}}}();n.Tween=function(e){var t=e,i={},r={},o={},s=1e3,a=0,h=!1,l=!1,c=!1,u=0,p=null,d=n.Easing.Linear.None,f=n.Interpolation.Linear,m=[],y=null,g=!1,v=null,b=null,_=null;for(var x in e)i[x]=parseFloat(e[x],10);this.to=function(e,t){return void 0!==t&&(s=t),r=e,this},this.start=function(e){n.add(this),l=!0,g=!1,p=void 0!==e?e:window.performance.now(),p+=u;for(var s in r){if(r[s]instanceof Array){if(0===r[s].length)continue;r[s]=[t[s]].concat(r[s])}i[s]=t[s],i[s]instanceof Array==!1&&(i[s]*=1),o[s]=i[s]||0}return this},this.stop=function(){return l?(n.remove(this),l=!1,null!==_&&_.call(t),this.stopChainedTweens(),this):this},this.stopChainedTweens=function(){for(var e=0,t=m.length;t>e;e++)m[e].stop()},this.delay=function(e){return u=e,this},this.repeat=function(e){return a=e,this},this.yoyo=function(e){return h=e,this},this.easing=function(e){return d=e,this},this.interpolation=function(e){return f=e,this},this.chain=function(){return m=arguments,this},this.onStart=function(e){return y=e,this},this.onUpdate=function(e){return v=e,this},this.onComplete=function(e){return b=e,this},this.onStop=function(e){return _=e,this},this.update=function(e){var n,l,_;if(p>e)return!0;g===!1&&(null!==y&&y.call(t),g=!0),l=(e-p)/s,l=l>1?1:l,_=d(l);for(n in r){var x=i[n]||0,w=r[n];w instanceof Array?t[n]=f(w,_):("string"==typeof w&&(w=x+parseFloat(w,10)),"number"==typeof w&&(t[n]=x+(w-x)*_))}if(null!==v&&v.call(t,_),1===l){if(a>0){isFinite(a)&&a--;for(n in o){if("string"==typeof r[n]&&(o[n]=o[n]+parseFloat(r[n],10)),h){var S=o[n];o[n]=r[n],r[n]=S}i[n]=o[n]}return h&&(c=!c),p=e+u,!0}null!==b&&b.call(t);for(var M=0,T=m.length;T>M;M++)m[M].start(p+s);return!1}return!0}},n.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){var t,i=.1,n=.4;return 0===e?0:1===e?1:(!i||1>i?(i=1,t=n/4):t=n*Math.asin(1/i)/(2*Math.PI),-(i*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)))},Out:function(e){var t,i=.1,n=.4;return 0===e?0:1===e?1:(!i||1>i?(i=1,t=n/4):t=n*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/n)+1)},InOut:function(e){var t,i=.1,n=.4;return 0===e?0:1===e?1:(!i||1>i?(i=1,t=n/4):t=n*Math.asin(1/i)/(2*Math.PI),(e*=2)<1?-.5*(i*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)):i*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)*.5+1)}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?.5*(e*e*((t+1)*e-t)):.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-n.Easing.Bounce.Out(1-e)},Out:function(e){return 1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return.5>e?.5*n.Easing.Bounce.In(2*e):.5*n.Easing.Bounce.Out(2*e-1)+.5}}},n.Interpolation={Linear:function(e,t){var i=e.length-1,r=i*t,o=Math.floor(r),s=n.Interpolation.Utils.Linear;return 0>t?s(e[0],e[1],r):t>1?s(e[i],e[i-1],i-r):s(e[o],e[o+1>i?i:o+1],r-o)},Bezier:function(e,t){for(var i=0,r=e.length-1,o=Math.pow,s=n.Interpolation.Utils.Bernstein,a=0;r>=a;a++)i+=o(1-t,r-a)*o(t,a)*e[a]*s(r,a);return i},CatmullRom:function(e,t){var i=e.length-1,r=i*t,o=Math.floor(r),s=n.Interpolation.Utils.CatmullRom;return e[0]===e[i]?(0>t&&(o=Math.floor(r=i*(1+t))),s(e[(o-1+i)%i],e[o],e[(o+1)%i],e[(o+2)%i],r-o)):0>t?e[0]-(s(e[0],e[0],e[1],e[1],-r)-e[0]):t>1?e[i]-(s(e[i],e[i],e[i-1],e[i-1],r-i)-e[i]):s(e[o?o-1:0],e[o],e[o+1>i?i:o+1],e[o+2>i?i:o+2],r-o)},Utils:{Linear:function(e,t,i){return(t-e)*i+e},Bernstein:function(e,t){var i=n.Interpolation.Utils.Factorial;return i(e)/i(t)/i(e-t)},Factorial:function(){var e=[1];return function(t){var i=1;if(e[t])return e[t];for(var n=t;n>1;n--)i*=n;return e[t]=i,i}}(),CatmullRom:function(e,t,i,n,r){var o=.5*(i-e),s=.5*(n-t),a=r*r,h=r*a;return(2*t-2*i+o+s)*h+(-3*t+3*i-2*o-s)*a+o*r+t}}},function(e){"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof i?t.exports=n:e.TWEEN=n}(this)},{}]},{},[6]);
